webpackJsonp([1],{"+ObS":function(e,t){},"+U9w":function(e,t){},"/nfb":function(e,t){},"07AF":function(e,t){},"0x9a":function(e,t){},"1HiJ":function(e,t){},"2e9R":function(e,t){},"31Vc":function(e,t){},"3LtE":function(e,t){},"47Nh":function(e,t){},"4z8Q":function(e,t){},"5XYr":function(e,t){},"5cle":function(e,t){},"5iL7":function(e,t){},"65NU":function(e,t){},"68SA":function(e,t){},"6mbZ":function(e,t){},"6qa5":function(e,t){},"75Wb":function(e,t){},"7R1e":function(e,t){},"7W8b":function(e,t){},"7bvK":function(e,t){},"7u0u":function(e,t){},"8NxH":function(e,t){},"8Td+":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MkZBQTNFQjQ4RDkzMTFFODk5QUY5MEYyNDkzRDE2ODIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MkZBQTNFQjU4RDkzMTFFODk5QUY5MEYyNDkzRDE2ODIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5MDc3MUI4OThENUQxMUU4OTlBRjkwRjI0OTNEMTY4MiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5MDc3MUI4QThENUQxMUU4OTlBRjkwRjI0OTNEMTY4MiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PoVF8H0AAAOnSURBVHja7Jvba9NQHMdP0iRNsy0ddjd0OnFOJiIo6pOo+OSDKAoiQ8XLk1d88S8Q55PPCvPJCYI+Koj65A3RFxGc4gZSEHQXt7m1nTW9JX5Pm0HWbbFuPUna5gcfTtrSQ775nd/v/M5JwhmGQazGcRwp1Z4PJkJoRsHOvd0Nn4iHrFjXrPHL7DcIVNBEKsS4pXgYnu1GsxH8BmdAP5DBGDz91sseFpbY3zFwGcyAdeA2OAS+gu1V52GLp6lXh8A+eHawFmKYCl4D2iolhoVl/p/G8DMQdVvIt8m0iOYmqAMXQGxR11upVIPgXcAw6SnWNYtAqsc+gvdAAa+ZJC0vG6ukVXEmlDmOetD0lrtfG5sABzsi0rArgmFHQaeDDusAO8DDUv9Q7iHtRohwXj/ByothlJRb0TwBrdbvo+MppifLw5etYZGERN7xIXiiWKwTpmOmSWi6KzEX8Nr86sewL9gX7AuuHcGapqlgM5CqXjBEHkAzbK4vo/jcXe0evgW+mMUF/f16tZeWq8B9WZbvwbvncbzWroMmVST1QbapIJU1yMhUmpngp+AKxB4xxV61LblQ3woBtrskOd1g6uHjpshNoA/csOtgLJbJU7FDGkN5ihTuKvjzsC+4VjYArCYJHJFFttctnTOIlta9IbglLDIXTJN0dEzzhuCJeJYoDszDnhnSWkbP4yctF6z/1XcZnKsJwRBK71OfBUEcX6oFD9PbLm9MTS+ZxfCKeoHUyWw3MdPIEf8qX0/tbk/Cs3RJ24njgZNlfqhlzjwcFNguHrgSByKE0iXVA6ZZenQ6Q3g+y3Ye1j00LZX7hPxpyRfs8pAO8Fw+cbG0LBYPmZzhDcFtjSIJSYwXD8gR0Z8pbwiOJXN5D9TM4mFGy+Xxk5YvuMKyNOrU02goZGQysZ7n2V0rRRZJQ0hyVzApbMrvoQeZnE53x5kJlsSAP6TtJgpWHnauYLZ5cAUFyDtSuCNC7Rd4wUrwkFN601nd5jfjcUdEuuPEkH5ECu8oMbdUJgthC87ttNy6yzyG4/F4+PAWdXVXi9SL0nnGCdHj08li0XpEIX3bVhrtOJ8uoCxpM2GxB8TR4X4010jh/STZMqTIDyz6YxpCjWO900FIXVAgCmr1iGIQeX4A0os/AC6qqvphbhow/k+wKboZzQZSuEnebGkbAX0Nrx40mBeEvlyhFo2acClrA5CwLo5MIfS7PyBpZmJ662HaDKtZRsBniE3Mz3sLC/4rwADdgm5QNzjziAAAAABJRU5ErkJggg=="},"8wm5":function(e,t){},"9Z+r":function(e,t){},AMGG:function(e,t){},Ajnd:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QkE0MjU5NkYyNTk3MTFFODhDMEFDOEU0MENBMDZDQ0QiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QkE0MjU5NzAyNTk3MTFFODhDMEFDOEU0MENBMDZDQ0QiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCQTQyNTk2RDI1OTcxMUU4OEMwQUM4RTQwQ0EwNkNDRCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCQTQyNTk2RTI1OTcxMUU4OEMwQUM4RTQwQ0EwNkNDRCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pmtl6ywAAANCSURBVHja7NzdS1NhHAfw5znbdLqVvWhoEQiFF4aKEUReFBlBGBbddGd3Wv9BedFFdRfdBL1QBpl5F3RRUGkk66KItCSbWCSYmUrNOR26zeY56/vkGolvc7N51O8XfjzHs8F5/Pic8zznCEdGIhHBJB6NBAQkIAHXcORCXyiva89GU4U6iipFbVrC4z9GnWypLg2tVEDrPHDqs7OoWpTjPx2/EnUVdXpVjUDgZaF5hNqfon5UYRQ2rgpA4NnRuFB7U9iPcdQeIH5aDZPI5RTjiegl4gH+eBkregTiFyhE41b7nXaLOFaUKwqyM4UzXRMWKZf0wAbugF588YknnT//3X0XdXGZTYZwJowlCng73WaprinbLnZstqekt/daB0V736jZBtbn6ArhFjC74wIEnizY4hypKdu23qrJlPXUwK24G4C6Yb578i5PwHjb57+GzXOADM4L2PDRe6YkL/OmlKnvaFgXYneO3XSAD90ecf1Nv9r8gKoA4sCsk8iz3rGtxXmZN5YDT8VmEaLTO2HmuaIE1Rxd3s0E3JCuteKslcvZQ0NGxI/gpJkRd6lr4oxTuLl37ECu0+IyQw/Vo0ndMEE/oq0vEBYNbQPiu2/a5e8gTuWYl3w1GOhclyYL+Vhg7gTDhmjqGhau7iH141MAVsQA33sCvzDr2sgUxwJxfFJcaekxQmE9B4jDf66BxIs/2Q6ruFCxU9uZ46iMjcAOb5D/FFlkQuFIeDhkZBzJd+p8oJpA7DZpc6RpLzkCk5yp+/16HkdgEk9hnGmykYBJJMMq91lHJ3gGJ34PH9Gsrq8TlEhiPuEpnGQISEACEpCADAEJSEACMgQkIAEJyBCQgAQkIENAAhKQgAwBCUhAAjIEJCABCcgQkIAEJCBDQAKaDtBPhoTjV4AddEg4bgX4nA4Jp1kB3kfptFh0lFmDdr5sYw826umx6NQru7+zsHpLWz9N4o6yqo0tYyDpRXOcM3J8My/qBMw809aB2PEOzSGOxAVHXjmsWmddSOODNjH1kpk7nFhmTBh1qOLoQItlzpftXHrty0dzCnUYVYTKWmNoI2LqTXZNarYF3LfZviT5Im7eCxOQgARkCEjAlZnfAgwAEjvnhoeEomIAAAAASUVORK5CYII="},CM68:function(e,t){},DmJO:function(e,t){},E3Op:function(e,t){},E7mM:function(e,t){},F3eK:function(e,t){},FlYF:function(e,t){},H7hH:function(e,t){},Hdq0:function(e,t){},KIo0:function(e,t){},KKaX:function(e,t){},KP6K:function(e,t){},KSrJ:function(e,t){},KY6x:function(e,t){},KfuN:function(e,t){},Kuzc:function(e,t){},M5b0:function(e,t){},MTDY:function(e,t){},"MV/I":function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});a("j1ja");var s=a("hKoQ"),i=a.n(s),r=a("lRwf"),o=a.n(r),l={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var n=a("VU/8")({name:"App",data:function(){return{}}},l,!1,function(e){a("u8g3")},null,null).exports,d=a("pRNm"),c=a.n(d),u=a("wvfG"),m=a.n(u),p=new(a("TXMN").a),h={data:function(){return{widthData:"200px",collapseFlag:!1,menuRouter:[],leftMenuRouter:[],leftModulesName:"微商城",projectName:"mall"}},mounted:function(){var e=this;p.$on("widthData",function(t){e.widthData=t})},computed:{},methods:{toRouterView:function(e){this.$router.push({path:e.path})},collapseTag:function(e){this.collapseFlag=e,this.collapseFlag?this.widthData="64px":this.widthData="200px"}},components:{}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("vue-gic-header",{attrs:{projectName:e.projectName,collapseFlag:e.collapseFlag},on:{collapseTag:e.collapseTag,toRouterView:e.toRouterView}}),e._v(" "),a("div",{staticClass:"mall-content-container"},[a("div",{staticClass:"left-menu"},[a("vue-gic-aside-menu",{staticStyle:{display:"inline-block",height:"100%"},attrs:{projectName:e.projectName,leftModulesName:e.leftModulesName,collapseFlag:e.collapseFlag}})],1),e._v(" "),a("div",{staticClass:"goods-manege-content",style:{marginLeft:e.widthData}},[a("router-view"),e._v(" "),a("vue-gic-footer")],1)])],1)},staticRenderFns:[]};var v=a("VU/8")(h,g,!1,function(e){a("Rclr"),a("m5KO")},"data-v-8a9d722c",null).exports,f=a("BO1k"),b=a.n(f),y=a("mw3O"),_=a.n(y),C={getInputVal:function(e,t){for(var a="",s=0,i=0;i<e.length&&(null!=e[i].match(/[^\x00-\xff]/gi)?s+=1:s+=.5,!(s>t));i++)a+=e[i];return a},getInputValSin:function(e,t){for(var a="",s=0,i=0;i<e.length&&!((s+=1)>t);i++)a+=e[i];return a},getZhLen:function(e){for(var t=0,a=0;a<e.length;a++){null!=e.charAt(a).match(/[^\x00-\xff]/gi)?t+=1:t+=.5}return Math.ceil(t)},getTime:function(e){isNaN(e)||(e=Number(e));var t=new Date(e),a=t.getFullYear(),s=t.getMonth()+1;s=s>=10?s:"0"+s;var i=t.getDate();return a+"-"+s+"-"+(i=i>=10?i:"0"+i)},getSeconds:function(e){isNaN(e)||(e=Number(e));var t=new Date(e),a=t.getHours();a=a>=10?a:"0"+a;var s=t.getMinutes();s=s>=10?s:"0"+s;var i=t.getSeconds();return a+":"+s+":"+(i=i>=10?i:"0"+i)},formatDate:function(e){isNaN(e)||(e=Number(e));var t=new Date(e),a=t.getFullYear(),s=t.getMonth()+1;s=s>=10?s:"0"+s;var i=t.getDate();i=i>=10?i:"0"+i;var r=t.getHours();r=r>=10?r:"0"+r;var o=t.getMinutes();o=o>=10?o:"0"+o;var l=t.getSeconds();return a+"-"+s+"-"+i+" "+r+":"+o+":"+(l=l>=10?l:"0"+l)}},I=a("//Fk"),S=a.n(I),w=a("Dd8w"),x=a.n(w),L=a("mtWM"),k=a.n(L),N=a("SJI6"),T=a.n(N),D={state:{all:0,cartData:[],total:0},getters:{allProducts:function(e,t,a){return e.all},allCartData:function(e){return e.cartData},total:function(e){e.total=0;var t=!0,a=!1,s=void 0;try{for(var i,r=b()(e.cartData);!(t=(i=r.next()).done);t=!0){var o=i.value;e.total+=o.price}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}return e.total}},actions:{setAll:function(e,t){(0,e.commit)("mutations_setAll",t)},setCartData:function(e,t){(0,e.commit)("mutations_CartData",t)},removecartData:function(e,t){(0,e.commit)("mutations_removeCartData",t)}},mutations:{mutations_setAll:function(e,t){e.all=t},mutations_CartData:function(e,t){e.cartData.push(t)},mutations_removeCartData:function(e,t){for(var a in e.cartData)e.cartData[a].id===t.id&&e.cartData.splice(a,1)}}};o.a.use(T.a);var P=new T.a.Store({modules:{product:D}}),F=void 0;(F=k.a.create({baseURL:"",withCredentials:!0,timeout:3e4,headers:{sign:""}})).interceptors.request.use(function(e){return e.params=x()({requestProject:"mall"},e.params),P.state.token&&(e.headers.Authorization="token "+P.state.token),localStorage.getItem("sign")?e.headers.sign=localStorage.getItem("sign"):e.headers.sign="",e},function(e){return S.a.reject(e)}),F.interceptors.response.use(function(e){return 200==e.status&&401===e.data.errorCode&&(window.location.href=window.location.origin+"/gic-web"),e},function(e){if(e.response)switch(e.response.status){case 401:P.commit(types.LOGOUT),Zs.replace({name:"login",query:{redirect:Zs.currentRoute.fullPath}})}return S.a.reject(e.response.data)});var A=F,M=a("mvHQ"),O=a.n(M),$={props:{modalData:{type:Object}},data:function(){return{}},methods:{onCopy:function(e){this.$message.success("复制成功")},onError:function(e){this.$message.error("复制失败")}}},V={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"商品链接",visible:e.modalData.show,width:"450px"},on:{"update:visible":function(t){e.$set(e.modalData,"show",t)}}},[a("div",{staticClass:"dialog-body"},[a("div",{staticClass:"wechat-url",staticStyle:{"margin-bottom":"30px"}},[a("p",{staticStyle:{"font-weight":"600","margin-bottom":"15px"}},[e._v("页面链接")]),e._v(" "),a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("el-input",{attrs:{type:"textarea",rows:2,disabled:""},model:{value:e.modalData.pageUrl,callback:function(t){e.$set(e.modalData,"pageUrl",t)},expression:"modalData.pageUrl"}}),e._v(" "),a("a",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.modalData.pageUrl,expression:"modalData.pageUrl",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}],staticStyle:{width:"40px","margin-left":"20px"},attrs:{href:"javaScript:void(0)"}},[e._v("\n          复制\n        ")])],1)]),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.modalData.loading,expression:"modalData.loading"}],staticClass:"wechat-img-box"},[a("p",{staticStyle:{"font-weight":"600","margin-bottom":"15px"}},[e._v("小程序二维码")]),e._v(" "),a("img",{staticClass:"wechat-img",staticStyle:{width:"140px",height:"140px"},attrs:{src:e.modalData.imgUrl}})])])])},staticRenderFns:[]};var R=a("VU/8")($,V,!1,function(e){a("2e9R")},"data-v-85b1ec02",null).exports,U={props:{tableSkuHeaderData:{type:Array},stockModalData:{type:Object}},data:function(){return{payload:[]}},methods:{confirmStockModal:function(){var e=this,t=[];for(var a in this.stockModalData.tableSkuData){var s=this.stockModalData.tableSkuData[0].length-1;for(var i in this.stockModalData.tableSkuData[a])i==s&&t.push(this.stockModalData.tableSkuData[a][i].valueName)}for(var r in this.payload=[],this.stockModalData.list)this.payload.push({mallProSkuId:this.stockModalData.list[r].mallProSkuId,mallProId:this.stockModalData.list[r].mallProId,stock:t[r]});A.post("/api-mall/update-mall-goods-stock",this.payload).then(function(t){0===t.data.errorCode?(e.$message.success(t.data.result),e.stockModalData.modalShow=!1,e.$nextTick(function(){e.$emit("getList")})):e.$message.error(t.data.message)})},cancelStockModal:function(){this.stockModalData.modalShow=!1}}},E={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"调整库存",visible:e.stockModalData.modalShow,width:e.stockModalData.modalWidth+40+"px"},on:{"update:visible":function(t){e.$set(e.stockModalData,"modalShow",t)},close:e.cancelStockModal}},[a("div",{staticClass:"dialog-body",staticStyle:{width:"570px"}},[a("table",{staticClass:"brand-table",style:{width:e.stockModalData.modalWidth+"px"}},[a("thead",{staticStyle:{display:"table",width:"100%","table-layout":"fixed"}},[a("tr",e._l(e.stockModalData.tableSkuHeaderData,function(t,s){return a("th",{key:s},[e._v("\n            "+e._s(t)+"\n          ")])}))]),e._v(" "),a("tbody",{staticStyle:{display:"block","max-height":"300px","overflow-y":"auto"}},e._l(e.stockModalData.tableSkuData,function(t,s){return a("tr",{key:s,staticStyle:{display:"table",width:"100%","table-layout":"fixed"}},e._l(t,function(s,i){return a("td",{key:i},[i!==t.length-1?a("span",[e._v(e._s(s.valueName))]):a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"请输入内容"},model:{value:s.valueName,callback:function(t){e.$set(s,"valueName",t)},expression:"m.valueName"}})],1)}))}))])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelStockModal}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.confirmStockModal()}}},[e._v("确 定")])],1)])},staticRenderFns:[]};var G=a("VU/8")(U,E,!1,function(e){a("P46x")},"data-v-73512c9e",null).exports,B={name:"tishi",props:{tips:{type:String,default:"是否删除?"}},data:function(){return{visible:!1}},methods:{cancel:function(){this.visible=!1},confirm:function(){this.visible=!1,this.$emit("confirm")}}},z={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("p",{staticStyle:{"line-height":"1.5",padding:"10px 10px 20px",color:"#606266"}},[e._v(e._s(e.tips))]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:e.cancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.confirm}},[e._v("确定")])],1),e._v(" "),a("span",{staticStyle:{margin:"0 10px"},attrs:{slot:"reference"},slot:"reference"},[e._t("default")],2)])},staticRenderFns:[]},j=a("VU/8")(B,z,!1,null,null,null).exports,H={props:{editInfoModal:{type:Object,default:function(){return{}}}},data:function(){return{goodsInfo:{proNameLen:0},modalRules:{proName:[{required:!0,message:"请输入商品名称",trigger:"blur"}]}}},methods:{proNameLimit:function(e){var t=this;this.$nextTick(function(){t.editInfoModal.proName=C.getInputVal(e,30),t.editInfoModal.proNameLen=C.getZhLen(t.editInfoModal.proName)})},submitProNanme:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var a={mallProId:t.editInfoModal.mallProId,mallProName:t.editInfoModal.proName};A.post("/api-mall/update-mall-goods-name",_.a.stringify(a)).then(function(e){0===e.data.errorCode?(t.$message.success("修改成功"),t.editInfoModal.dialogVisible=!1,t.$emit("getList")):t.$message.error(e.data.message)})})},cancelSubmit:function(e){this.$refs[e].resetFields(),this.editInfoModal.dialogVisible=!1}}},Y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"修改商品名称",visible:e.editInfoModal.dialogVisible,width:"450px"},on:{"update:visible":function(t){e.$set(e.editInfoModal,"dialogVisible",t)},close:function(t){e.cancelSubmit("editInfoModal")}}},[a("el-form",{ref:"editInfoModal",attrs:{model:e.editInfoModal,rules:e.modalRules}},[a("el-form-item",{attrs:{label:"商品名称","label-width":"80px",prop:"proName"}},[a("el-input",{staticStyle:{width:"330px"},attrs:{type:"textarea",row:2},on:{input:function(t){return e.proNameLimit(t)}},model:{value:e.editInfoModal.proName,callback:function(t){e.$set(e.editInfoModal,"proName",t)},expression:"editInfoModal.proName"}})],1),e._v(" "),a("span",{staticClass:"slot-num"},[e._v(e._s(e.editInfoModal.proNameLen)+"/30")])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.cancelSubmit("editInfoModal")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitProNanme("editInfoModal")}}},[e._v("确 定")])],1)],1)},staticRenderFns:[]};var Z=a("VU/8")(H,Y,!1,function(e){a("OL9M")},"data-v-327b943e",null).exports,K={props:{tableData:{type:Array,default:function(){return[]}},searchObj:{type:Object}},data:function(){return{sortColumn:"",sortType:"",dialogFormVisible:!1,getTime:C.getTime,getSeconds:C.getSeconds,stockModalData:{list:[],tableSkuData:[],tableSkuHeaderData:[],modalWidth:"",modalShow:!1,total:0},refreshStatus:!1,modalData:{show:!1,imgUrl:"",loading:!1},refash:!1,visible2:!1,editInfoModal:{proName:"",proNameLen:0,mallProId:"",dialogVisible:!1}}},computed:{temArr:function(){return this.tableData}},methods:{getList:function(e){this.$emit("getList")},sortChange:function(e){this.sortColumn=e.prop,"ascending"==e.order?this.sortType="asc":"descending"==e.order&&(this.sortType="desc"),this.$emit("getList",this.sortType,this.sortColumn)},handleSelectAll:function(e){this.$emit("getSelectList",e)},deleteItem:function(e,t,a,s){this.$emit("handleItem",e,t,a)},cancelDeleteItem:function(e){var t=!0,a=!1,s=void 0;try{for(var i,r=b()(this.tableData);!(t=(i=r.next()).done);t=!0){i.value.soldOutVisible=!1}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}this.tableData[e].soldOutVisible=!1,this.refash=!this.refash},getLink:function(e){var t=this;this.modalData.loading=!0;var a={mallProId:e};this.modalData.show=!0,A.get("/api-mall/get-mall-goods-qRCode",{params:a}).then(function(e){0===e.data.errorCode?(t.modalData.show=!0,t.modalData.pageUrl=e.data.result.page,t.modalData.imgUrl=e.data.result.url,t.modalData.loading=!1):t.$message.error(e.data.message)})},handleStock:function(e){var t=this;this.stockModalData.modalShow=!0;var a={mallProId:e.mallProId};A.get("/api-mall/get-mall-goods-skus",{params:a}).then(function(e){if(0===e.data.errorCode){t.stockModalData.list=e.data.result,t.stockModalData.total=e.data.result.length,t.stockModalData.tableSkuData=[],t.stockModalData.tableSkuHeaderData=[];var a=JSON.parse(e.data.result[0].mallPropValues);for(var s in a)t.stockModalData.tableSkuHeaderData.push(a[s].propName);for(var i in t.stockModalData.tableSkuHeaderData.push("库存"),e.data.result){var r=JSON.parse(e.data.result[i].mallPropValues);r.push({valueName:e.data.result[i].stock}),t.stockModalData.tableSkuData.push(r)}t.refreshStatus=!t.refreshStatus,t.stockModalData.modalWidth=140*(t.stockModalData.tableSkuData[0].length+1)}else t.$message.error(e.data.message)})},editGoods:function(e){window.localStorage.setItem("goodsSearch",O()(this.searchObj)),this.$router.push({name:"goodsEdit",params:{mallProId:e.mallProId,createSource:e.createSource}})},editErpGoods:function(e){window.localStorage.setItem("goodsSearch",O()(this.searchObj)),this.$router.push({name:"goodsErpEdit",params:{mallProId:e.mallProId}})},editProName:function(e){this.editInfoModal.proName=e.proName,this.editInfoModal.dialogVisible=!0,this.editInfoModal.proNameLen=C.getZhLen(this.editInfoModal.proName),this.editInfoModal.mallProId=e.mallProId}},components:{eqCodeDialog:R,stockModal:G,tishi:j,editInfo:Z}},J={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"goods-list-content"},[s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{"sort-change":e.sortChange,"selection-change":e.handleSelectAll}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),s("el-table-column",{attrs:{label:"商品信息",width:"400px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"img-text"},[s("img",{attrs:{src:t.row.mallProImageUrl?t.row.mallProImageUrl:"http://pic01-10001430.image.myqcloud.com/img-icon-pro.png"}}),e._v(" "),s("div",{staticClass:"text"},[s("p",{staticClass:"goods-descript"},[e._v(e._s(t.row.proName)),s("i",{staticClass:"el-icon-edit",on:{click:function(a){e.editProName(t.row)}}})]),e._v(" "),s("p",{staticClass:"goods-code"},[e._v("货号:"+e._s(t.row.proCode))]),e._v(" "),s("p",[1===t.row.activityIcon.reductionStatus?s("span",{staticClass:"active-icon-reduce"},[e._v("满")]):e._e(),e._v(" "),1===t.row.activityIcon.discountStatus?s("span",{staticClass:"active-icon-discount"},[e._v("折")]):e._e(),e._v(" "),1===t.row.activityIcon.freeStatus?s("span",{staticClass:"active-icon-postage"},[e._v("邮")]):e._e()])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"mallProSpuPrice",label:"单价",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v("￥"+e._s(t.row.mallProSpuPrice))])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"stock",label:"库存",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[s("span",[e._v(e._s(t.row.stock))]),e._v(" "),s("i",{staticClass:"el-icon-edit",on:{click:function(a){e.handleStock(t.row)}}})])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"complete",label:"完善状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.complete?s("p",{staticStyle:{"line-height":"18px"}},[s("span",{staticClass:"dm-status--error"},[e._v("未完善")])]):e._e(),e._v(" "),1===t.row.complete?s("p",{staticStyle:{"line-height":"18px"}},[s("span",{staticClass:"dm-status--success"},[e._v("已完善")])]):e._e()]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"saleNum",label:"总销量",sortable:"custom",width:"110px"}}),e._v(" "),s("el-table-column",{attrs:{prop:"upShelvesTime",label:"发布时间",sortable:"custom",width:"110px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticStyle:{"line-height":"18px"}},[e._v(e._s(e.getTime(t.row.upShelvesTime)))]),e._v(" "),s("p",{staticClass:"gray-color",staticStyle:{"line-height":"18px"}},[e._v(e._s(e.getSeconds(t.row.upShelvesTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:"240px",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.proType?s("el-button",{attrs:{type:"text"},on:{click:function(a){e.editGoods(t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),1===t.row.proType?s("el-button",{attrs:{type:"text"},on:{click:function(a){e.editErpGoods(t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),s("tishi",{ref:"tishi",attrs:{tips:"是否下架该商品?"},on:{confirm:function(a){e.deleteItem(t.row.mallProId,1,1)}}},[s("el-button",{attrs:{type:"text"}},[e._v("下架")])],1),e._v(" "),s("tishi",{ref:"tishi",staticStyle:{"margin-left":"-8px"},attrs:{tips:"是否删除该商品?"},on:{confirm:function(a){e.deleteItem(t.row.mallProId,3)}}},[s("el-button",{attrs:{type:"text"}},[e._v("删除")])],1),e._v(" "),s("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refash))]),e._v(" "),s("el-button",{attrs:{type:"text"},on:{click:function(a){e.getLink(t.row.mallProId)}}},[e._v("商品链接")])]}}])}),e._v(" "),s("template",{slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2),e._v(" "),s("eqCodeDialog",{attrs:{modalData:e.modalData}}),e._v(" "),s("stockModal",{attrs:{stockModalData:e.stockModalData},on:{getList:e.getList}}),e._v(" "),s("editInfo",{attrs:{editInfoModal:e.editInfoModal},on:{getList:e.getList}})],1)},staticRenderFns:[]};var W=a("VU/8")(K,J,!1,function(e){a("g7Hf"),a("3LtE")},"data-v-33028ebe",null).exports,q={props:{tableData:{type:Array,default:function(){return[]}},searchObj:{type:Object}},data:function(){return{getTime:C.getTime,getSeconds:C.getSeconds,modalData:{show:!1,imgUrl:"",loading:!1},stockModalData:{tableSkuData:[],tableSkuHeaderData:[],modalWidth:"",modalShow:!1},editInfoModal:{proName:"",proNameLen:0,mallProId:"",dialogVisible:!1}}},methods:{getList:function(e){this.$emit("getList")},sortChange:function(e){this.sortColumn=e.prop,"ascending"==e.order?this.sortType="asc":"descending"==e.order&&(this.sortType="desc"),this.$emit("getList",this.sortType,this.sortColumn)},handleSelectAll:function(e){this.$emit("getSelectList",e)},deleteItem:function(e,t,a){if(a&&2===t&&0===a.complete)return this.$message.error("未完善的商品不允许上架"),!1;this.$emit("handleItem",e,t)},getLink:function(e){var t=this;this.modalData.loading=!0;var a={mallProId:e};this.modalData.show=!0,A.get("/api-mall/get-mall-goods-qRCode",{params:a}).then(function(e){0===e.data.errorCode?(t.modalData.imgUrl=e.data.result.url,t.modalData.pageUrl=e.data.result.page,t.modalData.loading=!1,t.modalData.show=!0):t.$message.error(e.data.message)})},handleStock:function(e){var t=this;this.stockModalData.modalShow=!0;var a={mallProId:e.mallProId};A.get("/api-mall/get-mall-goods-skus",{params:a}).then(function(e){if(0===e.data.errorCode){t.stockModalData.list=e.data.result,t.stockModalData.total=e.data.result.length,t.stockModalData.tableSkuData=[],t.stockModalData.tableSkuHeaderData=[];var a=JSON.parse(e.data.result[0].mallPropValues);for(var s in a)t.stockModalData.tableSkuHeaderData.push(a[s].propName);for(var i in t.stockModalData.tableSkuHeaderData.push("库存"),e.data.result){var r=JSON.parse(e.data.result[i].mallPropValues);r.push({valueName:e.data.result[i].stock}),t.stockModalData.tableSkuData.push(r)}t.refreshStatus=!t.refreshStatus,t.stockModalData.modalWidth=140*(t.stockModalData.tableSkuData[0].length+1)}else t.$message.error(e.data.message)})},editGoods:function(e){window.localStorage.setItem("goodsSearch",O()(this.searchObj)),this.$router.push({name:"goodsEdit",params:{mallProId:e.mallProId,createSource:e.createSource}})},editErpGoods:function(e){window.localStorage.setItem("goodsSearch",O()(this.searchObj)),this.$router.push({name:"goodsErpEdit",params:{mallProId:e.mallProId}})},editProName:function(e){this.editInfoModal.proName=e.proName,this.editInfoModal.dialogVisible=!0,this.editInfoModal.proNameLen=C.getZhLen(this.editInfoModal.proName),this.editInfoModal.mallProId=e.mallProId}},components:{eqCodeDialog:R,stockModal:G,tishi:j,editInfo:Z}},Q={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"goods-list-content"},[s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{"sort-change":e.sortChange,"selection-change":e.handleSelectAll}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),s("el-table-column",{attrs:{label:"商品信息",width:"400px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"img-text"},[s("img",{attrs:{src:t.row.mallProImageUrl?t.row.mallProImageUrl:"http://pic01-10001430.image.myqcloud.com/img-icon-pro.png"}}),e._v(" "),s("div",{staticClass:"text"},[s("p",{staticClass:"goods-descript"},[e._v(e._s(t.row.proName)),s("i",{staticClass:"el-icon-edit",on:{click:function(a){e.editProName(t.row)}}})]),e._v(" "),s("p",{staticClass:"goods-code"},[e._v("货号:"+e._s(t.row.proCode))]),e._v(" "),s("p",[1===t.row.activityIcon.reductionStatus?s("span",{staticClass:"active-icon-reduce"},[e._v("满")]):e._e(),e._v(" "),1===t.row.activityIcon.discountStatus?s("span",{staticClass:"active-icon-discount"},[e._v("折")]):e._e(),e._v(" "),1===t.row.activityIcon.freeStatus?s("span",{staticClass:"active-icon-postage"},[e._v("邮")]):e._e()])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"mallProSpuPrice",label:"单价",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v("￥"+e._s(t.row.mallProSpuPrice))])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"stock",label:"库存",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[s("span",[e._v(e._s(t.row.stock))]),e._v(" "),s("i",{staticClass:"el-icon-edit",on:{click:function(a){e.handleStock(t.row)}}})])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"saleNum",label:"总销量",sortable:"custom",width:"110px"}}),e._v(" "),s("el-table-column",{attrs:{prop:"complete",label:"完善状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.complete?s("p",{staticStyle:{"line-height":"18px"}},[s("span",{staticClass:"dm-status--error"},[e._v("未完善")])]):e._e(),e._v(" "),1===t.row.complete?s("p",{staticStyle:{"line-height":"18px"}},[s("span",{staticClass:"dm-status--success"},[e._v("已完善")])]):e._e()]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"createTime",label:"创建时间",sortable:"custom",width:"110px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticStyle:{"line-height":"18px"}},[e._v(e._s(e.getTime(t.row.createTime)))]),e._v(" "),s("p",{staticClass:"gray-color",staticStyle:{"line-height":"18px"}},[e._v(e._s(e.getSeconds(t.row.createTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:"240px",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.proType?s("el-button",{attrs:{type:"text"},on:{click:function(a){e.editGoods(t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),1===t.row.proType?s("el-button",{attrs:{type:"text"},on:{click:function(a){e.editErpGoods(t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),s("tishi",{ref:"tishi",attrs:{tips:"是否上架该商品?"},on:{confirm:function(a){e.deleteItem(t.row.mallProId,2,t.row)}}},[s("el-button",{attrs:{type:"text"}},[e._v("上架")])],1),e._v(" "),s("tishi",{ref:"tishi",staticStyle:{"margin-left":"-8px"},attrs:{tips:"是否删除该商品?"},on:{confirm:function(a){e.deleteItem(t.row.mallProId,3)}}},[s("el-button",{attrs:{type:"text"}},[e._v("删除")])],1),e._v(" "),s("el-button",{attrs:{type:"text"},on:{click:function(a){e.getLink(t.row.mallProId)}}},[e._v("商品链接")])]}}])}),e._v(" "),s("template",{slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2),e._v(" "),s("eqCodeDialog",{attrs:{modalData:e.modalData}}),e._v(" "),s("stockModal",{attrs:{stockModalData:e.stockModalData}}),e._v(" "),s("editInfo",{attrs:{editInfoModal:e.editInfoModal},on:{getList:e.getList}})],1)},staticRenderFns:[]};var X=a("VU/8")(q,Q,!1,function(e){a("0x9a"),a("MV/I")},"data-v-78dd5758",null).exports,ee={props:{tableData:{type:Array,default:function(){return[]}},searchObj:{type:Object}},data:function(){return{getTime:C.getTime,getSeconds:C.getSeconds,modalData:{show:!1,imgUrl:"",loading:!1},stockModalData:{tableSkuData:[],tableSkuHeaderData:[],modalWidth:"",modalShow:!1},editInfoModal:{proName:"",proNameLen:0,mallProId:"",dialogVisible:!1}}},methods:{getList:function(e){this.$emit("getList")},sortChange:function(e){this.sortColumn=e.prop,"ascending"==e.order?this.sortType="asc":"descending"==e.order&&(this.sortType="desc"),this.$emit("getList",this.sortType,this.sortColumn)},handleSelectAll:function(e){this.$emit("getSelectList",e)},deleteItem:function(e,t,a){this.$emit("handleItem",e,t,a)},getLink:function(e){var t=this;this.modalData.loading=!0;var a={mallProId:e};this.modalData.show=!0,A.get("/api-mall/get-mall-goods-qRCode",{params:a}).then(function(e){0===e.data.errorCode?(t.modalData.show=!0,t.modalData.imgUrl=e.data.result.url,t.modalData.pageUrl=e.data.result.page,t.modalData.loading=!1):t.$message.error(e.data.message)})},handleStock:function(e){var t=this;this.stockModalData.modalShow=!0;var a={mallProId:e.mallProId};A.get("/api-mall/get-mall-goods-skus",{params:a}).then(function(e){if(0===e.data.errorCode){t.stockModalData.list=e.data.result,t.stockModalData.total=e.data.result.length,t.stockModalData.tableSkuData=[],t.stockModalData.tableSkuHeaderData=[];var a=JSON.parse(e.data.result[0].mallPropValues);for(var s in a)t.stockModalData.tableSkuHeaderData.push(a[s].propName);for(var i in t.stockModalData.tableSkuHeaderData.push("库存"),e.data.result){var r=JSON.parse(e.data.result[i].mallPropValues);r.push({valueName:e.data.result[i].stock}),t.stockModalData.tableSkuData.push(r)}t.refreshStatus=!t.refreshStatus,t.stockModalData.modalWidth=140*(t.stockModalData.tableSkuData[0].length+1)}else t.$message.error(e.data.message)})},editGoods:function(e){window.localStorage.setItem("goodsSearch",O()(this.searchObj)),this.$router.push({name:"goodsEdit",params:{mallProId:e.mallProId,createSource:e.createSource}})},editErpGoods:function(e){window.localStorage.setItem("goodsSearch",O()(this.searchObj)),this.$router.push({name:"goodsErpEdit",params:{mallProId:e.mallProId}})},editProName:function(e){this.editInfoModal.proName=e.proName,this.editInfoModal.dialogVisible=!0,this.editInfoModal.proNameLen=C.getZhLen(this.editInfoModal.proName),this.editInfoModal.mallProId=e.mallProId}},components:{eqCodeDialog:R,stockModal:G,tishi:j,editInfo:Z}},te={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"goods-list-content"},[s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{"sort-change":e.sortChange,"selection-change":e.handleSelectAll}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),s("el-table-column",{attrs:{label:"商品信息",width:"400px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"img-text"},[s("img",{attrs:{src:t.row.mallProImageUrl?t.row.mallProImageUrl:"http://pic01-10001430.image.myqcloud.com/img-icon-pro.png"}}),e._v(" "),s("div",{staticClass:"text"},[s("p",{staticClass:"goods-descript"},[e._v(e._s(t.row.proName)),s("i",{staticClass:"el-icon-edit",on:{click:function(a){e.editProName(t.row)}}})]),e._v(" "),s("p",{staticClass:"goods-code"},[e._v("货号:"+e._s(t.row.proCode))]),e._v(" "),s("p",[1===t.row.activityIcon.reductionStatus?s("span",{staticClass:"active-icon-reduce"},[e._v("满")]):e._e(),e._v(" "),1===t.row.activityIcon.discountStatus?s("span",{staticClass:"active-icon-discount"},[e._v("折")]):e._e(),e._v(" "),1===t.row.activityIcon.freeStatus?s("span",{staticClass:"active-icon-postage"},[e._v("邮")]):e._e()])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"mallProSpuPrice",label:"单价",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v("￥"+e._s(t.row.mallProSpuPrice))])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"stock",label:"库存",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[s("span",[e._v(e._s(t.row.stock))]),e._v(" "),s("i",{staticClass:"el-icon-edit",on:{click:function(a){e.handleStock(t.row)}}})])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"saleNum",label:"总销量",sortable:"custom",width:"110px"}}),e._v(" "),s("el-table-column",{attrs:{prop:"complete",label:"完善状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.complete?s("p",{staticStyle:{"line-height":"18px"}},[s("span",{staticClass:"dm-status--error"},[e._v("未完善")])]):e._e(),e._v(" "),1===t.row.complete?s("p",{staticStyle:{"line-height":"18px"}},[s("span",{staticClass:"dm-status--success"},[e._v("已完善")])]):e._e()]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"upShelvesTime",label:"发布时间",sortable:"custom",width:"110px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticStyle:{"line-height":"18px"}},[e._v(e._s(e.getTime(t.row.upShelvesTime)))]),e._v(" "),s("p",{staticClass:"gray-color",staticStyle:{"line-height":"18px"}},[e._v(e._s(e.getSeconds(t.row.upShelvesTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:"240px",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.proType?s("el-button",{attrs:{type:"text"},on:{click:function(a){e.editGoods(t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),1===t.row.proType?s("el-button",{attrs:{type:"text"},on:{click:function(a){e.editErpGoods(t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),s("tishi",{ref:"tishi",attrs:{tips:"是否下架该商品?"},on:{confirm:function(a){e.deleteItem(t.row.mallProId,1,1)}}},[s("el-button",{attrs:{type:"text"}},[e._v("下架")])],1),e._v(" "),s("tishi",{ref:"tishi",staticStyle:{"margin-left":"-8px"},attrs:{tips:"是否删除该商品?"},on:{confirm:function(a){e.deleteItem(t.row.mallProId,3)}}},[s("el-button",{attrs:{type:"text"}},[e._v("删除")])],1),e._v(" "),s("el-button",{attrs:{type:"text"},on:{click:function(a){e.getLink(t.row.mallProId)}}},[e._v("商品链接")])]}}])}),e._v(" "),s("template",{slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2),e._v(" "),s("eqCodeDialog",{attrs:{modalData:e.modalData}}),e._v(" "),s("stockModal",{attrs:{stockModalData:e.stockModalData}}),e._v(" "),s("editInfo",{attrs:{editInfoModal:e.editInfoModal},on:{getList:e.getList}})],1)},staticRenderFns:[]};var ae=a("VU/8")(ee,te,!1,function(e){a("5iL7"),a("gHWI")},"data-v-04fcc7dc",null).exports,se={props:{tableData:{type:Array,default:function(){return[]}},searchObj:{type:Object,default:function(){return{}}}},data:function(){return{getTime:C.getTime,getSeconds:C.getSeconds,editInfoModal:{proName:"",proNameLen:0,mallProId:"",dialogVisible:!1}}},methods:{getList:function(e){this.$emit("getList")},sortChange:function(e){this.sortColumn=e.prop,"ascending"==e.order?this.sortType="asc":"descending"==e.order&&(this.sortType="desc"),this.$emit("getList",this.sortType,this.sortColumn)},handleSelectAll:function(e){this.$emit("getSelectList",e)},deleteItem:function(e,t,a){this.$emit("handleItem",e,t,a)},editProName:function(e){this.editInfoModal.proName=e.proName,this.editInfoModal.dialogVisible=!0,this.editInfoModal.proNameLen=C.getZhLen(this.editInfoModal.proName),this.editInfoModal.mallProId=e.mallProId}},components:{tishi:j,editInfo:Z}},ie={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"goods-list-content"},[s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{"sort-change":e.sortChange,"selection-change":e.handleSelectAll}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),s("el-table-column",{attrs:{label:"商品信息",width:"360px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"img-text"},[s("img",{attrs:{src:t.row.mallProImageUrl?t.row.mallProImageUrl:"http://pic01-10001430.image.myqcloud.com/img-icon-pro.png"}}),e._v(" "),s("div",{staticClass:"text"},[s("p",{staticClass:"goods-descript"},[e._v(e._s(t.row.proName)),s("i",{staticClass:"el-icon-edit",on:{click:function(a){e.editProName(t.row)}}})]),e._v(" "),s("p",{staticClass:"goods-code"},[e._v("货号:"+e._s(t.row.proCode))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"mallProSpuPrice",label:"单价",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v("￥"+e._s(t.row.mallProSpuPrice))])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"stock",label:"库存",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[s("span",[e._v(e._s(t.row.stock))])])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"saleNum",label:"总销量",sortable:"custom",width:"110px"}}),e._v(" "),s("el-table-column",{attrs:{prop:"complete",label:"完善状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.complete?s("p",{staticStyle:{"line-height":"18px"}},[s("span",{staticClass:"dm-status--error"},[e._v("未完善")])]):e._e(),e._v(" "),1===t.row.complete?s("p",{staticStyle:{"line-height":"18px"}},[s("span",{staticClass:"dm-status--success"},[e._v("已完善")])]):e._e()]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"createTime",label:"创建时间",sortable:"custom",width:"110px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticStyle:{"line-height":"18px"}},[e._v(e._s(e.getTime(t.row.createTime)))]),e._v(" "),s("p",{staticClass:"gray-color",staticStyle:{"line-height":"18px"}},[e._v(e._s(e.getSeconds(t.row.createTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"updateTime",label:"删除时间",sortable:"custom",width:"110px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e.getTime(t.row.updateTime)))]),e._v(" "),s("p",{staticClass:"gray-color"},[e._v(e._s(e.getSeconds(t.row.updateTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作","min-width":"130px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("tishi",{ref:"tishi",attrs:{tips:"是否恢复到仓库?"},on:{confirm:function(a){e.deleteItem(t.row.mallProId,1,0)}}},[s("el-button",{attrs:{type:"text"}},[e._v("是否恢复到仓库")])],1)]}}])}),e._v(" "),s("template",{slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2),e._v(" "),s("editInfo",{attrs:{editInfoModal:e.editInfoModal},on:{getList:e.getList}})],1)},staticRenderFns:[]};var re,oe,le,ne=a("VU/8")(se,ie,!1,function(e){a("j+LA"),a("8wm5")},"data-v-3cca6110",null).exports,de=a("GXH0"),ce=a.n(de),ue=(a("DmJO"),a("pFYg")),me=a.n(ue),pe=(re=/str|num|boo|und/,oe=/fun/,le=/date|rege/i,function(e){var t,a=void 0,s=void 0;if(t=void 0===e?"undefined":me()(e),re.test(t)||!e)return e;if(oe.test(t))return new Function("return "+e.toString())();if(le.test(e.constructor))return new e.constructor(e.valueOf());for(a in s="length"in e?[]:{},e)e.hasOwnProperty(a)&&(s[a]=pe(e[a]));return s}),he=pe,ge={props:{selectCateData2:{type:Object}},data:function(){return{allDate:[],firstCate:[],classIndex1:0,refreshStatus:!1,seceltIndex1:"",seceltIndex2:"",selectCateData:[],selectedCate:"",showDrag:!1}},mounted:function(){this.selectCateData=he(this.selectCateData2)},created:function(){this.getFirstCateList()},methods:{showDragClick:function(){this.showDrag=!this.showDrag},getFirstCateList:function(){var e=this;A.get("/api-mall/list-mall-goods-all-category").then(function(t){0===t.data.errorCode?(e.allDate=[],e.allDate.push({search:"",arr:t.data.result})):e.$message.error(t.data.message)})},getNextCateList:function(e,t,a,s){var i=this;this.seceltIndex1=s,this.seceltIndex2=t,this.allDate.length=s+1,this.refreshStatus=!this.refreshStatus;var r=!0,o=!1,l=void 0;try{for(var n,d=b()(a.arr);!(r=(n=d.next()).done);r=!0){n.value.classIndex=-1,e.selectBgcolor=!1}}catch(e){o=!0,l=e}finally{try{!r&&d.return&&d.return()}finally{if(o)throw l}}e.classIndex=t,e.selectBgcolor=!0;var c={categoryId:e.categoryId};A.get("/api-mall/list-mall-goods-children-category",{params:c}).then(function(e){0===e.data.errorCode?e.data.result.length&&(i.allDate[s+1]={search:"",arr:e.data.result},i.refreshStatus=!i.refreshStatus):i.$message.error(e.data.message)})},searchCate:function(e,t,a){var s=this;if(this.allDate.length=t+1,0===t){var i={search:e};A.get("/api-mall/list-mall-goods-all-category",{params:i}).then(function(t){0===t.data.errorCode?(s.allDate=[],s.allDate.push({search:""!==e?e:"",arr:t.data.result})):s.$message.error(t.data.message)})}else{var r="";for(var o in this.allDate[t-1].arr)-1!==this.allDate[t-1].arr[o].classIndex&&(r=this.allDate[t-1].arr[o].categoryId);var l={search:e,categoryId:r};A.get("/api-mall/list-mall-goods-children-category",{params:l}).then(function(a){0===a.data.errorCode?(s.allDate[t]={search:""!==e?e:"",arr:a.data.result},s.refreshStatus=!s.refreshStatus):s.$message.error(a.data.message)})}},handaleConfirmCate:function(){if(this.showDrag=!this.showDrag,""===this.seceltIndex1||""===this.seceltIndex2)return!1;this.selectCateData={},this.selectCateData=this.allDate[this.seceltIndex1].arr[this.seceltIndex2],this.$emit("getCateIds",this.selectCateData)},cancelConfirmCate:function(){this.selectCateData={},this.showDrag=!1,this.$emit("getCateIds",this.selectCateData)},handleClose:function(){this.selectCateData=[]},searchBlur:function(e){return!1}},components:{}},ve={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"goods-cate-content"},[a("div",{staticClass:"goods-cate-title",on:{click:function(t){return t.stopPropagation(),e.showDragClick(t)}}},[a("el-tag",{directives:[{name:"show",rawName:"v-show",value:e.selectCateData.categoryName,expression:"selectCateData.categoryName"}],staticClass:"select-tag",attrs:{closable:"","disable-transitions":!1,size:"small"},on:{close:function(t){e.handleClose()}}},[e._v("\n      "+e._s(e.selectCateData.categoryName)+"\n    ")]),e._v(" "),a("i",{class:e.showDrag?"el-icon-arrow-down":"el-icon-arrow-up"})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showDrag,expression:"showDrag"}],staticClass:"goods-cate-list-container",on:{click:function(t){return t.stopPropagation(),e.searchBlur(t)}}},[a("div",{staticClass:"goods-cate-list-content"},e._l(e.allDate,function(t,s){return a("div",{key:s,staticClass:"goods-cate-box",on:{click:function(t){return t.stopPropagation(),e.searchBlur(t)}}},[a("el-input",{staticClass:"cate-search",attrs:{placeholder:"请输入内容","prefix-icon":"el-icon-search",size:"small",clearable:""},nativeOn:{keyup:function(a){if(!("button"in a)&&e._k(a.keyCode,"enter",13,a.key,"Enter"))return null;e.searchCate(t.search,s,t)}},model:{value:t.search,callback:function(a){e.$set(t,"search",a)},expression:"item.search"}}),e._v(" "),a("div",{staticClass:"goods-cate-list"},e._l(t.arr,function(i,r){return a("div",{key:i.categoryId,staticClass:"goods-cate-item",class:i.classIndex===r?"cate-item-active":"",on:{click:function(a){a.stopPropagation(),e.getNextCateList(i,r,t,s)}}},[a("span",[e._v(e._s(i.categoryName))]),e._v(" "),i.isChildren?a("i",{staticClass:"el-icon-arrow-right"}):e._e()])})),e._v(" "),a("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refreshStatus))])],1)})),e._v(" "),a("div",{staticClass:"goods-cate-footer"},[a("el-button",{staticClass:"cancel-cate",attrs:{type:"text"},on:{click:e.cancelConfirmCate}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"confirm-cate",attrs:{type:"text"},on:{click:e.handaleConfirmCate}},[e._v("确认")])],1)])])},staticRenderFns:[]};var fe=a("VU/8")(ge,ve,!1,function(e){a("4z8Q")},"data-v-214fcf36",null).exports,be={props:{goodsStatus:{type:Number,default:2},tableData:{type:Array,default:function(){return[]}}},data:function(){var e=this;return{getTime:C.getTime,getSeconds:C.getSeconds,getTimeAll:C.formatDate,searchValue:"",showSearch:!0,searchForm:{createTime:[],productPriceMin:"",productPriceMax:"",productStockMin:"",productStockMax:"",productSaleNumMin:"",productSaleNumMax:"",productType:"",mallCategoryId:"",tagId:null,complete:""},searchFormRules:{productPriceMin:[{type:"number",validator:function(t,a,s){""!==a&&0!==Number(a)?Number(a)?(e.searchForm.productPriceMin=Number(e.searchForm.productPriceMin).toFixed(2),""!==e.searchForm.productPriceMax?Number(a)>Number(e.searchForm.productPriceMax)&&s(new Error("最小单价不能大于最大单价")):s()):s(new Error("请输入数字")):s()},trigger:"blur"}],productPriceMax:[{type:"number",validator:function(t,a,s){""!==a&&0!==Number(a)?Number(a)?(e.searchForm.productPriceMax=Number(e.searchForm.productPriceMax).toFixed(2),""!==e.searchForm.productPriceMin?Number(a)<Number(e.searchForm.productPriceMin)&&s(new Error("最大单价不能小于最小单价")):s()):s(new Error("请输入数字")):s()},trigger:"blur"}],productStockMin:[{type:"number",validator:function(t,a,s){""!==a?/^[0-9]*$/.test(a)?e.searchForm.productStockMax&&Number(a)>Number(e.searchForm.productStockMax)?s(new Error("最小库存不能大于最大库存")):s():s(new Error("请输入整数")):s()},trigger:"blur"}],productStockMax:[{type:"number",validator:function(t,a,s){""!==a?/^[0-9]*$/.test(a)?e.searchForm.productStockMin&&Number(a)<Number(e.searchForm.productStockMin)?s(new Error("最大库存不能小于最小库存")):s():s(new Error("请输入整数")):s()},trigger:"blur"}],productSaleNumMin:[{type:"number",validator:function(t,a,s){""!=a?/^[0-9]*$/.test(a)?Number(e.searchForm.productSaleNumMax)&&Number(a)>Number(e.searchForm.productSaleNumMax)?s(new Error("最小销量不能大于最大销量")):s():s(new Error("请输入整数")):s()},trigger:"blur"}],productSaleNumMax:[{type:"number",validator:function(t,a,s){""!==a?/^[0-9]*$/.test(a)?Number(e.searchForm.productSaleNumMin)&&Number(a)<Number(e.searchForm.productSaleNumMin)?s(new Error("最大销量不能小于最小销量")):s():s(new Error("请输入整数")):s()},trigger:"blur"}]},goodsClassifyData:[],uploadUrl:window.location.origin,showTree:!1,selectCateData2:{},optionsData:{disabledDate:function(e){}},projectName:"mall",dialogVisible:!1,excelUrl:"/api-mall/download-simple-mall-goods",params:{}}},mounted:function(){this.getCateList()},methods:{handleSearch:function(){this.showSearch=!this.showSearch},getCateList:function(){var e=this;this.testList=[],A.get("/api-mall/list_mall_goods_tag_tree").then(function(t){0===t.data.errorCode?(e.goodsClassifyData.push({childTagList:t.data.result.childTagList,mallProTagId:t.data.result.mallProTagId,tagName:t.data.result.tagName}),e.getTreeData(e.goodsClassifyData)):e.$message.error(t.data.message)})},getTreeData:function(e){for(var t in e)e[t].label=e[t].tagName,e[t].id=e[t].mallProTagId,e[t].children=e[t].childTagList,e[t].children?this.getTreeData(e[t].children):delete e[t].children},handleSeniorSearch:function(){this.searchForm.createTime||(this.searchForm.createTime=[]);var e=he(this.searchForm);this.$emit("getSearch",e)},uploadFile:function(){var e=void 0,t=void 0;2===this.searchForm.createTime.length?(e=this.getTimeAll(this.searchForm.createTime[0]),t=this.getTimeAll(this.searchForm.createTime[1])):(e="",t="");var a=void 0;a=null===this.searchForm.tagId?"":this.searchForm.tagId,this.params={goodsStatus:this.goodsStatus,createTimeMin:e,createTimeMax:t,productType:this.searchForm.productType,productPriceMin:this.searchForm.productPriceMin,productPriceMax:this.searchForm.productPriceMax,productStockMin:this.searchForm.productStockMin,productStockMax:this.searchForm.productStockMax,productSaleNumMin:this.searchForm.productSaleNumMin,productSaleNumMax:this.searchForm.productSaleNumMax,mallCategoryId:this.searchForm.mallCategoryId,tagId:a,complete:this.searchForm.complete,requestProject:"mall"},this.dialogVisible=!0},getCateIds:function(e){this.searchForm.mallCategoryId=e.categoryId,this.selectCateData2=e,e.length||(this.selectCateData2={})},hideDrag:function(){var e=this;this.$nextTick(function(){e.$refs.modal.showDrag&&(e.$refs.modal.showDrag=!1)})}},components:{Treeselect:ce.a,cateSelect:fe}},ye={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"senior-search-container",on:{click:function(t){return t.stopPropagation(),e.hideDrag(t)}}},[a("div",{staticClass:"senior-search-content"},[a("el-form",{attrs:{model:e.searchForm,"label-width":"80px",rules:e.searchFormRules}},[a("el-form-item",{staticClass:"inline-item",attrs:{label:"创建时间"}},[a("el-date-picker",{staticStyle:{width:"408px"},attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.searchForm.createTime,callback:function(t){e.$set(e.searchForm,"createTime",t)},expression:"searchForm.createTime"}},[e._v("\n          }\n        ")])],1),e._v(" "),a("el-form-item",{staticClass:"inline-item",attrs:{label:"商品类型"}},[a("el-select",{staticStyle:{width:"408px"},attrs:{placeholder:"请选择",clearable:""},model:{value:e.searchForm.productType,callback:function(t){e.$set(e.searchForm,"productType",t)},expression:"searchForm.productType"}},[a("el-option",{attrs:{label:"手动发布",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"ERP同步",value:"2"}})],1)],1),e._v(" "),a("el-form-item",{staticClass:"inline-item",attrs:{label:"商品单价"}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"productPriceMin"}},[a("el-input",{staticStyle:{width:"195px"},attrs:{placeholder:"请输入"},model:{value:e.searchForm.productPriceMin,callback:function(t){e.$set(e.searchForm,"productPriceMin",t)},expression:"searchForm.productPriceMin"}})],1)],1),e._v(" "),a("el-col",{staticClass:"line",staticStyle:{width:"20px","text-align":"center"}},[e._v("-")]),e._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"productPriceMax"}},[a("el-input",{staticStyle:{width:"195px"},attrs:{placeholder:"请输入"},model:{value:e.searchForm.productPriceMax,callback:function(t){e.$set(e.searchForm,"productPriceMax",t)},expression:"searchForm.productPriceMax"}})],1)],1)],1),e._v(" "),a("el-form-item",{staticClass:"inline-item",attrs:{label:"商品库存"}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"productStockMin"}},[a("el-input",{staticStyle:{width:"195px"},attrs:{placeholder:"请输入"},model:{value:e.searchForm.productStockMin,callback:function(t){e.$set(e.searchForm,"productStockMin",t)},expression:"searchForm.productStockMin"}})],1)],1),e._v(" "),a("el-col",{staticClass:"line",staticStyle:{width:"20px","text-align":"center"}},[e._v("-")]),e._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"productStockMax"}},[a("el-input",{staticStyle:{width:"195px"},attrs:{placeholder:"请输入"},model:{value:e.searchForm.productStockMax,callback:function(t){e.$set(e.searchForm,"productStockMax",t)},expression:"searchForm.productStockMax"}})],1)],1)],1),e._v(" "),a("el-form-item",{staticClass:"inline-item",attrs:{label:"总销量"}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"productSaleNumMin"}},[a("el-input",{staticStyle:{width:"195px"},attrs:{placeholder:"请输入"},model:{value:e.searchForm.productSaleNumMin,callback:function(t){e.$set(e.searchForm,"productSaleNumMin",t)},expression:"searchForm.productSaleNumMin"}})],1)],1),e._v(" "),a("el-col",{staticClass:"line",staticStyle:{width:"20px","text-align":"center"}},[e._v("-")]),e._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"productSaleNumMax"}},[a("el-input",{staticStyle:{width:"195px"},attrs:{placeholder:"请输入"},model:{value:e.searchForm.productSaleNumMax,callback:function(t){e.$set(e.searchForm,"productSaleNumMax",t)},expression:"searchForm.productSaleNumMax"}})],1)],1)],1),e._v(" "),a("el-form-item",{staticClass:"inline-item",attrs:{label:"商品分类"}},[a("treeselect",{staticStyle:{width:"408px"},attrs:{multiple:!1,options:e.goodsClassifyData,size:"small",placeholder:"所有分类"},model:{value:e.searchForm.tagId,callback:function(t){e.$set(e.searchForm,"tagId",t)},expression:"searchForm.tagId"}})],1),e._v(" "),a("el-form-item",{staticStyle:{display:"inline-block",width:"1000px"},attrs:{label:"商品品类"}},[a("cateSelect",{ref:"modal",attrs:{selectCateData2:e.selectCateData2},on:{getCateIds:e.getCateIds}})],1),e._v(" "),a("el-form-item",{staticClass:"inline-item",attrs:{label:"完善状态"}},[a("el-select",{staticStyle:{width:"408px"},attrs:{placeholder:"请选择",clearable:""},model:{value:e.searchForm.complete,callback:function(t){e.$set(e.searchForm,"complete",t)},expression:"searchForm.complete"}},[a("el-option",{attrs:{label:"未完善",value:0}}),e._v(" "),a("el-option",{attrs:{label:"已完善",value:1}})],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.handleSeniorSearch}},[e._v("搜索")]),e._v(" "),a("el-button",{on:{click:e.uploadFile}},[e._v("导出")])],1)],1)],1),e._v(" "),a("vue-gic-export-excel",{attrs:{dataArr:e.tableData,dialogVisible:e.dialogVisible,type:1,excelUrl:e.excelUrl,params:e.params,projectName:e.projectName},on:{"update:dialogVisible":function(t){e.dialogVisible=t}}})],1)},staticRenderFns:[]};var _e={data:function(){return{getTimeAll:C.formatDate,mallHeight:document.documentElement.clientHeight-64-98,length:0,activeName:"first",tableData:[],goodsStatus:2,order:"desc",sortField:"createTime",searchValue:"",pageNum:1,pageSize:20,pageSizes:[20,40,60,80],total:0,saleNum:0,saloOutNum:0,storeNum:0,recycleNum:0,deleteList:[],selectList:[],showSearch:!1,dialogVisible:!1,goodsClassifySelect:null,action:"TYP_APPEND",goodsClassifyData:[],loading:!0,createTimeMin:"",createTimeMax:"",productPriceMin:"",productPriceMax:"",productStockMin:"",productStockMax:"",productSaleNumMin:"",productSaleNumMax:"",productType:"",mallCategoryId:"",tagId:null,complete:"",beatchOPerate:"",betachDialogVisible:!1,templateSelect:"",templateList:[],refash:!1,searchObj:{pageNum:1,pageSize:20,activeName:"first",searchValue:"",createTimeMin:"",createTimeMax:"",productPriceMin:-1,productPriceMax:-1,productStockMin:-1,productStockMax:-1,productSaleNumMin:-1,productSaleNumMax:-1,productType:-1,mallCategoryId:"",tagId:"",complete:"",sortField:"createTime",order:"desc"}}},created:function(){var e=this;this.getGoodsNum(),localStorage.getItem("goodsSearch")&&(this.searchObj=JSON.parse(localStorage.getItem("goodsSearch")),this.pageSize=this.searchObj.pageSize,this.pageNum=this.searchObj.pageNum,this.activeName=this.searchObj.activeName,this.searchValue=this.searchObj.searchValue,this.createTimeMin=this.searchObj.createTimeMin,this.createTimeMax=this.searchObj.createTimeMax,this.productPriceMin=this.searchObj.productPriceMin,this.productPriceMax=this.searchObj.productPriceMax,this.productStockMin=this.searchObj.productStockMin,this.productStockMax=this.searchObj.productStockMax,this.productSaleNumMin=this.searchObj.productSaleNumMin,this.productSaleNumMax=this.searchObj.productSaleNumMax,this.productType=this.searchObj.productType,this.mallCategoryId=this.searchObj.mallCategoryId,this.tagId=this.searchObj.tagId,this.complete=this.searchObj.complete,this.sortField=this.searchObj.sortField,this.order=this.searchObj.order,this.$nextTick(function(){e.pageNum=e.searchObj.pageNum,e.pageSize=e.searchObj.pageSize}),this.refash=!this.refash),"first"===this.activeName?this.goodsStatus=2:"second"===this.activeName?this.goodsStatus=4:"third"===this.activeName&&(this.goodsStatus=1),this.getList(),this.refash=!this.refash,localStorage.removeItem("goodsSearch")},computed:{},methods:{getSearch:function(e){this.tagId=e.tagId,this.mallCategoryId=e.mallCategoryId,this.createTimeMin=2===e.createTime.length?this.getTimeAll(e.createTime[0]):"",this.createTimeMax=2===e.createTime.length?this.getTimeAll(e.createTime[1]):"",this.productPriceMin=e.productPriceMin?e.productPriceMin:-1,this.productPriceMax=e.productPriceMax?e.productPriceMax:-1,this.productStockMin=e.productStockMin?e.productStockMin:-1,this.productStockMax=e.productStockMax?e.productStockMax:-1,this.productSaleNumMin=e.productSaleNumMin?e.productSaleNumMin:-1,this.productSaleNumMax=e.productSaleNumMax?e.productSaleNumMax:-1,this.productType=e.productType?e.productType:-1,this.complete=e.complete,this.pageNum=1,this.getList(),this.searchObj.tagId=e.tagId,this.searchObj.mallCategoryId=e.mallCategoryId,this.searchObj.createTimeMin=2===e.createTime.length?this.getTimeAll(e.createTime[0]):"",this.searchObj.createTimeMax=2===e.createTime.length?this.getTimeAll(e.createTime[1]):"",this.searchObj.productPriceMin=e.productPriceMin?e.productPriceMin:-1,this.searchObj.productPriceMax=e.productPriceMax?e.productPriceMax:-1,this.searchObj.productStockMin=e.productStockMin?e.productStockMin:-1,this.searchObj.productStockMax=e.productStockMax?e.productStockMax:-1,this.searchObj.productSaleNumMin=e.productSaleNumMin?e.productSaleNumMin:-1,this.searchObj.productSaleNumMax=e.productSaleNumMax?e.productSaleNumMax:-1,this.searchObj.productType=e.productType?e.productType:-1,this.searchObj.complete=e.complete},getList:function(e,t,a){var s=this;e&&(this.order=e,this.searchObj.order=e),t&&(this.sortField=t,this.searchObj.sortField=t),this.searchObj.sortField=this.sortField,this.searchObj.order=this.order;var i={pageNum:this.pageNum,pageSize:this.pageSize,search:this.searchValue.trim(),order:this.order,sortField:this.sortField,goodsStatus:this.goodsStatus,tagId:this.tagId,mallCategoryId:this.mallCategoryId,createTimeMin:this.createTimeMin,createTimeMax:this.createTimeMax,productPriceMin:this.productPriceMin,productPriceMax:this.productPriceMax,productStockMin:this.productStockMin,productStockMax:this.productStockMax,productSaleNumMin:this.productSaleNumMin,productSaleNumMax:this.productSaleNumMax,productType:this.productType,complete:this.complete};A.get("/api-mall/page-simple-mall-goods",{params:i}).then(function(e){0===e.data.errorCode?(e.data.result.result?(s.tableData=e.data.result.result,s.total=e.data.result.totalCount):(s.tableData=[],s.total=0),s.loading=!1):s.$message.error(e.data.message)})},newGoods:function(){this.$router.push({name:"goodsEdit",params:{mallProId:"-1",createSource:1,activeName:"first"}})},linkGoods:function(){this.$router.push({name:"goodsSynList"})},handleInputSearch:function(e){this.searchValue=e,this.searchObj.searchValue=e,this.pageNum=1,this.getList()},handleSeniorSearch:function(){this.showSearch=!this.showSearch},getGoodsNum:function(){var e=this;A.get("/api-mall/count-product-all-state").then(function(t){0===t.data.errorCode?(e.saleNum=t.data.result.onShelf,e.saloOutNum=t.data.result.sellOut,e.storeNum=t.data.result.offShelf,e.recycleNum=t.data.result.recycled):e.$message.error(t.data.errorCode)})},handleClick:function(e){this.searchObj.activeName=e.name,this.beatchOPerate="",this.pageNum=1,this.pageSize=20,this.searchValue="","0"===e.index?this.goodsStatus=2:"1"===e.index?this.goodsStatus=4:"2"===e.index?this.goodsStatus=1:"3"===e.index&&(this.goodsStatus=3),this.getList()},getSelectList:function(e){for(var t in this.selectList=e||[],this.deleteList=[],e)this.deleteList.push(e[t].mallProId)},getBeatch:function(){0===this.beatchOPerate?this.handleGoodsClassify():1===this.beatchOPerate?this.handleSaleOut():2===this.beatchOPerate?this.handlePutaway():3===this.beatchOPerate?this.handleDeleteGoodsList():4===this.beatchOPerate?this.handlePutWarehouse():5===this.beatchOPerate&&this.handleModifyFreight()},getTemplateList:function(){var e=this;A.get("/api-mall/list-mall-goods-freight").then(function(t){0===t.data.errorCode?t.data.result?e.templateList=t.data.result:e.templateList=[]:e.$message.error(t.data.message)})},handleModifyFreight:function(){if(0===this.deleteList.length)return this.$message.warning("请至少选择一件商品"),this.beatchOPerate="",!1;this.getTemplateList(),this.betachDialogVisible=!0},setFreight:function(){var e=this,t={proNos:this.deleteList.join(","),freightTemplateId:this.templateSelect};A.post("/api-mall/update_freight_template",_.a.stringify(t)).then(function(t){0===t.data.errorCode?(e.$message.success("设置成功"),e.betachDialogVisible=!1,e.beatchOPerate=""):e.$message.error(t.data.errorCode)})},cancelSetFreight:function(){this.betachDialogVisible=!1,this.beatchOPerate="",this.templateSelect=""},handleDeleteGoodsList:function(){var e=this;if(0===this.deleteList.length)this.$message.warning("请至少选择一件商品"),this.beatchOPerate="";else{var t={mallProIds:this.deleteList.join(","),status:3};this.$confirm("确认要删除这"+this.deleteList.length+"件商品吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){A.get("/api-mall/modify-mall-goods-status",{params:t}).then(function(t){0===t.data.errorCode?(e.$message.success("删除成功!"),e.getList(),e.getGoodsNum(),e.beatchOPerate=""):e.$message.error(t.data.message)})})}},handleSaleOut:function(){var e=this;if(0===this.deleteList.length)this.$message.warning("请至少选择一件商品"),this.beatchOPerate="";else{var t={mallProIds:this.deleteList.join(","),status:1};this.$confirm("确认要下架这"+this.deleteList.length+"件商品吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){A.get("/api-mall/modify-mall-goods-status",{params:t}).then(function(t){0===t.data.errorCode?(e.$message.success("下架成功!"),e.getList(),e.getGoodsNum(),e.beatchOPerate=""):e.$message.error(t.data.message)})})}},handlePutaway:function(){var e=this;if(0===this.deleteList.length)this.$message.warning("请至少选择一件商品"),this.beatchOPerate="";else{var t=!0,a=!1,s=void 0;try{for(var i,r=b()(this.selectList);!(t=(i=r.next()).done);t=!0){if(0===i.value.complete)return this.$message.error("未完善的商品不允许上架"),!1}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}var o={mallProIds:this.deleteList.join(","),status:2};this.$confirm("确认要上架"+this.deleteList.length+"件商品吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){A.get("/api-mall/modify-mall-goods-status",{params:o}).then(function(t){0===t.data.errorCode?(e.$message.success("上架成功!"),e.getList(),e.getGoodsNum(),e.beatchOPerate=""):e.$message.error(t.data.message)})})}},handleGoodsClassify:function(){if(0===this.deleteList.length)return this.$message.warning("请至少选择一件商品"),this.beatchOPerate="",!1;this.getClassifyList(),this.dialogVisible=!0},setClassify:function(){var e=this;if(!this.goodsClassifySelect)return this.$message.error("请先择分类"),!1;var t={productIds:this.deleteList.join(","),tagIds:this.goodsClassifySelect.join(","),action:this.action};A.post("/api-mall/batch-update-goods-tags",_.a.stringify(t)).then(function(t){0===t.data.errorCode?(e.$message.success("修改成功"),e.dialogVisible=!1,e.beatchOPerate=""):e.$message.error(t.data.errorCode)})},cancelSetClassify:function(){this.dialogVisible=!1,this.beatchOPerate=""},getClassifyList:function(){var e=this;A.get("/api-mall/list_mall_goods_tag_tree").then(function(t){e.goodsClassifyData=[],0===t.data.errorCode?(e.goodsClassifyData.push({childTagList:t.data.result.childTagList,mallProTagId:t.data.result.mallProTagId,tagName:t.data.result.tagName}),e.getTree(e.goodsClassifyData)):e.$message.error(t.data.message)})},getTree:function(e){for(var t in e)e[t].label=e[t].tagName,e[t].id=e[t].mallProTagId,e[t].children=e[t].childTagList,e[t].children&&e[t].children.length?this.getTree(e[t].children):delete e[t].children},handlePutWarehouse:function(){var e=this;if(0===this.deleteList.length)this.$message.warning("请至少选择一件商品"),this.beatchOPerate="";else{var t={mallProIds:this.deleteList.join(","),status:1};this.$confirm("确认这"+this.deleteList.length+"件商品要恢复到仓库吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){A.get("/api-mall/modify-mall-goods-status",{params:t}).then(function(t){0===t.data.errorCode?(e.$message.success("修改成功!"),e.getList(),e.getGoodsNum(),e.beatchOPerate=""):e.$message.error(t.data.message)})})}},handleItem:function(e,t,a){var s=this,i="";3===t?i="删除成功":2===t?i="上架成功":1!==t||a?1===t&&a&&(i="下架成功"):i="更新成功";var r={mallProIds:e,status:t};A.get("/api-mall/modify-mall-goods-status",{params:r}).then(function(e){0===e.data.errorCode?(s.$message.success(i),s.getList(),s.getGoodsNum()):s.$message.error(e.data.message)})},handleSizeChange:function(e){this.pageSize=e,this.searchObj.pageSize=e,this.getList()},handleCurrentChange:function(e){this.pageNum=e,this.searchObj.pageNum=e,this.getList()}},components:{saleList:W,storeList:X,saleOut:ae,recycleList:ne,goodsSearch:a("VU/8")(be,ye,!1,function(e){a("cFcj"),a("sKg4")},"data-v-85b80b86",null).exports,Treeselect:ce.a}},Ce={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title",staticStyle:{position:"relative",border:"none"}},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("商品管理")]),e._v(" "),a("el-breadcrumb-item",{staticClass:"bread-menu"},[e._v("商品列表")])],1),e._v(" "),e._m(0)],1),e._v(" "),a("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refash))]),e._v(" "),a("div",{staticClass:"mall-section"},[a("el-tabs",{staticClass:"bread-content",on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("div",{staticStyle:{height:"24px",background:"#f0f2f5"}}),e._v(" "),a("div",[a("div",{staticClass:"operate-top"},[a("div",{staticClass:"fl"},[a("div",{staticStyle:{display:"inline-block"}},[a("el-input",{attrs:{placeholder:"请输入商品名称或货号","prefix-icon":"el-icon-search",clearable:""},on:{clear:function(t){e.handleInputSearch(e.searchValue)}},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleInputSearch(e.searchValue)}},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1),e._v(" "),a("el-button",{staticClass:"senior-search",attrs:{type:"text"},on:{click:e.handleSeniorSearch}},[e._v("高级搜索"),a("i",{class:e.showSearch?"el-icon-d-arrow-left":"el-icon-d-arrow-right"})])],1),e._v(" "),a("div",{staticClass:"fr"},["2"==e.goodsStatus||"1"==e.goodsStatus||"4"==e.goodsStatus?a("el-button",{attrs:{type:"primary"},on:{click:e.newGoods}},[e._v("发布商品")]):e._e(),e._v(" "),"2"==e.goodsStatus||"1"==e.goodsStatus||"4"==e.goodsStatus?a("el-button",{on:{click:e.linkGoods}},[e._v("同步失败")]):e._e(),e._v(" "),a("div",{staticStyle:{"vertical-align":"top",display:"inline-block","margin-left":"8px",width:"130px"}},[a("el-select",{attrs:{placeholder:"批量操作",clearable:""},on:{change:e.getBeatch},model:{value:e.beatchOPerate,callback:function(t){e.beatchOPerate=t},expression:"beatchOPerate"}},["2"==e.goodsStatus||"1"==e.goodsStatus||"4"==e.goodsStatus?a("el-option",{attrs:{label:"修改分类",value:0}}):e._e(),e._v(" "),"2"==e.goodsStatus||"4"==e.goodsStatus?a("el-option",{attrs:{label:"批量下架",value:1}}):e._e(),e._v(" "),"1"==e.goodsStatus?a("el-option",{attrs:{label:"批量上架",value:2}}):e._e(),e._v(" "),"2"==e.goodsStatus||"1"==e.goodsStatus||"4"==e.goodsStatus?a("el-option",{attrs:{label:"批量删除",value:3}}):e._e(),e._v(" "),"3"==e.goodsStatus?a("el-option",{attrs:{label:"恢复到仓库",value:4}}):e._e(),e._v(" "),"2"==e.goodsStatus||"1"==e.goodsStatus||"4"==e.goodsStatus?a("el-option",{attrs:{label:"运费模板",value:5}}):e._e()],1)],1)],1)]),e._v(" "),a("goodsSearch",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],attrs:{goodsStatus:e.goodsStatus,tableData:e.tableData},on:{getSearch:e.getSearch}})],1),e._v(" "),a("el-tab-pane",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"goods-table-content",attrs:{label:"出售中("+e.saleNum+")",name:"first"}},[2===e.goodsStatus?a("saleList",{attrs:{tableData:e.tableData,searchObj:e.searchObj},on:{getList:e.getList,getSelectList:e.getSelectList,handleItem:e.handleItem}}):e._e()],1),e._v(" "),a("el-tab-pane",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"goods-table-content",attrs:{label:"已售罄("+e.saloOutNum+")",name:"second"}},[4===e.goodsStatus?a("saleOut",{attrs:{tableData:e.tableData,searchObj:e.searchObj},on:{getList:e.getList,getSelectList:e.getSelectList,handleItem:e.handleItem}}):e._e()],1),e._v(" "),a("el-tab-pane",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"goods-table-content",attrs:{label:"仓库中("+e.storeNum+")",name:"third"}},[1===e.goodsStatus?a("storeList",{attrs:{tableData:e.tableData,searchObj:e.searchObj},on:{getList:e.getList,getSelectList:e.getSelectList,handleItem:e.handleItem}}):e._e()],1),e._v(" "),a("el-tab-pane",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"goods-table-content",attrs:{label:"回收站("+e.recycleNum+")",name:"fouth"}},[3===e.goodsStatus?a("recycleList",{attrs:{tableData:e.tableData,searchObj:e.searchObj},on:{getList:e.getList,getSelectList:e.getSelectList,handleItem:e.handleItem}}):e._e()],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length,expression:"tableData.length"}],staticClass:"pagination-conteiner",staticStyle:{background:"#fff","margin-top":"-50px"}},[a("div",{staticClass:"pagination"},[0!=e.total?a("el-pagination",{attrs:{background:"","current-page":e.pageNum,"page-sizes":e.pageSizes,"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.pageNum=t}}}):e._e()],1)])],1)],1)]),e._v(" "),a("el-dialog",{attrs:{title:"商品分类",visible:e.dialogVisible,width:"600px"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.cancelSetClassify}},[a("el-form",{attrs:{"label-width":"100px","label-position":"right"}},[a("el-form-item",{attrs:{label:"修改方式",required:""}},[[a("el-radio",{attrs:{label:"TYP_APPEND"},model:{value:e.action,callback:function(t){e.action=t},expression:"action"}},[e._v("添加"),a("span",{staticClass:"radio-tip"},[e._v("（在原有的基础上添加）")])]),e._v(" "),a("el-radio",{attrs:{label:"TYP_REPLACE"},model:{value:e.action,callback:function(t){e.action=t},expression:"action"}},[e._v("替换"),a("span",{staticClass:"radio-tip"},[e._v("（替换掉原有分类）")])])]],2),e._v(" "),a("el-form-item",{attrs:{label:"商品分类",required:""}},[a("div",{staticClass:"goods-classsify-content"},[a("treeselect",{staticClass:"w-320",attrs:{multiple:!0,"disable-branch-nodes":!0,options:e.goodsClassifyData,placeholder:"所有分类"},model:{value:e.goodsClassifySelect,callback:function(t){e.goodsClassifySelect=t},expression:"goodsClassifySelect"}})],1)])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelSetClassify}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.setClassify}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"批量修改运费模板",visible:e.betachDialogVisible,width:"400px"},on:{"update:visible":function(t){e.betachDialogVisible=t},close:e.cancelSetFreight}},[a("div",[a("el-select",{staticStyle:{width:"360px"},attrs:{placeholder:"请选择"},model:{value:e.templateSelect,callback:function(t){e.templateSelect=t},expression:"templateSelect"}},e._l(e.templateList,function(e,t){return a("el-option",{key:t,attrs:{label:e.templateName,value:e.freightTemplateId}})}))],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelSetFreight}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.setFreight}},[e._v("确 定")])],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("商品管理")])])}]};var Ie=a("VU/8")(_e,Ce,!1,function(e){a("H7hH")},"data-v-39e693e6",null).exports,Se={props:{selectCateData:{type:Array,default:function(){return[]}}},data:function(){return{allDate:[],firstCate:[],classIndex1:0,refreshStatus:!1,seceltIndex1:"",seceltIndex2:"",showDrag:!1,showCateDrag:!0}},created:function(){this.getFirstCateList()},methods:{showDragClick:function(){this.showDrag=!this.showDrag,this.showDrag||this.getFirstCateList()},getFirstCateList:function(){var e=this;A.get("/api-mall/list-mall-goods-all-category").then(function(t){0===t.data.errorCode?(e.allDate=[],e.allDate.push({search:"",arr:t.data.result})):e.$message.error(t.data.message)})},getNextCateList:function(e,t,a,s){var i=this;this.seceltIndex1=s,this.seceltIndex2=t,this.allDate.length=s+1,this.refreshStatus=!this.refreshStatus;var r=!0,o=!1,l=void 0;try{for(var n,d=b()(a.arr);!(r=(n=d.next()).done);r=!0){n.value.classIndex=-1}}catch(e){o=!0,l=e}finally{try{!r&&d.return&&d.return()}finally{if(o)throw l}}e.classIndex=t;var c={categoryId:e.categoryId,search:a.search};A.get("/api-mall/list-mall-goods-children-category",{params:c}).then(function(e){0===e.data.errorCode?e.data.result.length&&(i.allDate[s+1]={search:"",arr:e.data.result},i.refreshStatus=!i.refreshStatus):i.$message.error(e.data.message)})},handaleConfirmCate:function(){var e=this;if(""===this.seceltIndex1||""===this.seceltIndex2){for(var t in this.showDrag=!1,this.allDate)for(var a in this.allDate[t].arr)this.allDate[t].arr[a].classIndex=-1;return!1}var s="";for(var i in this.allDate)for(var r in this.allDate[i].arr)-1!==this.allDate[i].arr[r].classIndex&&this.allDate[i].arr[r].hasOwnProperty("classIndex")&&(s=""===s?this.allDate[i].arr[r].categoryId:s+","+this.allDate[i].arr[r].categoryId);var o={categoryRelStr:s};for(var l in A.post("/api-goods/save-category-group-relation",_.a.stringify(o)).then(function(t){0===t.data.errorCode?s="":e.$message.error(t.data.message)}),this.selectCateData)this.allDate[this.seceltIndex1].arr[this.seceltIndex2].categoryGroupId===this.selectCateData[l].categoryGroupId&&this.selectCateData.splice(l,1);this.selectCateData.push(this.allDate[this.seceltIndex1].arr[this.seceltIndex2]);var n=[];for(var d in this.selectCateData)n.push(this.selectCateData[d].categoryId);this.$emit("getCateIds",n)},cancelConfirmCate:function(){for(var e in this.allDate)for(var t in this.allDate[e].arr)this.allDate[e].arr[t].classIndex=-1;this.getFirstCateList(),this.showDrag=!1,this.$emit("deleteSkuMess")},handleClose:function(e){this.selectCateData.splice(this.selectCateData.indexOf(e),1);var t=[];for(var a in this.selectCateData)t.push(this.selectCateData[a].categoryId);this.$emit("getCateIds",t),this.$emit("deleteSkuMess")},searchCate:function(e,t,a,s){var i=this;if(s.cancelBubble=!0,this.allDate.length=t+1,0===t){var r={search:e};A.get("/api-mall/list-mall-goods-all-category",{params:r}).then(function(t){0===t.data.errorCode?(i.allDate=[],i.allDate.push({search:""!==e?e:"",arr:t.data.result})):i.$message.error(t.data.message)})}else{var o="";for(var l in this.allDate[t-1].arr)-1!==this.allDate[t-1].arr[l].classIndex&&(o=this.allDate[t-1].arr[l].categoryId);var n={search:e,categoryId:o};A.get("/api-mall/list-mall-goods-children-category",{params:n}).then(function(a){0===a.data.errorCode?(i.allDate[t]={search:""!==e?e:"",arr:a.data.result},i.refreshStatus=!i.refreshStatus):i.$message.error(a.data.message)})}},searchBlur:function(e){return!1}},components:{}},we={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"goods-cate-content"},[a("div",{staticClass:"goods-cate-title",on:{click:function(t){return t.stopPropagation(),e.showDragClick(t)}}},[e._l(e.selectCateData,function(t,s){return a("el-tag",{key:s,staticClass:"select-tag",attrs:{closable:"","disable-transitions":!1,size:"small"},on:{close:function(a){e.handleClose(t)}}},[e._v("\n      "+e._s(t.categoryName)+"\n    ")])}),e._v(" "),a("i",{class:e.showDrag?"el-icon-arrow-down":"el-icon-arrow-up"})],2),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showDrag,expression:"showDrag"}],staticClass:"goods-cate-list-container",on:{click:function(t){return t.stopPropagation(),e.searchBlur(t)}}},[a("div",{staticClass:"goods-cate-list-content",on:{click:function(t){return t.stopPropagation(),e.searchBlur(t)}}},e._l(e.allDate,function(t,s){return a("div",{key:s,staticClass:"goods-cate-box",on:{click:function(t){return t.stopPropagation(),e.searchBlur(t)}}},[a("el-input",{staticClass:"cate-search",attrs:{placeholder:"请输入内容","prefix-icon":"el-icon-search",size:"small",clearable:""},nativeOn:{keyup:function(a){return"button"in a||!e._k(a.keyCode,"enter",13,a.key,"Enter")?function(a){return e.searchCate(t.search,s,t,a)}(a):null}},model:{value:t.search,callback:function(a){e.$set(t,"search",a)},expression:"item.search"}}),e._v(" "),a("div",{staticClass:"goods-cate-list"},e._l(t.arr,function(i,r){return a("div",{key:i.categoryId,staticClass:"goods-cate-item",class:i.classIndex===r?"cate-item-active":"",on:{click:function(a){a.stopPropagation(),e.getNextCateList(i,r,t,s)}}},[a("span",[e._v(e._s(i.categoryName))]),e._v(" "),i.isChildren?a("i",{staticClass:"el-icon-arrow-right"}):e._e()])})),e._v(" "),a("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refreshStatus))])],1)})),e._v(" "),a("div",{staticClass:"goods-cate-footer"},[a("el-button",{staticClass:"cancel-cate",attrs:{type:"text"},on:{click:e.cancelConfirmCate}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"confirm-cate",attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.handaleConfirmCate(t)}}},[e._v("确认")])],1)])])},staticRenderFns:[]};var xe=a("VU/8")(Se,we,!1,function(e){a("XKAA")},"data-v-a56795bc",null).exports,Le=a("5eDb"),ke=a.n(Le),Ne=(a("o5MN"),a("q47d")),Te=(a("HaK5"),a("NBEC"),a("gBhd"),a("Q/P+"),a("f85y"),a("q/hF"),a("yXOt"),a("Rv7z"),a("c/6r"),{name:"tinymce-edit",props:["bodyHtml","projectName"],data:function(){var e=this;return{tinymceHtml:"请输入内容",init:{language_url:"static/tinymce/zh_CN.js",language:"zh_CN",skin_url:"static/tinymce/skins/lightgray",height:300,images_upload_credentials:!0,images_upload_handler:function(t,a,s){e.handleImgUpload(t,a,s)},plugins:"image textcolor",toolbar:"fontsizeselect | forecolor backcolor | alignleft aligncenter alignright alignjustify |  link unlink image code",fontsize_formats:"8px 10px 12px 14px 18px 24px 36px",branding:!1,menubar:!1,setup:function(e){e.on("click",function(e){})}}}},methods:{handleImgUpload:function(e,t,a){if(e.blob().size>5242880)return a("请上传小于 5 M 文件"),!1;var s=new FormData;s.set("upload_file",e.blob()),s.set("requestProject",this.repProjectName),A.post("/api-plug/upload-img",s).then(function(e){t(e.data.result[0].qcloudImageUrl)}).catch(function(e){a("error")})}},watch:{projectName:function(e,t){this.repProjectName=e||"mall"},bodyHtml:function(e,t){this.tinymceHtml=e}},components:{Editor:Ne.a},mounted:function(){ke.a.init({fontsize_formats:"8px 10px 12px 14px 18px 24px 36px"}),this.tinymceHtml=this.bodyHtml}}),De={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"tinymce-contain"},[a("editor",{attrs:{id:"tinymce",init:e.init},model:{value:e.tinymceHtml,callback:function(t){e.tinymceHtml=t},expression:"tinymceHtml"}})],1)},staticRenderFns:[]};var Pe=a("VU/8")(Te,De,!1,function(e){a("VIek")},"data-v-230ab922",null).exports,Fe={props:{propertyData:{type:Object}},data:function(){return{dialogVisible:!1,dataSearch:"",selectList:[],pageSize:20,currentPage:1,totalPage:1,tableData:[],refash:!1}},directives:{loadmore:{bind:function(e,t){e.querySelector(".el-table__body-wrapper").addEventListener("scroll",function(){var e=1,a=this.scrollHeight-this.scrollTop<this.clientHeight+1&&this.scrollTop>e;this.scrollTop>e&&(e=this.scrollTop),this.scrollTop<e&&(e=this.scrollTop),a&&t.value()})}}},created:function(){this.getPropertyList()},methods:{loadmore:function(){this.currentPage<this.totalPage&&(this.currentPage+=1,this.getPropertyList())},getPropertyList:function(){var e=this;this.refash=!this.refash;var t={pageSize:this.pageSize,currentPage:this.currentPage,search:this.dataSearch};A.get("/api-goods/page-property",{params:t}).then(function(t){if(0===t.data.errorCode){t.data.result.result&&(e.tableData=e.tableData.concat(t.data.result.result)),e.totalPage=t.data.result.totalPage,e.refash=!e.refash;var a=function(t){var a;(a=e.tableData.find(function(e){return e.propertyId===t}))&&e.$refs.selectedTable.toggleRowSelection(a,!0)},s=!0,i=!1,r=void 0;try{for(var o,l=b()(e.propertyData.propertySelected);!(s=(o=l.next()).done);s=!0){a(o.value)}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}}else e.$message.success(t.data.errorCode)})},getSearchData:function(){this.currentPage=1,this.tableData=[],this.getPropertyList()},handleSelectionChange:function(e){this.selectList=e},selectRow:function(e,t,a){this.$refs.selectedTable.toggleRowSelection(e)},submitAdd:function(){var e=this;if(0===this.selectList.length)return this.$message.error("请至少选择一个属性进行添加"),!1;var t="",a=[],s=!0,i=!1,r=void 0;try{for(var o,l=b()(this.selectList);!(s=(o=l.next()).done);s=!0){var n=o.value;t=""===t?n.propertyId:t+","+n.propertyId}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}var d={propertyIds:t};A.get("/api-goods/list-property-value",{params:d}).then(function(t){if(0===t.data.errorCode){if(t.data.result){var s=!0,i=!1,r=void 0;try{for(var o,l=b()(t.data.result);!(s=(o=l.next()).done);s=!0){var n=o.value;if("TYP_MULTI"===n.propertyType){for(var d in n.propertyValueDTOList)n.propertyValueDTOList[d].label=n.propertyValueDTOList[d].valueName,n.propertyValueDTOList[d].id=n.propertyValueDTOList[d].valueId;n.mallPropValues=null}else"TYP_CHECK"===n.propertyType?n.mallPropValues=[]:"TYP_SINGLE"===n.propertyType&&(n.mallPropValues={valueId:"",valueName:""});a.push({propertyId:n.propertyId,bizRequire:n.bizRequire,propertyName:n.propertyName,propertyType:n.propertyType,children:n.propertyValueDTOList,mallPropValues:n.mallPropValues,units:n.units})}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}}else a=[];e.$emit("getPropertyList",a),e.propertyData.dialogVisible=!1}else e.$message.success(t.data.errorCode)})},cancelSubmit:function(){this.selectList=[],this.propertyData.dialogVisible=!1}}},Ae={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"添加商品属性",visible:e.propertyData.dialogVisible,width:"400px"},on:{"update:visible":function(t){e.$set(e.propertyData,"dialogVisible",t)},close:e.cancelSubmit}},[a("div",{staticClass:"dialog-body"},[a("div",{staticClass:"table-container"},[a("div",{staticClass:"input-div"},[a("el-input",{attrs:{placeholder:"请输入","prefix-icon":"el-icon-search",clearable:""},on:{clear:function(t){e.getSearchData()}},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.getSearchData()}},model:{value:e.dataSearch,callback:function(t){e.dataSearch=t},expression:"dataSearch"}})],1),e._v(" "),a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.loadmore,expression:"loadmore"}],ref:"selectedTable",staticClass:"scroll-table",staticStyle:{width:"100%"},attrs:{data:e.tableData,height:"400"},on:{"row-click":e.selectRow,"selection-change":e.handleSelectionChange}},[a("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refash))]),e._v(" "),a("el-table-column",{attrs:{type:"selection",width:"55","reserve-selection":"selectList"}}),e._v(" "),a("el-table-column",{attrs:{prop:"propertyName",label:"属性",border:""}})],1)],1)]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelSubmit}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitAdd}},[e._v("确 定")])],1)])},staticRenderFns:[]};var Me=a("VU/8")(Fe,Ae,!1,function(e){a("Hdq0"),a("u0Ez")},"data-v-5144ce96",null).exports,Oe={props:{standardData:{type:Object}},data:function(){return{dialogVisible:!1,dataSearch:"",selectList:[],pageSize:20,currentPage:1,totalPage:1,tableData:[],refash:!1}},directives:{loadmore:{bind:function(e,t){e.querySelector(".el-table__body-wrapper").addEventListener("scroll",function(){var e=1,a=this.scrollHeight-this.scrollTop<this.clientHeight+1&&this.scrollTop>e;this.scrollTop>e&&(e=this.scrollTop),this.scrollTop<e&&(e=this.scrollTop),a&&t.value()})}}},created:function(){this.getStandardList()},methods:{loadmore:function(){this.currentPage<this.totalPage&&(this.currentPage+=1,this.getStandardList())},getStandardList:function(){var e=this;this.refash=!this.refash;var t={pageSize:this.pageSize,currentPage:this.currentPage,search:this.dataSearch};A.get("/api-goods/page-standard",{params:t}).then(function(t){if(e.selectList=[],0===t.data.errorCode){t.data.result.result&&(e.tableData=e.tableData.concat(t.data.result.result)),e.totalPage=t.data.result.totalPage,e.refash=!e.refash;var a=function(t){var a;(a=e.tableData.find(function(e){return e.standardId===t}))&&e.$refs.selectedTable.toggleRowSelection(a,!0)},s=!0,i=!1,r=void 0;try{for(var o,l=b()(e.standardData.standardSelected);!(s=(o=l.next()).done);s=!0){a(o.value)}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}}else e.$message.success(t.data.message)})},getSearchData:function(){this.currentPage=1,this.tableData=[],this.getStandardList()},handleSelectionChange:function(e){this.selectList=e},selectRow:function(e,t,a){this.$refs.selectedTable.toggleRowSelection(e)},submitStandard:function(){if(0===this.selectList.length)return this.$message.error("请至少选择一个规格进行添加"),!1;var e=[],t=function(t){e.find(function(e){return e.standardId===t.standardId})||e.push(t)},a=!0,s=!1,i=void 0;try{for(var r,o=b()(this.selectList);!(a=(r=o.next()).done);a=!0){t(r.value)}}catch(e){s=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw i}}this.$emit("getStandardSelectList",e),this.standardData.dialogVisible=!1},cancelSubmit:function(){this.selectList=[],this.standardData.dialogVisible=!1}}},$e={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"添加商品规格",visible:e.standardData.dialogVisible,width:"400px"},on:{"update:visible":function(t){e.$set(e.standardData,"dialogVisible",t)},close:e.cancelSubmit}},[a("div",{staticClass:"dialog-body"},[a("div",{staticClass:"table-container"},[a("div",{staticClass:"input-div"},[a("el-input",{attrs:{placeholder:"请输入","prefix-icon":"el-icon-search",clearable:""},on:{clear:function(t){e.getSearchData()}},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.getSearchData()}},model:{value:e.dataSearch,callback:function(t){e.dataSearch=t},expression:"dataSearch"}})],1),e._v(" "),a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.loadmore,expression:"loadmore"}],ref:"selectedTable",staticClass:"scroll-table",staticStyle:{width:"100%"},attrs:{data:e.tableData,height:"400"},on:{"row-click":e.selectRow,"selection-change":e.handleSelectionChange}},[a("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refash))]),e._v(" "),a("el-table-column",{attrs:{type:"selection",width:"55","reserve-selection":"selectList"}}),e._v(" "),a("el-table-column",{attrs:{prop:"standardName",label:"规格",border:""}})],1)],1)]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelSubmit}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitStandard}},[e._v("确 定")])],1)])},staticRenderFns:[]};var Ve=a("VU/8")(Oe,$e,!1,function(e){a("ZCI+"),a("E7mM")},"data-v-26c7ba84",null).exports,Re={props:{standardGroupData:{type:Object}},data:function(){return{dataSearch:"",selectList:[],pageSize:20,currentPage:1,totalPage:1,tableData:[],refash:!1,tableDataValue:[],currentPageValue:1,dataValueSearch:"",totalPageValue:1,standardValueGroupId:"",standardValueGroupName:""}},directives:{loadmore:{bind:function(e,t){e.querySelector(".el-table__body-wrapper").addEventListener("scroll",function(){var e=1,a=this.scrollHeight-this.scrollTop<this.clientHeight+1&&this.scrollTop>e;this.scrollTop>e&&(e=this.scrollTop),this.scrollTop<e&&(e=this.scrollTop),a&&t.value()})}}},created:function(){this.standardGroupData.hasGroup?this.getStandardGroupList():this.getStandardValueList()},methods:{loadmore:function(){this.currentPage<this.totalPage&&(this.currentPage+=1,this.getStandardGroupList())},loadmoreValue:function(){this.currentPageValue<this.totalPageValue&&(this.currentPageValue+=1,this.getStandardValueList("load"))},getStandardGroupList:function(){var e=this;this.refash=!this.refash;var t={pageSize:this.pageSize,currentPage:this.currentPage,type:"TYP_GROUP",parentId:this.standardGroupData.standardId,search:this.dataSearch,sortStatus:""};A.get("/api-goods/page-standard",{params:t}).then(function(t){0===t.data.errorCode?(t.data.result.result&&(e.tableData=e.tableData.concat(t.data.result.result)),e.totalPage=t.data.result.totalPage,e.refash=!e.refash):e.$message.success(t.data.errorCode)})},selectRowGroup:function(e,t,a){this.standardValueGroupId=e.standardId,this.standardValueGroupName=e.standardName,this.$refs.selectedValueTable.clearSelection(),this.getStandardValueList()},getSearchData:function(){this.currentPage=1,this.tableData=[],this.getStandardGroupList()},getStandardValueList:function(e){var t=this,a={currentPage:this.currentPageValue,pageSize:20,standardId:this.standardGroupData.standardId,standardGroupId:this.standardValueGroupId,search:this.dataValueSearch};A.get("/api-goods/list-standardgroup-value",{params:a}).then(function(a){if(0===a.data.errorCode){if(a.data.result.result?t.tableDataValue="load"===e?t.tableDataValue.concat(a.data.result.result):a.data.result.result:t.tableDataValue=t.tableDataValue,t.totalPageValue=a.data.result.totalPage,t.standardGroupData.standardSelected){var s=function(e){var a;(a=t.tableDataValue.find(function(t){return t.valueId===e.valueId}))&&t.$refs.selectedValueTable.toggleRowSelection(a,!0)},i=!0,r=!1,o=void 0;try{for(var l,n=b()(t.standardGroupData.standardSelected);!(i=(l=n.next()).done);i=!0){s(l.value)}}catch(e){r=!0,o=e}finally{try{!i&&n.return&&n.return()}finally{if(r)throw o}}}t.refash=!t.refash}else t.$message.success(a.data.errorCode)})},getSearchValueData:function(){this.currentPageValue=1,this.tableDataValue=[],this.getStandardValueList()},handleSelectionChange:function(e){this.selectList=e},selectRow:function(e,t,a){this.$refs.selectedValueTable.toggleRowSelection(e)},submitStandard:function(){var e=this;if(0===this.selectList.length)return this.$message.error("请至少选择一个规格值进行添加"),!1;var t=[],a=[],s=function(s){t.find(function(e){return e.valueId===s.valueId})||(t.push({groupId:e.standardValueGroupId?e.standardValueGroupId:"-1",groupName:e.standardValueGroupId?e.standardValueGroupName:"-1",valueId:s.valueId,valueName:s.valueName}),a.push({valueId:s.valueId,valueName:s.valueName,remark:"",groupId:e.standardValueGroupId}))},i=!0,r=!1,o=void 0;try{for(var l,n=b()(this.selectList);!(i=(l=n.next()).done);i=!0){s(l.value)}}catch(e){r=!0,o=e}finally{try{!i&&n.return&&n.return()}finally{if(r)throw o}}var d={categoryIds:this.standardGroupData.categoryIds,standardId:this.standardGroupData.standardId,standardName:this.standardGroupData.standardName,list:t};A.post("/api-goods/save-category-standard",d).then(function(t){if(0===t.data.errorCode){if(e.standardGroupData.standardSelected){var s=function(e){a.find(function(t){return t.valueId===e.valueId})||(e.remark="",a.push(e))},i=!0,r=!1,o=void 0;try{for(var l,n=b()(e.standardGroupData.standardSelected);!(i=(l=n.next()).done);i=!0){s(l.value)}}catch(e){r=!0,o=e}finally{try{!i&&n.return&&n.return()}finally{if(r)throw o}}}e.$emit("getStandardSelectValueList",a),e.standardGroupData.dialogVisible=!1}else e.$message.error(t.data.message)})},cancelSubmit:function(){this.standardGroupData.dialogVisible=!1,this.selectList=[]}}},Ue={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"添加商品规格值",visible:e.standardGroupData.dialogVisible,width:e.standardGroupData.hasGroup?"660px":"400px"},on:{"update:visible":function(t){e.$set(e.standardGroupData,"dialogVisible",t)},close:e.cancelSubmit}},[a("div",{staticClass:"dialog-body"},[a("div",{staticClass:"table-container-content"},[e.standardGroupData.hasGroup>0?a("div",{staticClass:"table-container"},[a("div",{staticClass:"input-div"},[a("el-input",{attrs:{placeholder:"请输入","prefix-icon":"el-icon-search",clearable:""},on:{clear:function(t){e.getSearchData()}},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.getSearchData()}},model:{value:e.dataSearch,callback:function(t){e.dataSearch=t},expression:"dataSearch"}})],1),e._v(" "),a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.loadmore,expression:"loadmore"}],ref:"selectedTable",staticClass:"scroll-table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"highlight-current-row":"",height:"400"},on:{"row-click":e.selectRowGroup}},[a("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refash))]),e._v(" "),a("el-table-column",{attrs:{width:"30"}}),e._v(" "),a("el-table-column",{attrs:{prop:"standardName",label:"规格值组",border:""}})],1)],1):e._e(),e._v(" "),a("div",{staticClass:"table-container"},[a("div",{staticClass:"input-div"},[a("el-input",{attrs:{placeholder:"请输入","prefix-icon":"el-icon-search",clearable:""},on:{clear:function(t){e.getSearchValueData()}},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.getSearchValueData()}},model:{value:e.dataValueSearch,callback:function(t){e.dataValueSearch=t},expression:"dataValueSearch"}})],1),e._v(" "),a("el-table",{directives:[{name:"loadmore",rawName:"v-loadmore",value:e.loadmoreValue,expression:"loadmoreValue"}],ref:"selectedValueTable",staticClass:"scroll-table",staticStyle:{width:"100%"},attrs:{data:e.tableDataValue,height:"400"},on:{"row-click":e.selectRow,"selection-change":e.handleSelectionChange}},[a("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refash))]),e._v(" "),a("el-table-column",{attrs:{type:"selection",width:"55","reserve-selection":"selectList"}}),e._v(" "),a("el-table-column",{attrs:{prop:"valueName",label:"规格值",border:""}})],1)],1)])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelSubmit}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitStandard}},[e._v("确 定")])],1)])},staticRenderFns:[]};var Ee=a("VU/8")(Re,Ue,!1,function(e){a("xHyU"),a("tzAU")},"data-v-4125f53a",null).exports,Ge={data:function(){var e=this;return{getInputVal:C,getTime:C.getTime,getSeconds:C.getSeconds,mallHeight:document.documentElement.clientHeight-64-98,fixedWidth:document.documentElement.clientWidth-200,goodsForm:{goodsName:"",mallProId:"",createSource:0,goodsBrand:[],goodsBrandSelect:"",categoryIds:[],goodsClassifyData:[],goodsPropertyData:[],goodsClassifySelect:null,goodsStandardData:[],goodsStandardSelect:[],tableStandardList:[],goodsStandardValueData:[],goodsStandardValueSelect:"",tableStandardValueList:[],dataIndex:0,standardKeyList:[],combineKeyValueList:[],standardKeyHeaderList:[],skuImageJson:[],mallProStandardJson:[],skuJson:[],editSkuKeyJson:[],editSkuKeyHeader:[],combineKeyAllValueList:[],standardUnkeyList:[],standardUnkeyHeaderList:[],combineAllList:[],standardAllHeaderList:[],stock:"",mallProSpuPrice:"",proCode:"",proCodeQuery:"",imgTextEdit:"",templateList:[],templateSelect:"",putaway:"1",putawayTime:""},table1ShowStatus:!1,table2ShowStatus:!1,tinymceHtml:"请输入内容",goodsRules:{goodsName:[{required:!0,message:"请输入商品名称",trigger:"blur"}],goodsBrandSelect:[{required:!0,message:"请选择商品品牌",trigger:"blur"}],goodsClassifySelect:[{required:!0,message:"请选择商品分类",trigger:"blur"}],templateSelect:[{required:!0,message:"请选择运费模板",trigger:"blur"}],proCode:[{required:!0,message:"请填写商品货号",trigger:"blur"},{validator:function(t,a,s){var i={mallProId:"-1"==e.goodsForm.mallProId?"":e.goodsForm.mallProId,proCode:e.goodsForm.proCode};A.get("/api-mall/check-pro-code",{params:i}).then(function(e){0===e.data.errorCode?e.data.result?s():s(new Error("商品货号禁止重复")):s(new Error(e.data.result))})},trigger:"blur"}],mallProSpuPrice:[{required:!0,message:"请填写商品价格",trigger:"blur"},{validator:function(e,t,a){0===Number(t)?a(new Error("请输入大于0的数字")):Number(t)?a():a(new Error("请输入数字"))},trigger:"blur"}]},goodsFormLen:{nameLen:0},uploadAction:window.location.origin+"/api-plug/upload-img?requestProject=mall",headersUpload:{sign:""},uploadStatus:!0,dialogVisible:!1,dialogStandardValue:!1,dialogImageUrl:[],dialogEnlargeImageUrl:"",dialogVisibleImg:!1,projectName:"mall",batchPrice:"",batchStock:"",batchSku:"",batchBar:"",selectCateData:[],refash:!0,imgUrl:"",selectModalCopy:{},pageTitle:"新建商品",activeName:"",submitLoading:!1,pickerOptions:{disabledDate:function(e){return e.getTime()<(new Date).getTime()}},propertyData:{dialogVisible:!1,categoryIds:"",propertySelected:[]},propertyListCopy:[],standardData:{dialogVisible:!1,categoryIds:"",standardSelected:[]},standardGroupData:{dialogVisible:!1,categoryIds:"",standardId:"",standardName:"",hasGroup:1,standardSelected:[]}}},mounted:function(){window.onbeforeunload=function(e){localStorage.removeItem("goodsSearch")}},created:function(){this.getGoodsBrandList(),this.getClassifyList(),this.getTemplateList(),this.goodsForm.mallProId=this.$route.params.mallProId,this.goodsForm.createSource=this.$route.params.createSource,this.activeName=this.$route.params.activeName,"-1"!==this.goodsForm.mallProId&&"1"==this.goodsForm.createSource?(this.getEditMes(),this.getStandardImg(),this.pageTitle="编辑商品"):"-1"!==this.goodsForm.mallProId&&"0"==this.goodsForm.createSource&&(this.getEditOldMes(),this.pageTitle="编辑商品"),this.imgUrl=window.location.origin+"/gicweb/add-mall-goods?mallProId="+this.goodsForm.mallProId},computed:{},methods:{getEditMes:function(){var e=this,t={mallProId:this.goodsForm.mallProId};A.get("/api-mall/get-mall-good",{params:t}).then(function(t){if(0===t.data.errorCode){for(var a in t.data.result.mallCategories)e.goodsForm.categoryIds.push(t.data.result.mallCategories[a].categoryId);for(var s in null===t.data.result.mallCategories?e.selectCateData=[]:e.selectCateData=t.data.result.mallCategories,e.getProperyList(),e.goodsForm.imgTextEdit=t.data.result.detailDescription,e.goodsForm.goodsClassifySelect=t.data.result.mallProTagId,e.goodsForm.goodsName=he(t.data.result.proName),e.goodsFormLen.nameLen=C.getZhLen(e.goodsForm.goodsName),e.goodsForm.tableStandardList=JSON.parse(t.data.result.mallProStandardJson),e.goodsForm.tableStandardList)e.goodsForm.goodsStandardSelect.push(e.goodsForm.tableStandardList[s].standardId);if(t.data.result.skuJson&&(e.table2ShowStatus=!0),e.goodsForm.tableStandardList=JSON.parse(t.data.result.mallProStandardJson),t.data.result.mallProImageUrl?e.dialogImageUrl=t.data.result.mallProImageUrl:e.dialogImageUrl=[],e.dialogImageUrl.length>=10?e.uploadStatus=!1:e.uploadStatus=!0,e.goodsForm.goodsBrandSelect="-1"===t.data.result.brandId?"":t.data.result.brandId,t.data.result.skuJson){var i=JSON.parse(t.data.result.skuJson[0].mallPropValues);for(var r in i)e.goodsForm.standardAllHeaderList.push({standardName:i[r].propName,standardId:i[r].propId})}for(var o in t.data.result.skuJson){var l=JSON.parse(t.data.result.skuJson[o].mallPropValues);l.push({valueName:t.data.result.skuJson[o].mallProSkuPrice}),l.push({valueName:t.data.result.skuJson[o].stock}),l.push({valueName:t.data.result.skuJson[o].mallProSkuCode}),l.push({valueName:t.data.result.skuJson[o].mallProSkuBarCode}),e.goodsForm.combineKeyAllValueList.push(l)}e.goodsForm.proCode=t.data.result.proCode,e.goodsForm.proCodeQuery=t.data.result.proCodeQuery,e.goodsForm.mallProSpuPrice=t.data.result.mallProSpuPrice,e.goodsForm.stock=t.data.result.stock,e.goodsForm.templateSelect=t.data.result.freightTemplateId,1===t.data.result.status?e.goodsForm.putaway="3":e.goodsForm.putaway=String(t.data.result.upShelvesStatus),e.goodsForm.putawayTime=t.data.result.upShelvesTime,e.addStock()}else e.$message.error(t.data.message)})},getEditOldMes:function(){var e=this,t={mallProId:this.goodsForm.mallProId};A.get("/api-mall/get-mall-good",{params:t}).then(function(t){0===t.data.errorCode?(e.goodsForm.imgTextEdit=t.data.result.detailDescription,e.goodsForm.goodsClassifySelect=t.data.result.mallProTagId,e.goodsForm.goodsName=he(t.data.result.proName),e.goodsFormLen.nameLen=C.getZhLen(e.goodsForm.goodsName),e.dialogImageUrl=t.data.result.mallProImageUrl,e.goodsForm.goodsBrandSelect="-1"===t.data.result.brandId?"":t.data.result.brandId,e.goodsForm.templateSelect=t.data.result.freightTemplateId,e.goodsForm.putaway=String(t.data.result.upShelvesStatus),e.goodsForm.putawayTime=t.data.result.upShelvesTime):e.$message.error(t.data.message)})},getStandardImg:function(){var e=this,t={mallProId:this.goodsForm.mallProId};A.get("/api-mall/list-mall-goods-standard-image",{params:t}).then(function(t){if(0===t.data.errorCode){if(t.data.result.length){var a=t.data.result[0].standardValues;for(var s in a)e.goodsForm.standardKeyHeaderList.push({standardName:a[s].standardName,standardId:a[s].standardId});for(var i in t.data.result&&(e.table1ShowStatus=!0),t.data.result){var r=t.data.result[i].standardValues;r.push({valueName:t.data.result[i].imageUrl}),e.goodsForm.combineKeyValueList.push(r)}}}else e.$message.error(t.data.message)})},goodsLimit:function(e){var t=this;this.$nextTick(function(){t.goodsForm.goodsName=C.getInputVal(e,30),t.goodsFormLen.nameLen=C.getZhLen(t.goodsForm.goodsName)})},remarkLimit:function(e){this.$nextTick(function(){e.remark=C.getInputVal(e.remark,10)})},priceLimit:function(e){Number(this.batchPrice)?this.batchPrice=Number(this.batchPrice).toFixed(2):(this.$message.error("请输入数字类型"),this.batchPrice="")},stockLimit:function(e){var t=this;this.$nextTick(function(){t.batchStock=e.replace(/[^\d]/g,""),t.batchStock=C.getInputVal(e,3)})},SKULimit:function(e){var t=this;this.$nextTick(function(){t.batchSku=C.getInputVal(e,16)})},barLimit:function(e){var t=this;this.$nextTick(function(){t.batchBar=C.getInputVal(e,16)})},proCodeLimit:function(e){var t=this;this.$nextTick(function(){t.goodsForm.proCode=C.getInputVal(e,16)})},proCodeQueryLimit:function(e){var t=this;this.$nextTick(function(){t.goodsForm.proCodeQuery=C.getInputVal(e,16)})},getGoodsBrandList:function(){var e=this;A.get("/api-mall/list-enterprise-brand").then(function(t){0===t.data.errorCode?e.goodsForm.goodsBrand=t.data.result:e.$message.error(t.data.message)})},getClassifyList:function(){var e=this;A.get("/api-mall/list_mall_goods_tag_tree").then(function(t){0===t.data.errorCode?(e.goodsForm.goodsClassifyData.push({childTagList:t.data.result.childTagList,mallProTagId:t.data.result.mallProTagId,tagName:t.data.result.tagName}),e.getTree(e.goodsForm.goodsClassifyData)):e.$message.error(t.data.message)})},getTree:function(e){for(var t in e)e[t].label=e[t].tagName,e[t].id=e[t].mallProTagId,e[t].children=e[t].childTagList,e[t].children&&e[t].children.length?this.getTree(e[t].children):delete e[t].children},getProperyList:function(){var e=this;this.goodsForm.goodsPropertyData=[];var t={categoryIds:this.goodsForm.categoryIds.join(",")};"-1"!==this.goodsForm.mallProId&&(t.mallProId=this.goodsForm.mallProId),A.get("/api-mall/list-mall-goods-property",{params:t}).then(function(t){if(0===t.data.errorCode){var a=[];for(var s in a=t.data.result)if("-1"===e.goodsForm.mallProId||"0"===e.goodsForm.createSource)if("TYP_TEXT"===a[s].propertyType||"TYP_NUM"===a[s].propertyType||"TYP_REAL_NUM"===a[s].propertyType||"TYP_TIME"===a[s].propertyType||"TYP_CURRENCY"===a[s].propertyType||"TYP_PERCENT"===a[s].propertyType)a[s].mallPropValues="";else if("TYP_MULTI"===a[s].propertyType){for(var i in a[s].children)a[s].children[i].label=a[s].children[i].valueName,a[s].children[i].id=a[s].children[i].valueId;a[s].mallPropValues=null}else"TYP_CHECK"===a[s].propertyType&&(a[s].mallPropValues=[]);else if("TYP_TEXT"===a[s].propertyType||"TYP_NUM"===a[s].propertyType||"TYP_REAL_NUM"===a[s].propertyType||"TYP_TIME"===a[s].propertyType||"TYP_CURRENCY"===a[s].propertyType||"TYP_PERCENT"===a[s].propertyType)a[s].mallPropValues.length?a[s].mallPropValues=a[s].mallPropValues[0].valueName:a[s].mallPropValues="";else if("TYP_MULTI"===a[s].propertyType){for(var r in a[s].children)a[s].children[r].label=a[s].children[r].valueName,a[s].children[r].id=a[s].children[r].valueId;if(a[s].mallPropValues.length){var o=[];for(var l in a[s].mallPropValues)o.push(a[s].mallPropValues[l].valueId);a[s].mallPropValues=o}else a[s].mallPropValues=null}else if("TYP_SINGLE"===a[s].propertyType)a[s].mallPropValues.length?a[s].mallPropValues=a[s].mallPropValues[0]:a[s].mallPropValues="";else{var n=[];for(var d in a[s].mallPropValues)n.push({valueId:a[s].mallPropValues[d].valueId,valueName:a[s].mallPropValues[d].valueName});a[s].mallPropValues=n}e.goodsForm.goodsPropertyData=a,e.propertyListCopy=he(e.goodsForm.goodsPropertyData)}else e.$message.error(t.data.message)})},getPropertyList:function(e){var t=this,a=function(e){t.goodsForm.goodsPropertyData.some(function(t){return t.propertyId===e.propertyId})||t.goodsForm.goodsPropertyData.push(e)},s=!0,i=!1,r=void 0;try{for(var o,l=b()(e);!(s=(o=l.next()).done);s=!0){a(o.value)}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}this.propertyListCopy=he(this.goodsForm.goodsPropertyData)},addProperty:function(){var e=[],t=!0,a=!1,s=void 0;try{for(var i,r=b()(this.propertyListCopy);!(t=(i=r.next()).done);t=!0){var o=i.value;e.push(o.propertyId)}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}this.propertyData.propertySelected=e,this.propertyData.categoryIds=this.goodsForm.categoryIds.join(","),this.propertyData.dialogVisible=!0},deleteProperty:function(e,t){var a=this,s={categoryId:this.goodsForm.categoryIds.join(","),propertyId:e.propertyId};A.post("/api-goods/delete-category-property",_.a.stringify(s)).then(function(e){0===e.data.errorCode?(a.goodsForm.goodsPropertyData.splice(t,1),a.propertyListCopy=he(a.goodsForm.goodsPropertyData)):a.$message.error(e.data.message)})},changeProperty:function(e,t){this.newCategoryProperty(e,t),this.propertyListCopy=he(this.goodsForm.goodsPropertyData)},newCategoryProperty:function(e,t){var a=this,s="";if("TYP_MULTI"===e.propertyType){var i=!0,r=!1,o=void 0;try{for(var l,n=b()(e.mallPropValues);!(i=(l=n.next()).done);i=!0){var d=l.value;s=""===s?d:s+","+d}}catch(e){r=!0,o=e}finally{try{!i&&n.return&&n.return()}finally{if(r)throw o}}}else if("TYP_CHECK"===e.propertyType){var c=!0,u=!1,m=void 0;try{for(var p,h=b()(e.mallPropValues);!(c=(p=h.next()).done);c=!0){var g=p.value;s=""===s?g.valueId:s+","+g.valueId}}catch(e){u=!0,m=e}finally{try{!c&&h.return&&h.return()}finally{if(u)throw m}}}else"TYP_SINGLE"===e.propertyType&&(s=e.mallPropValues.valueId?e.mallPropValues.valueId:"");var v={categoryIds:this.goodsForm.categoryIds.join(","),productPropertyId:e.propertyId,productPropertyName:e.propertyName,productPropertyValueIds:s};if(""===v.productPropertyValueIds)return!1;A.post("/api-goods/save-category-property",v).then(function(e){if(0===e.data.errorCode)return!1;a.$message.error(e.data.message)})},beforeUpload:function(e){if(null===this.dialogImageUrl&&(this.dialogImageUrl=[]),this.dialogImageUrl.length>9)return this.$message.warning("最多上传10张商品主图"),!1;if(e.size>2097152)return this.$message.error("请上传小于2MB的图片"),!1;if("image/jpeg"!==e.type&&"image/png"!==e.type&&"image/jpg"!==e.type&&"image/gif"!==e.type)return this.$message.error("请上传jpg，png，gif格式的图片"),!1;localStorage.getItem("sign")?this.headersUpload.sign=localStorage.getItem("sign"):this.headersUpload.sign="";var t=this;return new S.a(function(a,s){var i=new FileReader;i.onload=function(e){var i=new Image;i.onload=function(){var e=this.width,i=this.height;(e<700||e/i<.5)&&(t.$message.error("请上传正确的图片尺寸"),s()),a()},i.src=e.target.result},i.readAsDataURL(e)})},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisibleImg=!0},uploadSuccess:function(e,t,a){0===e.errorCode?(this.dialogImageUrl.push({imageUrl:e.result[0].qcloudImageUrl,imageCode:e.result[0].imageFiledCode}),this.$message.success("上传成功"),10===this.dialogImageUrl.length?this.uploadStatus=!1:this.uploadStatus=!0):this.$message.error(e.message)},deteletDialogImageUrl:function(e){this.uploadStatus=!0,this.dialogImageUrl.splice(e,1)},enlargeDialogImageUrl:function(e){this.dialogEnlargeImageUrl=this.dialogImageUrl[e].imageUrl,this.dialogVisibleImg=!0},moveLeft:function(e){this.swapArray(this.dialogImageUrl,e,e-1)},moveRight:function(e){this.swapArray(this.dialogImageUrl,e,e+1)},swapArray:function(e,t,a){return e[t]=e.splice(a,1,e[t])[0],e},tableBeforeUpload:function(e){if(e.size>2097152)return this.$message.error("请上传小于2MB的图片"),!1;if("image/jpeg"!==e.type&&"image/png"!==e.type&&"image/jpg"!==e.type&&"image/gif"!==e.type)return this.$message.error("请上传jpg，png，gif格式的图片"),!1;localStorage.getItem("sign")?this.headersUpload.sign=localStorage.getItem("sign"):this.headersUpload.sign="";var t=this;return new S.a(function(a,s){var i=new FileReader;i.onload=function(e){var i=new Image;i.onload=function(){var e=this.width,i=this.height;(e<200||e/i<.5||i<200)&&(t.$message.error("请上传正确的图片尺寸"),s()),a()},i.src=e.target.result},i.readAsDataURL(e)})},tableUploadSuccess:function(e,t,a,s){0===e.errorCode?(s.valueName=e.result[0].qcloudImageUrl,s.valueId=e.result[0].imageFiledCode,this.$message.success("上传成功")):this.$message.error(e.message)},getCateIds:function(e){this.goodsForm.categoryIds=e,e.length||(this.selectCateData=[]),this.getProperyList()},deleteSkuMess:function(){this.goodsForm.goodsStandardSelect=[],this.goodsForm.goodsStandardValueSelect=[],this.goodsForm.tableStandardList=[],this.goodsForm.standardKeyHeaderList=[],this.goodsForm.combineKeyValueList=[],this.table1ShowStatus=!1,this.goodsForm.standardAllHeaderList=[],this.goodsForm.combineKeyAllValueList=[],this.table1ShowStatus2=!1},handleAddStandard:function(){this.standardData.categoryIds=this.goodsForm.categoryIds.join(","),this.standardData.standardSelected=this.goodsForm.goodsStandardSelect,this.standardData.dialogVisible=!0},getStandardList:function(){var e=this,t={categoryIds:this.goodsForm.categoryIds.join(",")};A.get("/api-mall/list-mall-goods-standard",{params:t}).then(function(t){0===t.data.errorCode?e.goodsForm.goodsStandardData=t.data.result:e.$message.error(t.data.message)}),this.selectModalCopy.goodsStandardSelect=he(this.goodsForm.goodsStandardSelect)},getStandardSelectList:function(e){this.goodsForm.tableStandardList=[];var t=[],a=!0,s=!1,i=void 0;try{for(var r,o=b()(this.goodsForm.tableStandardList);!(a=(r=o.next()).done);a=!0){var l=r.value;t.push(l.standardId)}}catch(e){s=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw i}}var n=[],d=!0,c=!1,u=void 0;try{for(var m,p=b()(e);!(d=(m=p.next()).done);d=!0){var h=m.value;n.push({standardName:h.standardName,standardId:h.standardId,pivotal:h.pivotal})}}catch(e){c=!0,u=e}finally{try{!d&&p.return&&p.return()}finally{if(c)throw u}}this.goodsForm.tableStandardList=n;var g=!0,v=!1,f=void 0;try{for(var y,_=b()(this.goodsForm.tableStandardList);!(g=(y=_.next()).done);g=!0){var C=y.value;this.goodsForm.goodsStandardSelect.push(C.standardId)}}catch(e){v=!0,f=e}finally{try{!g&&_.return&&_.return()}finally{if(v)throw f}}this.handleDate(this.goodsForm.tableStandardList),this.dialogVisible=!1,this.selectModalCopy.goodsStandardSelect=he(this.goodsForm.goodsStandardSelect)},deleteStandard:function(e,t){var a=this;this.goodsForm.tableStandardList.splice(t,1),this.goodsForm.goodsStandardSelect.splice(t,1),this.handleDate(this.goodsForm.tableStandardList);var s={categoryId:this.goodsForm.categoryIds.join(","),standardId:e.standardId};A.post("/api-goods/delete-category-standard",_.a.stringify(s)).then(function(e){if(0===e.data.errorCode)return!1;a.$message.error(e.data.message)})},handleAddStandardValue:function(e,t){var a=this;this.dataIndex=t;var s={standardId:e.standardId};A.get("/api-goods/find-standardgroup-count",{params:s}).then(function(t){0===t.data.errorCode?(t.data.result>0?a.standardGroupData.hasGroup=t.data.result:a.standardGroupData.hasGroup=0,a.standardGroupData.standardId=e.standardId,a.standardGroupData.standardName=e.standardName,a.standardGroupData.categoryIds=a.goodsForm.categoryIds.join(","),a.standardGroupData.standardSelected=e.standardValues,a.standardGroupData.dialogVisible=!0):a.$message.error(t.data.message)})},getStandardValueList:function(e,t){var a=this,s={categoryIds:this.goodsForm.categoryIds.join(","),standardId:e};for(var i in A.get("/api-mall/list-mall-goods-standard-values",{params:s}).then(function(e){0===e.data.errorCode?a.goodsForm.goodsStandardValueData=e.data.result:a.$message.error(e.data.message)}),this.selectModalCopy.goodsStandardValueData=he(this.goodsForm.goodsStandardValueData),this.goodsForm.goodsStandardValueSelect=[],this.goodsForm.tableStandardList[t].standardValues)this.goodsForm.goodsStandardValueSelect.push(this.goodsForm.tableStandardList[t].standardValues[i].valueId)},deleteStandardValue:function(e,t,a,s){var i=this;1===this.goodsForm.tableStandardList[e].standardValues.length?delete this.goodsForm.tableStandardList[e].standardValues:this.goodsForm.tableStandardList[e].standardValues.splice(t,1),this.handleDate(this.goodsForm.tableStandardList);var r={categoryId:this.goodsForm.categoryIds.join(","),standardId:a.standardId,groupId:s.groupId?s.groupId:"",valueId:s.valueId};A.post("/api-goods/delete-category-standard-value",_.a.stringify(r)).then(function(e){if(0===e.data.errorCode)return!1;i.$message.error(e.data.message)})},getStandardSelectValueList:function(e){this.goodsForm.tableStandardValueList=[];var t=[],a=!0,s=!1,i=void 0;try{for(var r,o=b()(e);!(a=(r=o.next()).done);a=!0){var l=r.value;t.push({valueId:l.valueId,valueName:l.valueName,remark:"",groupId:l.groupId})}}catch(e){s=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw i}}this.goodsForm.tableStandardValueList=e,this.goodsForm.tableStandardList[this.dataIndex].standardValues=this.goodsForm.tableStandardValueList,this.dialogStandardValue=!1,this.handleDate(this.goodsForm.tableStandardList),this.selectModalCopy.goodsStandardValueData=he(this.goodsForm.goodsStandardValueData)},handleDate:function(e){for(var t in this.goodsForm.standardKeyHeaderList=[],e)e[t].pivotal&&this.goodsForm.standardKeyHeaderList.push(e[t]);this.goodsForm.standardKeyList=[];for(var a=0;a<e.length;a++)e[a].pivotal&&(e[a].standardValues?this.goodsForm.standardKeyList.push(e[a].standardValues):this.goodsForm.standardKeyList.push([{valueName:"",valueId:""}]));this.goodsForm.standardKeyList.push([{valueName:"",valueId:""}]);var s=he(this.goodsForm.standardKeyList);for(var i in this.goodsForm.combineKeyValueList=he(this.combine(he(this.goodsForm.standardKeyList))),this.goodsForm.combineKeyValueList)for(var r in this.goodsForm.combineKeyValueList[i])this.goodsForm.combineKeyValueList[i][r].valueName&&(this.table1ShowStatus=!0);this.handleStandard(e,s)},handleStandard:function(e,t){for(var a in t.pop(),this.goodsForm.standardUnkeyHeaderList=[],e)e[a].pivotal||this.goodsForm.standardUnkeyHeaderList.push(e[a]);this.goodsForm.standardAllHeaderList=this.goodsForm.standardKeyHeaderList.concat(this.goodsForm.standardUnkeyHeaderList),this.goodsForm.standardUnkeyList=[];for(var s=[],i=0;i<e.length;i++)e[i].pivotal?e[i].standardValues?s.push(e[i].standardValues):s.push([{valueName:"",valueId:""}]):e[i].standardValues?this.goodsForm.standardUnkeyList.push(e[i].standardValues):this.goodsForm.standardUnkeyList.push([{valueName:"",valueId:""}]);for(var r in this.goodsForm.standardUnkeyList.push([{valueName:"",valueId:""}]),this.goodsForm.standardUnkeyList.push([{valueName:"",valueId:""}]),this.goodsForm.standardUnkeyList.push([{valueName:"",valueId:""}]),this.goodsForm.standardUnkeyList.push([{valueName:"",valueId:""}]),this.goodsForm.combineAllList=t.concat(this.goodsForm.standardUnkeyList),this.goodsForm.combineKeyAllValueList=he(this.combine(he(this.goodsForm.combineAllList))),this.goodsForm.combineKeyAllValueList)for(var o in this.goodsForm.combineKeyAllValueList[r])this.goodsForm.combineKeyAllValueList[r][o].valueName&&(this.table2ShowStatus=!0)},cancelSelectValueList:function(){this.goodsForm.goodsStandardValueData=he(this.selectModalCopy.goodsStandardValueData),this.dialogStandardValue=!1},combine:function(e){e.reverse();var t=[];return function e(a,s,i){if(0==i)return t.push(a);for(var r=0;r<s[i-1].length;r++)e(a.concat(s[i-1][r]),s,i-1)}([],e,e.length),t},getTemplateList:function(){var e=this;A.get("/api-mall/list-mall-goods-freight").then(function(t){0===t.data.errorCode?e.goodsForm.templateList=t.data.result:e.$message.error(t.data.message)})},handleStandSku:function(){var e=he(this.goodsForm.combineKeyAllValueList),t=void 0,a=void 0,s=[],i=[];for(var r in e){for(var o in a=(t=he(e[r])).splice(t.length-4,4),t)delete t[o].remark,t[o].propName=this.goodsForm.standardAllHeaderList[o].standardName,t[o].propId=this.goodsForm.standardAllHeaderList[o].standardId;this.goodsForm.skuJson=[],i.push(t),s.push(a)}for(var l in e)this.goodsForm.skuJson.push({mallProSkuPrice:s[l][0].valueName,stock:s[l][1].valueName,mallProSkuCode:s[l][2].valueName,mallProSkuBarCode:s[l][3].valueName,mallPropValues:i[l]})},batchSetSku:function(){for(var e in this.goodsForm.combineKeyAllValueList){var t=this.goodsForm.combineKeyAllValueList[e].length;this.batchPrice&&(this.goodsForm.combineKeyAllValueList[e][t-4].valueName=this.batchPrice),this.batchStock&&(this.goodsForm.combineKeyAllValueList[e][t-3].valueName=this.batchStock),this.batchSku&&(this.goodsForm.combineKeyAllValueList[e][t-2].valueName=this.batchSku),this.batchBar&&(this.goodsForm.combineKeyAllValueList[e][t-1].valueName=this.batchBar)}this.addStock()},sliceLimit:function(e,t,a){e.length-a!=2&&e.length-a!=1||this.$nextTick(function(){t.valueName=C.getInputVal(t.valueName,16)}),this.addStock(e,t,a)},addStock:function(e,t,a){var s=0;for(var i in this.goodsForm.combineKeyAllValueList)for(var r in this.goodsForm.combineKeyAllValueList[i])this.goodsForm.combineKeyAllValueList[i].length-r==3&&""!==this.goodsForm.combineKeyAllValueList[i][r].valueName&&(s+=Number(this.goodsForm.combineKeyAllValueList[i][r].valueName));this.goodsForm.stock=s},skuInput:function(e,t,a,s){if(e.length-s==4)Number(t.valueName)?t.valueName=Number(t.valueName).toFixed(2):(this.$message.error("请输入数字类型"),t.valueName="");else if(e.length-s==3){0!==Number(t.valueName)&&(Number(t.valueName)?/^\+?[1-9][0-9]*$/.test(Number(t.valueName))?(t.valueName=String(t.valueName).slice(0,6),this.addStock()):(this.$message.error("请输入整数"),t.valueName=""):(this.$message.error("请输入数字类型"),t.valueName=""))}else e.length-s==2?t.valueName=t.valueName.slice(0,32):e.length-s==1&&(t.valueName=t.valueName.slice(0,32))},submitGoodsForm:function(e){var t=this;return this.goodsForm.putawayTime=this.getTime(this.goodsForm.putawayTime)+" "+this.getSeconds(this.goodsForm.putawayTime),this.goodsForm.imgTextEdit=this.$refs.tinymceWrap.tinymceHtml,0===this.goodsForm.categoryIds.length?(this.$message.error("请选择商品品类"),!1):0===this.dialogImageUrl.length?(this.$message.error("请选择商品主图"),!1):""!==this.goodsForm.imgTextEdit&&this.goodsForm.imgTextEdit?0===this.goodsForm.tableStandardList.length?(this.$message.error("请添加规格信息"),!1):void this.$refs[e].validate(function(e){if(!e)return t.submitLoading=!1,!1;var a=!0,s=!1,i=void 0;try{for(var r,o=b()(t.goodsForm.combineKeyValueList);!(a=(r=o.next()).done);a=!0){var l=r.value;if(!l[l.length-1].valueName&&1!==l.length)return t.$message.error("请上传规格图片"),!1}}catch(e){s=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw i}}var n=!0,d=!1,c=void 0;try{for(var u,m=b()(t.goodsForm.combineKeyAllValueList);!(n=(u=m.next()).done);n=!0){var p=u.value;if(!p[p.length-2].valueName)return t.$message.error("请上传SKU编码"),!1;if(!p[p.length-3].valueName&&0!==p[p.length-3].valueName)return t.$message.error("请上传库存"),!1;if(!p[p.length-4].valueName)return t.$message.error("请上传sku价格"),!1}}catch(e){d=!0,c=e}finally{try{!n&&m.return&&m.return()}finally{if(d)throw c}}for(var h in t.handleStandSku(),t.goodsForm.skuImageJson=[],t.goodsForm.combineKeyValueList){for(var g="",v=0;v<t.goodsForm.combineKeyValueList[h].length-1;v++)g=g+"_"+t.goodsForm.combineKeyValueList[h][v].valueId;t.goodsForm.skuImageJson.push({valueId:g,imageUrl:he(t.goodsForm.combineKeyValueList[h]).pop().valueName,imageFileCode:he(t.goodsForm.combineKeyValueList[h]).pop().valueId})}var f=[];for(var y in t.goodsForm.goodsPropertyData)if(f.push({mallPropId:t.goodsForm.goodsPropertyData[y].propertyId}),f[y].mallPropValues=[],"TYP_TEXT"===t.goodsForm.goodsPropertyData[y].propertyType||"TYP_NUM"===t.goodsForm.goodsPropertyData[y].propertyType||"TYP_REAL_NUM"===t.goodsForm.goodsPropertyData[y].propertyType||"TYP_TIME"===t.goodsForm.goodsPropertyData[y].propertyType||"TYP_CURRENCY"===t.goodsForm.goodsPropertyData[y].propertyType||"TYP_PERCENT"===t.goodsForm.goodsPropertyData[y].propertyType)f[y].mallPropValues.push({valueName:t.goodsForm.goodsPropertyData[y].mallPropValues,valueId:""});else if("TYP_MULTI"===t.goodsForm.goodsPropertyData[y].propertyType)for(var C in t.goodsForm.goodsPropertyData[y].mallPropValues)f[y].mallPropValues.push({valueName:"",valueId:t.goodsForm.goodsPropertyData[y].mallPropValues[C]});else if("TYP_SINGLE"===t.goodsForm.goodsPropertyData[y].propertyType)f[y].mallPropValues.push({valueName:t.goodsForm.goodsPropertyData[y].mallPropValues.valueName,valueId:t.goodsForm.goodsPropertyData[y].mallPropValues.valueId});else for(var I in t.goodsForm.goodsPropertyData[y].mallPropValues)f[y].mallPropValues.push({valueName:t.goodsForm.goodsPropertyData[y].mallPropValues[I].valueName,valueId:t.goodsForm.goodsPropertyData[y].mallPropValues[I].valueId});var S={mallCategoryIds:t.goodsForm.categoryIds.join(","),mallProTagId:t.goodsForm.goodsClassifySelect.join(","),proName:t.goodsForm.goodsName.trim(),brandId:t.goodsForm.goodsBrandSelect,mallProImageUrl:O()(t.dialogImageUrl),mallProStandardJson:O()(t.goodsForm.tableStandardList),skuImageJson:O()(t.goodsForm.skuImageJson),propJson:O()(f),skuJson:O()(t.goodsForm.skuJson),stock:t.goodsForm.stock,mallProSpuPrice:t.goodsForm.mallProSpuPrice,proCode:t.goodsForm.proCode,proCodeQuery:t.goodsForm.proCodeQuery,detailDescription:t.goodsForm.imgTextEdit,stockOptType:1,freightTemplateId:t.goodsForm.templateSelect,upShelvesStatus:t.goodsForm.putaway,upShelvesTime:"2"===t.goodsForm.putaway?t.goodsForm.putawayTime:"",status:"3"===t.goodsForm.putaway?1:2};if("-1"!==t.goodsForm.mallProId&&(S.mallProId=t.goodsForm.mallProId),0===t.goodsForm.stock&&1==t.goodsForm.putaway||0===t.goodsForm.stock&&2==t.goodsForm.putaway)return t.$message.error("商品总库存为0的商品不可上架"),!1;"1"==t.goodsForm.putaway?t.activeName="first":t.activeName="third",t.submitLoading=!0,A.post("/api-mall/save-gic-mall-goods",_.a.stringify(S)).then(function(e){0===e.data.errorCode?(t.$message.success("保存成功"),t.$router.push({name:"goodsList"}),t.submitLoading=!1):(t.$message.error(e.data.message),t.submitLoading=!1)})}):(this.$message.error("请编辑图文详情"),!1)},cancelGoodsForm:function(){this.$router.go(-1)},hideDrag:function(e){var t=this;"-1"===e&&this.$nextTick(function(){t.$refs.modal&&(t.$refs.modal.showDrag=!1)})}},components:{Treeselect:ce.a,goodsCate:xe,tinymceEdit:Pe,addProperty:Me,addStandard:Ve,addStandardValue:Ee}},Be={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"},on:{click:function(t){t.stopPropagation(),e.hideDrag("-1")}}},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title",staticStyle:{position:"relative"}},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("商品管理")]),e._v(" "),a("el-breadcrumb-item",{attrs:{to:{path:"/goodsList"}}},[e._v("商品列表")]),e._v(" "),a("el-breadcrumb-item",[e._v(e._s(e.pageTitle))])],1),e._v(" "),a("h3",[a("span",[e._v(e._s(e.pageTitle))])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"0"==e.goodsForm.createSource,expression:"goodsForm.createSource == '0'"}],staticStyle:{width:"800px",position:"absolute",left:"50%","z-index":"1",top:"35px",transform:"translateX(-50%)"}},[a("el-alert",{attrs:{title:"即日起启用新版商品管理，请商户前往新版微商城及时完善商品资料。完善路径：新版->商品列表->编辑->保存，完善时可参考“旧版商品详情”。一经保存“旧版商品详情”入口关闭。请在10月15日之前完善，否则商品会被清除，感谢您的理解与支持。",type:"warning"}}),e._v(" "),a("a",{staticStyle:{position:"absolute",right:"-120px","z-index":"11",top:"25px","font-size":"14px"},attrs:{href:e.imgUrl,target:"_blank"}},[e._v("查看旧版商品详情")])],1)],1),e._v(" "),a("div",{staticClass:"mall-section"},[a("el-form",{ref:"goodsForm",staticClass:"demo-ruleForm",attrs:{model:e.goodsForm,rules:e.goodsRules,"label-width":"90px","label-position":"left"}},[a("div",{staticClass:"form-group"},[a("p",{staticClass:"title"},[e._v("基本信息")]),e._v(" "),a("el-form-item",{attrs:{label:"商品类型"}},[a("span",[e._v("手动发布")])]),e._v(" "),a("el-form-item",{attrs:{label:"商品品类"}},[a("goodsCate",{ref:"modal",attrs:{selectCateData:e.selectCateData},on:{getCateIds:e.getCateIds,deleteSkuMess:e.deleteSkuMess}}),e._v(" "),a("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refash))])],1),e._v(" "),a("el-form-item",{attrs:{label:"商品名称",prop:"goodsName"}},[a("el-input",{staticClass:"w-900",attrs:{type:"text"},on:{input:function(t){return e.goodsLimit(t)}},model:{value:e.goodsForm.goodsName,callback:function(t){e.$set(e.goodsForm,"goodsName",t)},expression:"goodsForm.goodsName"}},[a("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.goodsFormLen.nameLen)+"/30")])])],1),e._v(" "),a("el-form-item",{attrs:{label:"商品品牌",prop:"goodsBrandSelect"}},[a("el-select",{staticClass:"w-900",attrs:{placeholder:"请选择","value-key":"brandId"},model:{value:e.goodsForm.goodsBrandSelect,callback:function(t){e.$set(e.goodsForm,"goodsBrandSelect",t)},expression:"goodsForm.goodsBrandSelect"}},e._l(e.goodsForm.goodsBrand,function(e,t){return a("el-option",{key:t,attrs:{label:e.brandName,value:e.brandId}})}))],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.selectCateData.length>0,expression:"selectCateData.length > 0"}],staticStyle:{display:"inline-block"},attrs:{label:"商品属性",required:""}}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:this.selectCateData.length>0,expression:"this.selectCateData.length > 0"}],staticClass:"goods-nature",staticStyle:{"margin-bottom":"22px"}},[e._l(e.goodsForm.goodsPropertyData,function(t,s){return a("div",{key:s,staticStyle:{display:"inline-block"}},[t.bizRequire?a("el-form-item",{key:t.propertyId,staticClass:"goods-nature-item",attrs:{"label-width":"80px",prop:"goodsPropertyData."+s+".mallPropValues",label:t.propertyName,rules:[{required:!0,message:"请输入"+t.propertyName,trigger:"TYP_MULTI"===t.propertyType||"TYP_CHECK"===t.propertyType||"TYP_SINGLE"===t.propertyType?"change":"blur"}]}},["TYP_TEXT"===t.propertyType||"TYP_NUM"===t.propertyType||"TYP_REAL_NUM"===t.propertyType?a("el-input",{staticClass:"w-260",attrs:{type:"text"},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}}):e._e(),e._v(" "),"TYP_SINGLE"===t.propertyType?a("el-select",{staticClass:"w-260",attrs:{placeholder:"请选择","value-key":"valueId",filterable:"",clearable:""},on:{change:function(a){e.changeProperty(t,s)}},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}},e._l(t.children,function(e,t){return a("el-option",{key:t,attrs:{label:e.valueName,value:e}})})):e._e(),e._v(" "),"TYP_CHECK"===t.propertyType?a("el-select",{staticClass:"w-260",attrs:{placeholder:"请选择",multiple:"","value-key":"valueId",filterable:""},on:{change:function(a){e.changeProperty(t,s)}},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}},e._l(t.children,function(e,t){return a("el-option",{key:t,attrs:{label:e.valueName,value:e}})})):e._e(),e._v(" "),"TYP_MULTI"===t.propertyType?a("treeselect",{staticClass:"w-260 tree-select",attrs:{multiple:!0,options:t.children,placeholder:"请选择"},on:{input:function(a){e.changeProperty(t,s)}},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}}):e._e(),e._v(" "),"TYP_TIME"===t.propertyType?a("el-date-picker",{staticClass:"w-260",attrs:{type:"datetime",placeholder:"选择日期时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}}):e._e(),e._v(" "),"TYP_CURRENCY"===t.propertyType?a("div",{staticStyle:{display:"inline-block"}},[a("el-input",{staticClass:"w-220",attrs:{type:"text"},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}}),e._v(" "),a("span",{staticClass:"property-unit"},[e._v(e._s(t.units))])],1):e._e(),e._v(" "),"TYP_PERCENT"===t.propertyType?a("div",{staticStyle:{display:"inline-block"}},[a("el-input",{staticClass:"w-220",attrs:{type:"text"},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}}),e._v(" "),a("span",{staticClass:"property-unit"},[e._v("%")])],1):e._e(),e._v(" "),a("i",{staticClass:"el-icon-delete",class:t.bizCommon?"common-property":"",on:{click:function(a){e.deleteProperty(t,s)}}})],1):a("el-form-item",{key:t.propertyId,staticClass:"goods-nature-item",attrs:{"label-width":"80px",prop:t.propertyName,label:t.propertyName}},["TYP_TEXT"===t.propertyType||"TYP_NUM"===t.propertyType||"TYP_REAL_NUM"===t.propertyType?a("el-input",{staticClass:"w-260",attrs:{type:"text"},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}}):e._e(),e._v(" "),"TYP_SINGLE"===t.propertyType?a("el-select",{staticClass:"w-260",attrs:{placeholder:"请选择","value-key":"valueId",filterable:"",clearable:""},on:{change:function(a){e.changeProperty(t,s)}},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}},e._l(t.children,function(e,t){return a("el-option",{key:t,attrs:{label:e.valueName,value:e}})})):e._e(),e._v(" "),"TYP_CHECK"===t.propertyType?a("el-select",{staticClass:"w-260",attrs:{placeholder:"请选择",multiple:"","value-key":"valueId",filterable:""},on:{change:function(a){e.changeProperty(t,s)}},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}},e._l(t.children,function(e,t){return a("el-option",{key:t,attrs:{label:e.valueName,value:e}})})):e._e(),e._v(" "),"TYP_MULTI"===t.propertyType?a("treeselect",{staticClass:"w-260 tree-select",attrs:{multiple:!0,options:t.children,placeholder:"请选择"},on:{input:function(a){e.changeProperty(t,s)}},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}}):e._e(),e._v(" "),"TYP_TIME"===t.propertyType?a("el-date-picker",{staticClass:"w-260",attrs:{type:"datetime",placeholder:"选择日期时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}}):e._e(),e._v(" "),"TYP_CURRENCY"===t.propertyType?a("div",{staticStyle:{display:"inline-block"}},[a("el-input",{staticClass:"w-220",attrs:{type:"text"},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}}),e._v(" "),a("span",{staticClass:"property-unit"},[e._v(e._s(t.units))])],1):e._e(),e._v(" "),"TYP_PERCENT"===t.propertyType?a("div",{staticStyle:{display:"inline-block"}},[a("el-input",{staticClass:"w-220",attrs:{type:"text"},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}}),e._v(" "),a("span",{staticClass:"property-unit"},[e._v("%")])],1):e._e(),e._v(" "),a("i",{staticClass:"el-icon-delete",class:t.bizCommon?"common-property":"",on:{click:function(a){e.deleteProperty(t,s)}}})],1)],1)}),e._v(" "),a("div",{staticClass:"add-property"},[a("el-button",{attrs:{type:"primary"},on:{click:e.addProperty}},[e._v("添加属性")])],1)],2),e._v(" "),a("el-form-item",{staticStyle:{width:"856px"},attrs:{label:"商品主图"}},[a("div",{staticClass:"upload-list-box"},[a("div",{staticStyle:{display:"inline-block","vertical-align":"top","margin-right":"5px"}},[e._l(e.dialogImageUrl,function(t,s){return a("div",{key:s,staticClass:"img-box"},[a("img",{attrs:{width:"100%",src:t.imageUrl,alt:""}}),e._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:0!==s,expression:"index !== 0"}],staticClass:"el-icon-arrow-left",on:{click:function(t){e.moveLeft(s)}}}),e._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:s+1!==e.dialogImageUrl.length,expression:"index + 1 !== dialogImageUrl.length"}],staticClass:"el-icon-arrow-right",on:{click:function(t){e.moveRight(s)}}}),e._v(" "),a("i",{staticClass:"el-icon-delete",on:{click:function(t){e.deteletDialogImageUrl(s)}}}),e._v(" "),a("i",{staticClass:"el-icon-zoom-in",on:{click:function(t){e.enlargeDialogImageUrl(s)}}}),e._v(" "),a("div",{staticClass:"dialog-img"})])}),e._v(" "),a("el-upload",{directives:[{name:"show",rawName:"v-show",value:e.uploadStatus,expression:"uploadStatus"}],staticStyle:{display:"inline-block","vertical-align":"top"},attrs:{action:e.uploadAction,headers:e.headersUpload,"list-type":"picture-card","on-preview":e.handlePictureCardPreview,"before-upload":e.beforeUpload,"on-success":e.uploadSuccess,"with-credentials":"","show-file-list":!1}},[a("i",{staticClass:"el-icon-plus"})])],2),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisibleImg},on:{"update:visible":function(t){e.dialogVisibleImg=t}}},[a("img",{attrs:{width:"100%",src:e.dialogEnlargeImageUrl,alt:""}})])],1),e._v(" "),a("span",{staticStyle:{"font-size":"12px",color:"rgb(144, 147, 153)"},attrs:{"data-v-75235512":""}},[e._v("图片规格宽度大于等于700px，高度不大于宽度的2倍，单张图片大小不超过 2 MB，至少上传1张，最多可上传 10 张。")])]),e._v(" "),a("el-form-item",{attrs:{label:"图文详情"}},[a("div",{staticClass:"tinymce-wrap"},[a("tinymce-edit",{ref:"tinymceWrap",attrs:{bodyHtml:e.goodsForm.imgTextEdit,projectName:e.projectName}})],1)]),e._v(" "),a("el-form-item",{staticClass:"tree-goods-cate",attrs:{label:"商品分类",prop:"goodsClassifySelect"}},[a("treeselect",{staticClass:"w-320",attrs:{multiple:!0,options:e.goodsForm.goodsClassifyData,"disable-branch-nodes":!0,placeholder:"所有分类"},model:{value:e.goodsForm.goodsClassifySelect,callback:function(t){e.$set(e.goodsForm,"goodsClassifySelect",t)},expression:"goodsForm.goodsClassifySelect"}})],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.goodsForm.categoryIds.length>0,expression:"goodsForm.categoryIds.length > 0"}],staticClass:"form-group"},[a("p",{staticClass:"title"},[e._v("规格信息")]),e._v(" "),a("el-button",{staticClass:"add-size",staticStyle:{margin:"0 0 20px 32px"},attrs:{type:"primary",size:"medium"},on:{click:e.handleAddStandard}},[e._v("添加规格")]),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.goodsForm.tableStandardList.length>0,expression:"goodsForm.tableStandardList.length > 0"}],attrs:{label:"商品规格"}},e._l(e.goodsForm.tableStandardList,function(t,s){return a("table",{key:s,staticClass:"border-table w-900"},[a("thead",[a("tr",[a("th",{staticStyle:{width:"300px"}},[e._v(e._s(t.standardName))]),e._v(" "),a("th",{staticStyle:{width:"300px"}},[e._v("备注")]),e._v(" "),a("th",{staticStyle:{width:"200px"}},[a("a",{staticClass:"border-table-operate",attrs:{href:"JavaScript:void(0)"},on:{click:function(a){e.handleAddStandardValue(t,s)}}},[e._v("添加规格值")]),e._v(" "),a("a",{attrs:{href:"JavaScript:void(0)"},on:{click:function(a){e.deleteStandard(t,s)}}},[e._v("删除规格")])])])]),e._v(" "),a("tbody",e._l(t.standardValues,function(i,r){return a("tr",{key:r},[a("td",[e._v(e._s(i.valueName))]),e._v(" "),a("td",[a("el-input",{attrs:{size:"small",placeholder:"请输入内容"},on:{input:function(t){e.remarkLimit(i)}},model:{value:i.remark,callback:function(t){e.$set(i,"remark",t)},expression:"valueItem.remark"}})],1),e._v(" "),a("td",[a("a",{attrs:{href:"JavaScript:void(0)"},on:{click:function(a){e.deleteStandardValue(s,r,t,i)}}},[e._v("删除")])])])}))])})),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.table1ShowStatus,expression:"table1ShowStatus"}],attrs:{label:"规格图片"}},[a("span",{staticStyle:{"font-size":"12px",color:"#909399"}},[e._v("图片规格≥200*200，高度不大于宽度的2倍 ，单张图片大小不超过 2 MB")]),e._v(" "),a("div",{staticStyle:{width:"900px","overflow-x":"auto"}},[a("table",{staticClass:"border-table w-900"},[a("thead",[a("tr",[e._l(e.goodsForm.standardKeyHeaderList,function(t,s){return a("th",{key:s},[e._v("\n                      "+e._s(t.standardName)+"\n                    ")])}),e._v(" "),a("th",[e._v("图片")])],2)]),e._v(" "),a("tbody",e._l(e.goodsForm.combineKeyValueList,function(t,s){return a("tr",{key:s},e._l(t,function(s,i){return a("td",{key:i},[t.length-i<2?a("div",{staticClass:"table-upload"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.uploadAction,headers:e.headersUpload,"show-file-list":!1,"on-success":function(t,a,i){return e.tableUploadSuccess(t,a,i,s)},"before-upload":e.tableBeforeUpload,"with-credentials":""}},[s.valueName?a("img",{staticClass:"avatar",attrs:{src:s.valueName}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1):a("div",[e._v(e._s(s.valueName))])])}))}))])])]),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.goodsForm.tableStandardList.length>0,expression:"goodsForm.tableStandardList.length > 0"}],attrs:{label:"sku信息"}},[a("div",{staticClass:"w-900",staticStyle:{position:"relative"}},[a("div",{staticClass:"sku-top"},[a("el-input",{staticClass:"sku-input",attrs:{placeholder:"价格",size:"small",type:"tel"},on:{blur:function(t){e.priceLimit(e.batchPrice)}},model:{value:e.batchPrice,callback:function(t){e.batchPrice=t},expression:"batchPrice"}}),e._v(" "),a("el-input",{staticClass:"sku-input",attrs:{placeholder:"库存",size:"small"},on:{input:function(t){e.stockLimit(e.batchStock)}},model:{value:e.batchStock,callback:function(t){e.batchStock=t},expression:"batchStock"}}),e._v(" "),a("el-input",{staticClass:"sku-input",attrs:{placeholder:"SKU编码",size:"small"},on:{input:function(t){e.SKULimit(e.batchSku)}},model:{value:e.batchSku,callback:function(t){e.batchSku=t},expression:"batchSku"}}),e._v(" "),a("el-input",{staticClass:"sku-input",attrs:{placeholder:"商品条形码",size:"small"},on:{input:function(t){e.barLimit(e.batchBar)}},model:{value:e.batchBar,callback:function(t){e.batchBar=t},expression:"batchBar"}}),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.batchSetSku}},[e._v("批量填充")])],1),e._v(" "),a("div",{staticStyle:{width:"900px","overflow-x":"auto"}},[a("table",{staticClass:"border-table w-900"},[a("thead",[a("tr",[e._l(e.goodsForm.standardAllHeaderList,function(t,s){return a("th",{key:s,staticStyle:{width:"120px"}},[e._v("\n                        "+e._s(t.standardName)+"\n                      ")])}),e._v(" "),a("th",{staticStyle:{width:"80px"}},[e._v("价格")]),e._v(" "),a("th",{staticStyle:{width:"80px"}},[e._v("库存")]),e._v(" "),a("th",{staticStyle:{width:"200px"}},[e._v("SKU编码")]),e._v(" "),a("th",{staticStyle:{width:"120px"}},[e._v("商品条形码")])],2)]),e._v(" "),a("tbody",e._l(e.goodsForm.combineKeyAllValueList,function(t,s){return a("tr",{directives:[{name:"show",rawName:"v-show",value:e.table2ShowStatus,expression:"table2ShowStatus"}],key:s},e._l(t,function(i,r){return a("td",{key:r,staticStyle:{width:"120px"}},[t.length-r<5?a("span",[a("el-input",{attrs:{size:"small"},on:{input:function(a){e.sliceLimit(t,i,r)},blur:function(a){e.skuInput(t,i,s,r)}},model:{value:i.valueName,callback:function(t){e.$set(i,"valueName",t)},expression:"item2.valueName"}})],1):a("span",[e._v(e._s(i.valueName?i.valueName:""))])])}))}))])])])]),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.goodsForm.tableStandardList.length>0,expression:"goodsForm.tableStandardList.length > 0"}],attrs:{label:"spu信息"}},[a("div",{staticStyle:{width:"900px","overflow-x":"auto"}},[a("table",{staticClass:"border-table w-900"},[a("thead",[a("tr",[a("th",[e._v("商品货号")]),e._v(" "),a("th",[e._v("价格")]),e._v(" "),a("th",[e._v("库存")]),e._v(" "),a("th",[e._v("商品条形码")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[a("el-form-item",{attrs:{prop:"proCode"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入内容"},on:{input:function(t){e.proCodeLimit(e.goodsForm.proCode)}},model:{value:e.goodsForm.proCode,callback:function(t){e.$set(e.goodsForm,"proCode",t)},expression:"goodsForm.proCode"}})],1)],1),e._v(" "),a("td",[a("el-form-item",{attrs:{prop:"mallProSpuPrice"}},[a("el-input",{attrs:{size:"small",placeholder:"请输入内容"},model:{value:e.goodsForm.mallProSpuPrice,callback:function(t){e.$set(e.goodsForm,"mallProSpuPrice",t)},expression:"goodsForm.mallProSpuPrice"}})],1)],1),e._v(" "),a("td",[a("el-input",{attrs:{size:"small",placeholder:"",disabled:""},model:{value:e.goodsForm.stock,callback:function(t){e.$set(e.goodsForm,"stock",t)},expression:"goodsForm.stock"}})],1),e._v(" "),a("td",[a("el-input",{attrs:{size:"small",placeholder:"请输入内容"},on:{input:function(t){e.proCodeQueryLimit(e.goodsForm.proCodeQuery)}},model:{value:e.goodsForm.proCodeQuery,callback:function(t){e.$set(e.goodsForm,"proCodeQuery",t)},expression:"goodsForm.proCodeQuery"}})],1)])])])])])],1),e._v(" "),a("div",{staticClass:"form-group"},[a("p",{staticClass:"title"},[e._v("销售信息")]),e._v(" "),a("el-form-item",{attrs:{label:"运费模板",prop:"templateSelect"}},[a("el-select",{staticClass:"w-320",attrs:{placeholder:"请选择"},model:{value:e.goodsForm.templateSelect,callback:function(t){e.$set(e.goodsForm,"templateSelect",t)},expression:"goodsForm.templateSelect"}},e._l(e.goodsForm.templateList,function(e,t){return a("el-option",{key:t,attrs:{label:e.templateName,value:e.freightTemplateId}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"上架方式"}},[[a("el-radio",{attrs:{label:"1"},model:{value:e.goodsForm.putaway,callback:function(t){e.$set(e.goodsForm,"putaway",t)},expression:"goodsForm.putaway"}},[e._v("立即上架")]),e._v(" "),a("el-radio",{attrs:{label:"2"},model:{value:e.goodsForm.putaway,callback:function(t){e.$set(e.goodsForm,"putaway",t)},expression:"goodsForm.putaway"}},[e._v("定时上架")]),e._v(" "),a("el-radio",{attrs:{label:"3"},model:{value:e.goodsForm.putaway,callback:function(t){e.$set(e.goodsForm,"putaway",t)},expression:"goodsForm.putaway"}},[e._v("放入仓库")])]],2),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"2"===e.goodsForm.putaway,expression:"goodsForm.putaway === '2'"}],attrs:{label:"上架时间"}},[a("el-date-picker",{staticClass:"w-320",attrs:{type:"datetime",placeholder:"选择日期时间",pickerOptions:e.pickerOptions},model:{value:e.goodsForm.putawayTime,callback:function(t){e.$set(e.goodsForm,"putawayTime",t)},expression:"goodsForm.putawayTime"}})],1),e._v(" "),a("div",{staticClass:"confim-btn",style:{width:e.fixedWidth+"px"}},[a("el-form-item",{staticClass:"fix-btn"},[a("el-button",{attrs:{type:"primary",size:"small",loading:e.submitLoading},on:{click:function(t){e.submitGoodsForm("goodsForm")}}},[e._v("保存")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.cancelGoodsForm}},[e._v("返回")])],1)],1)],1)])],1)]),e._v(" "),e.propertyData.dialogVisible?a("addProperty",{attrs:{propertyData:e.propertyData},on:{getPropertyList:e.getPropertyList}}):e._e(),e._v(" "),e.standardData.dialogVisible?a("addStandard",{attrs:{standardData:e.standardData},on:{getStandardSelectList:e.getStandardSelectList}}):e._e(),e._v(" "),e.standardGroupData.dialogVisible?a("addStandardValue",{attrs:{standardGroupData:e.standardGroupData},on:{getStandardSelectValueList:e.getStandardSelectValueList}}):e._e()],1)},staticRenderFns:[]};var ze=a("VU/8")(Ge,Be,!1,function(e){a("yHTX"),a("oJml")},"data-v-07653a1e",null).exports,je={props:{importInfo:{type:Object}},data:function(){return{}},methods:{},components:{}},He={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"导入失败原因",visible:e.importInfo.dialogVisible,width:"420px"},on:{"update:visible":function(t){e.$set(e.importInfo,"dialogVisible",t)}}},[a("div",{staticClass:"info-content",staticStyle:{height:"400px","overflow-y":"auto"}},e._l(e.importInfo.infoList,function(t,s){return a("div",{key:s,staticClass:"list-content"},[a("p",{staticClass:"reason-info"},[e._v(e._s(t.reason))]),e._v(" "),a("span",{staticClass:"sku-info"},[e._v(e._s(t.data.join(",")))])])}))])},staticRenderFns:[]};var Ye=a("VU/8")(je,He,!1,function(e){a("VeOt")},"data-v-8af1f04a",null).exports,Ze={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,classifyList:[],modalForm:{mainName:"",childName:[]},formLen:{mainNameLen:0,childNameLen:0},modalRules:{mainName:[{required:!0,message:"请输入主分类名称",trigger:"blur"}]},modalChildForm:{childName:""},childLen:0,mainNameId:"",modalChildRules:{childName:[{required:!0,message:"请输入子分类名称",trigger:"blur"}]},dialogFormVisible:!1,dialogFormVisible2:!1,inputVisible:!1,inputValue:"",loading:!0,dialogVisible3:!1,dialogForm:{},showList:!1,uploadData:{tagId:""},action:window.location.origin+"/api-mall/import-product-tag-relation?requestProject=mall",headersUpload:{sign:""},dialogLoading:!1,importMess:!1,failNum:0,successNum:0,importInfo:{dialogVisible:!1,infoList:[]},modalData:{show:!1,imgUrl:"",loading:!1}}},created:function(){this.getList()},computed:{},methods:{mainPageNameLimit:function(e,t){this.$nextTick(function(){t.tagName=C.getInputVal(e,8)})},childNameLimit:function(e){var t=this;this.$nextTick(function(){t.modalForm.childrenName=C.getInputVal(e,8),t.childLen=C.getZhLen(t.modalForm.childrenName)})},mainNameLimit:function(e){var t=this;this.$nextTick(function(){t.modalForm.mainName=C.getInputVal(e,8),t.formLen.mainNameLen=C.getZhLen(t.modalForm.mainName)})},childrenNameLimit:function(e){var t=this;this.$nextTick(function(){t.inputValue=C.getInputVal(e,8),t.formLen.childNameLen=C.getZhLen(t.inputValue)})},getList:function(e){var t=this;A.get("/api-mall/tag-list",{params:{where:"categoryManage"}}).then(function(a){if(0===a.data.errorCode){var s=!0,i=!1,r=void 0;try{for(var o,l=b()(a.data.result);!(s=(o=l.next()).done);s=!0){var n=o.value;n.showStatus=!1,n.editStatus=!0,n.childTagList||(n.childTagList=[]);var d=!0,c=!1,u=void 0;try{for(var m,p=b()(n.childTagList);!(d=(m=p.next()).done);d=!0){m.value.childrenEditStaus=!0}}catch(e){c=!0,u=e}finally{try{!d&&p.return&&p.return()}finally{if(c)throw u}}}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}a.data.result?t.classifyList=a.data.result:t.classifyList=[],void 0!==e&&(t.classifyList[e].showStatus=!0),t.loading=!1}else t.$message.error(a.data.message),t.loading=!1})},explanNode:function(e,t){var a=!0,s=!1,i=void 0;try{for(var r,o=b()(this.classifyList);!(a=(r=o.next()).done);a=!0){r.value.showStatus=!1}}catch(e){s=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw i}}this.classifyList[e].showStatus=!t},editParentName:function(e){e.editStatus=!1},submitParentName:function(e){var t=this,a={tagId:e.mallProTagId,tagName:e.tagName};A.post("/api-mall/tag-edit",_.a.stringify(a)).then(function(a){0===a.data.errorCode?(t.$message.success("更新成功"),e.editStatus=!0,t.getList()):t.$message.success(a.data.errorCode)})},cancelSubmitName:function(e){e.editStatus=!0,this.getList()},editChildrentName:function(e){e.childrenEditStaus=!1},submitChildrenName:function(e,t){var a=this,s={tagId:e.mallProTagId,tagName:e.tagName};A.post("/api-mall/tag-edit",_.a.stringify(s)).then(function(s){0===s.data.errorCode?(a.$message.success("更新成功"),e.childrenEditStaus=!0,a.getList(t)):a.$message.success(s.data.errorCode)})},cancelChildrenName:function(e,t){e.childrenEditStaus=!0,this.getList(t)},getSort:function(e,t,a,s){var i=this,r={sortType:e,tagId:t,parentId:a};A.post("/api-mall/tag-sort-operator",_.a.stringify(r)).then(function(e){0===e.data.errorCode?(i.$message.success(e.data.message),i.getList(s)):i.$message.success(e.data.errorCode)})},adjustShow:function(e){var t=this,a={tagId:e.mallProTagId,display:e.display};e.display=!e.display,this.$confirm(e.display?"确认不显示?":"确认显示?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){A.post("/api-mall/tag-update-display",_.a.stringify(a)).then(function(e){0===e.data.errorCode?(t.$message.success("更新成功"),t.getList()):t.$message.error(e.data.message)})})},deleteCate:function(e,t){var a=this,s={tagId:e.mallProTagId};A.post("/api-mall/tag-delete",_.a.stringify(s)).then(function(e){0===e.data.errorCode?(a.$message.success(e.data.message),a.getList(t)):a.$message.success(e.data.errorCode)})},getLink:function(e){var t=this;this.modalData.loading=!0;var a={tagId:e.mallProTagId,tagName:e.tagName};this.modalData.show=!0,A.get("/api-mall/tag-qrCode",{params:a}).then(function(e){0===e.data.errorCode?(t.modalData.show=!0,t.modalData.pageUrl=e.data.result.page,t.modalData.imgUrl=e.data.result.url,t.modalData.loading=!1):t.$message.error(e.data.message)})},handleClose:function(e){this.modalForm.childName.splice(this.modalForm.childName.indexOf(e),1)},showInput:function(){var e=this;this.inputVisible=!0,this.$nextTick(function(t){e.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm:function(){var e=this.inputValue;e&&this.modalForm.childName.push(e),this.inputVisible=!1,this.inputValue="",this.formLen.childNameLen=0},newName:function(){this.dialogFormVisible=!0},submitName:function(e){var t=this;this.$refs[e].validate(function(a){if(!a)return!1;var s=t.modalForm.childName.join(","),i={tagName:t.modalForm.mainName,parentId:0,childTagNames:s};A.get("/api-mall/tag-add",{params:i}).then(function(a){0===a.data.errorCode?(t.$message.success("新建成功"),t.dialogFormVisible=!1,t.$refs[e].resetFields(),t.formLen.mainNameLen=0,t.formLen.childNameLen=0,t.getList()):t.$message.error(a.data.errorCode)})})},cancelName:function(e){this.dialogFormVisible=!1,this.$refs[e].resetFields()},addList:function(e){this.dialogFormVisible2=!0,this.mainNameId=e.mallProTagId},sumitChildName:function(e){var t=this;this.$refs[e].validate(function(a){if(!a)return!1;var s={tagName:t.modalForm.childrenName,parentId:t.mainNameId};A.get("/api-mall/tag-child-add",{params:s}).then(function(a){0===a.data.errorCode?(t.$message.success("新建成功"),t.dialogFormVisible2=!1,t.childLen=0,t.$refs[e].resetFields(),t.getList(),t.modalForm.childrenName=""):t.$message.error(a.data.errorCode)})})},cancelChildName:function(e){this.dialogFormVisible2=!1,this.$refs[e].resetFields()},editNum:function(e){this.importMess=!1,this.dialogVisible3=!0,this.uploadData.tagId=e.mallProTagId},downloadFile:function(){window.open("static/商品分类关联导入模板.xlsx")},uploadFileBefore:function(e){return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!==e.type&&"application/vnd.ms-excel"!==e.type?(this.$message.error("文件格式错误，请导入.xlsx .csv格式的文件"),!1):e.size>5242880?(this.$message.error("请上传小于5MB的文件"),!1):(localStorage.getItem("sign")?this.headersUpload.sign=localStorage.getItem("sign"):this.headersUpload.sign="",this.dialogLoading=!0,void(this.fileName=e.name))},uploadFile:function(e,t){this.dialogLoading=!0,0===e.errorCode?(this.dialogLoading=!1,this.$message.success("导入成功"),this.importMess=!0,this.failNum=e.result.failNum,this.successNum=e.result.successNum,e.result.failDetail?this.importInfo.infoList=e.result.failDetail:this.importInfo.infoList=[],this.getList()):(this.dialogLoading=!1,this.$message.error(e.message))},showInfo:function(){this.importInfo.dialogVisible=!0}},components:{importInfo:Ye,eqCodeDialog:R}},Ke={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("商品管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("商品分类")])],1),e._v(" "),e._m(0)],1),e._v(" "),a("div",{staticClass:"mall-section"},[a("div",{staticClass:"goodsClassify-content"},[a("div",{staticClass:"operate-top"},[a("div",{staticClass:"fr"},[a("el-button",{attrs:{type:"primary"},on:{click:e.newName}},[e._v("新建分组")])],1)]),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("table",{staticClass:"brand-table"},[a("thead",[a("tr",[a("th",[e._v("分类名称")]),e._v(" "),a("th",[e._v("关联商品数")]),e._v(" "),a("th",[a("span",[e._v("是否显示")]),e._v(" "),a("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:"设置此分类是否在前端小程序显示或隐藏。"}},[a("i",{staticClass:"iconfont icon-xinxixianshi",attrs:{slot:"reference"},slot:"reference"})])],1),e._v(" "),a("th",[e._v("排序")]),e._v(" "),a("th",[e._v("操作")])])]),e._v(" "),e._l(e.classifyList,function(t,s){return a("tbody",{key:s,staticStyle:{width:"100%"}},[a("tr",{staticClass:"parent-node",class:0===s?"first":""},[a("td",{staticStyle:{width:"300px"}},[a("div",{staticClass:"parent-fold"},[a("i",{class:t.showStatus?"el-icon-caret-bottom":"el-icon-caret-right",on:{click:function(a){e.explanNode(s,t.showStatus)}}}),e._v(" "),t.editStatus?a("div",{staticClass:"text-box"},[a("span",{staticClass:"tag-name"},[e._v(e._s(t.tagName))]),e._v(" "),a("i",{staticClass:"el-icon-edit edit-name",on:{click:function(a){e.editParentName(t)}}})]):e._e(),e._v(" "),t.editStatus?e._e():a("div",{staticClass:"edit-box"},[a("el-input",{staticClass:"w-180",attrs:{placeholder:"",size:"small"},on:{input:function(a){return e.mainPageNameLimit(a,t)}},model:{value:t.tagName,callback:function(a){e.$set(t,"tagName",a)},expression:"item.tagName"}}),e._v(" "),a("span",{staticClass:"operate-span",on:{click:function(a){e.submitParentName(t)}}},[e._v("确定")]),e._v(" "),a("span",{staticClass:"operate-span",on:{click:e.cancelSubmitName}},[e._v("取消")])],1)])]),e._v(" "),a("td",{staticClass:"edit-num"},[e._v(e._s(t.tagGoodsCount)),a("i",{staticClass:"el-icon-edit",on:{click:function(a){e.editNum(t)}}})]),e._v(" "),a("td",[a("el-switch",{on:{change:function(a){e.adjustShow(t)}},model:{value:t.display,callback:function(a){e.$set(t,"display",a)},expression:"item.display"}})],1),e._v(" "),a("td",{staticClass:"icon-sort"},[a("i",{staticClass:"el-icon-download icon-upload",on:{click:function(a){e.getSort(1,t.mallProTagId,0)}}}),e._v(" "),a("i",{staticClass:"iconfont icon-arrowdown icon-up",on:{click:function(a){e.getSort(2,t.mallProTagId,0)}}}),e._v(" "),a("i",{staticClass:"iconfont icon-arrowdown icon-down",on:{click:function(a){e.getSort(3,t.mallProTagId,0)}}}),e._v(" "),a("i",{staticClass:"el-icon-download icon-download",on:{click:function(a){e.getSort(4,t.mallProTagId,0)}}})]),e._v(" "),a("td",{staticClass:"operate"},[a("el-button",{attrs:{type:"text"},on:{click:function(a){e.getLink(t)}}},[e._v("推广")]),e._v(" "),a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:t.visible2,callback:function(a){e.$set(t,"visible2",a)},expression:"item.visible2"}},[a("p",{staticStyle:{"line-height":"1.5",padding:"10px 0px 10px 20px"}},[e._v("确定删除该分类吗？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.visible2=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.deleteCate(t)}}},[e._v("确定")])],1),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除")])],1)],1)]),e._v(" "),e._l(t.childTagList,function(i,r){return a("tr",{directives:[{name:"show",rawName:"v-show",value:t.showStatus,expression:"item.showStatus"}],key:r,staticClass:"children-node",class:0===r?"children-first":""},[a("td",[a("div",{staticClass:"children-fold"},[i.childrenEditStaus?a("div",{staticClass:"text-box"},[a("span",{staticClass:"tag-name"},[e._v(e._s(i.tagName))]),e._v(" "),a("i",{staticClass:"el-icon-edit",on:{click:function(t){e.editChildrentName(i)}}})]):e._e(),e._v(" "),i.childrenEditStaus?e._e():a("div",{staticClass:"edit-box"},[a("el-input",{staticClass:"w-180",attrs:{placeholder:"",size:"small"},on:{input:function(t){return e.mainPageNameLimit(t,i)}},model:{value:i.tagName,callback:function(t){e.$set(i,"tagName",t)},expression:"i.tagName"}}),e._v(" "),a("span",{staticClass:"operate-span",on:{click:function(t){e.submitChildrenName(i,s)}}},[e._v("确定")]),e._v(" "),a("span",{staticClass:"operate-span",on:{click:function(t){e.cancelChildrenName(i,s)}}},[e._v("取消")])],1)])]),e._v(" "),a("td",{staticClass:"edit-num"},[e._v(e._s(i.tagGoodsCount)),a("i",{staticClass:"el-icon-edit",on:{click:function(t){e.editNum(i)}}})]),e._v(" "),a("td"),e._v(" "),a("td",{staticClass:"children-sort"},[a("i",{staticClass:"iconfont icon-arrowdown icon-up",on:{click:function(a){e.getSort(2,i.mallProTagId,t.mallProTagId,s)}}}),e._v(" "),a("i",{staticClass:"iconfont icon-arrowdown icon-down",on:{click:function(a){e.getSort(3,i.mallProTagId,t.mallProTagId,s)}}})]),e._v(" "),a("td",{staticClass:"operate"},[a("el-button",{attrs:{type:"text"},on:{click:function(t){e.getLink(i)}}},[e._v("推广")]),e._v(" "),a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:i.visible2,callback:function(t){e.$set(i,"visible2",t)},expression:"i.visible2"}},[a("p",{staticStyle:{"line-height":"1.5",padding:"10px 10px 20px"}},[e._v("确定删除该分类吗？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){i.visible2=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.deleteCate(i,s)}}},[e._v("确定")])],1),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除")])],1)],1)])}),e._v(" "),a("tr",{directives:[{name:"show",rawName:"v-show",value:t.showStatus,expression:"item.showStatus"}],staticClass:"children-node"},[a("td",{staticClass:"add-edit"},[a("i",{staticClass:"el-icon-circle-plus-outline",on:{click:function(a){e.addList(t)}}})]),e._v(" "),a("td"),e._v(" "),a("td"),e._v(" "),a("td"),e._v(" "),a("td")])],2)})],2),e._v(" "),[a("div",{directives:[{name:"show",rawName:"v-show",value:e.classifyList.length<=0,expression:"classifyList.length <= 0"}],staticClass:"no-data-wrap"},[e._m(1),e._v(" "),a("p",[e._v("暂无数据")])])]],2)])])]),e._v(" "),a("el-dialog",{attrs:{title:"添加主分类",visible:e.dialogFormVisible,width:"450px"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:function(t){e.cancelName("modalForm")}}},[a("el-form",{ref:"modalForm",staticStyle:{width:"430px"},attrs:{model:e.modalForm,rules:e.modalRules}},[a("el-form-item",{attrs:{label:"一级分类","label-width":"80px",prop:"mainName"}},[a("el-input",{staticStyle:{width:"300px"},on:{input:function(t){return e.mainNameLimit(t)}},model:{value:e.modalForm.mainName,callback:function(t){e.$set(e.modalForm,"mainName",t)},expression:"modalForm.mainName"}},[a("span",{staticStyle:{"margin-right":"5px","font-size":"13px"},attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.formLen.mainNameLen)+"/8")])])],1),e._v(" "),a("el-form-item",{attrs:{label:"二级分类","label-width":"80px"}},[e._l(e.modalForm.childName,function(t){return a("el-tag",{key:t,attrs:{closable:"","disable-transitions":!1},on:{close:function(a){e.handleClose(t)}}},[e._v("\n          "+e._s(t)+"\n        ")])}),e._v(" "),e.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag w-180",attrs:{size:"small"},on:{blur:e.handleInputConfirm,input:function(t){return e.childrenNameLimit(t)}},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.handleInputConfirm(t):null}},model:{value:e.inputValue,callback:function(t){e.inputValue=t},expression:"inputValue"}},[a("span",{staticStyle:{"margin-right":"5px","font-size":"13px"},attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.formLen.childNameLen)+"/8")])]):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small",icon:"el-icon-plus"},on:{click:e.showInput}},[e._v("添加")])],2)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.cancelName("modalForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitName("modalForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"添加子分类",visible:e.dialogFormVisible2,width:"450px"},on:{"update:visible":function(t){e.dialogFormVisible2=t},close:function(t){e.cancelChildName("modalChildForm")}}},[a("el-form",{ref:"modalChildForm",staticStyle:{width:"430px"},attrs:{model:e.modalChildForm,rules:e.modalChildRules}},[a("el-form-item",{attrs:{label:"子分类","label-width":"80px",prop:"childrenName"}},[a("el-input",{staticStyle:{width:"300px"},on:{input:function(t){return e.childNameLimit(t)}},model:{value:e.modalForm.childrenName,callback:function(t){e.$set(e.modalForm,"childrenName",t)},expression:"modalForm.childrenName"}},[a("span",{staticStyle:{"margin-left":"5px"},attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.childLen)+"/8")])])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.cancelChildName("modalChildForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.sumitChildName("modalChildForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"批量添加关联商品",visible:e.dialogVisible3,width:"620px"},on:{"update:visible":function(t){e.dialogVisible3=t}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogLoading,expression:"dialogLoading"}],attrs:{model:e.dialogForm,"label-position":"right","label-width":"80px"}},[a("el-form-item",{attrs:{label:"选择文件",required:""}},[a("div",{staticClass:"upload-btn"},[a("div",[a("el-upload",{staticClass:"upload-ele",attrs:{action:e.action,headers:e.headersUpload,"before-upload":e.uploadFileBefore,"on-success":e.uploadFile,"with-credentials":"","show-file-list":e.showList,data:e.uploadData}},[a("el-button",{attrs:{size:"small"}},[a("i",{staticClass:"el-icon-upload2",staticStyle:{"margin-right":"5px"}}),e._v("点击上传")])],1)],1)]),e._v(" "),a("el-button",{attrs:{type:"info",plain:""},on:{click:e.downloadFile}},[e._v("下载EXCEL模板")]),e._v(" "),a("p",{directives:[{name:"show",rawName:"v-show",value:e.importMess,expression:"importMess"}],staticClass:"import-info"},[e._v("\n          本次共导入 "),a("span",{staticStyle:{"font-weight":"600"}},[e._v(e._s(e.successNum+e.failNum))]),e._v(" 个商品，其中成功 "),a("span",{staticStyle:{"font-weight":"600"}},[e._v(e._s(e.successNum))]),e._v(" 个，失败 "),a("span",{staticStyle:{color:"#f5222d"}},[e._v(e._s(e.failNum))]),e._v(" 个"),a("a",{directives:[{name:"show",rawName:"v-show",value:e.failNum>0,expression:"failNum > 0"}],staticStyle:{"margin-left":"10px"},attrs:{href:"javaScript:void(0)"},on:{click:e.showInfo}},[e._v("查看失败原因")])])],1),e._v(" "),a("el-form-item",{attrs:{label:"导入规则"}},[a("div",{staticClass:"line"}),e._v(" "),a("div",{staticClass:"upload-rules"},[a("p",[e._v("1. 每个文件最多300个商品")]),e._v(" "),a("p",[e._v("2. 只需要填写关联商品的SPU")]),e._v(" "),a("p",[e._v("3. 仅支持.xlsx .xls文件的导入（建议直接下载模板，在模板的基础上进行数据的填充）")]),e._v(" "),a("p",[e._v("4. 导入后，请在当前页面等待，系统将很快为您反馈导入结果！！！")])])])],1)],1),e._v(" "),a("importInfo",{attrs:{importInfo:e.importInfo}}),e._v(" "),a("eqCodeDialog",{attrs:{modalData:e.modalData}})],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("商品分类")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"no-data-icon"},[t("img",{attrs:{src:a("8Td+")}})])}]};var Je=a("VU/8")(Ze,Ke,!1,function(e){a("VHaN"),a("k4TW")},"data-v-7182ec8c",null).exports,We={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"container"},[t("vue-gic-header",{attrs:{projectName:this.projectName,collapseFlag:this.collapseFlag},on:{collapseTag:this.collapseTag,toRouterView:this.toRouterView}}),this._v(" "),t("div",{staticClass:"mall-content-container"},[t("div",{staticClass:"goods-manege-content"},[t("router-view")],1)])],1)},staticRenderFns:[]};var qe=a("VU/8")({data:function(){return{collapseFlag:!1,menuRouter:[],leftMenuRouter:[],leftModulesName:"微商城",projectName:"mall"}},computed:{},methods:{toRouterView:function(e){this.$router.push({path:e.path})},collapseTag:function(e){this.collapseFlag=e,this.collapseFlag?this.widthData="64px":this.widthData="200px"}},components:{}},We,!1,function(e){a("Xykz")},"data-v-0e343494",null).exports,Qe={props:{tableData:{type:Array,default:function(){return[]}},parentId:{type:String,default:""}},data:function(){return{getTime:C.getTime,getSeconds:C.getSeconds,multipleSelection:[],imgUrl:"",uploadData:{},action:window.location.origin+"/api-mall/gic-cloud-image-replace",dialogFormVisible:!1,imgDetail:{imgUrl:"",name:"",updateTime:"",size:"",width:"",length:"",imgType:"",id:""},currentIndex:-1,uploadId:""}},computed:{},methods:{handleSelectionChange:function(e){this.multipleSelection=e;var t,a=[],s=[],i=!0,r=!1,o=void 0;try{for(var l,n=b()(this.multipleSelection);!(i=(l=n.next()).done);i=!0){var d=l.value;a.push(d.id),"folder"===d.type&&s.push(d.name)}}catch(e){r=!0,o=e}finally{try{!i&&n.return&&n.return()}finally{if(r)throw o}}t=a.join(","),this.$emit("beforeDelete",t),this.$emit("getMatchName",s),this.$emit("moveObj",this.multipleSelection)},listDelete:function(e){this.$emit("deleteFile",e.id)},moveFile:function(e){var t=void 0;"folder"===e.type?t=2:"image"===e.type&&(t=1),this.$emit("moveFile",e.id,t)},reuploadImg:function(e,t){var a=this,s=new FormData;s.append("file",e.target.files[0]),s.append("parentId",this.parentId),s.append("targetId",this.uploadId);var i=e.target.files[0],r=new FileReader;return r.onload=function(e){var t=e.target.result;(new Image).src=t},r.readAsDataURL(i),"image/jpeg"!==i.type&&"image/png"!==i.type?(e.target.value="",this.$message.error("请上传jpg，png格式的图片"),!1):i.size>5242880?(e.target.value="",this.$message.error("请上传小于5MB的图片"),!1):void A.post("/api-mall/gic-cloud-image-replace",s).then(function(t){0===t.data.errorCode?(a.$message.success("上传成功"),a.$emit("getImgList"),e.target.value=""):(e.target.value="",a.$message.error(t.data.message))})},onCopy:function(e){this.$message.success("复制成功")},onError:function(e){this.$message.error("复制失败")},openFolder:function(e){this.$emit("getDbClick",e.id)},openImgDetail:function(e,t){this.dialogFormVisible=!0,this.imgDetail=e,this.currentIndex=t},lastImg:function(){if(0===this.currentIndex)return this.$message.error("已经是当前页的第一张了"),!1;"folder"===this.tableData[this.currentIndex-1].type?(this.currentIndex--,this.$message.error("已经是当前页的第一张了")):(this.imgDetail=this.tableData[this.currentIndex-1],this.currentIndex--)},nextImg:function(){if(this.currentIndex===this.tableData.length-1)return this.$message.error("已经是当前页的最后一张了"),!1;"folder"===this.tableData[this.currentIndex+1].type?this.currentIndex++:(this.imgDetail=this.tableData[this.currentIndex+1],this.currentIndex++)},beforeUpload:function(e){this.uploadId=e}},components:{}},Xe={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),s("el-table-column",{attrs:{label:"名称",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"img-box"},["folder"===t.row.type?s("img",{attrs:{src:a("Ajnd"),alt:""},on:{dblclick:function(a){e.openFolder(t.row)}}}):s("div",{staticStyle:{"border-radius":"2px",display:"inline-block",border:"1px solid #E4E7ED"}},[s("img",{attrs:{src:t.row.imgUrl,alt:""},on:{dblclick:function(a){e.openImgDetail(t.row,t.$index)}}})]),e._v(" "),s("span",[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"尺寸（px）"},scopedSlots:e._u([{key:"default",fn:function(t){return["image"===t.row.type?s("p",[e._v(e._s(t.row.width)+"x"+e._s(t.row.length))]):s("p",[e._v("--")])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"大小"},scopedSlots:e._u([{key:"default",fn:function(t){return["image"===t.row.type?s("p",[e._v(e._s((t.row.size/1024).toFixed(2)))]):s("p",[e._v("--")])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"图片引用状态"},scopedSlots:e._u([{key:"default",fn:function(t){return["image"===t.row.type?s("div",[1===t.row.quoteStatus?s("p",[s("span",{staticClass:"dm-status--primary"},[e._v("已引用")])]):s("p",[s("span",{staticClass:"dm-status--info"},[e._v("未引用")])])]):s("p",[e._v("--")])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"更新时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticStyle:{"line-height":"1.2"}},[e._v(e._s(t.row.updateTime?e.getTime(t.row.updateTime):"--"))]),e._v(" "),s("p",{staticStyle:{"line-height":"1.2"}},[e._v(e._s(t.row.updateTime?e.getSeconds(t.row.updateTime):"--"))])]}}])}),e._v(" "),s("el-table-column",{staticClass:"el-popover-box",attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-popover",{staticStyle:{width:"120px"},attrs:{placement:"bottom",width:"160",trigger:"hover"},model:{value:t.row.visible2,callback:function(a){e.$set(t.row,"visible2",a)},expression:"scope.row.visible2"}},["image"===t.row.type?s("div",{staticClass:"img-operate"},[s("p",{on:{click:function(a){e.moveFile(t.row)}}},[e._v("移动图片")]),e._v(" "),s("label",{attrs:{for:"upload1"}},[s("p",{on:{click:function(a){e.beforeUpload(t.row.id)}}},[e._v("重新上传")]),e._v(" "),s("input",{staticStyle:{display:"none"},attrs:{id:"upload1",type:"file"},on:{change:function(a){return e.reuploadImg(a,t.$index)}}})]),e._v(" "),s("p",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.row.imgUrl,expression:"scope.row.imgUrl",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}]},[e._v("\n              复制链接\n            ")]),e._v(" "),s("p",{on:{click:function(a){e.listDelete(t.row)}}},[e._v("删除图片")])]):s("div",{staticClass:"img-operate"},[s("p",{on:{click:function(a){e.moveFile(t.row)}}},[e._v("移动文件")]),e._v(" "),s("p",{on:{click:function(a){e.listDelete(t.row)}}},[e._v("删除文件")])]),e._v(" "),s("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[s("i",{staticClass:"el-icon-more"})])],1)]}}])}),e._v(" "),s("template",{staticStyle:{display:"none"},slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2),e._v(" "),s("el-dialog",{staticClass:"img-dialog",attrs:{title:"图片详情",visible:e.dialogFormVisible,width:"900px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("div",{staticClass:"img-detail-content"},[s("div",{staticClass:"img-detail-left"},[s("i",{staticClass:"el-icon-arrow-left",on:{click:e.lastImg}}),e._v(" "),s("i",{staticClass:"el-icon-arrow-right",on:{click:e.nextImg}}),e._v(" "),s("div",{staticClass:"big-img-box"},[s("img",{attrs:{src:e.imgDetail.imgUrl,alt:""}})])]),e._v(" "),s("div",{staticClass:"img-detail-right"},[s("h2",[e._v(e._s(e.imgDetail.name))]),e._v(" "),s("div",{staticClass:"img-info"},[s("h3",[e._v("图片属性")]),e._v(" "),s("div",{staticClass:"img-info-item"},[s("span",[e._v("编辑时间：")]),s("span",[e._v(e._s(e.getTime(e.imgDetail.updateTime))+" "+e._s(e.getSeconds(e.imgDetail.updateTime)))])]),e._v(" "),s("div",{staticClass:"img-info-item"},[s("span",[e._v("图片大小：")]),s("span",[e._v(e._s((e.imgDetail.size/1024).toFixed(2))+"KB")])]),e._v(" "),s("div",{staticClass:"img-info-item"},[s("span",[e._v("图片尺寸：")]),s("span",[e._v(e._s(e.imgDetail.width)+"x"+e._s(e.imgDetail.length))])]),e._v(" "),s("div",{staticClass:"img-info-item"},[s("span",[e._v("图片类型：")]),s("span",[e._v(e._s(e.imgDetail.imgType))])])])])])])],1)},staticRenderFns:[]};var et=a("VU/8")(Qe,Xe,!1,function(e){a("6qa5"),a("kf5e")},"data-v-03948ba1",null).exports,tt={props:{tableData:{type:Array,default:function(){return[]}},shuaxin:{type:Boolean,default:!1},parentId:{type:String,default:""}},data:function(){return{getTime:C.getTime,getSeconds:C.getSeconds,inputVisible:!1,dialogFormVisible:!1,refash:!1,uploadId:"",action:window.location.origin+"/api-mall/gic-cloud-image-replace",imgDetail:{imgUrl:"",name:"",updateTime:"",size:"",width:"",length:"",imgType:"",id:""},currentIndex:-1,nameChange:""}},directives:{focus:{inserted:function(e){e.focus()}}},computed:{},methods:{selectItemClick:function(e){this.$emit("changeStatus",e,2),this.refash=!this.refash},openFolder:function(e){this.$emit("getDbClick",e.id)},openImgDetail:function(e,t){this.dialogFormVisible=!0,this.imgDetail=e,this.currentIndex=t},lastImg:function(){if(0===this.currentIndex)return this.$message.error("已经是当前页的第一张了"),!1;"folder"===this.tableData[this.currentIndex-1].type?(this.currentIndex--,this.$message.error("已经是当前页的第一张了")):(this.imgDetail=this.tableData[this.currentIndex-1],this.currentIndex--)},nextImg:function(){if(this.currentIndex===this.tableData.length-1)return this.$message.error("已经是当前页的最后一张了"),!1;"folder"===this.tableData[this.currentIndex+1].type?this.currentIndex++:(this.imgDetail=this.tableData[this.currentIndex+1],this.currentIndex++)},editFileName:function(e,t){this.$emit("changeStatus",e,1,!0),this.refash=!this.refash,this.nameChange=e.name},editFinish:function(e){var t=this;this.$emit("changeStatus",e,1,!1),this.refash=!this.refash;var a={id:e.id,name:e.name};return this.nameChange!==e.name&&(""===e.name?(this.$message.error("名称不能为空"),e.name=this.nameChange,!1):void A.get("/api-mall/gic-cloud-image-rename",{params:a}).then(function(a){0===a.data.errorCode?(t.$message.success("修改成功!"),t.$emit("getImgList"),t.$emit("getTree")):(e.name=t.nameChange,t.$message.error(a.data.message))}))},nameLimit:function(e){var t="",a=0;if(e.name.length){for(var s=0;s<e.name.length&&(null!=e.name[s].match(/[^\x00-\xff]/gi)?a+=1:a+=.5,!(a>20));s++)t+=e.name[s];e.name=t}},listDelete:function(e){this.$emit("deleteFile",e.id)},moveFile:function(e){var t=void 0;"folder"===e.type?t=2:"image"===e.type&&(t=1),this.$emit("moveFile",e.id,t)},reuploadImg:function(e,t){var a=this,s=new FormData;s.append("file",e.target.files[0]),s.append("parentId",this.parentId),s.append("targetId",this.uploadId);var i=e.target.files[0],r=new FileReader;return r.onload=function(e){var t=e.target.result;(new Image).src=t},r.readAsDataURL(i),"image/jpeg"!==i.type&&"image/png"!==i.type?(e.target.value="",this.$message.error("请上传jpg，png格式的图片"),!1):i.size>5242880?(e.target.value="",this.$message.error("请上传小于5MB的图片"),!1):void A.post("/api-mall/gic-cloud-image-replace",s).then(function(t){0===t.data.errorCode?(a.$message.success("上传成功"),a.$emit("getImgList"),e.target.value=""):(e.target.value="",a.$message.error(t.data.message))})},beforeUpload:function(e){this.uploadId=e},onCopy:function(e){this.$message.success("复制成功")},onError:function(e){this.$message.error("复制失败")}},components:{}},at={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"card-content"},[e._l(e.tableData,function(t,i){return s("div",{key:t.id,staticClass:"card-item",class:t.selectItem?"select-item":""},[s("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refash)+e._s(e.shuaxin))]),e._v(" "),s("div",{class:"folder"===t.type?"folder-img":"img-box",on:{click:function(a){e.selectItemClick(t)}}},["folder"===t.type?s("div",{staticStyle:{border:"10px solid #fff",height:"138px"}},[s("img",{attrs:{src:a("Ajnd"),alt:""},on:{dblclick:function(a){e.openFolder(t)}}})]):s("img",{attrs:{src:t.imgUrl,alt:""},on:{dblclick:function(a){e.openImgDetail(t,i)}}}),e._v(" "),1===t.quoteStatus&&"image"===t.type?s("div",{staticClass:"used-pic"},[e._v("引")]):e._e()]),e._v(" "),s("div",{staticClass:"folder-name"},[t.editStatus?e._e():s("span",{on:{click:function(a){a.stopPropagation(),e.editFileName(t,i)}}},[e._v(e._s(t.name))]),e._v(" "),t.editStatus?s("input",{directives:[{name:"focus",rawName:"v-focus"},{name:"model",rawName:"v-model",value:t.name,expression:"item.name"}],staticClass:"file-input",attrs:{type:"text"},domProps:{value:t.name},on:{blur:function(a){e.editFinish(t)},input:[function(a){a.target.composing||e.$set(t,"name",a.target.value)},function(a){e.nameLimit(t)}]}}):e._e(),e._v(" "),s("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refash))]),e._v(" "),s("div",{staticClass:"img-operate"},[s("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"center"}},[s("a",{attrs:{href:"javaScript:void(0)",title:"移动"}},[s("i",{staticClass:"iconfont icon-zhuanyi",on:{click:function(a){a.stopPropagation(),e.moveFile(t)}}})]),e._v(" "),"image"===t.type?s("a",{attrs:{href:"javaScript:void(0)",title:"重新上传"}},[s("label",{attrs:{for:"upload2"}},[s("i",{staticClass:"iconfont icon-shangchuan",on:{click:function(a){e.beforeUpload(t.id)}}}),e._v(" "),s("input",{staticStyle:{display:"none"},attrs:{id:"upload2",type:"file"},on:{change:function(a){return e.reuploadImg(a,t)}}})])]):e._e(),e._v(" "),"image"===t.type?s("a",{attrs:{href:"javaScript:void(0)",title:"复制"}},[s("i",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.imgUrl,expression:"item.imgUrl",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success.prevent",value:e.onCopy,expression:"onCopy",arg:"success",modifiers:{prevent:!0}},{name:"clipboard",rawName:"v-clipboard:error.prevent",value:e.onError,expression:"onError",arg:"error",modifiers:{prevent:!0}}],staticClass:"iconfont icon-lianjie"})]):e._e(),e._v(" "),s("a",{attrs:{href:"javaScript:void(0)",title:"删除"}},[s("i",{staticClass:"el-icon-delete",on:{click:function(a){a.stopPropagation(),e.listDelete(t)}}})])])])])])}),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:0===e.tableData.length,expression:"tableData.length === 0"}],staticClass:"no-data-wrap",staticStyle:{"text-align":"center"}},[e._m(0),e._v(" "),s("p",{staticStyle:{color:"#909399","font-size":"14px"}},[e._v("暂无数据")])]),e._v(" "),s("el-dialog",{staticClass:"img-dialog",attrs:{title:"图片详情",visible:e.dialogFormVisible,width:"900px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("div",{staticClass:"img-detail-content"},[s("div",{staticClass:"img-detail-left"},[s("i",{staticClass:"el-icon-arrow-left",on:{click:e.lastImg}}),e._v(" "),s("i",{staticClass:"el-icon-arrow-right",on:{click:e.nextImg}}),e._v(" "),s("div",{staticClass:"big-img-box"},[s("img",{attrs:{src:e.imgDetail.imgUrl,alt:""}})])]),e._v(" "),s("div",{staticClass:"img-detail-right"},[s("h2",[e._v(e._s(e.imgDetail.name))]),e._v(" "),s("div",{staticClass:"img-info"},[s("h3",[e._v("图片属性")]),e._v(" "),s("div",{staticClass:"img-info-item"},[s("span",[e._v("编辑时间：")]),s("span",[e._v(e._s(e.getTime(e.imgDetail.updateTime))+" "+e._s(e.getSeconds(e.imgDetail.updateTime)))])]),e._v(" "),s("div",{staticClass:"img-info-item"},[s("span",[e._v("图片大小：")]),s("span",[e._v(e._s((e.imgDetail.size/1024).toFixed(2))+"KB")])]),e._v(" "),s("div",{staticClass:"img-info-item"},[s("span",[e._v("图片尺寸：")]),s("span",[e._v(e._s(e.imgDetail.width)+"x"+e._s(e.imgDetail.length))])]),e._v(" "),s("div",{staticClass:"img-info-item"},[s("span",[e._v("图片类型：")]),s("span",[e._v(e._s(e.imgDetail.imgType))])])])])])])],2)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"no-data-icon"},[t("img",{attrs:{src:a("8Td+")}})])}]};var st={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,quoteStatus:"",searchParams:"",checked:!1,sortType:"timeDesc",activeIndex:"2",currentPage:1,pageSize:20,pageSizes:[20,40,60,80],total:0,tableData:[],deleteIds:"",dialogFormVisible:!1,newFileForm:{fileName:"",newParentId:null},moveData:[],defaultOptions:{children:"chlidren",label:"name"},newFileRules:{fileName:[{required:!0,message:"请输入文件夹名称",trigger:"blur"}],newParentId:[{required:!0,message:"请选择所属文件夹",trigger:"blur"}]},fileNameLen:0,action:window.location.origin+"/api-mall/gic-cloud-image-upload?requestProject=mall",uploadData:{},dialogFormVisible2:!1,moveParentId:null,moveIds:"",shuaxin:!1,parentId:"",matchNameArr:[],moveFolderArr:[],moveTableObj:[],uploadFolderData:[],clearable:!0,dialogFormVisible3:!1,uploadForm:{uploadParentId:null},dropzoneOptions:{autoProcessQueue:!1,url:window.location.origin+"/api-mall/gic-cloud-image-upload?requestProject=mall",headers:{"Gic-Header":"header value"}},group:"mall",folderUrl:window.location.origin+"/api-mall/gic-cloud-image-createUploadFolder?requestProject=mall",matchOnlyImg:[],matchOnlyImgCode:[]}},created:function(){},computed:{},methods:{getTree:function(){this.$emit("getTree")},cancelCheckAll:function(){this.checked=!1},toggleClick:function(e){this.currentPage=1,this.pageSize=20,this.sortType="timeDesc",this.searchParams="",this.quoteStatus="","1"===e?this.activeIndex="1":"2"===e&&(this.activeIndex="2"),this.checked=!1,this.getImgList()},getParentId:function(e){this.parentId=e,this.currentPage=1,this.getImgList()},getDbClick:function(e){this.parentId=e,this.searchParams="",this.currentPage=1,this.getImgList()},getImgList:function(){var e=this,t={currentPage:this.currentPage,pageSize:this.pageSize,sortType:this.sortType,parentId:this.parentId?this.parentId:"",searchParams:this.searchParams.trim(),quoteStatus:this.quoteStatus};A.get("/api-mall/gic-cloud-image-list",{params:t}).then(function(t){0===t.data.errorCode?t.data.result.result?(e.tableData=t.data.result.result,e.total=t.data.result.totalCount):e.tableData=[]:e.$message.error(t.data.message)})},getSearchImgList:function(){this.currentPage=1,this.getImgList()},handleSizeChange:function(e){this.checked=!1,this.pageSize=e,this.getImgList()},handleCurrentChange:function(e){this.checked=!1,this.currentPage=e,this.getImgList()},beforeDelete:function(e){this.deleteIds=e},deleteFile:function(e){var t=this,a={ids:e};if("-1"===e){if("2"===this.activeIndex){var s=[],i=!0,r=!1,o=void 0;try{for(var l,n=b()(this.tableData);!(i=(l=n.next()).done);i=!0){var d=l.value;d.selectItem&&s.push(d.id)}}catch(e){r=!0,o=e}finally{try{!i&&n.return&&n.return()}finally{if(r)throw o}}if(s.length<=0)return this.$message.error("请选择要删除的文件"),!1;a.ids=s.join(",")}else if(a.ids=this.deleteIds,""===this.deleteIds||!this.deleteIds)return this.$message.error("请选择要删除的文件"),!1}else a.ids=e;this.$confirm("此操作删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){A.get("/api-mall/gic-cloud-image-delete",{params:a}).then(function(e){0===e.data.errorCode?(t.$message.success("删除成功!"),t.getImgList(),t.$emit("getFileData"),t.getTreeData(),t.checked=!1):t.$message.error(e.data.message)})}).catch(function(){return!1})},moveObj:function(e){this.moveTableObj=e;var t=[],a=[],s=[],i=[],r=!0,o=!1,l=void 0;try{for(var n,d=b()(e);!(r=(n=d.next()).done);r=!0){var c=n.value;t.push(c.id),"folder"===c.type?a.push(c.id):"image"===c.type&&(s.push(c.imgUrl),i.push(c.name))}}catch(e){o=!0,l=e}finally{try{!r&&d.return&&d.return()}finally{if(o)throw l}}this.moveFolderArr=a,this.moveIds=t.join(","),this.matchOnlyImg=s,this.matchOnlyImgCode=i},getMatchName:function(e){"1"===this.activeIndex&&(this.matchNameArr=e)},matchImg:function(){var e=this,t={proNos:""};if("1"===this.activeIndex){if(this.matchNameArr.length<=0)return this.$message.error("请选择要匹配的文件"),!1;t.proNos=this.matchNameArr.join(",")}else if("2"===this.activeIndex){var a=[],s=!0,i=!1,r=void 0;try{for(var o,l=b()(this.tableData);!(s=(o=l.next()).done);s=!0){var n=o.value;n.selectItem&&"folder"===n.type&&a.push(n.name)}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}if(a.length<=0)return this.$message.error("请选择要匹配的文件"),!1;t.proNos=a.join(",")}A.get("/api-mall/gic-cloud-image-matching",{params:t}).then(function(t){0===t.data.errorCode?(e.$message.success("正在匹配中，请耐心等待"),e.checked=!1):e.$message.error(t.data.message)})},matchImg2:function(){var e=this,t={proCodes:"",mainImgs:""},a=[],s=[];if("1"===this.activeIndex){if(0===this.matchOnlyImgCode.length)return this.$message.error("请选择要匹配的图片"),!1;t.proCodes=this.matchOnlyImgCode.join(","),t.mainImgs=this.matchOnlyImg.join(",")}else if("2"===this.activeIndex){if(this.tableData.every(function(e){return"folder"===e.type}))return this.$message.error("请选择要匹配的图片"),!1;var i=!0,r=!1,o=void 0;try{for(var l,n=b()(this.tableData);!(i=(l=n.next()).done);i=!0){var d=l.value;"image"===d.type&&d.selectItem&&(a.push(d.name),s.push(d.imgUrl))}}catch(e){r=!0,o=e}finally{try{!i&&n.return&&n.return()}finally{if(r)throw o}}t.proCodes=a.join(","),t.mainImgs=s.join(",")}A.post("/api-mall/goods-image-matching",_.a.stringify(t)).then(function(t){0===t.data.errorCode?(e.$message.success("正在匹配中，请耐心等待"),e.checked=!1):e.$message.error(t.data.message)})},selectAll:function(){if(this.checked){var e=!0,t=!1,a=void 0;try{for(var s,i=b()(this.tableData);!(e=(s=i.next()).done);e=!0){s.value.selectItem=!0}}catch(e){t=!0,a=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw a}}}else{var r=!0,o=!1,l=void 0;try{for(var n,d=b()(this.tableData);!(r=(n=d.next()).done);r=!0){n.value.selectItem=!1}}catch(e){o=!0,l=e}finally{try{!r&&d.return&&d.return()}finally{if(o)throw l}}}this.shuaxin=!this.shuaxin},fileNameLimit:function(e){var t=this;this.$nextTick(function(){t.newFileForm.fileName=C.getInputVal(e,20),t.fileNameLen=C.getZhLen(t.newFileForm.fileName)})},newFileClick:function(){this.getFileData(),this.newFileForm.fileName="",this.newFileForm.newParentId=null,this.dialogFormVisible=!0},getFileData:function(){var e=this;A.get("/api-mall/gic-cloud-image-group-list").then(function(t){0===t.data.errorCode?(e.moveData=t.data.result,e.getTreeData(e.moveData)):e.$message.error(t.data.message)})},getTreeData:function(e){for(var t in e)e[t].label=e[t].name,e[t].children=e[t].chlidren,e[t].children.length?this.getTreeData(e[t].children):delete e[t].children},getFileDateFolder:function(e){var t=this,a={folderIds:e};A.get("/api-mall/gic-cloud-image-group-moveList",{params:a}).then(function(e){0===e.data.errorCode?(t.moveData=e.data.result,t.getTreeData(t.moveData)):t.$message.error(e.data.message)})},submitNewFile:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var a={parentId:t.newFileForm.newParentId,groupName:t.newFileForm.fileName};A.get("/api-mall/gic-cloud-image-createFolder",{params:a}).then(function(e){0===e.data.errorCode?(t.$message.success("新建成功"),t.dialogFormVisible=!1,t.getImgList(),t.$emit("getFileData"),t.getTreeData(),t.checked=!1):t.$message.error(e.data.message)})})},cancelNewFile:function(e){this.$refs[e].resetFields(),this.dialogFormVisible=!1},uploadFolder:function(){var e=this;A.get("/api-mall/gic-cloud-image-group-list").then(function(t){0===t.data.errorCode?(e.moveData=t.data.result,e.uploadForm.uploadParentId=t.data.result[0].id,e.getTreeData(e.moveData)):e.$message.error(t.data.message)}),this.dialogFormVisible3=!0},uploadComplete:function(){this.getImgList(),this.$emit("getFileData"),this.dialogFormVisible3=!1},beforeUpload:function(e){var t=this,a=new FormData;a.append("file",e.target.files[0]),a.append("parentId",this.parentId);var s=e.target.files[0],i=new FileReader;return i.onload=function(e){var t=e.target.result;(new Image).src=t},i.readAsDataURL(s),"image/jpeg"!==s.type&&"image/png"!==s.type?(e.target.value="",this.$message.error("请上传jpg，png格式的图片"),!1):s.size>5242880?(e.target.value="",this.$message.error("请上传小于5MB的图片"),!1):void A.post("/api-mall/gic-cloud-image-upload",a).then(function(a){0===a.data.errorCode?(t.$message.success("上传成功"),e.target.value="",t.getImgList()):(e.target.value="",t.$message.error(a.data.message))})},moveFile:function(e,t){if("-1"===e)if("2"===this.activeIndex){var a=[],s=[],i=!0,r=!1,o=void 0;try{for(var l,n=b()(this.tableData);!(i=(l=n.next()).done);i=!0){var d=l.value;d.selectItem&&(a.push(d.id),"folder"===d.type&&s.push(d.id))}}catch(e){r=!0,o=e}finally{try{!i&&n.return&&n.return()}finally{if(r)throw o}}if(a.length<=0)return this.$message.error("请选择要移动的文件"),!1;if(this.moveIds=a.join(","),s.every(function(e){return"image"===e.type}))this.getFileData();else{var c;c=s.join(","),this.getFileDateFolder(c)}}else{if(this.moveTableObj.every(function(e){return"image"===e.type}))this.getFileData();else{var u;u=this.moveFolderArr.join(","),this.getFileDateFolder(u)}if(""===this.moveIds||!this.moveIds)return this.$message.error("请选择要移动的文件"),!1}else 1===t?this.getFileData():2===t&&this.getFileDateFolder(e),this.moveIds=e;this.dialogFormVisible2=!0,this.moveParentId=null},submitMoveFile:function(){var e=this,t={moveIds:this.moveIds,moveToId:this.moveParentId};if(!this.moveParentId)return this.$message.error("请选择要移动到的文件夹名称"),!1;A.get("/api-mall/gic-cloud-image-move",{params:t}).then(function(t){0===t.data.errorCode?(e.$message.success("移动成功"),e.dialogFormVisible2=!1,e.getImgList(),e.$emit("getFileData"),e.checked=!1):e.$message.error(t.data.message)})},changeStatus:function(e,t,a){1===t&&(e.editStatus=a),2===t&&(e.selectItem=!e.selectItem);var s=!0,i=!1,r=void 0;try{for(var o,l=b()(this.tableData);!(s=(o=l.next()).done);s=!0){o.value.selectItem||(this.checked=!1)}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}var n=[],d=!0,c=!1,u=void 0;try{for(var m,p=b()(this.tableData);!(d=(m=p.next()).done);d=!0){var h=m.value;h.selectItem&&n.push(h)}}catch(e){c=!0,u=e}finally{try{!d&&p.return&&p.return()}finally{if(c)throw u}}n.length===this.tableData.length&&(this.checked=!0)},goNextPage:function(){this.$router.push("imgRecycleList")}},components:{imgList:et,imgCard:a("VU/8")(tt,at,!1,function(e){a("65NU"),a("KfuN")},"data-v-654a3f02",null).exports,Treeselect:ce.a}},it={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container-right"},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-section"},[a("div",{staticClass:"operate-top"},[a("el-select",{staticStyle:{width:"130px"},attrs:{placeholder:"全部状态",clearable:""},on:{change:e.getSearchImgList},model:{value:e.quoteStatus,callback:function(t){e.quoteStatus=t},expression:"quoteStatus"}},[a("el-option",{attrs:{label:"已引用",value:1}}),e._v(" "),a("el-option",{attrs:{label:"未引用",value:0}})],1),e._v(" "),a("div",{staticClass:"search-box"},[a("el-input",{staticClass:"w-260",attrs:{placeholder:"请输入图片名称/文件夹名称","prefix-icon":"el-icon-search",clearable:""},on:{clear:e.getSearchImgList},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.getSearchImgList(t):null}},model:{value:e.searchParams,callback:function(t){e.searchParams=t},expression:"searchParams"}})],1)],1),e._v(" "),a("div",{staticClass:"space-list-container"},[a("div",{staticClass:"space-list-title"},[a("div",{staticClass:"fl"},["2"===e.activeIndex?a("el-checkbox",{staticClass:"check-box",attrs:{disabled:0===e.tableData.length},on:{change:e.selectAll},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("全选")]):e._e(),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(t){e.moveFile("-1")}}},[e._v("移动")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(t){e.deleteFile("-1")}}},[e._v("删除")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:e.newFileClick}},[e._v("新建文件夹")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(t){e.matchImg("-1")}}},[e._v("匹配图片")]),e._v(" "),a("el-popover",{staticStyle:{"margin-left":"-4px"},attrs:{placement:"right",width:"400",trigger:"hover"}},[a("p",[e._v("匹配规则如下：")]),e._v(" "),a("p",[e._v("只有文件夹可勾选匹配，单张图片不可匹配")]),e._v(" "),a("p",[e._v("文件夹命名规则如下：")]),e._v(" "),a("p",[e._v("第一层文件夹：文件夹名称【款号】")]),e._v(" "),a("p",[e._v("第二层文件夹：")]),e._v(" "),a("p",[e._v("文件夹名称【主图】：01，02")]),e._v(" "),a("p",[e._v("文件夹名称【颜色图】：色号")]),e._v(" "),a("p",[e._v("文件夹名称【详情页】：01，02")]),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[a("i",{staticClass:"iconfont icon-xinxixianshi"})])],1),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(t){e.matchImg2("-1")}}},[e._v("匹配门店商品图片")]),e._v(" "),a("el-popover",{staticStyle:{"margin-left":"-4px"},attrs:{placement:"right",width:"400",trigger:"hover"}},[a("p",[e._v("匹配规则如下：")]),e._v(" "),a("p",[e._v("只有图片可勾选匹配")]),e._v(" "),a("p",[e._v("文件夹命名规则如下：")]),e._v(" "),a("p",[e._v("货号-1，货号-2（当有多张主图时")]),e._v(" "),a("p",[e._v("或者直接使用货号")]),e._v(" "),a("p",[e._v("货号（当只需要一张主图时）")]),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[a("i",{staticClass:"iconfont icon-xinxixianshi"})])],1)],1),e._v(" "),a("div",{staticClass:"fr"},[a("el-select",{staticStyle:{width:"130px"},attrs:{placeholder:"图片引用状态"},on:{change:e.getSearchImgList},model:{value:e.sortType,callback:function(t){e.sortType=t},expression:"sortType"}},[a("el-option",{attrs:{label:"时间升序",value:"timeAsc"}}),e._v(" "),a("el-option",{attrs:{label:"时间降序",value:"timeDesc"}}),e._v(" "),a("el-option",{attrs:{label:"大小升序",value:"sizeAsc1"}}),e._v(" "),a("el-option",{attrs:{label:"大小降序",value:"sizeDesc"}}),e._v(" "),a("el-option",{attrs:{label:"名称升序",value:"nameAsc"}}),e._v(" "),a("el-option",{attrs:{label:"名称降序",value:"nameDesc"}})],1),e._v(" "),a("ul",{staticClass:"toggle-list"},[a("li",{staticClass:"icon-item",class:"1"===e.activeIndex?"icon-item-active":"",on:{click:function(t){e.toggleClick("1")}}},[a("i",{staticClass:"icon-toggle-list"})]),e._v(" "),a("li",{staticClass:"icon-item",class:"2"===e.activeIndex?"icon-item-active":"",on:{click:function(t){e.toggleClick("2")}}},[a("i",{staticClass:"icon-toggle-card"})])]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.uploadFolder}},[a("i",{staticClass:"el-icon-upload",staticStyle:{"margin-right":"4px"}}),e._v("上传图片")]),e._v(" "),a("el-button",{attrs:{plain:""},on:{click:e.goNextPage}},[e._v("图片回收站")])],1)]),e._v(" "),a("div",{staticClass:"space-list-content"},["1"===e.activeIndex?a("imgList",{attrs:{tableData:e.tableData,parentId:e.parentId},on:{deleteFile:e.deleteFile,beforeDelete:e.beforeDelete,moveFile:e.moveFile,getDbClick:e.getDbClick,getImgList:e.getImgList,getMatchName:e.getMatchName,moveObj:e.moveObj}}):e._e(),e._v(" "),"2"===e.activeIndex?a("imgCard",{attrs:{shuaxin:e.shuaxin,tableData:e.tableData,parentId:e.parentId},on:{deleteFile:e.deleteFile,moveFile:e.moveFile,getImgList:e.getImgList,changeStatus:e.changeStatus,getDbClick:e.getDbClick,getTree:e.getTree}}):e._e(),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length>0,expression:"tableData.length > 0"}],staticClass:"pagination-conteiner"},[a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])],1)])])]),e._v(" "),a("el-dialog",{attrs:{title:"新建文件夹",visible:e.dialogFormVisible,width:"600px"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:function(t){e.cancelNewFile("newFileForm")}}},[a("el-form",{ref:"newFileForm",attrs:{model:e.newFileForm,rules:e.newFileRules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"所属上级文件夹",prop:"newParentId"}},[a("treeselect",{staticStyle:{width:"408px"},attrs:{multiple:!1,options:e.moveData,size:"small",placeholder:"请选择"},model:{value:e.newFileForm.newParentId,callback:function(t){e.$set(e.newFileForm,"newParentId",t)},expression:"newFileForm.newParentId"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"文件夹名称",prop:"fileName"}},[a("el-input",{staticStyle:{width:"400px"},on:{input:function(t){return e.fileNameLimit(t)}},model:{value:e.newFileForm.fileName,callback:function(t){e.$set(e.newFileForm,"fileName",t)},expression:"newFileForm.fileName"}},[a("span",{staticStyle:{"margin-right":"5px"},attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.fileNameLen)+"/20")])])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.cancelNewFile("newFileForm")}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitNewFile("newFileForm")}}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"转移文件",visible:e.dialogFormVisible2,width:"450px"},on:{"update:visible":function(t){e.dialogFormVisible2=t}}},[a("treeselect",{staticStyle:{width:"408px"},attrs:{multiple:!1,options:e.moveData,size:"small",placeholder:"请选择"},model:{value:e.moveParentId,callback:function(t){e.moveParentId=t},expression:"moveParentId"}}),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible2=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submitMoveFile}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"上传图片",visible:e.dialogFormVisible3,width:"700px"},on:{"update:visible":function(t){e.dialogFormVisible3=t}}},[a("el-form",{ref:"uploadForm",staticClass:"tree-delete-hidden",attrs:{model:e.uploadForm,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"所属上级文件夹"}},[a("treeselect",{staticStyle:{width:"500px"},attrs:{multiple:!1,options:e.moveData,size:"small",placeholder:"全部图片"},model:{value:e.uploadForm.uploadParentId,callback:function(t){e.$set(e.uploadForm,"uploadParentId",t)},expression:"uploadForm.uploadParentId"}})],1),e._v(" "),a("el-form-item",[a("vue-gic-space",{ref:"myDropzone",attrs:{id:"dropzone",clearable:e.clearable,options:e.dropzoneOptions,action:e.folderUrl,parentId:e.uploadForm.uploadParentId,useCustomSlot:!0},on:{"upload-complete":e.uploadComplete}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("将图片或文件夹拖到此处上传，或点击"),a("b",[e._v("上传")]),e._v("图片")]),e._v(" "),a("div",{staticClass:"upload-tips"},[e._v("仅支持5M以内的jpg、png、gif格式的图片")])])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible3=!1}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var rt={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98-149,parentId:"",highlightCurrent:!0,data:[],defaultProps:{children:"chlidren",label:"name"},clickNodeExpand:!1}},created:function(){this.getFileDataFirst()},computed:{},methods:{handleNodeClick:function(e){this.parentId=e.id,this.$refs.childEvent.getParentId(e.id),this.$refs.childEvent.cancelCheckAll()},getFileDataFirst:function(){var e=this;A.get("/api-mall/gic-cloud-image-group-list").then(function(t){0===t.data.errorCode?(e.data=t.data.result,e.parentId=t.data.result[0].id,e.$refs.childEvent.getParentId(e.parentId)):e.$message.error(t.data.message)})},getFileData:function(){var e=this;A.get("/api-mall/gic-cloud-image-group-list").then(function(t){0===t.data.errorCode?e.data=t.data.result:e.$message.error(t.data.message)})},getTree:function(){this.getFileData()}},components:{imgSpaceRight:a("VU/8")(st,it,!1,function(e){a("liMJ"),a("X0KP")},"data-v-3ea96b94",null).exports}},ot={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-content"},[a("div",{staticClass:"mall-content-title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("商品管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("图片空间")])],1),e._v(" "),e._m(0)],1),e._v(" "),a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[a("div",{staticClass:"img-left-content",style:{height:e.mallHeight+"px"}},[a("div",{staticClass:"img-left"},[a("div",{staticClass:"img-lef-title"},[e._v("图片目录")]),e._v(" "),a("div",{staticClass:"img-tree-content"},[a("el-tree",{attrs:{data:e.data,props:e.defaultProps,"node-key":"id","expand-on-click-node":e.clickNodeExpand,setCurrentKey:e.parentId},on:{"node-click":e.handleNodeClick}})],1)])]),e._v(" "),a("div",{staticClass:"img-right-content"},[a("div",{staticClass:"img-right"},[a("imgSpaceRight",{ref:"childEvent",attrs:{parentId:e.parentId},on:{getFileData:e.getFileData,getTree:e.getTree}})],1)])]),e._v(" "),a("vue-gic-footer",{staticStyle:{"padding-bottom":"80px"}})],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("图片空间")])])}]};var lt=a("VU/8")(rt,ot,!1,function(e){a("RRyA"),a("tt8p")},"data-v-6b4b687a",null).exports,nt={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,getTime:C.getTime,getSeconds:C.getSeconds,tableList:[],multipleSelection:[],currentPage:1,pageSizes:[20,40,60,80],pageSize:20,total:0,searchValue:"",sortField:"updateTime",sort:"desc",modalForm:{newPageName:"",memberType:1},newPageNameLen:0,modalRules:{newPageName:[{required:!0,message:"请输入页面名称",trigger:"blur"}]},dialogFormVisible:!1,dialogWechartCode:!1,wechatImg:"",pageUrl:"",loading:!0,loadingModal:!0,dialogVisible:!1,memberModalForm:{memberType:1},defaltSelected:[],height:400,projectName:"mall",headerList:[],effectiveStatus:1,pageId:""}},created:function(){this.getTableList()},directives:{focus:{inserted:function(e){e.focus()}}},computed:{},methods:{renderHeader:function(e,t,a){t.column,t.$index;return e("span",{},[e("span",{},"序号"),e("el-popover",{props:{placement:"top-start",width:"200",trigger:"hover",content:"当一个会员命中多个页面时，可通过序号排序来设置优先显示哪个页面。序号越大，优先级越高；序号相同，则编辑时间越晚，优先级越高。"}},[e("i",{slot:"reference",class:"iconfont icon-xinxixianshi"},"")])])},handleSelectionChange:function(e){this.multipleSelection=e},getTableList:function(){var e=this,t={isIndexPage:1,currentPage:this.currentPage,pageSize:this.pageSize,search:this.searchValue.trim(),sortField:this.sortField,sort:this.sort};A.post("/api-mall/mall_page_list",_.a.stringify(t)).then(function(t){if(0===t.data.errorCode)if(t.data.result.result){var a=!0,s=!1,i=void 0;try{for(var r,o=b()(t.data.result.result);!(a=(r=o.next()).done);a=!0){var l=r.value;l.editStatus=!0,l.editNumStatus=!0}}catch(e){s=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw i}}e.tableList=t.data.result.result,e.total=t.data.result.totalCount,e.loading=!1}else e.tableList=[],e.total=0,e.loading=!1;else e.$message.error(t.data.message)})},handleSizeChange:function(e){this.pageSize=e,this.getTableList()},handleCurrentChange:function(e){this.currentPage=e,this.getTableList()},deleteBatch:function(){var e=this;if(0===this.multipleSelection.length)this.$message.error("请至少选择一个");else{var t=[];for(var a in this.multipleSelection){if(1===this.multipleSelection[a].isOpen)return this.$message.error("启用中的页面不可以删除"),!1;t.push(this.multipleSelection[a].pageId)}var s={pageId:t.join(",")};this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){A.post("/api-mall/delete_mall_page",_.a.stringify(s)).then(function(t){0===t.data.errorCode?(e.$message.success("删除成功"),e.getTableList()):e.$message.error(t.data.message)})}).catch(function(){})}},deleteList:function(e,t){var a=this,s={pageId:e};A.post("/api-mall/delete_mall_page",_.a.stringify(s)).then(function(e){0===e.data.errorCode?(a.tableList.splice(t,1),0===a.tableList.length&&a.currentPage>1&&(a.currentPage=a.currentPage-1),a.$message.success("删除成功"),a.getTableList()):a.$message.error(e.data.message)})},editNewPage:function(e){this.$router.push({name:"newPage",params:{pageId:e}})},wechartCode:function(e){var t=this,a={type:0,pageId:e.pageId,enterpriseId:e.enterpriseId};this.dialogWechartCode=!0,this.loadingModal=!0,A.post("/api-mall/mallpage-qrcode",_.a.stringify(a)).then(function(e){0===e.data.errorCode?(t.wechatImg=e.data.result.url,t.pageUrl=e.data.result.page,t.loadingModal=!1):t.$message.error(e.data.message)})},newPage:function(){this.dialogFormVisible=!0,this.modalForm.memberType=1,this.defaltSelected=[]},copyPage:function(e){var t=this,a={pageId:e.pageId};A.post("/api-mall/mall_page_copy",_.a.stringify(a)).then(function(e){0===e.data.errorCode?(t.$message.success("复制页面成功"),t.getTableList()):t.$message.error(e.data.message)})},submitNewPage:function(e){var t=this;this.$refs[e].validate(function(a){if(!a)return!1;var s=void 0;if(t.defaltSelected.length<1&&2===t.modalForm.memberType)return t.$message.error("请选择会员分组"),!1;if(1===t.modalForm.memberType)s="";else if(2===t.modalForm.memberType){s=[];var i=!0,r=!1,o=void 0;try{for(var l,n=b()(t.defaltSelected);!(i=(l=n.next()).done);i=!0){var d=l.value;s.push(d.memberTagGroupId)}}catch(e){r=!0,o=e}finally{try{!i&&n.return&&n.return()}finally{if(r)throw o}}s=s.join(",")}var c={pageName:t.modalForm.newPageName,isIndexPage:1,memberLabelType:t.modalForm.memberType,memberLabelId:s};A.post("/api-mall/add_mall_home_page",_.a.stringify(c)).then(function(a){if(0===a.data.errorCode){t.$message.success("新建成功"),t.dialogFormVisible=!1,t.getTableList(),t.$refs[e].resetFields();var s=a.data.result;t.$router.push({name:"newPage",params:{pageId:s}})}else t.$message.error(a.data.message)})})},cancelNewPage:function(e){this.dialogFormVisible=!1,this.modalForm.newPageName="",this.modalForm.memberType=1,this.defaltSelected=[],this.$refs[e].resetFields()},editName:function(e){e.editStatus=!1},editNumber:function(e){e.editNumStatus=!1},editNumSubmit:function(e){var t=this,a={pageId:e.pageId,sortId:e.sortId};A.post("/api-mall/mall_page_update_for_sort",_.a.stringify(a)).then(function(a){0===a.data.errorCode?(t.$message.success("新建成功"),e.editNumStatus=!0,t.getTableList()):t.$message.error(a.data.message)})},editNumCancel:function(e){e.editNumStatus=!0},editNameSubmit:function(e){var t=this,a={pageId:e.pageId,pageName:e.pageName,isOpen:e.isOpen,isIndexPage:1};A.post("/api-mall/update_mall_page",_.a.stringify(a)).then(function(a){0===a.data.errorCode?(t.$message.success("更新成功"),t.getTableList(),e.editStatus=!1):t.$message.error(a.data.message)})},editNameCancel:function(e){e.editStatus=!0,this.getTableList()},editMemberType:function(e,t){this.pageId=e.pageId,e.tagGroupList?this.defaltSelected=e.tagGroupList:this.defaltSelected=[],e.memberLabelType?this.memberModalForm.memberType=e.memberLabelType:this.memberModalForm.memberType=1,this.dialogVisible=!0},submitEditMemberType:function(){var e=this;if(this.defaltSelected.length<1&&2===this.memberModalForm.memberType)return this.$message.error("请选择会员分组"),!1;var t=void 0;if(1===this.memberModalForm.memberType)t="";else if(2===this.memberModalForm.memberType){t=[];var a=!0,s=!1,i=void 0;try{for(var r,o=b()(this.defaltSelected);!(a=(r=o.next()).done);a=!0){var l=r.value;t.push(l.memberTagGroupId)}}catch(e){s=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw i}}t=t.join(",")}var n={tagIds:t,pageId:this.pageId,memberLabelType:this.memberModalForm.memberType};A.post("/api-mall/mall_page_update_for_member",_.a.stringify(n)).then(function(t){0===t.data.errorCode?(e.$message.success("更新成功"),e.getTableList(),e.dialogVisible=!1):e.$message.error(t.data.message)})},cancelEditMemberType:function(){this.dialogVisible=!1,this.memberModalForm.memberType=1,this.defaltSelected=[]},openStatus:function(e){var t=this,a={pageId:e.pageId,pageName:e.pageName,isOpen:1,isIndexPage:1};1===e.isOpen?(e.isOpen=0,a.isOpen=1):0===e.isOpen&&(e.isOpen=1,a.isOpen=0),this.$confirm(1==e.isOpen?"确认停用这个页面吗?":"确认启用这个页面吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){A.post("/api-mall/update_mall_page",_.a.stringify(a)).then(function(e){0===e.data.errorCode?(t.$message({type:"success",message:"更新成功!"}),t.getTableList()):t.$message.error(e.data.message)})}).catch(function(){t.$message({type:"info",message:"已取消"})})},pageNameLimit:function(e){var t=this;this.$nextTick(function(){t.modalForm.newPageName=C.getInputVal(e,10),t.newPageNameLen=C.getZhLen(t.modalForm.newPageName)})},pageLimit:function(e,t){this.$nextTick(function(){t.pageName=C.getInputVal(e,10)})},handleSearch:function(e){this.currentPage=1,this.searchValue=e,this.getTableList()},sortChange:function(e){this.sortField=e.prop,"ascending"==e.order?this.sort="asc":"descending"==e.order&&(this.sort="desc"),null===e.order&&(this.sortField="createTime"),this.getTableList()},onCopy:function(e){this.$message.success("复制成功")},onError:function(e){this.$message.error("复制失败")},handleDataTransferred:function(e){this.defaltSelected=e},handleDataLeft:function(e,t){this.defaltSelected=e}},components:{}},dt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[s("div",{staticClass:"mall-content-section"},[s("div",{staticClass:"mall-content-title",staticStyle:{position:"relative",border:"none"}},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",[e._v("商品管理")]),e._v(" "),s("el-breadcrumb-item",[e._v("店铺管理")]),e._v(" "),s("el-breadcrumb-item",[e._v("店铺装修")])],1),e._v(" "),e._m(0)],1),e._v(" "),s("div",{staticClass:"mall-section header-style"},[e._m(1),e._v(" "),s("div",{staticClass:"operate-top"},[s("div",{staticClass:"fl"},[s("el-input",{attrs:{placeholder:"请输入页面名称","prefix-icon":"el-icon-search",clearable:""},on:{clear:function(t){e.handleSearch(e.searchValue)}},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleSearch(e.searchValue)}},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1),e._v(" "),s("div",{staticClass:"fr"},[s("el-button",{attrs:{type:"danger",plain:""},on:{click:e.deleteBatch}},[e._v("批量删除")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.newPage}},[e._v("新建页面")])],1)]),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableList},on:{"sort-change":e.sortChange,"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),s("el-table-column",{attrs:{prop:"pageName",label:"页面名称",width:"260px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.editStatus?s("p",{staticClass:"name-tr",staticStyle:{display:"inline-block"}},[s("span",[e._v(e._s(t.row.pageName))]),e._v(" "),1===t.row.isDefault&&t.row.editStatus?s("span",{staticClass:"default-page"},[e._v("默认")]):e._e(),e._v(" "),s("i",{staticClass:"el-icon-edit",on:{click:function(a){e.editName(t.row)}}})]):e._e(),e._v(" "),t.row.editStatus?e._e():s("div",[s("el-input",{staticClass:"w-180",staticStyle:{width:"160px"},attrs:{placeholder:"",size:"small"},on:{input:function(a){return e.pageLimit(a,t.row)}},model:{value:t.row.pageName,callback:function(a){e.$set(t.row,"pageName",a)},expression:"scope.row.pageName"}}),e._v(" "),s("span",{staticClass:"operate-span",on:{click:function(a){e.editNameSubmit(t.row)}}},[e._v("确定")]),e._v(" "),s("span",{staticClass:"operate-span",on:{click:function(a){e.editNameCancel(t.row)}}},[e._v("取消")])],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"创建时间",sortable:"custom",prop:"createTime","min-width":"160px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticStyle:{"line-height":"18px"}},[e._v(e._s(e.getTime(t.row.createTime)))]),e._v(" "),s("p",{staticClass:"gray-color",staticStyle:{"line-height":"18px"}},[e._v(e._s(e.getSeconds(t.row.createTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"最后编辑时间",prop:"updateTime",sortable:"custom","min-width":"160px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticStyle:{"line-height":"18px"}},[e._v(e._s(e.getTime(t.row.updateTime)))]),e._v(" "),s("p",{staticClass:"gray-color",staticStyle:{"line-height":"18px"}},[e._v(e._s(e.getSeconds(t.row.updateTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"isOpen",label:"发布状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-switch",{attrs:{"active-value":1,"inactive-value":0,disabled:1===t.row.isDefault},on:{change:function(a){e.openStatus(t.row)}},model:{value:t.row.isOpen,callback:function(a){e.$set(t.row,"isOpen",a)},expression:"scope.row.isOpen"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"适用对象","min-width":"160px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticClass:"edit-group"},[2===t.row.memberLabelType?s("span",[e._v(e._s(t.row.memberTagCount)+"个会员分组")]):s("span",[e._v("全部会员")]),e._v(" "),0===t.row.isDefault?s("i",{staticClass:"el-icon-edit",on:{click:function(a){e.editMemberType(t.row,t.$index)}}}):e._e()])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"序号",width:"150px","render-header":e.renderHeader},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.editNumStatus?s("p",{staticClass:"edit-number"},[e._v(e._s(t.row.sortId)),0===t.row.isDefault?s("i",{staticClass:"el-icon-edit",on:{click:function(a){e.editNumber(t.row)}}}):e._e()]):e._e(),e._v(" "),t.row.editNumStatus||0!==t.row.isDefault?e._e():s("div",[t.row.editNumStatus?e._e():s("el-input",{staticClass:"w-180",staticStyle:{width:"60px"},attrs:{placeholder:"",size:"small",type:"number"},model:{value:t.row.sortId,callback:function(a){e.$set(t.row,"sortId",a)},expression:"scope.row.sortId"}}),e._v(" "),s("span",{staticClass:"operate-span",on:{click:function(a){e.editNumSubmit(t.row)}}},[e._v("确定")]),e._v(" "),s("span",{staticClass:"operate-span",on:{click:function(a){e.editNumCancel(t.row)}}},[e._v("取消")])],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[s("el-button",{attrs:{type:"text"},on:{click:function(a){e.editNewPage(t.row.pageId)}}},[e._v("编辑")]),e._v(" "),s("el-popover",{staticStyle:{"margin-left":"8px"},attrs:{placement:"top",width:"160"},model:{value:t.row.visible,callback:function(a){e.$set(t.row,"visible",a)},expression:"scope.row.visible"}},[s("p",{staticStyle:{"line-height":"1.5",padding:"10px 10px 20px"}},[e._v("确定复制该页面吗？")]),e._v(" "),s("div",{staticStyle:{"text-align":"right",margin:"0"}},[s("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.row.visible=!1}}},[e._v("取消")]),e._v(" "),s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.copyPage(t.row)}}},[e._v("确定")])],1),e._v(" "),s("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("复制")])],1),e._v(" "),0==t.row.isOpen?s("el-popover",{staticStyle:{"margin-left":"8px"},attrs:{placement:"top",width:"160"},model:{value:t.row.visible2,callback:function(a){e.$set(t.row,"visible2",a)},expression:"scope.row.visible2"}},[s("p",{staticStyle:{"line-height":"1.5",padding:"10px 10px 20px"}},[e._v("确定删除该页面吗？")]),e._v(" "),s("div",{staticStyle:{"text-align":"right",margin:"0"}},[s("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.row.visible2=!1}}},[e._v("取消")]),e._v(" "),s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.deleteList(t.row.pageId,t.$index)}}},[e._v("确定")])],1),e._v(" "),s("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除")])],1):e._e(),e._v(" "),1==t.row.isOpen?s("el-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"text"},on:{click:function(a){e.wechartCode(t.row)}}},[e._v("页面链接")]):e._e()],1)]}}])}),e._v(" "),s("template",{slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.tableList.length>0,expression:"tableList.length > 0"}],staticClass:"pagination-conteiner"},[s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])],1)]),e._v(" "),s("el-dialog",{attrs:{title:"新建页面",visible:e.dialogFormVisible,width:"946px"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:function(t){e.cancelNewPage("modalForm")}}},[s("el-form",{ref:"modalForm",attrs:{model:e.modalForm,rules:e.modalRules}},[s("el-form-item",{attrs:{label:"页面名称","label-width":"80px",prop:"newPageName"}},[s("el-input",{staticStyle:{width:"330px"},on:{input:function(t){return e.pageNameLimit(t)}},model:{value:e.modalForm.newPageName,callback:function(t){e.$set(e.modalForm,"newPageName",t)},expression:"modalForm.newPageName"}},[s("span",{staticStyle:{"margin-right":"5px"},attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.newPageNameLen)+"/10")])])],1),e._v(" "),s("el-form-item",{attrs:{label:"适用对象","label-width":"80px",required:""}},[[s("el-radio",{attrs:{label:1},model:{value:e.modalForm.memberType,callback:function(t){e.$set(e.modalForm,"memberType",t)},expression:"modalForm.memberType"}},[e._v("全部会员")]),e._v(" "),s("el-radio",{attrs:{label:2},model:{value:e.modalForm.memberType,callback:function(t){e.$set(e.modalForm,"memberType",t)},expression:"modalForm.memberType"}},[e._v("会员分组")])]],2),e._v(" "),2===e.modalForm.memberType?s("div",{staticStyle:{margin:"-30px 0 0 50px"}},[s("vue-gic-member-group",{attrs:{defaltSelected:e.defaltSelected,height:e.height,headerList:e.headerList,projectName:e.projectName,effectiveStatus:e.effectiveStatus},on:{handleDataTransferred:e.handleDataTransferred,handleDataLeft:e.handleDataLeft}})],1):e._e()],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.cancelNewPage("modalForm")}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitNewPage("modalForm")}}},[e._v("确 定")])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"页面链接",visible:e.dialogWechartCode,width:"450px"},on:{"update:visible":function(t){e.dialogWechartCode=t}}},[s("div",{staticClass:"dialog-body"},[s("div",{staticClass:"wechat-url",staticStyle:{"margin-bottom":"30px"}},[s("p",{staticStyle:{"font-weight":"600","margin-bottom":"15px"}},[e._v("页面链接")]),e._v(" "),s("div",{staticStyle:{display:"flex","align-items":"center"}},[s("el-input",{attrs:{type:"textarea",rows:2,disabled:""},model:{value:e.pageUrl,callback:function(t){e.pageUrl=t},expression:"pageUrl"}}),e._v(" "),s("a",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.pageUrl,expression:"pageUrl",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}],staticStyle:{width:"40px","margin-left":"20px"},attrs:{href:"javaScript:void(0)"}},[e._v("\n            复制\n          ")])],1)]),e._v(" "),s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingModal,expression:"loadingModal"}],staticClass:"wechat-img-box"},[s("img",{staticClass:"wechat-img",attrs:{src:e.wechatImg}})])])]),e._v(" "),s("el-dialog",{attrs:{title:"编辑适用对象",visible:e.dialogVisible,width:"946px"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.cancelEditMemberType}},[s("el-form",{ref:"memberModalForm",attrs:{model:e.memberModalForm}},[s("el-form-item",{attrs:{label:"适用对象","label-width":"80px",required:""}},[[s("el-radio",{attrs:{label:1},model:{value:e.memberModalForm.memberType,callback:function(t){e.$set(e.memberModalForm,"memberType",t)},expression:"memberModalForm.memberType"}},[e._v("全部会员")]),e._v(" "),s("el-radio",{attrs:{label:2},model:{value:e.memberModalForm.memberType,callback:function(t){e.$set(e.memberModalForm,"memberType",t)},expression:"memberModalForm.memberType"}},[e._v("会员分组")])]],2),e._v(" "),2===e.memberModalForm.memberType?s("div",{staticStyle:{margin:"-30px 0 0 50px"}},[s("vue-gic-member-group",{attrs:{defaltSelected:e.defaltSelected,height:e.height,projectName:e.projectName,headerList:e.headerList,effectiveStatus:e.effectiveStatus},on:{handleDataTransferred:e.handleDataTransferred,handleDataLeft:e.handleDataLeft}})],1):e._e()],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.cancelEditMemberType}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.submitEditMemberType}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("店铺装修")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"page-info"},[t("h3",[t("i",{staticClass:"el-icon-info"}),this._v("会员的个性化装修已上线，并在装修时注意以下两点：")]),this._v(" "),t("p",[this._v("1.当一个会员处于多个会员分组时，可能造成该会员同时命中多个装修页，则可通过排序来设置优先显示的页面。")]),this._v(" "),t("p",[this._v("2.当一个会员不处于任何一个会员分组时，可能造成该会员无法显示首页，因此必须编辑完成一个“默认首页”，来承接此类会员。")])])}]};var ct=a("VU/8")(nt,dt,!1,function(e){a("VrN5"),a("qofe")},"data-v-7d0a5be4",null).exports,ut={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,getTime:C.getTime,getSeconds:C.getSeconds,tableList:[],multipleSelection:[],currentPage:1,pageSizes:[20,40,60,80],pageSize:20,total:0,searchValue:"",sortField:"updateTime",sort:"desc",modalForm:{newPageName:""},newPageNameLen:0,modalRules:{newPageName:[{required:!0,message:"请输入页面名称",trigger:"blur"}]},dialogFormVisible:!1,dialogWechartCode:!1,wechatImg:"",pageUrl:"",loading:!0,loadingModal:!0}},created:function(){this.getTableList()},computed:{},methods:{handleSelectionChange:function(e){this.multipleSelection=e},getTableList:function(){var e=this,t={isIndexPage:0,currentPage:this.currentPage,pageSize:this.pageSize,search:this.searchValue.trim(),sortField:this.sortField,sort:this.sort};A.post("/api-mall/mall_page_list",_.a.stringify(t)).then(function(t){if(0===t.data.errorCode)if(t.data.result.result){var a=!0,s=!1,i=void 0;try{for(var r,o=b()(t.data.result.result);!(a=(r=o.next()).done);a=!0){r.value.editStatus=!0}}catch(e){s=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw i}}e.tableList=t.data.result.result,e.total=t.data.result.totalCount,e.loading=!1}else e.tableList=[],e.total=0,e.loading=!1;else e.$message.error(t.data.message)})},handleSizeChange:function(e){this.pageSize=e,this.getTableList()},handleCurrentChange:function(e){this.currentPage=e,this.getTableList()},deleteBatch:function(){var e=this;if(0===this.multipleSelection.length)this.$message.error("请至少选择一个");else{var t=[];for(var a in this.multipleSelection){if(1===this.multipleSelection[a].isOpen)return this.$message.error("启用中的页面不可以删除"),!1;t.push(this.multipleSelection[a].pageId)}var s={pageId:t.join(",")};this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){A.post("/api-mall/delete_mall_page",_.a.stringify(s)).then(function(t){0===t.data.errorCode?(e.$message.success("删除成功"),e.getTableList()):e.$message.error(t.data.message)})})}},deleteList:function(e,t){var a=this,s={pageId:e};A.post("/api-mall/delete_mall_page",_.a.stringify(s)).then(function(e){0===e.data.errorCode?(a.tableList.splice(t,1),0===a.tableList.length&&a.currentPage>1&&(a.currentPage=a.currentPage-1),a.$message.success("删除成功"),a.getTableList()):a.$message.error(e.data.message)})},wechartCode:function(e){var t=this,a={type:2,pageId:e.pageId,enterpriseId:e.enterpriseId};this.dialogWechartCode=!0,this.loadingModal=!0,A.post("/api-mall/mallpage-qrcode",_.a.stringify(a)).then(function(e){0===e.data.errorCode?(t.wechatImg=e.data.result.url,t.pageUrl=e.data.result.page,t.loadingModal=!1):t.$message.error(e.data.message)})},editNewPage:function(e){this.$router.push({name:"newPage",params:{pageId:e}})},newPage:function(){this.dialogFormVisible=!0},submitNewPage:function(e){var t=this;this.$refs[e].validate(function(a){if(!a)return!1;var s={pageName:t.modalForm.newPageName,isIndexPage:0};A.post("/api-mall/add_mall_page",_.a.stringify(s)).then(function(a){if(0===a.data.errorCode){t.$message.success("新建成功"),t.dialogFormVisible=!1,t.getTableList(),t.$refs[e].resetFields();var s=a.data.result;t.$router.push({name:"newPage",params:{pageId:s}})}else t.$message.error(a.data.message)})})},cancelNewPage:function(e){this.dialogFormVisible=!1,this.modalForm.newPageName="",this.$refs[e].resetFields()},editName:function(e){e.editStatus=!1},editNameSubmit:function(e){var t=this,a={pageId:e.pageId,pageName:e.pageName,isOpen:e.isOpen,isIndexPage:0};A.post("/api-mall/update_mall_page",_.a.stringify(a)).then(function(a){0===a.data.errorCode?(t.$message.success("更新成功"),t.getTableList(),e.editStatus=!1):t.$message.error(a.data.message)})},editNameCancel:function(e){e.editStatus=!0,this.getTableList()},openStatus:function(e){var t=this,a={pageId:e.pageId,pageName:e.pageName,isIndexPage:0};1===e.isOpen?(e.isOpen=0,a.isOpen=1):0===e.isOpen&&(e.isOpen=1,a.isOpen=0),this.$confirm(1==e.isOpen?"确认停用这个页面吗?":"确认启用这个页面吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){A.post("/api-mall/update_mall_page",_.a.stringify(a)).then(function(e){0===e.data.errorCode?(t.$message({type:"success",message:"更新成功!"}),t.getTableList()):t.$message.error(e.data.message)})}).catch(function(){1===e.isOpen?e.isOpen=1:0===e.isOpen&&(e.isOpen=0),t.$message({type:"info",message:"已取消删除"})})},pageNameLimit:function(e){var t=this;this.$nextTick(function(){t.modalForm.newPageName=C.getInputVal(e,10),t.newPageNameLen=C.getZhLen(t.modalForm.newPageName)})},pageLimit:function(e,t){this.$nextTick(function(){t.pageName=C.getInputVal(e,10)})},handleSearch:function(e){this.currentPage=1,this.searchValue=e,this.getTableList()},sortChange:function(e){this.sortField=e.prop,"ascending"==e.order?this.sort="asc":"descending"==e.order&&(this.sort="desc"),null===e.order&&(this.sortField="createTime"),this.getTableList()},onCopy:function(e){this.$message.success("复制成功")},onError:function(e){this.$message.error("复制失败")}},components:{}},mt={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[s("div",{staticClass:"mall-content-section"},[s("div",{staticClass:"mall-content-title",staticStyle:{position:"relative",border:"none"}},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",[e._v("商品管理")]),e._v(" "),s("el-breadcrumb-item",[e._v("店铺管理")]),e._v(" "),s("el-breadcrumb-item",[e._v("自定义页面")])],1),e._v(" "),e._m(0)],1),e._v(" "),s("div",{staticClass:"mall-section"},[s("div",{staticClass:"operate-top"},[s("div",{staticClass:"fl"},[s("el-input",{attrs:{placeholder:"请输入页面名称","prefix-icon":"el-icon-search",clearable:""},on:{clear:function(t){e.handleSearch(e.searchValue)}},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleSearch(e.searchValue)}},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1),e._v(" "),s("div",{staticClass:"fr"},[s("el-button",{attrs:{type:"danger",plain:""},on:{click:e.deleteBatch}},[e._v("批量删除")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.newPage}},[e._v("新建页面")])],1)]),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableList},on:{"sort-change":e.sortChange,"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),s("el-table-column",{attrs:{prop:"pageName",label:"页面名称",width:"320px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.editStatus?s("p",{staticClass:"name-tr"},[s("span",[e._v(e._s(t.row.pageName))]),e._v(" "),s("i",{staticClass:"el-icon-edit",on:{click:function(a){e.editName(t.row)}}})]):e._e(),e._v(" "),t.row.editStatus?e._e():s("div",[s("el-input",{staticClass:"w-180",attrs:{placeholder:"",size:"small"},on:{input:function(a){return e.pageLimit(a,t.row)}},model:{value:t.row.pageName,callback:function(a){e.$set(t.row,"pageName",a)},expression:"scope.row.pageName"}}),e._v(" "),s("span",{staticClass:"operate-span",on:{click:function(a){e.editNameSubmit(t.row)}}},[e._v("确定")]),e._v(" "),s("span",{staticClass:"operate-span",on:{click:function(a){e.editNameCancel(t.row)}}},[e._v("取消")])],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"创建时间",sortable:"custom",prop:"createTime"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticStyle:{"line-height":"18px"}},[e._v(e._s(e.getTime(t.row.createTime)))]),e._v(" "),s("p",{staticClass:"gray-color",staticStyle:{"line-height":"18px"}},[e._v(e._s(e.getSeconds(t.row.createTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"最后编辑时间",prop:"updateTime",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticStyle:{"line-height":"18px"}},[e._v(e._s(e.getTime(t.row.updateTime)))]),e._v(" "),s("p",{staticClass:"gray-color",staticStyle:{"line-height":"18px"}},[e._v(e._s(e.getSeconds(t.row.updateTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"isOpen",label:"发布状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:function(a){e.openStatus(t.row)}},model:{value:t.row.isOpen,callback:function(a){e.$set(t.row,"isOpen",a)},expression:"scope.row.isOpen"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[s("el-button",{attrs:{type:"text"},on:{click:function(a){e.editNewPage(t.row.pageId)}}},[e._v("编辑")]),e._v(" "),0==t.row.isOpen?s("el-popover",{staticStyle:{"margin-left":"8px"},attrs:{placement:"top",width:"160"},model:{value:t.row.visible2,callback:function(a){e.$set(t.row,"visible2",a)},expression:"scope.row.visible2"}},[s("p",{staticStyle:{"line-height":"1.5",padding:"10px 10px 20px"}},[e._v("确定删除该页面吗？")]),e._v(" "),s("div",{staticStyle:{"text-align":"right",margin:"0"}},[s("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.row.visible2=!1}}},[e._v("取消")]),e._v(" "),s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.deleteList(t.row.pageId,t.$index)}}},[e._v("确定")])],1),e._v(" "),s("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除")])],1):e._e(),e._v(" "),1==t.row.isOpen?s("el-button",{attrs:{type:"text"},on:{click:function(a){e.wechartCode(t.row)}}},[e._v("页面链接")]):e._e()],1)]}}])}),e._v(" "),s("template",{slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.tableList.length>0,expression:"tableList.length > 0"}],staticClass:"pagination-conteiner"},[s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])],1)]),e._v(" "),s("el-dialog",{attrs:{title:"新建页面",visible:e.dialogFormVisible,width:"450px"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:function(t){e.cancelNewPage("modalForm")}}},[s("el-form",{ref:"modalForm",staticStyle:{width:"450px"},attrs:{model:e.modalForm,rules:e.modalRules}},[s("el-form-item",{attrs:{label:"页面名称","label-width":"80px",prop:"newPageName"}},[s("el-input",{staticStyle:{width:"300px"},on:{input:function(t){return e.pageNameLimit(t)}},model:{value:e.modalForm.newPageName,callback:function(t){e.$set(e.modalForm,"newPageName",t)},expression:"modalForm.newPageName"}},[s("span",{staticStyle:{"margin-right":"5px"},attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.newPageNameLen)+"/10")])])],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.cancelNewPage("modalForm")}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitNewPage("modalForm")}}},[e._v("确 定")])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"页面链接",visible:e.dialogWechartCode,width:"450px"},on:{"update:visible":function(t){e.dialogWechartCode=t}}},[s("div",{staticClass:"dialog-body"},[s("div",{staticClass:"wechat-url",staticStyle:{"margin-bottom":"30px"}},[s("p",{staticStyle:{"font-weight":"600","margin-bottom":"15px"}},[e._v("页面链接")]),e._v(" "),s("div",{staticStyle:{display:"flex","align-items":"center"}},[s("el-input",{attrs:{type:"textarea",rows:2,disabled:""},model:{value:e.pageUrl,callback:function(t){e.pageUrl=t},expression:"pageUrl"}}),e._v(" "),s("a",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:e.pageUrl,expression:"pageUrl",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}],staticStyle:{width:"40px","margin-left":"20px"},attrs:{href:"javaScript:void(0)"}},[e._v("\n            复制\n          ")])],1)]),e._v(" "),s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingModal,expression:"loadingModal"}],staticClass:"wechat-img-box"},[s("img",{staticClass:"wechat-img",attrs:{src:e.wechatImg}})])])])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("自定义页面")])])}]};var pt=a("VU/8")(ut,mt,!1,function(e){a("t8X1"),a("oyc9")},"data-v-466a1816",null).exports,ht=a("Gu7T"),gt=a.n(ht),vt={props:{cateModal:{type:Boolean}},data:function(){return{allDate:[],firstCate:[],classIndex1:0,refreshStatus:!1,seceltIndex1:"",seceltIndex2:"",selectCateData:{},selectedCate:"",showDrag:!1}},created:function(){this.getFirstCateList()},methods:{showDragClick:function(){this.showDrag=!this.showDrag},getFirstCateList:function(){var e=this;A.get("/api-mall/list-mall-goods-all-category").then(function(t){0===t.data.errorCode?(e.allDate=[],e.allDate.push({search:"",arr:t.data.result})):e.$message.error(t.data.message)})},getNextCateList:function(e,t,a,s){var i=this;this.seceltIndex1=s,this.seceltIndex2=t,this.allDate.length=s+1,this.refreshStatus=!this.refreshStatus;var r=!0,o=!1,l=void 0;try{for(var n,d=b()(a.arr);!(r=(n=d.next()).done);r=!0){n.value.classIndex=-1,e.selectBgcolor=!1}}catch(e){o=!0,l=e}finally{try{!r&&d.return&&d.return()}finally{if(o)throw l}}e.classIndex=t,e.selectBgcolor=!0;var c={categoryId:e.categoryId};A.get("/api-mall/list-mall-goods-children-category",{params:c}).then(function(e){0===e.data.errorCode?e.data.result.length&&(i.allDate[s+1]={search:"",arr:e.data.result},i.refreshStatus=!i.refreshStatus):i.$message.error(e.data.message)})},searchCate:function(e,t,a){var s=this;if(this.allDate.length=t+1,0===t){var i={search:e};A.get("/api-mall/list-mall-goods-all-category",{params:i}).then(function(t){0===t.data.errorCode?(s.allDate=[],s.allDate.push({search:""!==e?e:"",arr:t.data.result})):s.$message.error(t.data.message)})}else{var r="";for(var o in this.allDate[t-1].arr)-1!==this.allDate[t-1].arr[o].classIndex&&(r=this.allDate[t-1].arr[o].categoryId);var l={search:e,categoryId:r};A.get("/api-mall/list-mall-goods-children-category",{params:l}).then(function(a){0===a.data.errorCode?(s.allDate[t]={search:""!==e?e:"",arr:a.data.result},s.refreshStatus=!s.refreshStatus):s.$message.error(a.data.message)})}},handaleConfirmCate:function(){if(this.showDrag=!this.showDrag,""===this.seceltIndex1||""===this.seceltIndex2)return!1;this.selectCateData={},this.selectCateData=this.allDate[this.seceltIndex1].arr[this.seceltIndex2]},getCateMessage:function(){this.$emit("getCateMess",this.selectCateData),this.$emit("cancelCateModal")},cancelCate:function(){this.selectCateData={},this.$emit("cancelCateModal")},handleClose:function(){this.selectCateData=[]}}},ft={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"选择品类",visible:e.cateModal,width:"840px"},on:{close:e.cancelCate}},[a("div",{staticClass:"goods-cate-content-modal"},[a("div",{staticClass:"goods-cate-title",on:{click:e.showDragClick}},[a("el-tag",{directives:[{name:"show",rawName:"v-show",value:e.selectCateData.categoryName,expression:"selectCateData.categoryName"}],staticClass:"select-tag",attrs:{closable:"","disable-transitions":!1,size:"small"},on:{close:function(t){e.handleClose()}}},[e._v("\n        "+e._s(e.selectCateData.categoryName)+"\n      ")])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showDrag,expression:"showDrag"}],staticClass:"goods-cate-list-container"},[a("div",{staticClass:"goods-cate-list-content"},e._l(e.allDate,function(t,s){return a("div",{key:s,staticClass:"goods-cate-box"},[a("el-input",{staticClass:"cate-search",attrs:{placeholder:"请输入内容","prefix-icon":"el-icon-search",size:"medium",clearable:""},nativeOn:{keyup:function(a){if(!("button"in a)&&e._k(a.keyCode,"enter",13,a.key,"Enter"))return null;e.searchCate(t.search,s,t)}},model:{value:t.search,callback:function(a){e.$set(t,"search",a)},expression:"item.search"}}),e._v(" "),a("div",{staticClass:"goods-cate-list"},e._l(t.arr,function(i,r){return a("div",{key:i.categoryId,staticClass:"goods-cate-item",class:i.classIndex===r?"cate-item-active":"",on:{click:function(a){e.getNextCateList(i,r,t,s)}}},[a("span",[e._v(e._s(i.categoryName))]),e._v(" "),i.isChildren?a("i",{staticClass:"el-icon-arrow-right"}):e._e()])})),e._v(" "),a("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refreshStatus))])],1)})),e._v(" "),a("div",{staticClass:"goods-cate-footer"},[a("el-button",{staticClass:"confirm-cate",attrs:{type:"text",size:"small"},on:{click:e.handaleConfirmCate}},[e._v("确认选择")])],1)])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelCate}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.getCateMessage}},[e._v("确 定")])],1)])},staticRenderFns:[]};var bt=a("VU/8")(vt,ft,!1,function(e){a("grVv")},null,null).exports,yt={props:{selectGoodsModal:{type:Boolean},goodsNum:{type:Number}},data:function(){return{getTime:C.getTime,getSeconds:C.getSeconds,activeName:"first",mallProTag:[],mallProTagId:null,mallCategoryId:"",mallCategoryName:"",searchValue:"",sortType:"asc",sortColumn:"createTime",goodsList:[],selectGoodsList:[],total:0,currentPage:1,cateModal:!1}},created:function(){this.getGoodsCate(),this.getGoodsList()},methods:{getGoodsCate:function(){var e=this;A.get("/api-mall/list_mall_goods_tag_tree").then(function(t){0===t.data.errorCode?(e.mallProTag.push({childTagList:t.data.result.childTagList,mallProTagId:t.data.result.mallProTagId,tagName:t.data.result.tagName}),e.getTree(e.mallProTag)):e.$message.error(t.data.message)})},getTree:function(e){for(var t in e)e[t].label=e[t].tagName,e[t].id=e[t].mallProTagId,e[t].children=e[t].childTagList,e[t].children?this.getTree(e[t].children):delete e[t].children},handleInputSearch:function(e){this.searchValue=e,this.getGoodsList()},searchMallTagId:function(){this.getGoodsList()},sortChange:function(e){this.sortColumn=e.prop,"ascending"==e.order?this.sortType="asc":"descending"==e.order&&(this.sortType="desc"),this.getGoodsList()},handleCurrentChange:function(e){this.currentPage=e,this.getGoodsList()},getGoodsList:function(){var e=this,t={goodsStatus:2,pageNum:this.currentPage,pageSize:10,order:this.sortType,sortField:this.sortColumn,mallCategoryId:this.mallCategoryId,tagId:this.mallProTagId,search:this.searchValue};A.get("/api-mall/page-simple-mall-goods",{params:t}).then(function(t){if(0===t.data.errorCode)if(t.data.result.result){for(var a in t.data.result.result)for(var s in t.data.result.result[a].selectStatus=!1,e.selectGoodsList)e.selectGoodsList[s].mallProId===t.data.result.result[a].mallProId&&(t.data.result.result[a].selectStatus=!0);e.goodsList=t.data.result.result,e.total=t.data.result.totalCount}else e.goodsList=[],e.total=0;else e.$message.error(t.data.message)})},selectAll:function(){if(this.goodsNum<=this.selectGoodsList.length)return this.$message.error("商品数量已达上限"),!1;if(this.goodsNum-this.selectGoodsList.length>0)for(var e in this.goodsList)if(!this.goodsList[e].selectStatus){if(!(this.selectGoodsList.length<this.goodsNum))return this.$message.error("商品数量已达上限"),!1;this.goodsList[e].selectStatus=!0,this.selectGoodsList.push(this.goodsList[e])}},selectItem:function(e){if(e.selectStatus)for(var t in e.selectStatus=!1,this.selectGoodsList)this.selectGoodsList[t].mallProId===e.mallProId&&this.selectGoodsList.splice(t,1);else{if(this.goodsNum<=this.selectGoodsList.length)return this.$message.error("商品数量已达上限"),!1;e.selectStatus=!0,this.selectGoodsList.push(e)}},removeItem:function(e,t){this.selectGoodsList.splice(t,1)},selectCate:function(){this.cateModal=!0},getCateMess:function(e){this.mallCategoryId=e.categoryId,this.mallCategoryName=e.categoryName,this.getGoodsList()},cancelCateModal:function(){this.cateModal=!1},cancelSelectGoods:function(){this.$emit("cancelSelectGoodsModal")},selectGoods:function(){this.$emit("getSelectGoods",this.selectGoodsList),this.cancelSelectGoods()},handleDate:function(){var e=!0,t=!1,a=void 0;try{for(var s,i=b()(this.goodsList);!(e=(s=i.next()).done);e=!0){s.value.selectStatus=!1}}catch(e){t=!0,a=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw a}}this.selectGoodsList=[]}},components:{Treeselect:ce.a,cateModal:bt}},_t={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"选择商品",visible:e.selectGoodsModal,width:"1000px"},on:{close:e.cancelSelectGoods}},[s("div",{staticClass:"modal-tab"},[s("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("div",{staticClass:"search-top"},[s("div",{staticClass:"fl"},[e.mallCategoryId?s("el-button",{staticStyle:{height:"36px"},on:{click:e.selectCate}},[e._v("\n              "+e._s(e.mallCategoryName)+"\n            ")]):s("el-button",{staticStyle:{height:"36px"},on:{click:e.selectCate}},[e._v("\n              选择商品品类\n            ")]),e._v(" "),s("treeselect",{staticClass:"w-260",staticStyle:{display:"inline-block","vertical-align":"top"},attrs:{multiple:!1,options:e.mallProTag,placeholder:"所有分类"},on:{input:e.searchMallTagId},model:{value:e.mallProTagId,callback:function(t){e.mallProTagId=t},expression:"mallProTagId"}})],1),e._v(" "),s("div",{staticClass:"fr"},[s("el-input",{staticClass:"w-260",staticStyle:{display:"inline-block"},attrs:{placeholder:"请输入内容","prefix-icon":"el-icon-search",clearable:"",size:"medium"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleInputSearch(e.searchValue)}},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}}),e._v(" "),s("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.selectAll}},[e._v("全选本页")])],1)]),e._v(" "),s("el-tab-pane",{attrs:{label:"出售中的商品",name:"first"}},[[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.goodsList,height:"400"},on:{"sort-change":e.sortChange}},[s("el-table-column",{attrs:{label:"商品信息",width:"450px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"img-text"},[s("img",{attrs:{src:t.row.mallProImageUrl}}),e._v(" "),s("div",{staticClass:"text"},[s("p",{staticClass:"goods-descript"},[e._v(e._s(t.row.proName))]),e._v(" "),s("p",{staticClass:"goods-code"},[e._v("货号:"+e._s(t.row.proCode))]),e._v(" "),s("p",{staticStyle:{color:"red"}},[e._v("￥"+e._s(t.row.mallProSpuPrice))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"createTime",label:"创建时间",sortable:"custom",width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e.getTime(t.row.createTime)))]),e._v(" "),s("p",{staticClass:"gray-color"},[e._v(e._s(e.getSeconds(t.row.createTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"stock",label:"库存",sortable:"custom",width:"160px"}}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.selectStatus?s("el-button",{on:{click:function(a){e.selectItem(t.row)}}},[e._v("已选择")]):s("el-button",{on:{click:function(a){e.selectItem(t.row)}}},[e._v("请选择")])]}}])}),e._v(" "),s("template",{slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2)],e._v(" "),s("div",{staticClass:"fr",staticStyle:{margin:"15px 0"}},[s("el-pagination",{attrs:{"page-size":10,"pager-count":5,layout:"prev, pager, next","current-page":e.currentPage,total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],2),e._v(" "),s("el-tab-pane",{attrs:{label:"已选择("+e.selectGoodsList.length+")",name:"second"}},[[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.selectGoodsList,height:"400"},on:{"sort-change":e.sortChange}},[s("el-table-column",{attrs:{label:"商品信息",width:"450px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"img-text"},[s("img",{attrs:{src:t.row.mallProImageUrl}}),e._v(" "),s("div",{staticClass:"text"},[s("p",{staticClass:"goods-descript"},[e._v(e._s(t.row.proName))]),e._v(" "),s("p",{staticClass:"goods-code"},[e._v("货号:"+e._s(t.row.proCode))]),e._v(" "),s("p",{staticStyle:{color:"red"}},[e._v("￥"+e._s(t.row.mallProSpuPrice))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"createTime",label:"创建时间",sortable:"custom",width:"180px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e.getTime(t.row.createTime)))]),e._v(" "),s("p",{staticClass:"gray-color"},[e._v(e._s(e.getSeconds(t.row.createTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"stock",label:"库存",sortable:"custom",width:"160px"}}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:"140px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{on:{click:function(a){e.removeItem(t.row,t.$index)}}},[e._v("移除")])]}}])}),e._v(" "),s("template",{slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2)]],2)],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.cancelSelectGoods}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.selectGoods}},[e._v("确 定")])],1)]),e._v(" "),s("cateModal",{attrs:{cateModal:e.cateModal},on:{getCateMess:e.getCateMess,cancelCateModal:e.cancelCateModal}})],1)},staticRenderFns:[]};var Ct=a("VU/8")(yt,_t,!1,function(e){a("e6wZ")},null,null).exports,It={props:{linkModal:{type:Boolean}},data:function(){return{activeName:"first",searchValue:"",goodsList:[],mallProTag:[],mallProTagId:null,mallCategoryId:"",mallCategoryName:"",currentPage:1,total:0,pageCount:0,sortType:"asc",sortColumn:"createTime",selectMallProTagId:null,selectMallProTagName:null,selectMallProTag:[],pageList:[{id:1,label:"商城首页",children:[{id:"A2",label:"分类页"},{id:"A3",label:"搜索页"},{id:"A4",label:"所有商品"}]},{id:2,label:"购物车",children:[{id:"B1",label:"购物车"}]},{id:3,label:"我的",children:[{id:"E2",label:"商城订单"},{id:"E3",label:"购物小票"}]},{id:4,label:"积分服务",children:[{id:"B5",label:"卡券兑换列表"},{id:"B6",label:"礼品兑换列表"}]}],defaultProps:{children:"children",label:"label"},goodsPageList:[],cateModal:!1,hrefUrl:{},classIndex:-1,classIndex1:-1,pageLinkForm:{displayName:"",url:"",type:5},appLink:{type:6,appid:"",displayName:""},appList:[],pageLinkRules:{displayName:[{required:!0,message:"请输入页面名称",trigger:"blur"}],url:[{required:!0,message:"请输入网址",trigger:"blur"},{validator:function(e,t,a){t?/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&:/~\+#]*[\w\-\@?^=%&/~\+#])?/.test(t)?a():a(new Error("请输入正确的网址")):a()},trigger:"blur"}]}}},created:function(){this.getGoodsList(),this.getGoodsCate()},methods:{handleClick:function(e,t){this.activeName=e.name,"first"===this.activeName?this.getGoodsList():"second"===this.activeName?this.getGoodsCate():"third"===this.activeName||("fourth"===this.activeName?this.getPageList():"fifth"===this.activeName||"sixth"===this.activeName&&this.getApp())},handleInputSearch:function(e){this.searchValue=e,this.getGoodsList()},searchMallTagId:function(){this.getGoodsList()},getGoodsCate:function(){var e=this;A.get("/api-mall/list_mall_goods_tag_tree").then(function(t){0===t.data.errorCode?("first"===e.activeName&&(e.mallProTag.push({childTagList:t.data.result.childTagList,mallProTagId:t.data.result.mallProTagId,tagName:t.data.result.tagName}),e.getTree(e.mallProTag)),"second"===e.activeName&&(e.selectMallProTag=[],e.selectMallProTag.push({childTagList:t.data.result.childTagList,mallProTagId:t.data.result.mallProTagId,tagName:t.data.result.tagName}),e.getTree(e.selectMallProTag))):e.$message.error(t.data.message)})},getTree:function(e){for(var t in e)e[t].label=e[t].tagName,e[t].id=e[t].mallProTagId,e[t].children=e[t].childTagList,e[t].children&&e[t].children.length?this.getTree(e[t].children):delete e[t].children},getGoodsList:function(){var e=this,t={goodsStatus:2,pageNum:this.currentPage,pageSize:9,mallCategoryId:this.mallCategoryId,tagId:this.mallProTagId,search:this.searchValue,order:this.sortType,sortField:this.sortColumn};A.get("/api-mall/page-simple-mall-goods",{params:t}).then(function(t){0===t.data.errorCode?t.data.result.result?(e.goodsList=t.data.result.result,e.total=t.data.result.totalCount,e.pageCount=t.data.result.totalPage):(e.goodsList=[],e.total=0):e.$message.error(t.data.message)})},handleCurrentChange:function(e){this.currentPage=e,this.getGoodsList()},getPageList:function(){var e=this;A.get("/api-mall/mall_page_list",{params:{currentPage:1,pageSize:100,isIndexPage:0,sort:"asc",sortField:"createTime"}}).then(function(t){0===t.data.errorCode?t.data.result.result?e.goodsPageList=t.data.result.result:e.goodsList=[]:e.$message.error(t.data.message)})},cancelSelectLink:function(){this.$emit("cancelLinkModal")},getApp:function(){var e=this;A.get("/api-plug/applet-app-search").then(function(t){0===t.data.errorCode?t.data.result?e.appList=t.data.result:e.appList=[]:e.$message.error(t.data.message)})},changeApp:function(){var e=this;this.appLink.displayName=this.appList.find(function(t){return t.appId===e.appLink.appid}).appName,this.hrefUrl=this.appLink},confirmSelectLink:function(){"fifth"===this.activeName?(this.hrefUrl=this.pageLinkForm,""===this.pageLinkForm.displayName?this.$message.error("请输入页面名称"):""===this.pageLinkForm.url?this.$message.error("请输入网址"):/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&:/~\+#]*[\w\-\@?^=%&/~\+#])?/.test(this.pageLinkForm.url)?(this.hrefUrl=this.pageLinkForm,this.$emit("getLinkMess",this.hrefUrl)):this.$message.error("请输入正确的网址")):"{}"==O()(this.hrefUrl)?this.$message.error("请选择链接"):this.$emit("getLinkMess",this.hrefUrl),this.cancelSelectLink()},selectCate:function(){this.cateModal=!0},getCateMess:function(e){this.mallCategoryId=e.categoryId,this.mallCategoryName=e.categoryName,this.getGoodsList()},cancelCateModal:function(){this.cateModal=!1},selectLink1:function(e,t){this.hrefUrl={type:1,displayName:e.proName,mallProId:e.mallProId},this.classIndex=t},selectLink2:function(){if(!this.selectMallProTagId)return this.hrefUrl={},!1;for(var e in this.hrefUrl={type:2,mallProTagId:this.selectMallProTagId,displayName:""},"0"===this.selectMallProTagId&&(this.hrefUrl.displayName="所有分类"),this.selectMallProTag[0].children)for(var t in this.selectMallProTag[0].children[e].id===this.selectMallProTagId&&(this.hrefUrl.displayName=this.selectMallProTag[0].children[e].label),this.selectMallProTag[0].children[e].children)this.selectMallProTag[0].children[e].children[t].id===this.selectMallProTagId&&(this.hrefUrl.displayName=this.selectMallProTag[0].children[e].children[t].label)},selectLink3:function(e){if(1===e.id||2===e.id||3===e.id||4===e.id)return this.hrefUrl={},!1;this.hrefUrl={type:3,displayName:e.label,funcPageCode:e.id}},selectLink4:function(e,t){this.classIndex1=t,this.hrefUrl={type:4,displayName:e.pageName,pageId:e.pageId}}},components:{Treeselect:ce.a,cateModal:bt}},St={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"链接小工具",visible:e.linkModal,width:"1000px"},on:{close:e.cancelSelectLink}},[s("div",{staticClass:"modal-tab"},[s("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"商品链接",name:"first"}},[s("div",{staticClass:"search-top"},[s("div",{staticClass:"fl"},[e.mallCategoryId?s("el-button",{staticStyle:{height:"36px"},on:{click:e.selectCate}},[e._v("\n                "+e._s(e.mallCategoryName)+"\n              ")]):s("el-button",{staticStyle:{height:"36px"},on:{click:e.selectCate}},[e._v("\n                选择商品品类\n              ")]),e._v(" "),s("treeselect",{staticClass:"w-260",staticStyle:{display:"inline-block","vertical-align":"top"},attrs:{multiple:!1,options:e.mallProTag,placeholder:"所有分类"},on:{input:e.searchMallTagId},model:{value:e.mallProTagId,callback:function(t){e.mallProTagId=t},expression:"mallProTagId"}})],1),e._v(" "),s("div",{staticClass:"fr"},[s("el-input",{staticClass:"w-260",staticStyle:{display:"inline-block"},attrs:{placeholder:"请输入商品名称或货号","prefix-icon":"el-icon-search",clearable:"",size:"medium"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleInputSearch(e.searchValue)}},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1)]),e._v(" "),s("div",{staticClass:"goods-list-content"},[e.goodsList.length?s("ul",{staticClass:"goods-list"},e._l(e.goodsList,function(t,a){return s("li",{key:a,staticClass:"goods-list-item",class:e.classIndex===a?"goods-list-item-active":"",on:{click:function(s){e.selectLink1(t,a)}}},[s("img",{attrs:{src:t.mallProImageUrl}}),e._v(" "),s("div",{staticClass:"img-text"},[s("p",{staticClass:"pro-name"},[e._v(e._s(t.proName))]),e._v(" "),s("p",{staticClass:"pro-code"},[e._v("货号:"+e._s(t.proCode))]),e._v(" "),s("p",{staticClass:"pro-price"},[e._v("￥"+e._s(t.mallProSpuPrice))])])])})):s("div",{staticClass:"no-data-wrap",staticStyle:{"text-align":"center"}},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])]),e._v(" "),e.goodsList.length?s("div",{staticClass:"fr",staticStyle:{margin:"15px 0"}},[s("el-pagination",{attrs:{"page-size":9,layout:"prev, pager, next","current-page":e.currentPage,total:e.total,"page-count":e.pageCount},on:{"current-change":e.handleCurrentChange}})],1):e._e()]),e._v(" "),s("el-tab-pane",{attrs:{label:"商品分类链接",name:"second"}},[s("div",{staticStyle:{"margin-top":"15px",height:"385px"}},[s("treeselect",{staticClass:"w-260",staticStyle:{display:"inline-block","vertical-align":"top"},attrs:{multiple:!1,options:e.selectMallProTag,lable:e.selectMallProTagName,placeholder:"所有分类"},on:{input:e.selectLink2},model:{value:e.selectMallProTagId,callback:function(t){e.selectMallProTagId=t},expression:"selectMallProTagId"}})],1)]),e._v(" "),s("el-tab-pane",{attrs:{label:"主功能页面链接",name:"third"}},[s("div",{staticClass:"main-page",staticStyle:{height:"385px","overflow-y":"auto"}},[s("el-tree",{attrs:{data:e.pageList,props:e.defaultProps,"disable-branch-nodes":!0},on:{"node-click":e.selectLink3}})],1)]),e._v(" "),s("el-tab-pane",{attrs:{label:"自定义页面链接",name:"fourth"}},[s("div",{staticStyle:{height:"385px","overflow-y":"auto","margin-top":"15px"}},e._l(e.goodsPageList,function(t,a){return s("div",{key:a,staticClass:"page-list",class:e.classIndex1===a?"page-list-active":"",on:{click:function(s){e.selectLink4(t,a)}}},[e._v(e._s(t.pageName))])}))]),e._v(" "),s("el-tab-pane",{attrs:{label:"h5页面链接",name:"fifth"}},[s("div",{staticStyle:{height:"385px","margin-top":"20px"}},[s("el-form",{staticStyle:{"margin-top":"22px"},attrs:{model:e.pageLinkForm,rules:e.pageLinkRules,"label-width":"90px"}},[s("el-form-item",{attrs:{label:"名称",prop:"displayName"}},[s("el-input",{staticStyle:{width:"500px"},attrs:{placeholder:"请输入页面名称"},model:{value:e.pageLinkForm.displayName,callback:function(t){e.$set(e.pageLinkForm,"displayName",t)},expression:"pageLinkForm.displayName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"网址",prop:"url"}},[s("el-input",{staticStyle:{width:"500px"},attrs:{placeholder:"请输入网址"},model:{value:e.pageLinkForm.url,callback:function(t){e.$set(e.pageLinkForm,"url",t)},expression:"pageLinkForm.url"}})],1)],1)],1)]),e._v(" "),s("el-tab-pane",{attrs:{label:"第三方小程序",name:"sixth"}},[s("div",{staticStyle:{height:"385px","margin-top":"30px"}},[s("el-select",{attrs:{placeholder:"请选择"},on:{change:e.changeApp},model:{value:e.appLink.appid,callback:function(t){e.$set(e.appLink,"appid",t)},expression:"appLink.appid"}},e._l(e.appList,function(e){return s("el-option",{key:e.appId,attrs:{label:e.appName,value:e.appId}})}))],1)])],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.cancelSelectLink}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.confirmSelectLink}},[e._v("确 定")])],1)]),e._v(" "),s("cateModal",{attrs:{cateModal:e.cateModal},on:{getCateMess:e.getCateMess,cancelCateModal:e.cancelCateModal}})],1)},staticRenderFns:[]};var wt=a("VU/8")(It,St,!1,function(e){a("V52o")},null,null).exports,xt={props:{column:{type:Number,default:3},row:{type:Number,default:3},boxMsg:{type:Array,default:function(){return[]}},isNew:{type:Boolean,default:!1}},data:function(){return{boxWidth:0,boxHeigth:0,selecIndex:-1,refash:!1,isClick:!1,falseClick:{x:0,y:0},trueClick:{x:0,y:0},boxArr:[],boxPosition:[],lineData:[{rowData:[{isSelect:!1,isUse:!1},{isSelect:!1,isUse:!1},{isSelect:!1,isUse:!1}]},{rowData:[{isSelect:!1,isUse:!1},{isSelect:!1,isUse:!1},{isSelect:!1,isUse:!1}]},{rowData:[{isSelect:!1,isUse:!1},{isSelect:!1,isUse:!1},{isSelect:!1,isUse:!1}]}],isUse:!1,action:window.location.origin+"/api-plug/upload-img?requestProject=mall"}},watch:{column:function(){this.changeRow(this.column)},row:function(){this.changeLine(this.row)},boxMsg:function(){this.boxArr=he(this.boxMsg),this.boxArr.length||this.changeBox(),this.refash=!this.refash}},created:function(){this.boxArr=he(this.boxMsg),this.boxWidth=325/this.column,this.boxHeigth=this.boxWidth,this.changeBox(),this.refash=!this.refash},methods:{changeLine:function(e){var t=this;this.refash=!this.refash,this.row=e,this.boxHeigth=this.boxWidth,this.boxPosition=[],this.boxArr=[],setTimeout(function(){t.changeBox1()},50)},changeRow:function(e){var t=this;this.refash=!this.refash,this.column=e;var a=325-(e-4);this.boxWidth=a/e,this.boxPosition=[],this.boxArr=[],setTimeout(function(){t.changeBox1()},50)},handleSelect:function(e,t){if(this.isClick=!this.isClick,this.isClick&&(this.trueClick.x=t,this.trueClick.y=e,this.lineData[e].rowData[t].isSelect=!0,this.isUse=!1),!this.isClick){this.falseClick.x=t,this.falseClick.y=e,this.resetColor();var a=this.trueClick.x<t?this.trueClick.x:t,s=this.trueClick.y<e?this.trueClick.y:e,i=this.trueClick.x>t?this.trueClick.x:t,r=this.trueClick.y>e?this.trueClick.y:e;if(this.isUse)this.boxPosition.push({startX:this.trueClick.x,startY:this.trueClick.y,endX:this.trueClick.x,endY:this.trueClick.y}),this.boxArr.push({left:this.trueClick.x,top:this.trueClick.y,endLeft:this.trueClick.x+1,endTop:this.trueClick.y+1,height:0,width:0,picURL:""}),this.lineData[this.trueClick.y].rowData[this.trueClick.x].isUse=!0;else{this.boxArr.push({left:this.falseClick.x-this.trueClick.x>0?this.trueClick.x:this.falseClick.x,top:this.falseClick.y-this.trueClick.y>0?this.trueClick.y:this.falseClick.y,endLeft:this.trueClick.x>t?this.trueClick.x+1:t+1,endTop:this.trueClick.y>e?this.trueClick.y+1:e+1,height:Math.abs(this.falseClick.y-this.trueClick.y),width:Math.abs(this.falseClick.x-this.trueClick.x),picURL:""}),this.boxPosition.push({startX:this.trueClick.x<t?this.trueClick.x:t,startY:this.trueClick.y<e?this.trueClick.y:e,endX:this.trueClick.x>t?this.trueClick.x:t,endY:this.trueClick.y>e?this.trueClick.y:e});for(var o=s;o<=r;o++)for(var l=a;l<=i;l++)this.lineData[o].rowData[l].isUse=!0;var n=he(this.boxArr),d=!0,c=!1,u=void 0;try{for(var m,p=b()(n);!(d=(m=p.next()).done);d=!0)for(var h=m.value,g=h.top,v=h.endTop-1,f=h.left,y=h.endLeft-1,_=g;_<=v;_++)for(var C=f;C<=y;C++)this.lineData[_].rowData[C].isUse=!0,this.refash=!this.refash}catch(e){c=!0,u=e}finally{try{!d&&p.return&&p.return()}finally{if(c)throw u}}}this.selecIndex=this.boxArr.length-1,this.$emit("getBoxArr",this.boxArr[this.selecIndex],this.selecIndex),this.$emit("getBoxIndex",this.selecIndex);var I=this.lineData.map(function(e){return e.rowData.every(function(e){return!0===e.isUse})}).every(function(e){return!0===e});this.$emit("getSelectAll",I)}this.refash=!this.refash},mouseMove:function(e,t){var a=this.trueClick.x<t?this.trueClick.x:t,s=this.trueClick.y<e?this.trueClick.y:e,i=this.trueClick.x>t?this.trueClick.x:t,r=this.trueClick.y>e?this.trueClick.y:e;if(this.isClick){for(var o=[],l=s;l<=r;l++)for(var n=a;n<=i;n++)o.push(this.lineData[l].rowData[n].isUse);if(this.isUse=o.some(function(e){return!0===e}),!this.isUse)for(var d in this.lineData)if(s<=d&&d<=r)for(var c in this.lineData[d].rowData)this.lineData[d].rowData[c].isSelect=a<=c&&c<=i;else for(var u in this.lineData[d].rowData)this.lineData[d].rowData[u].isSelect=!1}this.refash=!this.refash},resetColor:function(){for(var e in this.lineData)for(var t in this.lineData[e].rowData)this.lineData[e].rowData[t].isSelect=!1},removeBox:function(e){var t=this.boxArr.splice(e,1);this.falseClick.x=t[0].left,this.falseClick.y=t[0].top,this.trueClick.x=t[0].endLeft,this.trueClick.y=t[0].endTop;var a=this.trueClick.x<this.falseClick.x?this.trueClick.x:this.falseClick.x,s=this.trueClick.y<this.falseClick.y?this.trueClick.y:this.falseClick.y,i=(this.trueClick.x>this.falseClick.x?this.trueClick.x:this.falseClick.x)-1,r=(this.trueClick.y>this.falseClick.y?this.trueClick.y:this.falseClick.y)-1;if(t)for(var o=s;o<=r;o++)for(var l=a;l<=i;l++)this.lineData[o].rowData[l].isUse=!1,this.refash=!this.refash;var n=this.lineData.map(function(e){return e.rowData.every(function(e){return!0===e.isUse})}).every(function(e){return!0===e});this.$emit("getSelectAll",n),this.$emit("removeBoxArr",this.selecIndex)},changeBox:function(){this.lineData=[];for(var e=0;e<this.row;e++){this.lineData[e]={},this.lineData[e].rowData=[];for(var t=0;t<this.column;t++)this.lineData[e].rowData[t]={isSelect:!1,isUse:!1}}var a=he(this.boxArr),s=!0,i=!1,r=void 0;try{for(var o,l=b()(a);!(s=(o=l.next()).done);s=!0)for(var n=o.value,d=n.top,c=n.endTop-1,u=n.left,m=n.endLeft-1,p=d;p<=c;p++)for(var h=u;h<=m;h++)this.lineData[p].rowData[h].isUse=!0,this.refash=!this.refash}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}if(!a.length)for(var g=0;g<this.row;g++){this.lineData[g]={},this.lineData[g].rowData=[];for(var v=0;v<this.column;v++)this.lineData[g].rowData[v]={isSelect:!1,isUse:!this.isNew}}},changeBox1:function(){this.lineData=[];for(var e=0;e<this.row;e++){this.lineData[e]={},this.lineData[e].rowData=[];for(var t=0;t<this.column;t++)this.lineData[e].rowData[t]={isSelect:!1,isUse:!1}}var a=he(this.boxArr),s=!0,i=!1,r=void 0;try{for(var o,l=b()(a);!(s=(o=l.next()).done);s=!0)for(var n=o.value,d=n.top,c=n.endTop-1,u=n.left,m=n.endLeft-1,p=d;p<=c;p++)for(var h=u;h<=m;h++)this.lineData[p].rowData[h].isUse=!0,this.refash=!this.refash}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}if(!a.length)for(var g=0;g<this.row;g++){this.lineData[g]={},this.lineData[g].rowData=[];for(var v=0;v<this.column;v++)this.lineData[g].rowData[v]={isSelect:!1,isUse:!1}}},selectBox:function(e){this.selecIndex=e,this.$emit("getBoxArr",this.boxArr[this.selecIndex],this.selecIndex),this.$emit("getBoxIndex",this.selecIndex);var t=this.lineData.map(function(e){return e.rowData.every(function(e){return!0===e.isUse})}).every(function(e){return!0===e});this.$emit("getSelectAll",t)},getPic:function(e,t){this.boxArr[e].picURL=t},cubeUploadBefore:function(e){return"image/jpeg"!==e.type&&"image/png"!==e.type&&"image/jpg"!==e.type&&"image/gif"!==e.type?(this.$message.error("请上传jpg，png格式的图片"),!1):e.size>3145728?(this.$message.error("图片大小请控制在3M内"),!1):new S.a(function(t,a){var s=new FileReader;s.onload=function(e){var a=new Image;a.onload=function(){t()},a.src=e.target.result},s.readAsDataURL(e)})},cubeUploadSuccess:function(e,t,a){0===e.errorCode?(-1!==this.selecIndex&&(this.boxArr[this.selecIndex].picURL=e.result[0].qcloudImageUrl,this.$message.success("上传成功"),this.refash=!this.refash),this.$emit("getBoxArr",this.boxArr[this.selecIndex],this.selecIndex)):this.$message.error(e.message)}},components:{}},Lt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"cube-content"},[a("div",{staticStyle:{position:"relative"}},[a("div",{staticClass:"cube-box"},e._l(e.lineData,function(t,s){return a("ul",{key:s,staticClass:"cube-ul"},e._l(t.rowData,function(t,i){return a("li",{key:i,staticClass:"cube-item",staticStyle:{position:"relative"},style:{"background-color":t.isSelect?"#e8f7fd":"",width:e.boxWidth+"px",height:e.boxWidth+"px","line-height":e.boxWidth+"px"},on:{click:function(t){e.handleSelect(s,i)},mouseenter:function(t){e.mouseMove(s,i)}}},[a("span",{staticClass:"el-icon-plus"})])}))})),e._v(" "),a("div",{staticStyle:{display:"none"}},[e._v("\n      "+e._s(e.refash)+"\n    ")]),e._v(" "),e._l(e.boxArr,function(t,s){return a("div",{key:s,staticClass:"click-box",style:{left:t.left*e.boxWidth+t.left+"px",top:t.top*e.boxWidth+t.top+"px",width:(t.endLeft-t.left)*e.boxWidth+(t.endLeft-t.left-1)+"px",height:(t.endTop-t.top)*e.boxWidth+(t.endTop-t.top-1)+"px","z-index":e.selecIndex===s?1:0,border:e.selecIndex===s?"1px solid #1890ff":"1px solid #dcdfe6"},on:{click:function(t){e.selectBox(s)}}},[a("span",{staticClass:"img-size-text"},[e._v("建议"+e._s((750/e.column*(t.endLeft-t.left)).toFixed(0))+"*"+e._s((750/e.column*(t.endTop-t.top)).toFixed(0)))]),e._v(" "),a("img",{staticClass:"upload-img",style:{width:(t.endLeft-t.left)*e.boxWidth+(t.endLeft-t.left-1)+"px",height:(t.endTop-t.top)*e.boxWidth+(t.endTop-t.top-1)+"px"},attrs:{src:t.picURL,alt:""}}),e._v(" "),a("span",{staticClass:"delete-cube-icon el-icon-error",style:{display:e.selecIndex===s?"inline-block":"none"},on:{click:function(t){t.stopPropagation(),e.removeBox(s)}}})])})],2),e._v(" "),a("div",{staticClass:"edit-img-list edit-item"},[a("div",{staticClass:"edit-img-item"},[e._m(0),e._v(" "),a("el-upload",{staticClass:"avatar-uploader",staticStyle:{width:"270px",margin:"15px auto"},attrs:{"show-file-list":!1,action:e.action,"with-credentials":"","on-success":function(t,a,s){return e.cubeUploadSuccess(t,a,s)},"before-upload":e.cubeUploadBefore}},[e.boxArr[e.selecIndex]&&e.boxArr[e.selecIndex].picURL?a("img",{staticClass:"avatar",attrs:{src:e.boxArr[e.selecIndex]?e.boxArr[e.selecIndex].picURL:""}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"edit-img-title"},[t("span",[this._v("图片")])])}]};var kt=a("VU/8")(xt,Lt,!1,function(e){a("x4E0")},null,null).exports,Nt={name:"rightEdit",props:{showEditStatus:{type:Number},obj:{type:Object},changeStatus:{type:Boolean}},data:function(){var e=this;return{mallHeight:document.documentElement.clientHeight-65,imageUrl:"",singleImg:{moduleType:3,pageModule:{picInfo:[{picURL:"",hrefURL:{type:1,displayName:"",mallProId:""}}]}},singleImgRules:{},singleParams:{},doubleImg:{moduleType:4,pageModule:{picInfo:[{picURL:"",hrefURL:{type:"",displayName:"",mallProId:""}},{picURL:"",hrefURL:{type:"",displayName:"",mallProId:""}}]}},doubleImgHeight:"",doubleIndex:-1,doubleParams:{},textTitle:{moduleType:5,pageModule:{titleText:"",hrefUrl:{type:1,displayName:"",mallProId:""}}},textTitleLen:0,textTitleRules:{},textTitleError:"1",swiperPicInfo:[{picURL:""}],swiperImgHeight:"",swiperIndex:1,doubleGoodsList:{moduleType:1,moduleName:"",pageModule:{moduleName:"",moreButtonUrl:{type:0,displayName:"",mallProId:""},choseType:1,proNumber:2,sortCol:"1001",mallCategoryId:"",mallProTagId:null,priceRange:{begin:"",end:""},proKeyword:"",productList:[{mallProId:"",mallProImageUrl:"",proName:"",mallProSpuPrice:""},{mallProId:"",mallProImageUrl:"",proName:"",mallProSpuPrice:""}]}},handleGoodsStatus:!1,mallCategoryName:"",productSelectList:[],doubleNameLen:0,selectGoodsModal:!1,beginValidator:function(t,a,s){Number(a)?""!==e.doubleGoodsList.pageModule.priceRange.end&&Number(a)>Number(e.doubleGoodsList.pageModule.priceRange.end)?s(new Error("最低价格不能高于最高价格")):s():s(new Error("请输入数字"))},endValidator:function(t,a,s){Number(a)?""!==e.doubleGoodsList.pageModule.priceRange.begin&&Number(a)<Number(e.doubleGoodsList.pageModule.priceRange.begin)?s(new Error("最高价格不能低于最价格")):s():s(new Error("请输入数字"))},mallProTag:[],swiperImg:{moduleType:2,pageModule:{moduleType:2,picInfo:[{picURL:"",hrefURL:{type:"",displayName:"",mallProId:""}}]}},swiperLinkIndex:-1,swiperImgRules:{},swiperParams:{},cateModal:!1,linkModal:!1,action:window.location.origin+"/api-plug/upload-img?requestProject=mall",assistBlank:{moduleType:7,setting:{height:20},pageModule:{}},blankRules:{},cubeForm:{moduleType:8,setting:{row:3,column:3},pageModule:{picInfo:[{picURL:"",hrefURL:{type:1,displayName:"",mallProId:""},zb:""}]}},selectCubeIndex:0,cubeLinkIndex:0,cubeLink:[],boxPosition:[],refash:!1,selectAll:!0,boxMsg:[],isNew:!1}},watch:{changeStatus:function(){this.textTitleError="1",1===this.showEditStatus?(this.getGoodsCate(),this.doubleGoodsList=he(this.obj),2===this.doubleGoodsList.pageModule.choseType&&(this.handleGoodsStatus=!0,this.productSelectList=this.doubleGoodsList.pageModule.productList),this.doubleNameLen=C.getZhLen(this.doubleGoodsList.pageModule.moduleName)):2===this.showEditStatus?(this.swiperImgHeight="",this.swiperImg=he(this.obj)):3===this.showEditStatus?this.singleImg=he(this.obj):4===this.showEditStatus?(this.doubleImgHeight="",this.doubleImg=he(this.obj)):5===this.showEditStatus?(this.textTitle=he(this.obj),this.textTitleLen=C.getZhLen(this.textTitle.pageModule.titleText)):7===this.showEditStatus?this.assistBlank=he(this.obj):8===this.showEditStatus&&(this.cubeLinkIndex=0,this.cubeForm=he(this.obj),this.cubeFormCopy=he(this.obj),""!==this.cubeForm.pageModule.picInfo[0].picURL?(this.isNew=!1,this.boxMsg=this.cubeForm.pageModule.picInfo.map(function(e){var t=e.zb.split(","),a=[],s=!0,i=!1,r=void 0;try{for(var o,l=b()(t);!(s=(o=l.next()).done);s=!0){var n=o.value;a=[].concat(gt()(a),gt()(n.split(".")))}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}return{left:Number(a[0]),top:Number(a[1]),endLeft:Number(a[2]),endTop:Number(a[3]),picURL:e.picURL,hrefURL:e.hrefURL}}),this.cubeLink=this.cubeForm.pageModule.picInfo.map(function(e){return{hrefURL:e.hrefURL}})):(this.boxMsg=[],this.isNew=!0))}},created:function(){var e="0.8,2.10".split(","),t=[],a=!0,s=!1,i=void 0;try{for(var r,o=b()(e);!(a=(r=o.next()).done);a=!0){var l=r.value;t=[].concat(gt()(t),gt()(l.split(".")))}}catch(e){s=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw i}}},computed:{},methods:{getGoodsCate:function(){var e=this;A.get("/api-mall/list_mall_goods_tag_tree").then(function(t){e.mallProTag=[],0===t.data.errorCode?(e.mallProTag.push({childTagList:t.data.result.childTagList,mallProTagId:t.data.result.mallProTagId,tagName:t.data.result.tagName}),e.getTree(e.mallProTag)):e.$message.error(t.data.message)})},getTree:function(e){for(var t in e)e[t].label=e[t].tagName,e[t].id=e[t].mallProTagId,e[t].children=e[t].childTagList,e[t].children?this.getTree(e[t].children):delete e[t].children},doubleNameLimit:function(e){var t=this;this.$nextTick(function(){t.doubleGoodsList.pageModule.moduleName=C.getInputVal(e,20),t.doubleNameLen=C.getZhLen(t.doubleGoodsList.pageModule.moduleName)})},saveDoubleGoods:function(e){var t=this;if(1==this.doubleGoodsList.pageModule.choseType){this.handleGoodsStatus=!1,this.doubleGoodsList.pageModule.productList=[];var a={mallCategoryId:this.doubleGoodsList.pageModule.mallCategoryId,mallProTagId:this.doubleGoodsList.pageModule.mallProTagId,begin:this.doubleGoodsList.pageModule.priceRange.begin,end:this.doubleGoodsList.pageModule.priceRange.end,searchName:this.doubleGoodsList.pageModule.proKeyword,sort:this.doubleGoodsList.pageModule.sortCol,size:this.doubleGoodsList.pageModule.proNumber};A.get("/api-mall/list_or_save_goods_for_mallpage",{params:a}).then(function(e){if(0===e.data.errorCode){if(!e.data.result.list.length)return t.$message.error("暂无推荐的商品"),!1;for(var a in e.data.result.list)t.doubleGoodsList.pageModule.productList.push({proName:e.data.result.list[a].proName,mallProSpuPrice:e.data.result.list[a].mallProSpuPrice,mallProImageUrl:e.data.result.list[a].mallProImageUrl,mallProId:e.data.result.list[a].mallProId})}else t.$message.error(e.data.message)})}else{for(var s in this.doubleGoodsList.pageModule.productList=[],this.productSelectList)this.doubleGoodsList.pageModule.productList.push({proName:this.productSelectList[s].proName,mallProSpuPrice:this.productSelectList[s].mallProSpuPrice,mallProImageUrl:this.productSelectList[s].mallProImageUrl,mallProId:this.productSelectList[s].mallProId,proCode:this.productSelectList[s].proCode});this.handleGoodsStatus=!0}""===this.doubleGoodsList.pageModule.moreButtonUrl.mallProId&&(this.doubleGoodsList.pageModule.moreButtonUrl={}),this.$emit("getEditMess",this.doubleGoodsList),this.$refs.selectchild.handleDate()},cancelSaveDoubleGoods:function(){this.doubleGoodsList.pageModule.moduleName="",this.doubleGoodsList.pageModule.moreButtonUrl.type="",this.doubleGoodsList.pageModule.moreButtonUrl.displayName="",this.doubleGoodsList.pageModule.moreButtonUrl.displayName="",this.doubleGoodsList.pageModule.choseType=1,this.doubleGoodsList.pageModule.proNumber=2,this.doubleGoodsList.pageModule.sortCol="1001",this.doubleGoodsList.pageModule.mallCategoryId="",this.doubleGoodsList.pageModule.mallProTagId=null,this.doubleGoodsList.pageModule.priceRange.begin="",this.doubleGoodsList.pageModule.priceRange.end="",this.doubleGoodsList.pageModule.proKeyword="",this.doubleGoodsList.pageModule.productList=[],this.$emit("getEditMess",this.doubleGoodsList)},getCateMess:function(e){this.mallCategoryName=e.categoryName,this.doubleGoodsList.pageModule.mallCategoryId=e.categoryId},selectCate:function(){this.cateModal=!0},cancelCateModal:function(){this.cateModal=!1},selectGoods:function(){this.selectGoodsModal=!0},cancelSelectGoodsModal:function(){this.selectGoodsModal=!1},moreLink1:function(){this.linkModal=!0},cancelLinkModal:function(){this.linkModal=!1},getLinkMess:function(e){if(1===this.showEditStatus&&(this.doubleGoodsList.pageModule.moreButtonUrl=e),2===this.showEditStatus){if(-1===this.swiperLinkIndex)return!1;this.swiperImg.pageModule.picInfo[this.swiperLinkIndex].hrefURL=e,this.swiperImg.pageModule.picInfo=he(this.swiperImg.pageModule.picInfo)}if(3===this.showEditStatus&&(this.singleImg.pageModule.picInfo[0].hrefURL=e),4===this.showEditStatus){if(-1===this.doubleIndex)return!1;this.doubleImg.pageModule.picInfo[this.doubleIndex].hrefURL=e,this.doubleImg.pageModule.picInfo=he(this.doubleImg.pageModule.picInfo)}if(5===this.showEditStatus&&(this.textTitle.pageModule.hrefUrl=e),8===this.showEditStatus){if(-1===this.selectCubeIndex)return!1;this.cubeForm.pageModule.picInfo[this.selectCubeIndex].hrefURL=e,this.cubeForm.pageModule.picInfo=he(this.cubeForm.pageModule.picInfo),this.cubeLink[this.cubeLinkIndex]=e,this.cubeLink=he(this.cubeLink)}},getSelectGoods:function(e){this.productSelectList=e},addSwiper:function(){if(this.swiperImg.pageModule.picInfo.length>=10)return this.$message.error("最多添加10张图片"),!1;this.swiperImg.pageModule.picInfo.push({picURL:"",hrefURL:{}})},swiperUploadBefore:function(e){if("image/jpeg"!==e.type&&"image/png"!==e.type&&"image/jpg"!==e.type&&"image/gif"!==e.type)return this.$message.error("请上传jpg，png格式的图片"),this.swiperImgHeight="",!1;if(e.size>3145728)return this.$message.error("图片大小请控制在3M内"),!1;var t=this;return new S.a(function(a,s){var i=new FileReader;i.onload=function(e){var i=new Image;i.onload=function(){var e=this.width,i=this.height;t.swiperParams={width:e,height:i},""===t.swiperImg.pageModule.picInfo[0].picURL&&""===t.swiperImgHeight&&(t.swiperImgHeight=i),t.swiperImg.pageModule.picInfo[0].picURL&&(t.swiperImgHeight=t.imgHeight(t.swiperImg.pageModule.picInfo[0].picURL)),1===t.swiperImg.pageModule.picInfo.length&&(t.swiperImgHeight=""),(e<750||i<100||i>1500)&&(t.$message.error("请上传正确的图片尺寸"),t.swiperImgHeight="",s()),""!==t.swiperImgHeight&&i!==t.swiperImgHeight&&(t.$message.error("请上传相同高度的图片"),s()),a()},i.src=e.target.result},i.readAsDataURL(e)})},swiperUploadSuccess:function(e,t,a,s){0===e.errorCode?(this.swiperImg.pageModule.picInfo[s].picURL=e.result[0].qcloudImageUrl,this.swiperImg.pageModule.picInfo[s].width=this.swiperParams.width,this.swiperImg.pageModule.picInfo[s].height=this.swiperParams.height,this.swiperImg.pageModule.picInfo[s].hrefURL={},this.$message.success("上传成功"),this.getChangePutStatus(!1)):this.$message.error(e.message)},deleteImg:function(e){if(1==this.swiperImg.pageModule.picInfo.length)return this.$message.error("不能再减少了"),!1;this.swiperImg.pageModule.picInfo.splice(e,1)},moveUp:function(e){this.moveItem(this.swiperImg.pageModule.picInfo,e,e+1)},moveDown:function(e){this.moveItem(this.swiperImg.pageModule.picInfo,e,e-1)},moveItem:function(e,t,a){return e[t]=e.splice(a,1,e[t])[0],e},moreLink2:function(e){this.linkModal=!0,this.swiperLinkIndex=e},saveSwiperImg:function(e){if(this.swiperImg.pageModule.picInfo.every(function(e){e.picURL}))return this.$message.error("请上传图片"),!1;this.$emit("getEditMess",this.swiperImg),this.getChangePutStatus(!0)},cancelSaveSwiperImg:function(){for(var e in this.swiperImg.pageModule.picInfo)this.swiperImg.pageModule.picInfo[e].picURL="",this.swiperImg.pageModule.picInfo[e].hrefURL={}},singleUploadSuccess:function(e,t,a,s){0===e.errorCode?(this.singleImg.pageModule.picInfo[s].picURL=e.result[0].qcloudImageUrl,this.singleImg.pageModule.picInfo[s].width=this.singleParams.width,this.singleImg.pageModule.picInfo[s].height=this.singleParams.height,this.$message.success("上传成功"),this.getChangePutStatus(!1)):this.$message.error(e.message)},singleloadBefore:function(e){if("image/jpeg"!==e.type&&"image/png"!==e.type&&"image/jpg"!==e.type&&"image/gif"!==e.type)return this.$message.error("请上传jpg，png格式的图片"),!1;if(e.size>3145728)return this.$message.error("图片大小请控制在3M内"),!1;var t=this;return new S.a(function(a,s){var i=new FileReader;i.onload=function(e){var i=new Image;i.onload=function(){var e=this.width,i=this.height;t.singleParams={width:e,height:i},(e<750||i<100||i>1500)&&(t.$message.error("请上传正确的图片尺寸"),s()),a()},i.src=e.target.result},i.readAsDataURL(e)})},moreLink3:function(){this.linkModal=!0},saveSingalImg:function(){""!==this.singleImg.pageModule.picInfo[0].picURL?(""===this.singleImg.pageModule.picInfo[0].hrefURL.pageId&&(this.singleImg.pageModule.picInfo[0].hrefURL={}),this.$emit("getEditMess",this.singleImg),this.getChangePutStatus(!0)):this.$message.error("请上传图片")},cancelSaveSingalImg:function(){this.singleImg.pageModule.picInfo[0].picURL="",this.singleImg.pageModule.picInfo[0].hrefURL={}},doubleUploadSuccess:function(e,t,a,s){0===e.errorCode?(this.doubleImg.pageModule.picInfo[s].picURL=e.result[0].qcloudImageUrl,this.doubleImg.pageModule.picInfo[s].width=this.doubleParams.width,this.doubleImg.pageModule.picInfo[s].height=this.doubleParams.height,this.$message.success("上传成功"),this.getChangePutStatus(!1)):this.$message.error(e.message)},doubleloadBefore:function(e){if("image/jpeg"!==e.type&&"image/png"!==e.type&&"image/jpg"!==e.type&&"image/gif"!==e.type)return this.$message.error("请上传jpg，png格式的图片"),this.doubleImgHeight="",!1;if(e.size>3145728)return this.$message.error("图片大小请控制在3M内"),!1;var t=this;return new S.a(function(a,s){var i=new FileReader;i.onload=function(e){var i=new Image;i.onload=function(){var e=this.width,i=this.height;t.doubleParams={width:e,height:i},""===t.doubleImg.pageModule.picInfo[0].picURL&&""===t.doubleImgHeight&&(t.doubleImgHeight=i),t.doubleImg.pageModule.picInfo[0].picURL&&(t.doubleImgHeight=t.imgHeight(t.doubleImg.pageModule.picInfo[0].picURL)),1===t.doubleImg.pageModule.picInfo.length&&(t.doubleImgHeight=""),(e<350||i<100||i>1e3)&&(t.$message.error("请上传正确的图片尺寸"),t.doubleImgHeight="",s()),""!==t.doubleImgHeight&&i!==t.doubleImgHeight&&(t.$message.error("请上传相同高度的图片"),s()),a()},i.src=e.target.result},i.readAsDataURL(e)})},imgHeight:function(e){var t=new Image;return t.src=e,t.height},moreLink4:function(e){this.doubleIndex=e,this.linkModal=!0},saveDoubleImg:function(){for(var e in this.doubleImg.pageModule.picInfo)if(""===this.doubleImg.pageModule.picInfo[e].picURL)return this.$message.error("请上传图片"),!1;for(var t in this.doubleImg.pageModule.picInfo)""===this.doubleImg.pageModule.picInfo[t].hrefURL.pageId&&(this.doubleImg.pageModule.picInfo[t].hrefURL={});this.$emit("getEditMess",this.doubleImg),this.getChangePutStatus(!0)},cancelSaveDoubleImg:function(){for(var e in this.doubleImg.pageModule.picInfo)this.doubleImg.pageModule.picInfo[e].picURL="",this.doubleImg.pageModule.picInfo[e].hrefURL={}},textTitleLimit:function(e){var t=this;this.$nextTick(function(){t.textTitle.pageModule.titleText=C.getInputVal(e,20),t.textTitleLen=C.getZhLen(t.textTitle.pageModule.titleText)})},moreLink5:function(){this.linkModal=!0},textTitleBlur:function(){if(""===this.textTitle.pageModule.titleText)return this.textTitleError="0",!1;this.textTitleError="1"},saveTextTitle:function(){""===this.textTitle.pageModule.hrefUrl.mallProId&&(this.textTitle.pageModule.hrefUrl={}),""===this.textTitle.pageModule.titleText?this.textTitleError="0":this.textTitleError="1",this.textTitle.pageModule.titleText,this.$emit("getEditMess",this.textTitle)},cancelSaveTextTitle:function(){this.textTitle.pageModule.titleText="",this.textTitle.pageModule.hrefUrl={}},blankBlur:function(){var e=this;this.assistBlank.setting.height||this.$nextTick(function(){e.assistBlank.setting.height=10}),this.assistBlank.setting.height>30&&(this.$message.error("辅助空白最多30px"),this.$nextTick(function(){e.assistBlank.setting.height=30}))},saveBlank:function(){this.assistBlank.pageModule={},this.$emit("getEditMess",this.assistBlank)},cancelBlank:function(){this.assistBlank.setting.height=20},getBoxIndex:function(e){this.selectCubeIndex=Number(e)},getBoxArr:function(e,t){this.selectCubeIndex=t,this.cubeLinkIndex=t,this.cubeForm.pageModule.picInfo[t]=e,e.hrefURL?this.cubeLink[t]=e.hrefURL:this.cubeLink[t]={type:1,displayName:"",mallProId:""},this.refash=!this.refash,e.endLeft-e.left&&""===e.picURL&&this.getChangePutStatus(!1)},removeBoxArr:function(e){this.cubeForm.pageModule.picInfo.splice(e,1),this.cubeLink.splice(e,1);var t=this.cubeForm.pageModule.picInfo.some(function(e){return e.hasOwnProperty("left")});this.isNew&&!this.cubeForm.pageModule.picInfo.length&&(t=!0),this.getChangePutStatus(t)},moreLink6:function(){this.linkModal=!0},changeColumn:function(){this.boxMsg=[],this.cubeForm.pageModule.picInfo=[]},changeRow:function(){this.boxMsg=[],this.cubeForm.pageModule.picInfo=[]},getSelectAll:function(e){this.selectAll=e},saveCube:function(){var e=[];if(!this.selectAll)return this.$message.error("布局区域的列必须全部填充"),!1;var t=!0,a=!1,s=void 0;try{for(var i,r=b()(this.cubeForm.pageModule.picInfo);!(t=(i=r.next()).done);t=!0){var o=i.value,l=o.left+"."+o.top+","+o.endLeft+"."+o.endTop;o.hrefURL?e.push({picURL:o.picURL,hrefURL:o.hrefURL,zb:o.zb?o.zb:l}):e.push({picURL:o.picURL,hrefURL:{},zb:o.zb?o.zb:l})}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}if(this.cubeForm.pageModule.picInfo=e,this.cubeForm.pageModule.picInfo.some(function(e){return""===e.picURL}))return this.$message.error("请上传图片"),!1;this.$emit("getEditMess",this.cubeForm),this.getChangePutStatus(!0)},cancelCube:function(){this.boxMsg=[],this.cubeForm.pageModule.picInfo=[],this.cubeForm.setting.column=3,this.cubeForm.setting.row=3},getChangePutStatus:function(e){this.$emit("changePutStatus",e)}},components:{Treeselect:ce.a,selecGoods:Ct,linkModal:wt,cateModal:bt,cubeBox:kt}},Tt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-decoration-container"},[a("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refash))]),e._v(" "),1===e.showEditStatus?a("el-form",{ref:"doubleGoodsList",attrs:{"label-position":"left",model:e.doubleGoodsList}},[a("div",{staticClass:"edit-double-goods"},[a("h3",[e._v("双列商品")]),e._v(" "),a("el-form-item",{staticClass:"edit-item"},[a("p",{staticClass:"title"},[e._v("标题")]),e._v(" "),a("el-input",{staticClass:"w-360",on:{input:function(t){return e.doubleNameLimit(t)}},model:{value:e.doubleGoodsList.pageModule.moduleName,callback:function(t){e.$set(e.doubleGoodsList.pageModule,"moduleName",t)},expression:"doubleGoodsList.pageModule.moduleName"}},[a("span",{staticStyle:{"margin-left":"15px"},attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.doubleNameLen)+"/20")])])],1),e._v(" "),a("el-form-item",{staticClass:"edit-item"},[a("p",{staticClass:"title"},[e._v("更多链接")]),e._v(" "),a("div",{staticClass:"link-content"},[a("p",{staticClass:"link-box"},[a("span",{staticClass:"link-text"},[e._v(e._s(e.doubleGoodsList.pageModule.moreButtonUrl.displayName))]),e._v(" "),a("el-button",{staticStyle:{"border-radius":"0px"},attrs:{type:"primary",icon:"iconfont icon-lianjie"},on:{click:e.moreLink1}})],1)])]),e._v(" "),a("el-form-item",{staticClass:"edit-item"},[a("p",{staticClass:"title"},[e._v("商品数量")]),e._v(" "),a("el-select",{staticClass:"w-360",attrs:{placeholder:"2"},model:{value:e.doubleGoodsList.pageModule.proNumber,callback:function(t){e.$set(e.doubleGoodsList.pageModule,"proNumber",t)},expression:"doubleGoodsList.pageModule.proNumber"}},[a("el-option",{attrs:{label:"2",value:2}}),e._v(" "),a("el-option",{attrs:{label:"4",value:4}}),e._v(" "),a("el-option",{attrs:{label:"6",value:6}}),e._v(" "),a("el-option",{attrs:{label:"8",value:8}}),e._v(" "),a("el-option",{attrs:{label:"10",value:10}}),e._v(" "),a("el-option",{attrs:{label:"12",value:12}}),e._v(" "),a("el-option",{attrs:{label:"14",value:14}}),e._v(" "),a("el-option",{attrs:{label:"16",value:16}}),e._v(" "),a("el-option",{attrs:{label:"18",value:18}}),e._v(" "),a("el-option",{attrs:{label:"20",value:20}})],1)],1),e._v(" "),a("el-form-item",{staticClass:"edit-item",attrs:{label:"推荐类型","label-width":"100px"}},[a("el-radio",{attrs:{label:1},model:{value:e.doubleGoodsList.pageModule.choseType,callback:function(t){e.$set(e.doubleGoodsList.pageModule,"choseType",t)},expression:"doubleGoodsList.pageModule.choseType"}},[e._v("自动推荐")]),e._v(" "),a("el-radio",{attrs:{label:2},model:{value:e.doubleGoodsList.pageModule.choseType,callback:function(t){e.$set(e.doubleGoodsList.pageModule,"choseType",t)},expression:"doubleGoodsList.pageModule.choseType"}},[e._v("手动推荐")])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1==e.doubleGoodsList.pageModule.choseType,expression:"doubleGoodsList.pageModule.choseType == 1"}],staticClass:"edit-item"},[a("el-form-item",[a("p",{staticClass:"title"},[e._v("排序规则")]),e._v(" "),a("el-select",{staticClass:"w-360",attrs:{placeholder:"销量从高到低"},model:{value:e.doubleGoodsList.pageModule.sortCol,callback:function(t){e.$set(e.doubleGoodsList.pageModule,"sortCol",t)},expression:"doubleGoodsList.pageModule.sortCol"}},[a("el-option",{attrs:{label:"销量从高到低",value:"1001"}}),e._v(" "),a("el-option",{attrs:{label:"上架时间从近到远",value:"1002"}}),e._v(" "),a("el-option",{attrs:{label:"价格从低到高",value:"1003"}})],1)],1),e._v(" "),a("el-form-item",[a("p",{staticClass:"title"},[e._v("商品品类")]),e._v(" "),""!==e.doubleGoodsList.pageModule.mallCategoryId?a("el-button",{staticClass:"w-355",on:{click:e.selectCate}},[e._v(e._s(e.mallCategoryName))]):a("el-button",{staticClass:"w-355",on:{click:e.selectCate}},[e._v("选择商品品类")])],1),e._v(" "),a("el-form-item",[a("p",{staticClass:"title"},[e._v("商品分类")]),e._v(" "),a("treeselect",{staticClass:"w-355",attrs:{multiple:!1,options:e.mallProTag,placeholder:"所有分类"},model:{value:e.doubleGoodsList.pageModule.mallProTagId,callback:function(t){e.$set(e.doubleGoodsList.pageModule,"mallProTagId",t)},expression:"doubleGoodsList.pageModule.mallProTagId"}})],1),e._v(" "),a("el-form-item",[a("p",{staticClass:"title"},[e._v("价格范围")]),e._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"pageModule.priceRange.begin",rules:[{type:"number",validator:e.beginValidator,trigger:"blur"}]}},[a("el-input",{staticStyle:{width:"170px"},attrs:{type:"text"},model:{value:e.doubleGoodsList.pageModule.priceRange.begin,callback:function(t){e.$set(e.doubleGoodsList.pageModule.priceRange,"begin",t)},expression:"doubleGoodsList.pageModule.priceRange.begin"}})],1)],1),e._v(" "),a("el-col",{staticClass:"line",attrs:{span:2}},[e._v("-")]),e._v(" "),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"pageModule.priceRange.end",rules:[{type:"number",validator:e.endValidator,trigger:"blur"}]}},[a("el-input",{staticStyle:{width:"170px"},attrs:{type:"text"},model:{value:e.doubleGoodsList.pageModule.priceRange.end,callback:function(t){e.$set(e.doubleGoodsList.pageModule.priceRange,"end",t)},expression:"doubleGoodsList.pageModule.priceRange.end"}})],1)],1)],1),e._v(" "),a("el-form-item",[a("p",{staticClass:"title"},[e._v('关键词(多个关键词用"#"分隔)')]),e._v(" "),a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:e.doubleGoodsList.pageModule.proKeyword,callback:function(t){e.$set(e.doubleGoodsList.pageModule,"proKeyword",t)},expression:"doubleGoodsList.pageModule.proKeyword"}})],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:2==e.doubleGoodsList.pageModule.choseType,expression:"doubleGoodsList.pageModule.choseType == 2"}],staticClass:"edit-item"},[e._l(e.doubleGoodsList.pageModule.productList,function(t,s){return a("div",{directives:[{name:"show",rawName:"v-show",value:e.handleGoodsStatus&&2==e.doubleGoodsList.pageModule.choseType,expression:"handleGoodsStatus && doubleGoodsList.pageModule.choseType == 2"}],key:s,staticClass:"img-text"},[a("img",{attrs:{src:t.mallProImageUrl}}),e._v(" "),a("div",{staticClass:"text"},[a("p",{staticClass:"pro-name"},[e._v(e._s(t.proName))]),e._v(" "),a("p",{staticClass:"pro-code"},[e._v("货号:"+e._s(t.proCode))]),e._v(" "),a("p",{staticClass:"pro-price"},[e._v("￥"+e._s(t.mallProSpuPrice))])])])}),e._v(" "),a("el-form-item",[a("div",{staticClass:"add-img",on:{click:e.selectGoods}},[a("i",{staticClass:"el-icon-plus"}),e._v(" "),a("span",[e._v("添加商品")]),e._v(" "),a("span",{staticClass:"add-num"},[e._v(e._s(e.doubleGoodsList.pageModule.productList.length)+"/"+e._s(e.doubleGoodsList.pageModule.proNumber))])])])],2),e._v(" "),a("div",{staticClass:"height60"}),e._v(" "),a("div",{staticClass:"bottom-btn",staticStyle:{"text-align":"center","margin-top":"30px"}},[a("span",{on:{click:e.saveDoubleGoods}},[e._v("保存")]),e._v(" "),a("span",{on:{click:e.cancelSaveDoubleGoods}},[e._v("重置")])])],1)]):e._e(),e._v(" "),2===e.showEditStatus?a("el-form",{attrs:{"label-position":"left"}},[a("div",{staticClass:"edit-img-content"},[a("h3",[e._v("轮播图片")]),e._v(" "),a("div",{staticClass:"edit-img-list edit-item"},[e._l(e.swiperImg.pageModule.picInfo,function(t,s){return a("div",{key:s,staticClass:"edit-img-item"},[a("div",{staticClass:"edit-img-title"},[a("span",[e._v("图片")]),e._v(" "),a("div",{staticClass:"img-move"},[a("p",{directives:[{name:"show",rawName:"v-show",value:0!==s,expression:"index !== 0"}],staticClass:"move-box",on:{click:function(t){e.moveDown(s)}}},[a("i",{staticClass:"el-icon-arrow-up"})]),e._v(" "),a("p",{directives:[{name:"show",rawName:"v-show",value:s!==e.swiperImg.pageModule.picInfo.length-1,expression:"index !== swiperImg.pageModule.picInfo.length - 1"}],staticClass:"move-box",on:{click:function(t){e.moveUp(s)}}},[a("i",{staticClass:"el-icon-arrow-down"})]),e._v(" "),a("p",{directives:[{name:"show",rawName:"v-show",value:0!==s,expression:"index !== 0"}],staticClass:"move-box delete-move",on:{click:function(t){e.deleteImg(s)}}},[a("i",{staticClass:"el-icon-close"})])])]),e._v(" "),a("el-upload",{staticClass:"avatar-uploader",staticStyle:{width:"270px",margin:"15px auto"},attrs:{"show-file-list":!1,action:e.action,"with-credentials":"","on-success":function(t,a,i){return e.swiperUploadSuccess(t,a,i,s)},"before-upload":e.swiperUploadBefore}},[t.picURL?a("img",{staticClass:"avatar",attrs:{src:t.picURL}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),a("p",{staticClass:"img-warm"},[e._v("图片宽度大于等于750px，高度在100x~1500px之间，格式为：jpg、png，要求一组的图片高度必须完全一致")]),e._v(" "),a("div",{staticClass:"link-content"},[a("p",{staticClass:"link-box"},[a("span",{staticClass:"link-text"},[e._v(e._s(e.swiperImg.pageModule.picInfo[s].hrefURL.displayName))]),e._v(" "),a("el-button",{staticStyle:{"border-radius":"0px"},attrs:{type:"primary",icon:"iconfont icon-lianjie"},on:{click:function(t){e.moreLink2(s)}}}),e._v("\n              }\n            ")],1)])],1)}),e._v(" "),a("div",{staticClass:"add-img",on:{click:e.addSwiper}},[a("i",{staticClass:"el-icon-plus"}),e._v(" "),a("span",[e._v("添加图片")]),e._v(" "),a("span",{staticClass:"add-num"},[e._v(e._s(e.swiperImg.pageModule.picInfo.length)+"/10")])])],2),e._v(" "),a("div",{staticClass:"height60"}),e._v(" "),a("div",{staticClass:"bottom-btn",staticStyle:{"text-align":"center","margin-top":"30px"}},[a("span",{on:{click:function(t){e.saveSwiperImg("swiperImg")}}},[e._v("保存")]),e._v(" "),a("span",{on:{click:e.cancelSaveSwiperImg}},[e._v("重置")])])])]):e._e(),e._v(" "),3===e.showEditStatus?a("el-form",{attrs:{"label-position":"left"}},[a("div",{staticClass:"edit-img-content"},[a("h3",[e._v("单列图片")]),e._v(" "),a("div",{staticClass:"edit-img-list edit-item"},e._l(e.singleImg.pageModule.picInfo,function(t,s){return a("div",{key:s,staticClass:"edit-img-item"},[a("div",{staticClass:"edit-img-title"},[a("span",[e._v("图片")])]),e._v(" "),a("el-upload",{staticClass:"avatar-uploader",staticStyle:{width:"270px",margin:"15px auto"},attrs:{"show-file-list":!1,action:e.action,"with-credentials":"","on-success":function(t,a,i){return e.singleUploadSuccess(t,a,i,s)},"before-upload":e.singleloadBefore}},[t.picURL?a("img",{staticClass:"avatar",attrs:{src:t.picURL}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),a("p",{staticClass:"img-warm"},[e._v("图片宽度大于等于750px，高度在100x~1500px之间，格式为：jpg、png")]),e._v(" "),a("div",{staticClass:"link-content"},[a("p",{staticClass:"link-box"},[a("span",{staticClass:"link-text"},[e._v(e._s(e.singleImg.pageModule.picInfo[s].hrefURL.displayName))]),e._v(" "),a("el-button",{staticStyle:{"border-radius":"0px"},attrs:{type:"primary",icon:"iconfont icon-lianjie"},on:{click:e.moreLink3}})],1)])],1)})),e._v(" "),a("div",{staticClass:"bottom-btn",staticStyle:{"text-align":"center","margin-top":"30px"}},[a("span",{on:{click:e.saveSingalImg}},[e._v("保存")]),e._v(" "),a("span",{on:{click:e.cancelSaveSingalImg}},[e._v("重置")])])])]):e._e(),e._v(" "),4===e.showEditStatus?a("el-form",[a("div",{staticClass:"edit-img-content"},[a("h3",[e._v("双列图片")]),e._v(" "),a("div",{staticClass:"edit-img-list edit-item"},e._l(e.doubleImg.pageModule.picInfo,function(t,s){return a("div",{key:s,staticClass:"edit-img-item"},[a("div",{staticClass:"edit-img-title"},[a("span",0===s?[e._v("第一张图片")]:[e._v("第二张图片")])]),e._v(" "),a("el-upload",{staticClass:"avatar-uploader",staticStyle:{width:"270px",margin:"15px auto"},attrs:{action:e.action,"show-file-list":!1,"with-credentials":"","on-success":function(t,a,i){return e.doubleUploadSuccess(t,a,i,s)},"before-upload":e.doubleloadBefore}},[t.picURL?a("img",{staticClass:"avatar",attrs:{src:t.picURL}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),a("p",{staticClass:"img-warm"},[e._v("图片宽度大于等于350px，高度在100x~1000px之间，格式为：jpg、png，要求一组内的图片高度必须完全一致")]),e._v(" "),a("div",{staticClass:"link-content"},[a("p",{staticClass:"link-box"},[a("span",{staticClass:"link-text"},[e._v(e._s(e.doubleImg.pageModule.picInfo[s].hrefURL.displayName))]),e._v(" "),a("el-button",{staticStyle:{"border-radius":"0px"},attrs:{type:"primary",icon:"iconfont icon-lianjie"},on:{click:function(t){e.moreLink4(s)}}})],1)])],1)})),e._v(" "),a("div",{staticClass:"height60"}),e._v(" "),a("div",{staticClass:"bottom-btn",staticStyle:{"text-align":"center","margin-top":"30px"}},[a("span",{on:{click:e.saveDoubleImg}},[e._v("保存")]),e._v(" "),a("span",{on:{click:e.cancelSaveDoubleImg}},[e._v("重置")])])])]):e._e(),e._v(" "),5===e.showEditStatus?a("el-form",{ref:"textTitle",attrs:{model:e.textTitle,rules:e.textTitleRules}},[a("div",{staticClass:"edit-text"},[a("h3",[e._v("文本标题")]),e._v(" "),a("el-form-item",{class:"0"===e.textTitleError?"is-error":"",attrs:{prop:"pageModule.titleText"}},[a("p",{staticClass:"title"},[e._v("标题")]),e._v(" "),a("el-input",{staticClass:"w-360",on:{input:function(t){return e.textTitleLimit(t)},blur:e.textTitleBlur},model:{value:e.textTitle.pageModule.titleText,callback:function(t){e.$set(e.textTitle.pageModule,"titleText",t)},expression:"textTitle.pageModule.titleText"}},[a("span",{staticStyle:{"margin-left":"15px"},attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.textTitleLen)+"/20")])]),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"0"===e.textTitleError,expression:"textTitleError === '0'"}],staticStyle:{position:"absolute","margin-top":"5px","font-size":"12px",color:"#f5222d","line-height":"1.2",display:"block"}},[e._v("请输入文本标题")])],1),e._v(" "),a("el-form-item",[a("p",{staticClass:"title"},[e._v("链接")]),e._v(" "),a("div",{staticClass:"link-content"},[a("p",{staticClass:"link-box"},[a("span",{staticClass:"link-text"},[e._v(e._s(e.textTitle.pageModule.hrefUrl.displayName))]),e._v(" "),a("el-button",{staticStyle:{"border-radius":"0px"},attrs:{type:"primary",icon:"iconfont icon-lianjie"},on:{click:e.moreLink5}})],1)])])],1),e._v(" "),a("div",{staticClass:"bottom-btn",staticStyle:{"text-align":"center","margin-top":"30px"}},[a("span",{on:{click:e.saveTextTitle}},[e._v("保存")]),e._v(" "),a("span",{on:{click:e.cancelSaveTextTitle}},[e._v("重置")])])]):e._e(),e._v(" "),6===e.showEditStatus?a("div",{staticClass:"edit-line"},[a("h3",[e._v("辅助线")]),e._v(" "),a("div",[e._v("该模块不可编辑")])]):e._e(),e._v(" "),7===e.showEditStatus?a("el-form",{attrs:{model:e.assistBlank,rules:e.blankRules}},[a("div",{staticClass:"edit-blank"},[a("h3",[e._v("辅助空白")]),e._v(" "),a("el-form-item",{staticClass:"edit-item",attrs:{prop:"setting.height"}},[a("p",{staticClass:"title"},[e._v("高度")]),e._v(" "),a("el-input-number",{staticClass:"w-320",attrs:{min:1,max:30},on:{blur:e.blankBlur},model:{value:e.assistBlank.setting.height,callback:function(t){e.$set(e.assistBlank.setting,"height",t)},expression:"assistBlank.setting.height"}}),e._v(" "),a("p",{staticStyle:{color:"#909399"}},[e._v("区间范围在10~30px")])],1)],1),e._v(" "),a("div",{staticClass:"bottom-btn",staticStyle:{"text-align":"center","margin-top":"30px"}},[a("span",{on:{click:e.saveBlank}},[e._v("保存")]),e._v(" "),a("span",{on:{click:e.cancelBlank}},[e._v("重置")])])]):e._e(),e._v(" "),8===e.showEditStatus?a("el-form",{attrs:{model:e.cubeForm}},[a("div",{staticClass:"edit-cube"},[a("h3",[e._v("魔方")]),e._v(" "),a("el-form-item",{staticClass:"edit-item"},[a("p",{staticClass:"title"},[e._v("魔方列数")]),e._v(" "),a("el-select",{staticClass:"w-330",attrs:{placeholder:"请选择列数"},on:{change:e.changeColumn},model:{value:e.cubeForm.setting.column,callback:function(t){e.$set(e.cubeForm.setting,"column",t)},expression:"cubeForm.setting.column"}},[a("el-option",{attrs:{label:"3",value:3}}),e._v(" "),a("el-option",{attrs:{label:"4",value:4}})],1)],1),e._v(" "),a("el-form-item",{staticClass:"edit-item"},[a("p",{staticClass:"title"},[e._v("魔方行数")]),e._v(" "),a("el-select",{staticClass:"w-330",attrs:{placeholder:"请选择行数"},on:{change:e.changeRow},model:{value:e.cubeForm.setting.row,callback:function(t){e.$set(e.cubeForm.setting,"row",t)},expression:"cubeForm.setting.row"}},[a("el-option",{attrs:{label:"1",value:1}}),e._v(" "),a("el-option",{attrs:{label:"2",value:2}}),e._v(" "),a("el-option",{attrs:{label:"3",value:3}}),e._v(" "),a("el-option",{attrs:{label:"4",value:4}}),e._v(" "),a("el-option",{attrs:{label:"5",value:5}}),e._v(" "),a("el-option",{attrs:{label:"6",value:6}}),e._v(" "),a("el-option",{attrs:{label:"7",value:7}}),e._v(" "),a("el-option",{attrs:{label:"8",value:8}}),e._v(" "),a("el-option",{attrs:{label:"9",value:9}}),e._v(" "),a("el-option",{attrs:{label:"10",value:10}})],1)],1),e._v(" "),a("el-form-item",{staticClass:"edit-item"},[a("p",{staticClass:"title"},[e._v("布局")]),e._v(" "),a("cubeBox",{attrs:{column:e.cubeForm.setting.column,row:e.cubeForm.setting.row,boxMsg:e.boxMsg,isNew:e.isNew},on:{getBoxIndex:e.getBoxIndex,getBoxArr:e.getBoxArr,removeBoxArr:e.removeBoxArr,getSelectAll:e.getSelectAll}})],1),e._v(" "),a("div",{staticClass:"edit-img-list edit-item"},[a("div",{staticClass:"edit-img-item"},[a("p",{staticClass:"img-warm",staticStyle:{margin:"0px"}},[e._v("选定布局区域大小，在下方添加图片")]),e._v(" "),a("p",{staticClass:"img-warm",staticStyle:{"margin-top":"0px"}},[e._v("请按照建议尺寸或同比例尺寸上传图片，否则图片会被剪裁")]),e._v(" "),a("div",{staticClass:"link-content"},[a("p",{staticClass:"link-box"},[0!==e.cubeLink.length&&e.cubeLink[e.cubeLinkIndex]?a("span",{staticClass:"link-text"},[e._v(e._s(e.cubeLink[e.cubeLinkIndex].displayName))]):a("span",{staticClass:"link-text"}),e._v(" "),a("el-button",{staticStyle:{"border-radius":"0px"},attrs:{type:"primary",icon:"iconfont icon-lianjie"},on:{click:e.moreLink6}})],1)])])])],1),e._v(" "),a("div",{staticClass:"bottom-btn",staticStyle:{"text-align":"center","margin-top":"30px"}},[a("span",{on:{click:e.saveCube}},[e._v("保存")]),e._v(" "),a("span",{on:{click:e.cancelCube}},[e._v("重置")])])]):e._e(),e._v(" "),1===e.showEditStatus?a("cateModal",{attrs:{cateModal:e.cateModal},on:{getCateMess:e.getCateMess,cancelCateModal:e.cancelCateModal}}):e._e(),e._v(" "),1===e.showEditStatus?a("selecGoods",{ref:"selectchild",attrs:{selectGoodsModal:e.selectGoodsModal,goodsNum:e.doubleGoodsList.pageModule.proNumber},on:{cancelSelectGoodsModal:e.cancelSelectGoodsModal,getSelectGoods:e.getSelectGoods}}):e._e(),e._v(" "),a("linkModal",{attrs:{linkModal:e.linkModal},on:{cancelLinkModal:e.cancelLinkModal,getLinkMess:e.getLinkMess}})],1)},staticRenderFns:[]};var Dt=a("VU/8")(Nt,Tt,!1,function(e){a("WH0e")},"data-v-4b13fc49",null).exports,Pt=a("DAYN"),Ft={data:function(){return{changeStatus:!1,mallHeight:document.documentElement.clientHeight-65,leftList1:[{moduleName:"双列商品",moduleType:1,iconfontClass:"mall-icon-double-goods",pageModule:{moduleName:"",moreButtonUrl:{type:0,displayName:"",mallProId:""},choseType:1,proNumber:2,sortCol:"1001",mallCategoryId:"",mallProTagId:null,priceRange:{begin:"",end:""},proKeyword:"",productList:[]}}],leftList2:[{moduleName:"轮播图片",moduleType:2,iconfontClass:"mall-icon-carousel",pageModule:{moduleType:2,picInfo:[{picURL:"",hrefURL:{type:4,displayName:"",pageId:""}}]}},{moduleName:"单列图片",moduleType:3,iconfontClass:"mall-icon-single-img",pageModule:{moduleType:3,picInfo:[{picURL:"",hrefURL:{type:4,displayName:"",pageId:""}}]}},{moduleName:"双列图片",moduleType:4,iconfontClass:"mall-icon-double-img",pageModule:{moduleType:2,picInfo:[{picURL:"",hrefURL:{type:4,displayName:"",pageId:""}},{picURL:"",hrefURL:{type:4,displayName:"",pageId:""}}]}},{moduleName:"文本标题",moduleType:5,iconfontClass:"mall-icon-text",pageModule:{titleText:"",hrefUrl:{type:1,displayName:"",mallProId:""}}},{moduleName:"辅助线",moduleType:6,iconfontClass:"mall-icon-line",pageModule:{}},{moduleName:"辅助空白",moduleType:7,iconfontClass:"mall-icon-blank",setting:{height:20},pageModule:{}},{moduleName:"魔方",moduleType:8,iconfontClass:"mall-icon-cube",setting:{row:3,column:3},pageModule:{picInfo:[{picURL:"",hrefURL:{type:1,displayName:"",mallProId:""},zb:""}]}}],dragOptions1:{sort:!1,group:{name:"description",pull:"clone",put:!1},ghostClass:"ghost"},dragOptions2:{sort:!1,group:{name:"description",pull:"clone",put:!1},ghostClass:"ghost"},dragOptions3:{group:{name:"description",pull:!1,put:!0},ghostClass:"ghost"},pageElementList:[],obj:{},showEditStatus:0,classIndex:"",itemIndex:-1,refash:!1,mallProId:"",showDialog:!1,pageId:""}},created:function(){this.pageId=this.$route.params.pageId,this.getPageMess()},computed:{},methods:{changeElementList:function(e){this.showEditStatus=this.pageElementList[e.newIndex].moduleType,this.obj=this.pageElementList[e.newIndex],this.itemIndex=e.newIndex,this.changeStatus=!this.changeStatus},selectEditItem:function(e,t,a){this.dragOptions3.group.put?(this.showEditStatus=e,this.classIndex=t,this.itemIndex=t,this.obj=a,this.changeStatus=!this.changeStatus):this.$message.error("请先保存")},deletePageMoudle:function(e){var t=this;this.$confirm("确定删除该模块吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.pageElementList.splice(e,1),t.$message({type:"success",message:"删除成功!"})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},dragStart:function(){this.dragOptions3.group.put||this.$message.error("请先保存")},changePutStatus:function(e){this.showDialog=e,this.dragOptions3.group.put=e},getEditMess:function(e){if(8===e.moduleType&&0===e.pageModule.picInfo.length)return this.$message.error("请填充魔方布局"),!1;this.pageElementList[this.itemIndex]=e,this.refash=!this.refash},getPageMess:function(){var e=this,t={pageId:this.pageId};A.get("/api-mall/mall_page_design",{params:t}).then(function(t){if(0===t.data.errorCode)if(e.pageId=t.data.result.pageId,e.pageElementList=t.data.result.pageElementList,e.pageElementList){for(var a in e.pageElementList)1===e.pageElementList[a].moduleType&&(e.pageElementList[a].pageModule.proList?(e.pageElementList[a].pageModule.productList=e.pageElementList[a].pageModule.proList,e.pageElementList[a].pageModule.moreButtonUrl=JSON.parse(e.pageElementList[a].pageModule.moreButtonUrl)):e.pageElementList[a].pageModule.productList=[],e.pageElementList[a].pageModule.priceRange&&(e.pageElementList[a].pageModule.priceRange=JSON.parse(e.pageElementList[a].pageModule.priceRange))),2!==e.pageElementList[a].moduleType&&3!==e.pageElementList[a].moduleType&&4!==e.pageElementList[a].moduleType||e.pageElementList[a].pageModule.picInfo&&(e.pageElementList[a].pageModule.picInfo=JSON.parse(e.pageElementList[a].pageModule.picInfo)),5===e.pageElementList[a].moduleType&&(e.pageElementList[a].pageModule.hrefUrl=JSON.parse(e.pageElementList[a].pageModule.hrefUrl)),7===e.pageElementList[a].moduleType&&(e.pageElementList[a].setting=JSON.parse(e.pageElementList[a].setting)),8===e.pageElementList[a].moduleType&&(e.pageElementList[a].pageModule.picInfo=JSON.parse(e.pageElementList[a].pageModule.picInfo),e.pageElementList[a].setting=JSON.parse(e.pageElementList[a].setting));e.pageElementList=e.pageElementList}else e.pageElementList=[];else e.$message.error(t.data.message)})},submitPage:function(e){var t=this,a=[];for(var s in this.pageElementList)a[s]={sortScore:s,moduleType:this.pageElementList[s].moduleType,pageModule:this.pageElementList[s].pageModule},7===this.pageElementList[s].moduleType&&(a[s].setting=this.pageElementList[s].setting),8===this.pageElementList[s].moduleType&&(a[s].setting=this.pageElementList[s].setting);var i={pageId:this.pageId,pageElementList:a};if(0===this.pageElementList.length)return this.$message.error("请完善页面信息"),!1;for(var r in this.pageElementList)if(1===this.pageElementList[r].moduleType){for(var o in this.pageElementList[r].pageModule.productList)if(""===this.pageElementList[r].pageModule.productList[o].mallProImageUrl)return this.$message.error("请完善页面信息"),!1}else if(2===this.pageElementList[r].moduleType){for(var l in this.pageElementList[r].pageModule.picInfo)if(""===this.pageElementList[r].pageModule.picInfo[l].picURL)return this.$message.error("请完善页面信息"),!1}else if(3===this.pageElementList[r].moduleType){for(var n in this.pageElementList[r].pageModule.picInfo)if(""===this.pageElementList[r].pageModule.picInfo[n].picURL)return this.$message.error("请完善页面信息"),!1}else if(4===this.pageElementList[r].moduleType){for(var d in this.pageElementList[r].pageModule.picInfo)if(""===this.pageElementList[r].pageModule.picInfo[d].picURL)return this.$message.error("请完善页面信息"),!1}else if(5===this.pageElementList[r].moduleType){if(""===this.pageElementList[r].pageModule.titleText)return this.$message.error("请完善页面信息"),!1}else if(7===this.pageElementList[r].moduleType){if(!this.pageElementList[r].setting.height)return this.$message.error("请完善页面信息"),!1}else if(8===this.pageElementList[r].moduleType){if(this.pageElementList[r].pageModule.picInfo.some(function(e){return""===e.picURL}))return this.$message.error("请完善信息"),!1}"1"===e&&(i.isOpen=1),A.post("/api-mall/mall_page_save_elements",i).then(function(e){0===e.data.errorCode?t.$message.success("保存成功"):t.$message.error(e.data.message)})},goBack:function(){this.$router.go(-1)}},components:{rightEdit:Dt,draggable:a.n(Pt).a}},At={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page-decoration-container"},[s("div",{staticClass:"page-decoration-content"},[s("div",{staticClass:"decoration-header"},[e._m(0),e._v(" "),s("div",{staticClass:"fr"},[s("el-button",{staticClass:"header-btn",attrs:{plain:""},on:{click:e.goBack}},[e._v("返回")]),e._v(" "),s("el-button",{staticClass:"header-btn",attrs:{plain:""},on:{click:function(t){e.submitPage("0")}}},[e._v("保存")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitPage("1")}}},[e._v("保存并发布")])],1)]),e._v(" "),s("div",{staticClass:"page-content",style:{height:e.mallHeight+"px"}},[s("div",{staticClass:"page-left"},[s("div",{staticClass:"page-left-group"},[s("h3",[e._v("商品类")]),e._v(" "),s("draggable",{staticClass:"module-content",attrs:{element:"div",options:e.dragOptions1},model:{value:e.leftList1,callback:function(t){e.leftList1=t},expression:"leftList1"}},e._l(e.leftList1,function(t){return s("div",{key:t.moduleType,staticClass:"module-item"},[s("i",{staticClass:"mall-icon",class:t.iconfontClass}),e._v(" "),s("p",[e._v(e._s(t.moduleName))])])}))],1),e._v(" "),s("div",{staticClass:"page-left-group"},[s("h3",[e._v("图文类")]),e._v(" "),s("draggable",{staticClass:"module-content",attrs:{element:"div",options:e.dragOptions2},on:{start:e.dragStart},model:{value:e.leftList2,callback:function(t){e.leftList2=t},expression:"leftList2"}},e._l(e.leftList2,function(t){return s("div",{key:t.moduleType,staticClass:"module-item"},[s("i",{staticClass:"mall-icon",class:t.iconfontClass}),e._v(" "),s("p",[e._v(e._s(t.moduleName))])])}))],1)]),e._v(" "),s("div",{staticClass:"page-center-content"},[s("div",{staticClass:"page-center"},[e._m(1),e._v(" "),s("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refash))]),e._v(" "),s("div",{staticClass:"phone-content"},[s("draggable",{staticStyle:{"min-height":"500px"},attrs:{element:"div",options:e.dragOptions3},on:{add:e.changeElementList},model:{value:e.pageElementList,callback:function(t){e.pageElementList=t},expression:"pageElementList"}},e._l(e.pageElementList,function(t,i){return s("div",{key:i,staticClass:"hover-class",class:e.classIndex==i?"activeSelect":"",on:{click:function(a){e.selectEditItem(t.moduleType,i,t)}}},[1===t.moduleType&&0===t.pageModule.productList.length?s("div",{staticClass:"phone-double-goods"},[s("div",{staticClass:"double-goods-title"},[s("span",[e._v("双列商品")]),e._v(" "),s("i",{staticClass:"el-icon-arrow-right"})]),e._v(" "),e._l(2,function(t,i){return s("div",{key:i,staticClass:"double-goods-item"},[s("img",{attrs:{src:a("oQG7")}}),e._v(" "),s("p",{staticClass:"goods-describe"},[e._v("商品名称")]),e._v(" "),s("p",{staticClass:"goods-price"},[e._v("￥0.00")])])})],2):e._e(),e._v(" "),1===t.moduleType&&0!==t.pageModule.productList.length?s("div",{staticClass:"phone-double-goods"},[s("div",{staticClass:"double-goods-title"},[s("span",[e._v(e._s(t.pageModule.moduleName))]),e._v(" "),s("i",{staticClass:"el-icon-arrow-right"})]),e._v(" "),e._l(t.pageModule.productList,function(t,a){return s("div",{key:a,staticClass:"double-goods-item"},[s("img",{attrs:{src:t.mallProImageUrl}}),e._v(" "),s("p",{staticClass:"goods-describe"},[e._v(e._s(t.proName))]),e._v(" "),s("p",{staticClass:"goods-price"},[e._v("￥"+e._s(t.mallProSpuPrice))])])})],2):e._e(),e._v(" "),2===t.moduleType&&""===t.pageModule.picInfo[0].picURL?s("div",{staticClass:"phone-carousel"},[s("img",{attrs:{src:a("oQG7")}})]):e._e(),e._v(" "),2===t.moduleType&&t.pageModule.picInfo[0].picURL?[s("el-carousel",{staticClass:"phone-carousel",attrs:{interval:5e3,arrow:"always",height:"150px"}},e._l(t.pageModule.picInfo,function(e,t){return s("el-carousel-item",{key:t},[s("img",{attrs:{src:e.picURL,alt:""}})])}))]:e._e(),e._v(" "),3===t.moduleType?s("div",{staticClass:"phone-single-img"},[""===t.pageModule.picInfo[0].picURL?s("img",{attrs:{src:a("oQG7")}}):s("img",{attrs:{src:t.pageModule.picInfo[0].picURL,alt:""}})]):e._e(),e._v(" "),4===t.moduleType?s("div",{staticClass:"phone-double-img"},[""===t.pageModule.picInfo[0].picURL?s("img",{attrs:{src:a("oQG7"),alt:""}}):s("img",{attrs:{src:t.pageModule.picInfo[0].picURL}}),e._v(" "),""===t.pageModule.picInfo[1].picURL?s("img",{attrs:{src:a("oQG7"),alt:""}}):s("img",{attrs:{src:t.pageModule.picInfo[1].picURL}})]):e._e(),e._v(" "),5===t.moduleType?s("div",{staticClass:"phone-text-title"},[""===t.pageModule.titleText?s("span",[e._v("文本标题")]):s("span",[e._v(e._s(t.pageModule.titleText))]),e._v(" "),t.pageModule.hrefUrl&&""!==t.pageModule.hrefUrl.mallProId?s("i",{staticClass:"el-icon-arrow-right"}):e._e()]):e._e(),e._v(" "),6===t.moduleType?s("div",{staticClass:"phone-line"},[s("p")]):e._e(),e._v(" "),7===t.moduleType?s("div",{staticClass:"phone-blank"},[s("p",{style:{height:t.setting.height+"px"}})]):e._e(),e._v(" "),8===t.moduleType?s("div",{staticClass:"phone-cube"},[""==t.pageModule.picInfo[0].zb?s("div",{style:{height:350/t.setting.column*t.setting.row+"px"}}):s("div",{style:{height:350/t.setting.column*t.setting.row+"px"}},e._l(t.pageModule.picInfo,function(e,a){return s("img",{key:a,staticClass:"img-cube",style:{width:(e.zb.split(".").join(",").split(",")[2]-e.zb.split(".").join(",").split(",")[0])*(350/t.setting.column)+"px",height:(e.zb.split(".").join(",").split(",")[3]-e.zb.split(".").join(",").split(",")[1])*(350/t.setting.column)+"px",left:e.zb.split(".").join(",").split(",")[0]*(350/t.setting.column)+"px",top:e.zb.split(".").join(",").split(",")[1]*(350/t.setting.column)+"px"},attrs:{src:e.picURL,alt:""}})}))]):e._e(),e._v(" "),s("span",{staticClass:"deleteMoudle",on:{click:function(t){e.deletePageMoudle(i)}}},[s("i",{staticClass:"el-icon-close"})])],2)}))],1)])]),e._v(" "),s("div",{staticClass:"page-right"},[s("rightEdit",{attrs:{showEditStatus:e.showEditStatus,obj:e.obj,changeStatus:e.changeStatus},on:{getEditMess:e.getEditMess,changePutStatus:e.changePutStatus}})],1)])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"fl"},[t("img",{attrs:{src:a("aH8B")}}),this._v(" "),t("img",{attrs:{src:a("WjWg")}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"phone-header"},[t("img",{attrs:{src:a("y6mx")}})])}]};var Mt=a("VU/8")(Ft,At,!1,function(e){a("Rt1m"),a("clUE")},"data-v-4213824a",null).exports,Ot={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,mallForm:{useStatus:!1,closePicUrl:"",useCollection:!1},mallRules:{},commonURL:window.location.origin,uploadAction:window.location.origin+"/api-plug/upload-img?requestProject=mall"}},mounted:function(){this.getMessage()},computed:{},methods:{getMessage:function(){var e=this;A.post("/api-mall/mall_advanced_setting").then(function(t){0===t.data.errorCode?(1===t.data.result.useStatus?e.mallForm.useStatus=!0:e.mallForm.useStatus=!1,1===t.data.result.useCollection?e.mallForm.useCollection=!0:e.mallForm.useCollection=!1,e.mallForm.closePicUrl=t.data.result.closePicUrl):e.$message.error(t.data.message)})},onSubmit:function(){var e=this,t={useCollection:this.mallForm.useCollection?"1":"0"};A.post("/api-mall/update_advanced_setting",_.a.stringify(t)).then(function(t){0===t.data.errorCode?e.$message.success("设置成功"):e.$message.error(t.data.message)})},beforeUpload:function(e){if("image/jpeg"!==e.type&&"image/png"!==e.type&&"image/jpg"!==e.type)return this.$message.error("格式有误"),!1;var t=this;return new S.a(function(a,s){var i=new FileReader;i.onload=function(e){var i=new Image;i.onload=function(){var e=this.width,i=this.height;750===e&&1e3===i||(t.$message.error("请上传尺寸：750*1000像素，格式：jpg、png的图片"),s()),a()},i.src=e.target.result},i.readAsDataURL(e)})},uploadSuccess:function(e,t,a){0===e.errorCode&&(this.mallForm.closePicUrl=e.result[0].qcloudImageUrl,this.$message.success("上传成功"))}},components:{}},$t={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("商城设置")]),e._v(" "),a("el-breadcrumb-item",[e._v("通用设置")])],1),e._v(" "),e._m(0)],1),e._v(" "),a("div",{staticClass:"mall-section"},[a("div",{staticClass:"common-content"},[a("el-form",{attrs:{model:e.mallForm,rules:e.mallRules,"label-width":"100px","label-position":"left"}},[a("el-form-item",{attrs:{label:"显示收藏按钮"}},[a("el-switch",{model:{value:e.mallForm.useCollection,callback:function(t){e.$set(e.mallForm,"useCollection",t)},expression:"mallForm.useCollection"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("保存")])],1)],1)],1)])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("通用设置")])])}]};var Vt=a("VU/8")(Ot,$t,!1,function(e){a("7bvK")},"data-v-1ed43bec",null).exports,Rt={data:function(){return{setForm:{autoClose:!0,openTime:"",autoConfirm:!0,takeGoodsTime:"",afterSaleServiceText:"",payReminder:!0,payReminderType:"1",afterSaleTime:15,paymentTime:"",dayTime:"",deliverReminder:!0,autoRefundGoods:!1},limitLen:0,setRules:{}}},mounted:function(){this.getMessage()},methods:{limitServiceText:function(e){var t=this;this.$nextTick(function(){t.setForm.afterSaleServiceText=C.getInputVal(e,2e3),t.limitLen=C.getZhLen(t.setForm.afterSaleServiceText.trim())})},getMessage:function(){var e=this;A.post("/api-mall/get_order_setting").then(function(t){0===t.data.errorCode?(t.data.result.autoClose?0===t.data.result.autoClose?(e.setForm.autoClose=!1,e.setForm.openTime=720):(e.setForm.autoClose=!0,e.setForm.openTime=t.data.result.autoClose):(e.setForm.autoClose=!1,e.setForm.openTime=720),t.data.result.autoConfirm?0===t.data.result.autoConfirm?(e.setForm.autoConfirm=!1,e.setForm.takeGoodsTime=7):(e.setForm.autoConfirm=!0,e.setForm.takeGoodsTime=t.data.result.autoConfirm):(e.setForm.autoConfirm=!1,e.setForm.takeGoodsTime=7),t.data.result.afterSaleServiceText?(e.setForm.afterSaleServiceText=t.data.result.afterSaleServiceText,e.limitLen=C.getZhLen(e.setForm.afterSaleServiceText.trim())):e.setForm.afterSaleServiceText="",t.data.result.payReminderType&&(e.setForm.payReminderType=String(t.data.result.payReminderType)),t.data.result.payReminder?0===t.data.result.payReminder?(e.setForm.payReminder=!1,1===t.data.result.payReminderType?(e.setForm.paymentTime=30,e.setForm.dayTime=""):(e.setForm.paymentTime="",e.setForm.dayTime="00:15")):(e.setForm.payReminder=!0,1===t.data.result.payReminderType?(e.setForm.paymentTime=t.data.result.payReminderDelay,e.setForm.dayTime=""):(e.setForm.dayTime=t.data.result.payReminderTime,e.setForm.paymentTime="")):(e.setForm.payReminder=!1,e.setForm.paymentTime=30),0===t.data.result.deliverReminder&&(0===t.data.result.deliverReminder?e.setForm.deliverReminder=!1:e.setForm.deliverReminder=!0),0===t.data.result.autoRefundGoods?e.setForm.autoRefundGoods=!1:1===t.data.result.autoRefundGoods&&(e.setForm.autoRefundGoods=!0),e.setForm.afterSaleTime=t.data.result.afterSaleTime):e.$message.error(t.data.message)})},changePayReminderType:function(e){1==e?(this.setForm.paymentTime=30,this.setForm.dayTime=""):2==e&&(this.setForm.dayTime="00:15",this.setForm.paymentTime="")},onSubmit:function(){var e=this,t={autoClose:this.setForm.autoClose?this.setForm.openTime:"0",autoConfirm:this.setForm.autoConfirm?this.setForm.takeGoodsTime:"0",afterSaleServiceText:this.setForm.afterSaleServiceText,payReminder:this.setForm.payReminder?"1":"0",payReminderType:this.setForm.payReminderType,payReminderDelay:"1"===this.setForm.payReminderType?this.setForm.paymentTime:"",payReminderTime:"2"===this.setForm.payReminderType?this.setForm.dayTime:"",deliverReminder:this.setForm.deliverReminder?"1":"0",autoRefundGoods:this.setForm.autoRefundGoods?1:0,afterSaleTime:this.setForm.afterSaleTime};A.post("/api-mall/update_order_setting",_.a.stringify(t)).then(function(t){0===t.data.errorCode?(e.$message.success("保存成功"),e.getMessage()):e.$message.error(t.data.message)})}}},Ut={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"set-content"},[a("el-form",{ref:"setForm",staticClass:"demo-ruleForm",attrs:{model:e.setForm,rules:e.setRules,"label-width":"120px","label-position":"right"}},[a("el-form-item",{attrs:{label:"自动关闭订单"}},[a("el-switch",{model:{value:e.setForm.autoClose,callback:function(t){e.$set(e.setForm,"autoClose",t)},expression:"setForm.autoClose"}})],1),e._v(" "),e.setForm.autoClose?a("el-form-item",{attrs:{label:""}},[a("el-select",{attrs:{placeholder:"请选择活动区域"},model:{value:e.setForm.openTime,callback:function(t){e.$set(e.setForm,"openTime",t)},expression:"setForm.openTime"}},[a("el-option",{attrs:{label:"12小时未付款自动关闭",value:720}}),e._v(" "),a("el-option",{attrs:{label:"24小时未付款自动关闭",value:1440}}),e._v(" "),a("el-option",{attrs:{label:"36小时未付款自动关闭",value:2160}}),e._v(" "),a("el-option",{attrs:{label:"48小时未付款自动关闭",value:2880}})],1)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"自动确认收货"}},[a("el-switch",{model:{value:e.setForm.autoConfirm,callback:function(t){e.$set(e.setForm,"autoConfirm",t)},expression:"setForm.autoConfirm"}})],1),e._v(" "),e.setForm.autoConfirm?a("el-form-item",{attrs:{label:""}},[a("span",[e._v("发货")]),e._v(" "),a("el-select",{attrs:{placeholder:""},model:{value:e.setForm.takeGoodsTime,callback:function(t){e.$set(e.setForm,"takeGoodsTime",t)},expression:"setForm.takeGoodsTime"}},[a("el-option",{attrs:{label:"7天后",value:7}}),e._v(" "),a("el-option",{attrs:{label:"15天后",value:15}}),e._v(" "),a("el-option",{attrs:{label:"30天后",value:30}})],1),e._v(" "),a("span",[e._v("自动确认")])],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"订单提醒"}},[a("el-switch",{model:{value:e.setForm.payReminder,callback:function(t){e.$set(e.setForm,"payReminder",t)},expression:"setForm.payReminder"}})],1),e._v(" "),e.setForm.payReminder?a("el-form-item",{attrs:{label:"催付提醒"}},[a("el-radio-group",{on:{change:e.changePayReminderType},model:{value:e.setForm.payReminderType,callback:function(t){e.$set(e.setForm,"payReminderType",t)},expression:"setForm.payReminderType"}},[a("el-radio",{attrs:{label:"1"}},[a("span",[e._v("下单")]),e._v(" "),a("el-select",{staticStyle:{width:"220px"},attrs:{placeholder:"请选择"},model:{value:e.setForm.paymentTime,callback:function(t){e.$set(e.setForm,"paymentTime",t)},expression:"setForm.paymentTime"}},[a("el-option",{attrs:{label:"30分钟",value:30}}),e._v(" "),a("el-option",{attrs:{label:"1个小时",value:60}}),e._v(" "),a("el-option",{attrs:{label:"2个小时",value:120}}),e._v(" "),a("el-option",{attrs:{label:"3个小时",value:180}}),e._v(" "),a("el-option",{attrs:{label:"4个小时",value:240}}),e._v(" "),a("el-option",{attrs:{label:"5个小时",value:300}}),e._v(" "),a("el-option",{attrs:{label:"6个小时",value:360}})],1),e._v(" "),a("span",[e._v("未付款")])],1),e._v(" "),a("div",{staticStyle:{height:"22px"}}),e._v(" "),a("el-radio",{attrs:{label:"2"}},[a("span",[e._v("每天")]),e._v(" "),a("el-time-select",{staticStyle:{width:"220px"},attrs:{"picker-options":{start:"00:15",step:"00:15",end:"24:00"},placeholder:"选择时间"},model:{value:e.setForm.dayTime,callback:function(t){e.$set(e.setForm,"dayTime",t)},expression:"setForm.dayTime"}}),e._v(" "),a("span",[e._v("未付款")])],1)],1)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"发货提醒"}},[a("el-switch",{model:{value:e.setForm.deliverReminder,callback:function(t){e.$set(e.setForm,"deliverReminder",t)},expression:"setForm.deliverReminder"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"自动同意退货"}},[a("el-switch",{model:{value:e.setForm.autoRefundGoods,callback:function(t){e.$set(e.setForm,"autoRefundGoods",t)},expression:"setForm.autoRefundGoods"}}),e._v(" "),a("p",{staticStyle:{"font-size":"12px",color:"rgb(144, 147, 153)"}},[e._v("开启自动同意退货后，买家若申请退货退款，则默认同意买家的退货申请并将默认的退货地址发送给买家")])],1),e._v(" "),a("el-form-item",{attrs:{label:"售后申请时长"}},[a("el-select",{staticStyle:{width:"220px"},attrs:{placeholder:"请选择"},model:{value:e.setForm.afterSaleTime,callback:function(t){e.$set(e.setForm,"afterSaleTime",t)},expression:"setForm.afterSaleTime"}},[a("el-option",{attrs:{label:"7天内",value:7}}),e._v(" "),a("el-option",{attrs:{label:"15天内",value:15}}),e._v(" "),a("el-option",{attrs:{label:"30天内",value:30}})],1),e._v(" "),a("p",{staticStyle:{"font-size":"12px",color:"rgb(144, 147, 153)"}},[e._v("可设置自订单交易完成后，买家可申请售后的时间截止时长")])],1),e._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"0px"},attrs:{label:"售后服务说明"}},[a("el-input",{staticStyle:{width:"600px"},attrs:{type:"textarea",rows:"5"},on:{input:function(t){return e.limitServiceText(t)}},model:{value:e.setForm.afterSaleServiceText,callback:function(t){e.$set(e.setForm,"afterSaleServiceText",t)},expression:"setForm.afterSaleServiceText"}}),e._v(" "),a("div",{staticStyle:{"font-size":"12px",color:"#909399",width:"600px","margin-top":"-5px"}},[a("span",{staticStyle:{float:"right"}},[e._v(e._s(e.limitLen)+"/2000")])])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("setForm")}}},[e._v("保 存")])],1)],1)],1)},staticRenderFns:[]};var Et={data:function(){return{loading:!0,search:"",pageSize:20,pageNum:1,currentPage4:1,total:4,templateList:[{freightTemplateId:"ff808081644e485d01644e6e1626000d",enterpriseId:null,brandId:"-1",templateName:"0元测试",freeShipping:0,areaId:"-1",fristBatchNumber:1,fristBatchCost:0,fristBatchCostStr:"0.00",otherBatchNumber:1,otherBatchCost:0,otherBatchCostStr:"0.00",isDefault:0,status:1,createTime:1530324194e3,updateTime:1533203304e3,subList:[{subFreightTemplateId:"ff80808164ab74240164b5ff027e004f",enterpriseId:"ff808081593917d90159398ec6340012",brandId:"-1",freightTemplateId:"ff808081644e485d01644e6e1626000d",areaId:"310000,320000,330000,340000,350000,360000,370000",areaName:"上海市,江苏省,浙江省,安徽省,福建省,江西省,山东省",fristBatchNumber:98,fristBatchCost:14,fristBatchCostStr:"14.00",otherBatchNumber:90,otherBatchCost:9088,otherBatchCostStr:"9088.00",status:1,createTime:1532061745e3,updateTime:1533203304e3}]},{freightTemplateId:"ff808081643b81720164447e35d50038",enterpriseId:null,brandId:"-1",templateName:"测试运费模板C",freeShipping:0,areaId:"-1",fristBatchNumber:1,fristBatchCost:8,fristBatchCostStr:"8.00",otherBatchNumber:1,otherBatchCost:12,otherBatchCostStr:"12.00",isDefault:0,status:1,createTime:1530157479e3,updateTime:1532065005e3,subList:[{subFreightTemplateId:"ff808081643b81720164447eb39d0039",enterpriseId:"ff808081593917d90159398ec6340012",brandId:"-1",freightTemplateId:"ff808081643b81720164447e35d50038",areaId:"210000,220000,230000",areaName:"辽宁省,吉林省,黑龙江省",fristBatchNumber:1,fristBatchCost:1,fristBatchCostStr:"1.00",otherBatchNumber:1,otherBatchCost:1,otherBatchCostStr:"1.00",status:1,createTime:1530157511e3,updateTime:1532065005e3}]},{freightTemplateId:"ff8080816422610101643632d7e7005b",enterpriseId:null,brandId:"-1",templateName:"运费模板测试 B",freeShipping:0,areaId:"-1",fristBatchNumber:2,fristBatchCost:10,fristBatchCostStr:"10.00",otherBatchNumber:1,otherBatchCost:4,otherBatchCostStr:"4.00",isDefault:0,status:1,createTime:1529917659e3,updateTime:1529918439e3,subList:[{subFreightTemplateId:"ff8080816422610101643632d7ee005c",enterpriseId:"ff808081593917d90159398ec6340012",brandId:"-1",freightTemplateId:"ff8080816422610101643632d7e7005b",areaId:"210000,220000,230000",areaName:"辽宁省,吉林省,黑龙江省",fristBatchNumber:5,fristBatchCost:20,fristBatchCostStr:"20.00",otherBatchNumber:2,otherBatchCost:20,otherBatchCostStr:"20.00",status:1,createTime:1529917659e3,updateTime:1529918439e3},{subFreightTemplateId:"ff8080816422610101643632d7ee005d",enterpriseId:"ff808081593917d90159398ec6340012",brandId:"-1",freightTemplateId:"ff8080816422610101643632d7e7005b",areaId:"310000,320000,330000,340000,350000,360000,370000",areaName:"上海市,江苏省,浙江省,安徽省,福建省,江西省,山东省",fristBatchNumber:5,fristBatchCost:15,fristBatchCostStr:"15.00",otherBatchNumber:2,otherBatchCost:15,otherBatchCostStr:"15.00",status:1,createTime:1529917659e3,updateTime:1529918439e3}]},{freightTemplateId:"ff80808160fed3c7016101e8256a0008",enterpriseId:null,brandId:"-1",templateName:"运费模板测试 A",freeShipping:0,areaId:"-1",fristBatchNumber:1,fristBatchCost:10,fristBatchCostStr:"10.00",otherBatchNumber:1,otherBatchCost:5,otherBatchCostStr:"5.00",isDefault:0,status:1,createTime:1516155446e3,updateTime:1529918413e3,subList:[{subFreightTemplateId:"ff8080816422610101643631fa82005a",enterpriseId:"ff808081593917d90159398ec6340012",brandId:"-1",freightTemplateId:"ff80808160fed3c7016101e8256a0008",areaId:"110000,120000,130000,140000,150000",areaName:"北京市,天津市,河北省,山西省,内蒙古自治区",fristBatchNumber:1,fristBatchCost:20,fristBatchCostStr:"20.00",otherBatchNumber:1,otherBatchCost:10,otherBatchCostStr:"10.00",status:1,createTime:1529917602e3,updateTime:1529918413e3}]}]}},mounted:function(){this.getTemplateList()},computed:{},methods:{handleSizeChange:function(e){this.pageSize=e,this.getTemplateList()},handleCurrentChange:function(e){this.pageNum=e,this.getTemplateList()},getTemplateList:function(){var e=this;this.loading=!1;var t={search:this.search,pageSize:this.pageSize,pageNum:this.pageNum};A.post("/api-mall/page-shipping-templates",_.a.stringify(t)).then(function(t){0===t.data.errorCode?(e.templateList=t.data.result.result,e.total=t.data.result.totalCount,e.loading=!1):e.$message.error(t.data.message)})},deleteTemplate:function(e){var t=this,a={freightTemplateId:e};this.$confirm("确认删除该模板?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){A.post("/api-mall/delete-shipping-templates",_.a.stringify(a)).then(function(e){0===e.data.errorCode?(t.$message.success("删除模板成功！！"),t.getTemplateList()):t.$message.error(e.data.message)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},goTemplateEdit:function(e){this.$router.push({name:"templateEdit",params:{templateId:e}}),window.localStorage.setItem("tabName","second")}}},Gt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"order-wrap-padding"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:16}},[a("div",{staticClass:"fl"},[a("el-input",{attrs:{placeholder:"请输入运费模板名称",clearable:"","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.getTemplateList()}},model:{value:e.search,callback:function(t){e.search="string"==typeof t?t.trim():t},expression:"search"}})],1)]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"fr"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.goTemplateEdit("-1")}}},[e._v("新建运费模板")])],1)])],1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"margin-top":"22px"}},e._l(e.templateList,function(t,s){return a("div",{key:s,staticClass:"template-list"},[a("el-row",{staticClass:"template-list-title"},[a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content-left",staticStyle:{"font-size":"14px","font-weight":"600",color:"#303133"}},[e._v("\n            "+e._s(t.templateName)+"\n          ")])]),e._v(" "),a("el-col",{attrs:{span:12}},[a("div",{staticClass:"grid-content-right"},[a("span",[e._v("最近修改时间："+e._s(e._f("getTime")(t.updateTime))+" "+e._s(e._f("getSeconds")(t.updateTime)))]),e._v(" "),a("a",{attrs:{href:"javascript:;"},on:{click:function(a){e.goTemplateEdit(t.freightTemplateId)}}},[e._v("编辑")]),a("a",{attrs:{href:"javascript:;"},on:{click:function(a){e.deleteTemplate(t.freightTemplateId)}}},[e._v("删除")])])])],1),e._v(" "),a("el-row",{staticClass:"template-list-wrap",staticStyle:{"background-color":"rgba(241, 243, 247, 1)",color:"#909399"}},[a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content"},[e._v("\n            运送方式\n          ")])]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[e._v("\n            运送到\n          ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n            首件数（个）\n          ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n            首费（元）\n          ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n            续件数（个）\n          ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n            续费（元）\n          ")])])],1),e._v(" "),a("el-row",{staticClass:"template-list-wrap"},[a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content"},[e._v("\n            快递\n          ")])]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[e._v("\n            中国\n          ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n            "+e._s(t.fristBatchNumber)+"\n          ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n            "+e._s(t.fristBatchCostStr)+"\n          ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n            "+e._s(t.otherBatchNumber)+"\n          ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n            "+e._s(t.otherBatchCost)+"\n          ")])])],1),e._v(" "),e._l(t.subList,function(t){return a("el-row",{key:t.subFreightTemplateId,staticClass:"template-list-wrap"},[a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content"},[e._v("\n            快递\n          ")])]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[e._v("\n            "+e._s(t.areaName)+"\n          ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n            "+e._s(t.fristBatchNumber)+"\n          ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n            "+e._s(t.fristBatchCostStr)+"\n          ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n            "+e._s(t.otherBatchNumber)+"\n          ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n            "+e._s(t.otherBatchCost)+"\n          ")])])],1)})],2)})),e._v(" "),a("div",{staticClass:"block-page-wrap"},[a("div",{staticClass:"block-page"},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage4,"page-sizes":[20,40,60,80],"page-size":20,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])],1)},staticRenderFns:[]};var Bt={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,length:0,activeName:"first"}},mounted:function(){window.localStorage.getItem("tabName")&&(this.activeName=window.localStorage.getItem("tabName")),window.localStorage.removeItem("tabName")},computed:{},methods:{},components:{BasicSet:a("VU/8")(Rt,Ut,!1,function(e){a("t9M/")},"data-v-a26c952a",null).exports,TemplateSet:a("VU/8")(Et,Gt,!1,function(e){a("75Wb")},"data-v-89466700",null).exports}},zt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title",staticStyle:{position:"relative",border:"none"}},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("商城设置")]),e._v(" "),a("el-breadcrumb-item",[e._v("订单设置")])],1),e._v(" "),e._m(0)],1),e._v(" "),a("div",{staticClass:"mall-section"},[a("el-tabs",{staticClass:"bread-content",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"基础设置",name:"first"}},[a("div",{staticStyle:{height:"25px",background:"#f5f7fa"}}),e._v(" "),a("div",{staticClass:"tab-content"},[a("BasicSet")],1)]),e._v(" "),a("el-tab-pane",{attrs:{label:"发货设置",name:"second"}},[a("div",{staticStyle:{height:"25px",background:"#f5f7fa"}}),e._v(" "),a("TemplateSet")],1)],1)],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("订单设置")])])}]};var jt=a("VU/8")(Bt,zt,!1,function(e){a("hCmM")},"data-v-3530ab15",null).exports,Ht={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,saveForm:{templateName:"",freightTemplateId:"",freeShipping:0,fristBatchNumber:"",fristBatchCost:"",otherBatchNumber:"",otherBatchCost:"",subList:[]},saveSellForm:{templateName:"",freightTemplateId:"",freeShipping:1,fristBatchNumber:"",fristBatchCost:"",otherBatchNumber:"",otherBatchCost:"",subList:[]},indexItem:0,checkedKeys:[],form:{name:"",region:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""},dialogAreaFormVisible:!1,areaData:[],data3:[],data2:[],defaultProps:{children:"children",label:"label"},pageTitle:"新建运费模板"}},mounted:function(){window.onbeforeunload=function(e){localStorage.removeItem("tabName")},this.getMallDictTree(),this.templateId=this.$route.params.templateId,"-1"!==this.templateId&&(this.getTemplateById(this.templateId),this.pageTitle="编辑运费模板")},computed:{},methods:{getCheckedNodes:function(){for(var e=this.$refs.tree.getCheckedNodes(),t=[],a=0;a<e.length;a++)if(e[a].children)for(var s=0;s<e[a].children.length;s++)if(t.push(e[a].children[s]),e[a].children[s].children)for(var i=0;i<e[a].children[s].children.length;i++)t.push(e[a].children[s].children[i]);for(var r=[],o=0;o<e.length;o++){for(var l=!0,n=0;n<t.length;n++)e[o].id==t[n].id&&(l=!1);l&&r.push(e[o])}for(var d=this.indexItem,c="",u="",m=0;m<r.length;m++)m<r.length-1?(c+=r[m].id+",",u+=r[m].label+","):(c+=r[m].id,u+=r[m].label);this.saveForm.subList[d].areaId=c,this.saveForm.subList[d].areaName=u,this.dialogAreaFormVisible=!1},setCheckedNodes:function(){this.$refs.tree.setCheckedNodes([{id:5,label:"二级 2-1"},{id:9,label:"三级 1-1-1"}])},setCheckedKeys:function(){this.$refs.tree.setCheckedKeys([3])},resetChecked:function(){this.$refs.tree.setCheckedKeys([])},getMallDictTree:function(){var e=this;A.post("/api-mall/mall-dict-tree").then(function(t){if(0===t.data.errorCode){e.areaData=t.data.result;for(var a=[],s=0;s<t.data.result.length;s++){var i={};if(i.id=t.data.result[s].partStr,i.label=t.data.result[s].partName,i.disabled=!1,i.children=[],t.data.result[s].node)for(var r=t.data.result[s].node,o=0;o<r.length;o++){var l={};if(l.id=r[o].provinceId,l.label=r[o].provinceName,l.disabled=!1,l.children=[],r[o].node)for(var n=0;n<r[o].node.length;n++){var d={};d.id=r[o].node[n].cityId,d.label=r[o].node[n].cityName,d.disabled=!1,l.children.push(d)}i.children.push(l)}a.push(i)}e.data2=a,e.data3=a.concat([])}else e.$message.error(t.data.message)})},getTemplateById:function(e){var t=this,a={templateId:e};A.post("/api-mall/get-shipping-templates",_.a.stringify(a)).then(function(e){if(0===e.data.errorCode){if(e.data.result.otherBatchNumber?t.saveForm.otherBatchNumber=e.data.result.otherBatchNumber:t.saveForm.otherBatchNumber=0,e.data.result.otherBatchCostStr?t.saveForm.otherBatchCost=e.data.result.otherBatchCostStr:t.saveForm.otherBatchCost=0,t.saveForm.templateName=e.data.result.templateName,t.saveForm.freightTemplateId=e.data.result.freightTemplateId,t.saveForm.freeShipping=e.data.result.freeShipping,t.saveForm.fristBatchNumber=e.data.result.fristBatchNumber,t.saveForm.fristBatchCost=e.data.result.fristBatchCostStr,e.data.result.subList){var a=!0,s=!1,i=void 0;try{for(var r,o=b()(e.data.result.subList);!(a=(r=o.next()).done);a=!0){var l=r.value;l.otherBatchCostStr?l.otherBatchCost=l.otherBatchCostStr:l.otherBatchCost=0,l.otherBatchNumber?l.otherBatchNumber=l.otherBatchNumber:l.otherBatchNumber=0}}catch(e){s=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw i}}}t.saveForm.subList=e.data.result.subList}else t.$message.error(e.data.message)})},addTemplateList:function(){this.saveForm.subList.push({fristBatchNumber:"",fristBatchCost:"",otherBatchNumber:0,otherBatchCost:0,areaName:"",areaId:"",subFreightTemplateId:""})},dialogAreaForm:function(e){this.dialogAreaFormVisible=!0,this.data2=this.data3.concat([]),this.checkedKeys=[],this.indexItem=e;for(var t=[],a=[],s=0;s<this.saveForm.subList.length;s++)if(e!=s){var i=this.saveForm.subList[s].areaId.split(",");t=t.concat(i)}else if(e==s){var r=this.saveForm.subList[s].areaId.split(",");a=a.concat(r)}for(var o=0;o<this.data2.length;o++){this.data2[o].disabled=!1;for(var l=0;l<this.data2[o].children.length;l++){this.data2[o].children[l].disabled=!1;for(var n=0;n<this.data2[o].children[l].children.length;n++)this.data2[o].children[l].children[n].disabled=!1}}for(var d=0;d<this.data2.length;d++)for(var c=0;c<t.length;c++)if(t[c]==this.data2[d].id){this.data2[d].disabled=!0;for(var u=0;u<this.data2[d].children.length;u++){this.data2[d].children[u].disabled=!0;for(var m=0;m<this.data2[d].children[u].children.length;m++)this.data2[d].children[u].children[m].disabled=!0}}for(var p=0;p<this.data2.length;p++)for(var h=0;h<this.data2[p].children.length;h++)for(var g=0;g<t.length;g++)if(t[g]==this.data2[p].children[h].id){this.data2[p].children[h].disabled=!0;for(var v=0;v<this.data2[p].children[h].children.length;v++)this.data2[p].children[h].children[v].disabled=!0}for(var f=0;f<this.data2.length;f++)for(var b=0;b<this.data2[f].children.length;b++)for(var y=0;y<this.data2[f].children[b].children.length;y++)for(var _=0;_<t.length;_++)t[_]==this.data2[f].children[b].children[y].id&&(this.data2[f].children[b].children[y].disabled=!0);this.checkedKeys=a},deleteAreaItem:function(e){var t=this,a=e;this.$confirm("确认删除该项?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.saveForm.subList.splice(a,1)}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},saveTemplate:function(){var e=this;if(""!=this.saveForm.templateName)if(0!==this.saveForm.freeShipping||this.saveForm.fristBatchNumber&&this.saveForm.fristBatchCost&&this.saveForm.otherBatchNumber&&this.saveForm.otherBatchCost){var t={};1==this.saveForm.freeShipping?(this.saveSellForm.templateName=this.saveForm.templateName,this.saveSellForm.freightTemplateId=this.saveForm.freightTemplateId,t=this.saveSellForm):t=this.saveForm;var a=!0,s=!1,i=void 0;try{for(var r,o=b()(this.saveForm.subList);!(a=(r=o.next()).done);a=!0){var l=r.value;if(l.areaId){if(!l.fristBatchNumber||!l.fristBatchCost)return this.$message.error("请填写首件数或首费"),!1;if((""===l.otherBatchNumber||""===l.otherBatchCost)&&"0"!=l.otherBatchNumber&&"0"!=l.otherBatchCost)return this.$message.error("请填写续件数或续费"),!1}}}catch(e){s=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw i}}var n={payload:t=O()(t)};A.post("/api-mall/add-update-shipping-templates",_.a.stringify(n)).then(function(t){0===t.data.errorCode?(e.$message.success("模板保存成功！！"),e.$router.push({name:"orderSet"})):e.$message.error(t.data.message)})}else this.$message.error("请填写默认运费");else this.$message.error("请填写模板名称！！")}},components:{}},Yt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("商城设置")]),e._v(" "),a("el-breadcrumb-item",{attrs:{to:{path:"/orderSet"}}},[e._v("订单设置")]),e._v(" "),a("el-breadcrumb-item",[e._v("编辑运费模板")])],1),e._v(" "),a("h3",[a("span",[e._v(e._s(e.pageTitle))])])],1),e._v(" "),a("div",{staticClass:"mall-section"},[a("div",{staticClass:"order-wrap-padding"},[a("div",{staticClass:"edit-wrap"},[a("div",{staticClass:"edit-title"},[e._v("模板名称")]),e._v(" "),a("div",{staticClass:"edit-content"},[a("el-input",{staticStyle:{width:"380px"},model:{value:e.saveForm.templateName,callback:function(t){e.$set(e.saveForm,"templateName",t)},expression:"saveForm.templateName"}})],1)]),e._v(" "),a("div",{staticClass:"edit-wrap"},[a("div",{staticClass:"edit-title"},[e._v("是否包邮")]),e._v(" "),a("div",{staticClass:"edit-content"},[a("el-radio-group",{model:{value:e.saveForm.freeShipping,callback:function(t){e.$set(e.saveForm,"freeShipping",t)},expression:"saveForm.freeShipping"}},[a("el-radio",{attrs:{label:0}},[e._v("自定义运费")]),e._v(" "),a("el-radio",{attrs:{label:1}},[e._v("卖家承担运费")])],1)],1)]),e._v(" "),0==e.saveForm.freeShipping?a("div",{staticClass:"edit-wrap"},[a("div",{staticClass:"edit-title"},[e._v("运费设置")]),e._v(" "),a("div",{staticClass:"edit-content-table"},[a("div",{staticClass:"template-list"},[a("div",{staticClass:"template-list-title"},[a("span",[e._v("默认运费")]),e._v(" "),a("div",{staticClass:"input-width"},[a("el-input",{attrs:{size:"small"},model:{value:e.saveForm.fristBatchNumber,callback:function(t){e.$set(e.saveForm,"fristBatchNumber",t)},expression:"saveForm.fristBatchNumber"}})],1),e._v(" "),a("span",[e._v("件内")]),e._v(" "),a("div",{staticClass:"input-width"},[a("el-input",{attrs:{size:"small"},model:{value:e.saveForm.fristBatchCost,callback:function(t){e.$set(e.saveForm,"fristBatchCost",t)},expression:"saveForm.fristBatchCost"}})],1),e._v(" "),a("span",[e._v("元，每增加")]),e._v(" "),a("div",{staticClass:"input-width"},[a("el-input",{attrs:{size:"small"},model:{value:e.saveForm.otherBatchNumber,callback:function(t){e.$set(e.saveForm,"otherBatchNumber",t)},expression:"saveForm.otherBatchNumber"}})],1),e._v(" "),a("span",[e._v("件，运费增加")]),e._v(" "),a("div",{staticClass:"input-width"},[a("el-input",{attrs:{size:"small"},model:{value:e.saveForm.otherBatchCost,callback:function(t){e.$set(e.saveForm,"otherBatchCost",t)},expression:"saveForm.otherBatchCost"}})],1),e._v(" "),a("span",[e._v("元")])]),e._v(" "),a("el-row",{staticClass:"template-list-wrap",staticStyle:{"background-color":"rgba(241, 243, 247, 1)",color:"#909399"}},[a("el-col",{attrs:{span:10}},[a("div",{staticClass:"grid-content"},[e._v("\n                    运送到\n                  ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n                    首件数（个）\n                  ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n                    首费（元）\n                  ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n                    续件数（个）\n                  ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n                    续费（元）\n                  ")])]),e._v(" "),a("el-col",{attrs:{span:2}},[a("div",{staticClass:"grid-content"},[e._v("\n                    操作\n                  ")])])],1),e._v(" "),e._l(e.saveForm.subList,function(t,s){return a("el-row",{key:t.subFreightTemplateId+s,staticClass:"template-list-wrap"},[a("el-col",{attrs:{span:9}},[a("div",{staticClass:"grid-content-area"},[e._v("\n                    "+e._s(t.areaName)+"\n                    "),t.areaName?e._e():a("a",{attrs:{href:"javascript:;"},on:{click:function(t){e.dialogAreaForm(s)}}},[e._v("点击设置地区")])])]),e._v(" "),a("el-col",{attrs:{span:1}},[a("div",{staticClass:"grid-content"},[t.areaName?a("a",{attrs:{href:"javascript:;"},on:{click:function(t){e.dialogAreaForm(s)}}},[e._v("编辑")]):e._e()])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[a("el-input",{attrs:{size:"small"},model:{value:t.fristBatchNumber,callback:function(a){e.$set(t,"fristBatchNumber",a)},expression:"item.fristBatchNumber"}})],1)]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[a("el-input",{attrs:{size:"small"},model:{value:t.fristBatchCost,callback:function(a){e.$set(t,"fristBatchCost",a)},expression:"item.fristBatchCost"}})],1)]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[a("el-input",{attrs:{size:"small"},model:{value:t.otherBatchNumber,callback:function(a){e.$set(t,"otherBatchNumber",a)},expression:"item.otherBatchNumber"}})],1)]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[a("el-input",{attrs:{size:"small"},model:{value:t.otherBatchCost,callback:function(a){e.$set(t,"otherBatchCost",a)},expression:"item.otherBatchCost"}})],1)]),e._v(" "),a("el-col",{attrs:{span:2}},[a("div",{staticClass:"grid-content"},[a("a",{attrs:{href:"javascript:;"},on:{click:function(t){e.deleteAreaItem(s)}}},[e._v("删除")])])])],1)})],2),e._v(" "),a("div",{staticClass:"add-template-list",staticStyle:{"margin-top":"10px"}},[a("a",{attrs:{href:"javascript:;"},on:{click:e.addTemplateList}},[a("i",{staticClass:"el-icon-plus"}),e._v(" "),a("span",[e._v("为指定地区设置运费")])])])])]):e._e(),e._v(" "),a("div",{staticClass:"comfire-btn",staticStyle:{"padding-bottom":"24px"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.saveTemplate}},[e._v("确认保存")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"选择区域",visible:e.dialogAreaFormVisible},on:{"update:visible":function(t){e.dialogAreaFormVisible=t}}},[a("div",{staticStyle:{height:"400px","overflow-y":"auto"}},[a("el-tree",{ref:"tree",attrs:{data:e.data2,"show-checkbox":"","node-key":"id","highlight-current":"","default-checked-keys":e.checkedKeys,props:e.defaultProps}})],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogAreaFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.getCheckedNodes}},[e._v("确 定")])],1)])],1)])])},staticRenderFns:[]};var Zt=a("VU/8")(Ht,Yt,!1,function(e){a("pThe")},"data-v-fe7b95d4",null).exports,Kt={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,mallForm:{defaultKeyword:"",hotKeyword:""},mallFormLen:{defaultWordLen:0,hotWordLen:0},mallRules:{defaultKeyword:[{required:!0,message:"请输入搜索框默认值",trigger:"blur"}],hotKeyword:[{required:!0,message:"热门搜索词",trigger:"blur"}]}}},mounted:function(){this.getMessage()},computed:{},methods:{defaultWordLimit:function(e){var t=this;this.$nextTick(function(){t.mallForm.defaultKeyword=C.getInputVal(e,20),t.mallFormLen.defaultWordLen=C.getZhLen(t.mallForm.defaultKeyword)})},hotWordLimit:function(e){var t=this;this.$nextTick(function(){t.mallForm.hotKeyword=C.getInputVal(e,200),t.mallFormLen.hotWordLen=C.getZhLen(t.mallForm.hotKeyword)})},getMessage:function(){var e=this;A.post("/api-mall/get_hot_word").then(function(t){0===t.data.errorCode?(e.mallForm=t.data.result,t.data.result&&(e.mallFormLen.defaultWordLen=C.getZhLen(e.mallForm.defaultKeyword),e.mallFormLen.hotWordLen=C.getZhLen(e.mallForm.hotKeyword))):e.$message.error(t.data.message)})},onSubmit:function(e){var t=this;"#"===this.mallForm.hotKeyword.substr(0,1)&&(this.mallForm.hotKeyword=this.mallForm.hotKeyword.substr(1)),this.$refs[e].validate(function(e){if(!e)return!1;var a={defaultKeyword:t.mallForm.defaultKeyword,hotKeyword:t.mallForm.hotKeyword};A.post("/api-mall/update_hot_word",_.a.stringify(a)).then(function(e){0===e.data.errorCode?t.$message.success("设置成功"):t.$message.error(e.data.message)})})}},components:{}},Jt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("商城设置")]),e._v(" "),a("el-breadcrumb-item",[e._v("搜索设置")])],1),e._v(" "),e._m(0)],1),e._v(" "),a("div",{staticClass:"mall-section"},[a("div",{staticClass:"common-content"},[a("el-form",{ref:"mallForm",attrs:{model:e.mallForm,rules:e.mallRules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"搜索框默认值",prop:"defaultKeyword"}},[a("el-input",{staticStyle:{width:"600px"},on:{input:function(t){return e.defaultWordLimit(t)}},model:{value:e.mallForm.defaultKeyword,callback:function(t){e.$set(e.mallForm,"defaultKeyword",t)},expression:"mallForm.defaultKeyword"}},[a("span",{staticStyle:{"margin-left":"5px"},attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.mallFormLen.defaultWordLen)+"/20")])])],1),e._v(" "),a("el-form-item",{staticStyle:{width:"720px"},attrs:{label:"热门搜索词",prop:"hotKeyword"}},[a("span",{staticStyle:{"font-size":"12px",color:"rgb(144, 147, 153)"}},[e._v("多个搜索词之间以“#”隔开，默认第一个不能是“#”")]),e._v(" "),a("el-input",{staticStyle:{width:"600px"},attrs:{type:"textarea",rows:"5"},on:{input:function(t){return e.hotWordLimit(t)}},model:{value:e.mallForm.hotKeyword,callback:function(t){e.$set(e.mallForm,"hotKeyword",t)},expression:"mallForm.hotKeyword"}}),e._v(" "),a("div",{staticStyle:{"font-size":"12px",color:"#c0c4cc",position:"absolute",right:"0px",bottom:"-30px"}},[a("span",{staticStyle:{float:"right"}},[e._v(e._s(e.mallFormLen.hotWordLen)+"/200")])])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("mallForm")}}},[e._v("保 存")])],1)],1)],1)])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("搜索设置")])])}]};var Wt=a("VU/8")(Kt,Jt,!1,function(e){a("68SA")},"data-v-4eff8567",null).exports,qt={props:{orderList:{type:Array,default:function(){return[]}},orderObj:{type:Object,default:function(){return{}}}},data:function(){return{checkAll:!1,isIndeterminate:!1,closeOrderDialog:!1,closeOrderForm:{closeReason:"",mallOrderId:""},logistics:[],deliveryOrder:{},deliveryOrderDialog:!1,deliveryOrderForm:{logisticsCompanyId:"",courierNumber:"",mallOrderId:""},splitOrderInfo:{},canDeliveryNum:0,splitDeliveryOrderDialog:!1,splitDeliveryOrderForm:{logisticsCompanyId:"",courierNumber:"",mallOrderId:"",itemDelivery:""},freightOrderDialog:!1,freightOrderForm:{actualFreight:"",orderId:""},list:[],windowUrl:window.location.origin,otherLogistics:!1,otherLogisticsName:"",orderItemOnlyOne:!1,deliveryLoading:!1,splitLoading:!1,closeLoading:!1,freightOrderLoading:!1}},mounted:function(){for(var e=0;e<this.list.length;e++)this.$set(this.list[e],"checked",!1);this.getLogistics()},filters:{times:function(e){var t=new Date(e);return t.getFullYear()+"-"+((t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-")+((t.getDate()<10?"0"+t.getDate():t.getDate())+" ")+((t.getHours()<10?"0"+t.getHours():t.getHours())+":")+((t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":")+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())},afterSales:function(e){return 1==e?"退款中":2==e?"退款成功":3==e?"退款关闭":""},orderStepName:function(e){return 0==e?"交易关闭":1==e?"待付款":2==e?"买家已付款":3==e?"已发货":4==e?"交易完成":7==e?"部分发货":""}},methods:{handleCheckAllChange:function(e){if(e)for(var t=0;t<this.list.length;t++)this.list[t].checked=!0;else for(var a=0;a<this.list.length;a++)this.list[a].checked=!1;this.isIndeterminate=!1},handleCheckedCitiesChange:function(e){for(var t=0,a=0;a<this.list.length;a++)this.list[a].checked&&(t+=1);this.checkAll=t===this.list.length,this.isIndeterminate=t>0&&t<this.list.length},closeOrderShow:function(e){this.closeOrderDialog=!0,this.closeOrderForm.mallOrderId=e},closeOrderDeal:function(){var e=this;if(""!=this.closeOrderForm.closeReason){var t={closeReason:this.closeOrderForm.closeReason,mallOrderId:this.closeOrderForm.mallOrderId,requestProject:"mall"};this.closeLoading=!0,A.post("/api-mall/close-mall-order",_.a.stringify(t)).then(function(t){0==t.data.errorCode?(e.$message({message:t.data.result,type:"success"}),e.$emit("listonupdate"),e.closeOrderDialog=!1,e.closeLoading=!1):(e.$message.error(t.data.message),e.closeLoading=!1)})}else this.$message.error("请填写关闭原因！")},canceclCloseOrderDeal:function(){this.closeOrderDialog=!1,this.closeOrderForm.closeReason=""},getLogistics:function(){var e=this;A.get("/api-mall/logisties-list",{params:{requestProject:"mall"}}).then(function(t){0==t.data.errorCode?e.logistics=t.data.result.logistiesList:e.$message.error(t.data.message)})},showdeliveryOrder:function(e,t){e.orderItemList&&(1!==e.orderItemList.length?this.orderItemOnlyOne=!1:this.orderItemOnlyOne=!0),this.deliveryOrder=e,this.deliveryOrderForm.mallOrderId=e.orderId,this.deliveryOrderDialog=!0},changeLogisticsCompanyName:function(e){e?"QITA"===this.logistics.find(function(t){return t.logisticsCompanyId===e}).logisticsCompanyCode?this.otherLogistics=!0:(this.otherLogistics=!1,this.otherLogisticsName=""):(this.otherLogistics=!1,this.otherLogisticsName="")},logisticsNameLimit:function(e){var t=this;this.$nextTick(function(){t.otherLogisticsName=C.getInputVal(e,8)})},courierNumberLimit:function(e){var t=this;this.$nextTick(function(){t.deliveryOrderForm.courierNumber=C.getInputVal(e,15)})},deliveryOrderDeal:function(){var e=this;if(this.deliveryOrderForm.logisticsCompanyId)if(this.deliveryOrderForm.courierNumber){if(/^[0-9a-zA-Z]+$/.test(this.deliveryOrderForm.courierNumber)){for(var t="",a="",s=0;s<this.logistics.length;s++)if(this.logistics[s].logisticsCompanyId==this.deliveryOrderForm.logisticsCompanyId){t=this.logistics[s].logisticsCompanyName,a=this.logistics[s].logisticsCompanyCode;break}if("QITA"!==a||""!==this.otherLogisticsName){var i={paramsJson:O()({deliverData:[{logisticsCompanyId:this.deliveryOrderForm.logisticsCompanyId,courierNumber:this.deliveryOrderForm.courierNumber,mallOrderId:this.deliveryOrderForm.mallOrderId,logisticsCompanyName:"QITA"===a?this.otherLogisticsName:t,logisticsCompanyCode:a}]}),type:0,requestProject:"mall"};this.deliveryLoading=!0,A.post("/api-mall/do-order-deliver",_.a.stringify(i)).then(function(t){0==t.data.errorCode?(e.$message({message:t.data.result,type:"success"}),e.$emit("listonupdate"),e.deliveryOrderDialog=!1,e.deliveryLoading=!1):(e.$message.error(t.data.message),e.deliveryLoading=!1)})}else this.$message.error("请填写物流名称")}else this.$message.error("物流单号只能是数字或字母")}else this.$message.error("请填写物流单号！！");else this.$message.error("请选择物流公司！！")},cancelDeliveryOrderDeal:function(){this.deliveryOrderDialog=!1,this.deliveryOrderForm.logisticsCompanyId="",this.deliveryOrderForm.courierNumber="",this.otherLogisticsName="",this.otherLogistics=!1},freightOrder:function(e){this.freightOrderForm.orderId=e,this.freightOrderDialog=!0},freightOrderDeal:function(){var e=this;if(Number(this.freightOrderForm.actualFreight)<0)return this.$message.error("快递运费不可为负"),!1;var t={actualFreight:this.freightOrderForm.actualFreight,orderId:this.freightOrderForm.orderId,requestProject:"mall"};this.freightOrderLoading=!0,A.post("/api-mall/modify-order-freight",_.a.stringify(t)).then(function(t){0==t.data.errorCode?(e.$message({message:t.data.result,type:"success"}),e.$emit("listonupdate"),e.freightOrderDialog=!1,e.freightOrderLoading=!1):(e.$message.error(t.data.message),e.freightOrderLoading=!1)})},cancelFreightOrderDeal:function(){this.freightOrderDialog=!1,this.freightOrderForm.actualFreight=""},goSplitDeliveryOrder:function(){var e=this.deliveryOrder;this.deliveryOrderDialog=!1,this.splitDeliveryOrder(e)},splitDeliveryOrder:function(e){for(var t=0,a=0;a<e.orderItemList.length;a++){var s=0;if(null==e.orderItemList[a].orderLogistics)e.orderItemList[a].orderLogistics=[{courierNumber:"",logisticsCompanyId:"",orderItemNum:"",isNew:!0,logisticsCompanyCode:"",otherLogistics:!1,otherLogisticsName:""}],s+=e.orderItemList[a].refundCount?parseInt(e.orderItemList[a].refundCount):0;else for(var i=0;i<e.orderItemList[a].orderLogistics.length;i++)s+=e.orderItemList[a].orderLogistics[i].orderItemNum?parseInt(e.orderItemList[a].orderLogistics[i].orderItemNum):0;s<e.orderItemList[a].mallProNumber&&(t+=1)}this.canDeliveryNum=t,this.splitOrderInfo=e,this.splitDeliveryOrderDialog=!0},changeLogisticsItem:function(e,t){e?"QITA"===this.logistics.find(function(t){return t.logisticsCompanyId===e}).logisticsCompanyCode?t.otherLogistics=!0:(t.otherLogistics=!1,t.otherLogisticsName=""):(t.otherLogistics=!1,t.otherLogisticsName="")},logisticsItemNameLimit:function(e,t){this.$nextTick(function(){t.otherLogisticsName=C.getInputVal(e,8)})},courierNumberItemLimit:function(e,t){this.$nextTick(function(){t.courierNumber=C.getInputVal(e,15)})},splitDeliveryOrderDeal:function(){for(var e=this,t=[],a="",s=0;s<this.splitOrderInfo.orderItemList.length;s++)for(var i=0;i<this.splitOrderInfo.orderItemList[s].orderLogistics.length;i++)if(this.splitOrderInfo.orderItemList[s].orderLogistics[i].isNew){if(""!==this.splitOrderInfo.orderItemList[s].orderLogistics[i].orderItemNum&&0===Number(this.splitOrderInfo.orderItemList[s].orderLogistics[i].orderItemNum)){a="拆单数量不能为0！！";break}if(!this.splitOrderInfo.orderItemList[s].orderLogistics[i].logisticsCompanyId&&this.splitOrderInfo.orderItemList[s].orderLogistics[i].courierNumber){a="请选择物流公司！！";break}if(!this.splitOrderInfo.orderItemList[s].orderLogistics[i].courierNumber&&this.splitOrderInfo.orderItemList[s].orderLogistics[i].logisticsCompanyId){a="请填写物流单号！！";break}var r=/^[0-9a-zA-Z]+$/;if(!r.test(this.splitOrderInfo.orderItemList[s].orderLogistics[i].courierNumber)&&this.splitOrderInfo.orderItemList[s].orderLogistics[i].logisticsCompanyId||!r.test(this.splitOrderInfo.orderItemList[s].orderLogistics[i].courierNumber)&&this.splitOrderInfo.orderItemList[s].orderLogistics[i].logisticsCompanyId){a="物流单号只能是数字或字母";break}for(var o={mallOrderId:this.splitOrderInfo.orderItemList[s].orderId,orderItemNum:this.splitOrderInfo.orderItemList[s].mallProNumber,logisticsCompanyId:this.splitOrderInfo.orderItemList[s].orderLogistics[i].logisticsCompanyId,logisticsCompanyName:"",logisticsCompanyCode:"",courierNumber:this.splitOrderInfo.orderItemList[s].orderLogistics[i].courierNumber,orderItemId:this.splitOrderInfo.orderItemList[s].orderItemId,orderItemSunNum:this.splitOrderInfo.orderItemList[s].mallProNumber,otherLogisticsName:this.splitOrderInfo.orderItemList[s].orderLogistics[i].otherLogistics?this.splitOrderInfo.orderItemList[s].orderLogistics[i].otherLogisticsName:""},l=0;l<this.logistics.length;l++)if(this.logistics[l].logisticsCompanyId==this.splitOrderInfo.orderItemList[s].orderLogistics[i].logisticsCompanyId){o.logisticsCompanyName=this.logistics[l].logisticsCompanyName,o.logisticsCompanyCode=this.logistics[l].logisticsCompanyCode,"QITA"===this.logistics[l].logisticsCompanyCode&&(o.logisticsCompanyName=o.otherLogisticsName);break}t.push(o)}var n=!0,d=!1,c=void 0;try{for(var u,m=b()(t);!(n=(u=m.next()).done);n=!0){var p=u.value;if("QITA"===p.logisticsCompanyCode&&""===p.logisticsCompanyName)return this.$message.error("请填写物流公司名称"),!1}}catch(e){d=!0,c=e}finally{try{!n&&m.return&&m.return()}finally{if(d)throw c}}for(var h=0;h<t.length;h++)t[h].logisticsCompanyCode||t[h].logisticsCompanyId||(t.splice(h,1),h=-1);if(a)this.$message.error(a);else{if(0===t.length)return this.$message.error("发货信息不能为空"),!1;var g={paramsJson:O()({deliverData:t}),type:0,requestProject:"mall"};this.splitLoading=!0,A.post("/api-mall/split-order-deliver",_.a.stringify(g)).then(function(t){0==t.data.errorCode?(e.$message({message:t.data.result,type:"success"}),e.$emit("listonupdate"),e.splitDeliveryOrderDialog=!1,e.splitLoading=!1):(e.$message.error(t.data.message),e.splitLoading=!1)})}},cancelSplitDeliveryOrderDeal:function(){this.splitDeliveryOrderDialog=!1},splitOrder:function(e){this.splitOrderInfo.orderItemList[e].orderLogistics.length+this.splitOrderInfo.orderItemList[e].refundCount>=this.splitOrderInfo.orderItemList[e].mallProNumber?this.$message.error("拆单数量不得大于当前单量！"):this.splitOrderInfo.orderItemList[e].orderLogistics.push({ordernum:"",wuliuName:"",wuliuNum:"",isNew:!0})},deleteOrder:function(e,t){this.splitOrderInfo.orderItemList[e].orderLogistics.splice(t,1)},limitOrderNumDeal:function(e,t){for(var a=0,s=0;s<this.splitOrderInfo.orderItemList[e].orderLogistics.length;s++){a+=this.splitOrderInfo.orderItemList[e].orderLogistics[s].orderItemNum?parseInt(this.splitOrderInfo.orderItemList[e].orderLogistics[s].orderItemNum):0}return a<0?(this.$message.error("输入正确的拆单数量！"),this.splitOrderInfo.orderItemList[e].orderLogistics[t].orderItemNum="",!1):a+this.splitOrderInfo.orderItemList[e].refundCount>this.splitOrderInfo.orderItemList[e].mallProNumber?(this.$message.error("输入数量之和不得大于当前单量！"),void(this.splitOrderInfo.orderItemList[e].orderLogistics[t].orderItemNum="")):void 0},goToDetail:function(e){window.localStorage.setItem("orderObj",O()(this.orderObj)),this.$router.push({name:"orderDetails",params:{orderId:e}})}},watch:{orderList:function(e){this.list=e}}},Qt={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{staticClass:"order-list-title"},[a("el-col",{attrs:{span:3}},[a("div",[a("el-checkbox",{staticClass:"order-checkbox",attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")])],1)]),e._v(" "),a("el-col",{attrs:{span:5}},[a("div",{staticClass:"grid-content"},[e._v("\n        商品\n      ")])]),e._v(" "),a("el-col",{attrs:{span:2}},[a("div",{staticClass:"grid-content",staticStyle:{"text-align":"center"}},[e._v("\n        单价\n      ")])]),e._v(" "),a("el-col",{attrs:{span:2}},[a("div",{staticClass:"grid-content",staticStyle:{"text-align":"center"}},[e._v("\n        数量\n      ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content",staticStyle:{"text-align":"center"}},[e._v("\n        售后\n      ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content",staticStyle:{"text-align":"center"}},[e._v("\n        买家\n      ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content",staticStyle:{"text-align":"center"}},[e._v("\n        交易状态\n      ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content",staticStyle:{"text-align":"center"}},[e._v("\n        实付金额\n      ")])])],1),e._v(" "),e.list.length>0?a("div",e._l(e.list,function(t,s){return a("div",{key:s,staticClass:"order-list-wrap"},[a("div",{staticClass:"order-item-title"},[a("el-checkbox",{attrs:{label:t.id},on:{change:e.handleCheckedCitiesChange},model:{value:t.checked,callback:function(a){e.$set(t,"checked",a)},expression:"item.checked"}}),e._v(" "),a("span",{staticStyle:{"margin-right":"43px"}},[e._v("订单编号："+e._s(t.orderNumber))]),e._v(" "),a("span",[e._v("下单时间："+e._s(e._f("times")(t.createTime)))]),e._v(" "),a("span",{staticClass:"order-detail",on:{click:function(a){e.goToDetail(t.orderId)}}},[e._v("\n          订单详情\n          "),a("i",{staticClass:"el-icon-arrow-right"})])],1),e._v(" "),a("div",{staticClass:"order-item-wrap"},[a("table",[a("tbody",e._l(t.orderItemList,function(s,i){return a("tr",{key:i},[a("td",[a("div",{staticClass:"goods-info"},[a("div",[a("a",{attrs:{href:"javascript:;"}},[a("img",{staticClass:"imgs-style",attrs:{src:s.mallProImageUrl,alt:""}})])]),e._v(" "),a("div",{staticClass:"goods-text"},[a("div",{staticClass:"goods-text-name"},[1===s.isGift?a("span",{staticClass:"zeng-pin"},[e._v("赠品")]):e._e(),a("span",[e._v(e._s(s.mallProName))])]),e._v(" "),a("div",{staticClass:"goods-text-info"},[a("div",e._l(JSON.parse(s.mallProSkuAttr),function(t,s){return a("span",{key:s},[e._v(e._s(t.propName)+"："+e._s(t.valueName)+"   ")])})),e._v(" "),a("div",[e._v("SKU编码："+e._s(s.mallProSkuCode))])])])])]),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[a("span",[e._v("￥"+e._s(s.mallProPrice))])])]),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[a("span",[e._v(e._s(s.mallProNumber))])])]),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[a("span",[e._v(e._s(e._f("afterSales")(s.refundStatus)))])])]),e._v(" "),0==i&&t.orderItemList.length>1?a("td",{staticClass:"border-left",attrs:{rowspan:t.orderItemList.length}},[a("div",{staticClass:"grid-content-other"},[a("div",[e._v(e._s(t.memberName))]),e._v(" "),a("div",[a("a",{attrs:{href:e.windowUrl+"/member/#/wechatmemberDetail?memberId="+t.memberId,target:"_blank"}},[e._v(e._s(t.memberCardNum))])])])]):0==i?a("td",{attrs:{rowspan:t.orderItemList.length}},[a("div",{staticClass:"grid-content-other"},[a("div",[e._v(e._s(t.memberName))]),e._v(" "),a("div",[a("a",{attrs:{href:e.windowUrl+"/member/#/wechatmemberDetail?memberId="+t.memberId,target:"_blank"}},[e._v(e._s(t.memberCardNum))])])])]):e._e(),e._v(" "),0==i?a("td",{attrs:{rowspan:t.orderItemList.length}},[a("div",{staticClass:"grid-content-other"},[a("div",[e._v(e._s(e._f("orderStepName")(t.orderStep)))]),e._v(" "),1==t.orderStep?a("div",{on:{click:function(a){e.closeOrderShow(t.orderId)}}},[a("a",{attrs:{href:"javascript:;"}},[e._v("关闭订单")])]):e._e(),e._v(" "),2===t.orderStep?a("div",{on:{click:function(a){e.showdeliveryOrder(t,s.refundStatus)}}},[a("a",{attrs:{href:"javascript:;"}},[e._v("发货")])]):e._e(),e._v(" "),7===t.orderStep?a("div",{on:{click:function(a){e.splitDeliveryOrder(t)}}},[a("a",{attrs:{href:"javascript:;"}},[e._v("发货")])]):e._e()])]):e._e(),e._v(" "),0==i?a("td",{attrs:{rowspan:t.orderItemList.length}},[a("div",{staticClass:"grid-content-other"},[a("div",[e._v("￥"+e._s((t.payAmount+t.actualFreight).toFixed(2))+" (含运费：￥"+e._s(t.actualFreight)+")")]),e._v(" "),1==t.orderStep?a("div",{on:{click:function(a){e.freightOrder(t.orderId)}}},[a("a",{attrs:{href:"javascript:;"}},[e._v("修改运费")])]):e._e()])]):e._e()])}))])])])})):a("div",[e._m(0)]),e._v(" "),a("el-dialog",{attrs:{title:"关闭订单",visible:e.closeOrderDialog,width:"464px"},on:{"update:visible":function(t){e.closeOrderDialog=t},close:e.canceclCloseOrderDeal}},[a("div",{staticClass:"close-reason"},[e._v("关闭原因")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[a("el-input",{attrs:{type:"textarea",rows:3},model:{value:e.closeOrderForm.closeReason,callback:function(t){e.$set(e.closeOrderForm,"closeReason",t)},expression:"closeOrderForm.closeReason"}})],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.canceclCloseOrderDeal}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.closeLoading},on:{click:e.closeOrderDeal}},[e._v("确 定")])],1)]),e._v(" "),a("el-dialog",{attrs:{visible:e.deliveryOrderDialog,width:"464px"},on:{"update:visible":function(t){e.deliveryOrderDialog=t},close:e.cancelDeliveryOrderDeal}},[a("div",{staticClass:"all-delivery",attrs:{slot:"title"},slot:"title"},[e._v("\n      整单发货\n      "),0==e.deliveryOrder.splitDeliverGoodsOnOff||e.orderItemOnlyOne?e._e():a("div",{staticClass:"go-split-delivery",on:{click:function(t){e.goSplitDeliveryOrder()}}},[a("a",{attrs:{href:"javascript:;"}},[e._v("去拆单发货")])])]),e._v(" "),a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"close-reason"},[e._v("收货信息:")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[e._v(e._s(e.deliveryOrder.buyerName)+","+e._s(e.deliveryOrder.buyerPhone)+","+e._s(e.deliveryOrder.areaName)+" "+e._s(e.deliveryOrder.addressInfo))])]),e._v(" "),a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"close-reason"},[e._v("物流公司")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[a("el-select",{staticClass:"width-style",attrs:{clearable:"",filterable:"",placeholder:"请选择"},on:{change:e.changeLogisticsCompanyName},model:{value:e.deliveryOrderForm.logisticsCompanyId,callback:function(t){e.$set(e.deliveryOrderForm,"logisticsCompanyId",t)},expression:"deliveryOrderForm.logisticsCompanyId"}},e._l(e.logistics,function(e){return a("el-option",{key:e.logisticsCompanyId,attrs:{label:e.logisticsCompanyName,value:e.logisticsCompanyId}})}))],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.otherLogistics,expression:"otherLogistics"}],staticStyle:{"margin-left":"75px",width:"340px","margin-bottom":"22px"}},[a("el-input",{attrs:{placeholder:"请输入快递公司"},on:{input:function(t){return e.logisticsNameLimit(t)}},model:{value:e.otherLogisticsName,callback:function(t){e.otherLogisticsName=t},expression:"otherLogisticsName"}}),e._v(" "),a("span",{staticClass:"other-name-warm"},[e._v("若设置为其他快递公司，则系统不提供物流信息查询")])],1),e._v(" "),a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"close-reason"},[e._v("物流单号")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[a("el-input",{attrs:{type:"text"},on:{input:function(t){return e.courierNumberLimit(t)}},model:{value:e.deliveryOrderForm.courierNumber,callback:function(t){e.$set(e.deliveryOrderForm,"courierNumber",t)},expression:"deliveryOrderForm.courierNumber"}})],1)]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelDeliveryOrderDeal}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.deliveryLoading},on:{click:e.deliveryOrderDeal}},[e._v("确 定")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"拆单发货",visible:e.splitDeliveryOrderDialog,width:"88%"},on:{"update:visible":function(t){e.splitDeliveryOrderDialog=t}}},[a("el-row",{staticClass:"split-title"},[a("el-col",{attrs:{span:12}},[e._v(" 当前收货信息共有可发货 "+e._s(e.canDeliveryNum)+"个订单 ")]),e._v(" "),a("el-col",{attrs:{span:12}},[e._v(" 收货信息： "+e._s(e.splitOrderInfo.buyerName)+","+e._s(e.splitOrderInfo.buyerPhone)+","+e._s(e.splitOrderInfo.areaName)+" "+e._s(e.splitOrderInfo.addressInfo)+" ")])],1),e._v(" "),a("el-row",{staticClass:"order-list-title"},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[e._v("\n          商品\n        ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content grid-center"},[e._v("\n          购买数量\n        ")])]),e._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content"},[e._v("\n          物流公司\n        ")])]),e._v(" "),a("el-col",{attrs:{span:5}},[a("div",{staticClass:"grid-content"},[e._v("\n          物流单号\n        ")])]),e._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content"},[e._v("\n          交易状态\n        ")])])],1),e._v(" "),a("div",{staticClass:"order-item-title"},[a("span",[e._v("订单编号："+e._s(e.splitOrderInfo.orderNumber))]),e._v(" "),a("span",[e._v("下单时间："+e._s(e._f("times")(e.splitOrderInfo.createTime)))])]),e._v(" "),a("div",{staticClass:"order-item-wrap"},[a("table",{staticClass:"split-table"},[a("tbody",e._l(e.splitOrderInfo.orderItemList,function(t,s){return a("tr",{key:s},[a("td",[a("div",{staticClass:"goods-info"},[a("div",[a("a",{attrs:{href:"javascript:;"}},[a("img",{staticClass:"imgs-style",attrs:{src:t.mallProImageUrl,alt:""}})])]),e._v(" "),a("div",{staticClass:"goods-text"},[a("div",{staticClass:"goods-text-name"},[1===t.isGift?a("span",{staticClass:"zeng-pin"},[e._v("赠品")]):e._e(),a("span",[e._v(e._s(t.mallProName))])]),e._v(" "),a("div",{staticClass:"goods-text-info"},[a("div",e._l(JSON.parse(t.mallProSkuAttr),function(t,s){return a("span",{key:s},[e._v(e._s(t.propName)+"："+e._s(t.valueName)+"   ")])})),e._v(" "),a("div",[e._v("SKU编码："+e._s(t.mallProSkuCode))])])])])]),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[a("span",[e._v(e._s(t.mallProNumber)+" ")]),e._v(" "),t.refundCount>0?a("span",[e._v("(已退"+e._s(t.refundCount)+") ")]):e._e()])]),e._v(" "),a("td",e._l(t.orderLogistics,function(t,s){return a("div",{key:s,staticClass:"split-logistics-other"},[a("p",[a("el-select",{attrs:{disabled:!t.isNew,clearable:"",filterable:"",placeholder:"请选择"},on:{change:function(a){return e.changeLogisticsItem(a,t)}},model:{value:t.logisticsCompanyId,callback:function(a){e.$set(t,"logisticsCompanyId",a)},expression:"itemss.logisticsCompanyId"}},e._l(e.logistics,function(e){return a("el-option",{key:e.logisticsCompanyId,attrs:{label:e.logisticsCompanyName,value:e.logisticsCompanyId}})}))],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.otherLogistics,expression:"itemss.otherLogistics"}],staticStyle:{"margin-top":"14px"}},[a("el-input",{attrs:{placeholder:"请输入快递公司"},on:{input:function(a){return e.logisticsItemNameLimit(a,t)}},model:{value:t.otherLogisticsName,callback:function(a){e.$set(t,"otherLogisticsName",a)},expression:"itemss.otherLogisticsName"}}),e._v(" "),a("span",{staticClass:"other-name-warm"},[e._v("若设置为其他快递公司，则系统不提供物流信息查询")])],1)])})),e._v(" "),a("td",e._l(t.orderLogistics,function(t,i){return a("div",{key:i,staticClass:"split-content-other"},[a("p",{staticClass:"split-order-wuliunum"},[a("el-input",{attrs:{disabled:!t.isNew,placeholder:"请输入内容"},on:{input:function(a){return e.courierNumberItemLimit(a,t)}},model:{value:t.courierNumber,callback:function(a){e.$set(t,"courierNumber",a)},expression:"itemss.courierNumber"}})],1),e._v(" "),i>0&&t.isNew?a("p",[a("el-button",{attrs:{type:"text"},on:{click:function(t){e.deleteOrder(s,i)}}},[e._v("删除")])],1):a("p",{staticStyle:{visibility:"hidden"}},[e._v("删除")])])})),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[a("span",[e._v(e._s(e._f("orderStepName")(t.orderItemStatus)))])])])])}))])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelSplitDeliveryOrderDeal}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.splitLoading},on:{click:e.splitDeliveryOrderDeal}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"修改运费",visible:e.freightOrderDialog,width:"464px"},on:{"update:visible":function(t){e.freightOrderDialog=t},close:e.cancelFreightOrderDeal}},[a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"close-reason"},[e._v("快递运费")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[a("el-input",{attrs:{type:"number"},model:{value:e.freightOrderForm.actualFreight,callback:function(t){e.$set(e.freightOrderForm,"actualFreight",t)},expression:"freightOrderForm.actualFreight"}},[a("template",{slot:"append"},[e._v("\n            元\n          ")])],2)],1)]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelFreightOrderDeal}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.freightOrderLoading},on:{click:e.freightOrderDeal}},[e._v("确 定")])],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"no-data-wrap"},[t("div",{staticClass:"no-data-icon"},[t("img",{attrs:{src:a("8Td+")}})]),this._v(" "),t("p",[this._v("暂无数据")])])}]};var Xt={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,pickerOptions2:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},getTimeAll:C.formatDate,length:0,activeName:"-1",dateValue:[new Date-7776e6,(new Date).valueOf()],startDate:"",endDate:"",saleStatus:-1,orderStatus:-1,searchparams:"",evaluateStatus:-1,orderList:[],loading:!0,pageSize:20,pageNum:1,currentPage4:1,total:0,orderObj:{pageNum:1,pageSize:20,searchparams:"",activeName:"-1",startDate:"",endDate:""},projectName:"mall",dialogVisible:!1,excelUrl:"/api-mall/order-list-excel",params:{},tableData:[]}},mounted:function(){localStorage.getItem("orderObj")&&(this.orderObj=JSON.parse(localStorage.getItem("orderObj")),this.pageNum=this.orderObj.pageNum,this.pageSize=this.orderObj.pageSize,this.searchparams=this.orderObj.searchparams,this.activeName=this.orderObj.activeName,this.startDate=this.orderObj.startDate,this.endDate=this.orderObj.endDate,this.orderObj.startDate?(this.dateValue=[],this.dateValue[0]=this.orderObj.startDate,this.dateValue[1]=this.orderObj.endDate):this.dateValue="",this.orderStatus=this.orderObj.activeName,localStorage.removeItem("orderObj")),this.getOrderList()},computed:{},methods:{handleSizeChange:function(e){this.pageSize=e,this.orderObj.pageSize=e,this.getOrderList()},handleCurrentChange:function(e){this.pageNum=e,this.orderObj.pageNum=e,this.getOrderList()},handleClick:function(e,t){this.pageNum=1,this.orderObj.activeName=e.name,"11"==e.name?(this.saleStatus=1,this.orderStatus=-1):(this.saleStatus=-1,this.orderStatus=e.name),this.getOrderList()},batchDeliveryView:function(){if(2==this.orderStatus){this.dateValue?(this.startDate=this.dateValue[0],this.endDate=this.dateValue[1]):(this.startDate="",this.endDate="");for(var e={orderIds:"",startDate:this.startDate,endDate:this.endDate,searchInput:this.searchparams,requestProject:"mall"},t=0;t<this.orderList.length;t++)this.orderList[t].checked&&(e.orderIds+=this.orderList[t].orderId+",");if(""===e.orderIds)return this.$message.error("请选择批量发货的订单"),!1;this.$router.push({name:"batchDelivery",params:{searchObj:e}})}else this.$message.error("批量发货只能是待发货的订单！！")},changeTime:function(){this.dateValue?(this.orderObj.startDate=this.dateValue[0],this.orderObj.endDate=this.dateValue[1]):(this.orderObj.startDate="",this.orderObj.endDate=""),this.pageNum=1,this.getOrderList()},getSearchOrderList:function(){this.pageNum=1,this.orderObj.searchparams=this.searchparams,this.getOrderList()},getOrderList:function(){var e=this;this.loading=!0,this.dateValue?(this.startDate=this.getTimeAll(this.dateValue[0]),this.endDate=this.getTimeAll(this.dateValue[1])):(this.startDate="",this.endDate="");var t={pageNum:this.pageNum,pageSize:this.pageSize,evaluateStatus:this.evaluateStatus,saleStatus:this.saleStatus,orderStatus:this.orderStatus,startDate:this.startDate,endDate:this.endDate,searchparams:this.searchparams,isSearchLogistics:1,requestProject:"mall"};A.post("/api-mall/page-mall-order",_.a.stringify(t)).then(function(t){0===t.data.errorCode?t.data.result.result?(e.orderList=t.data.result.result,e.total=t.data.result.totalCount,e.loading=!1):(e.orderList=[],e.total=0,e.loading=!1):e.$message.error(t.data.message)})},formatDig:function(e){return e>9?""+e:"0"+e},formatDate:function(e){var t=new Date(e),a=t.getFullYear(),s=t.getMonth()+1,i=t.getDate(),r=t.getHours(),o=t.getMinutes(),l=t.getSeconds();return a+"-"+this.formatDig(s)+"-"+this.formatDig(i)+" "+this.formatDig(r)+":"+this.formatDig(o)+":"+this.formatDig(l)},exportOrderList:function(){if(!this.dateValue)return this.startDate="",this.endDate="",void this.$message.error("导出订单必须选择时间段！！");this.startDate=this.formatDate(this.dateValue[0]),this.endDate=this.formatDate(this.dateValue[1]),this.dialogVisible=!0,this.params={evaluateStatus:this.evaluateStatus,saleStatus:this.saleStatus,orderStatus:this.orderStatus,startDate:this.startDate,endDate:this.endDate,searchparams:this.searchparams,requestProject:"mall"}}},components:{layoutTable:a("VU/8")(qt,Qt,!1,function(e){a("8NxH")},"data-v-28b5927c",null).exports}},ea={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title",staticStyle:{position:"relative",border:"none"}},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("订单管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("所有订单")])],1),e._v(" "),e._m(0)],1),e._v(" "),a("div",{staticClass:"mall-section"},[a("el-tabs",{staticClass:"tabs-wrap",staticStyle:{background:"#fff","padding-left":"25px"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"全部",name:"-1"}}),e._v(" "),a("el-tab-pane",{attrs:{label:"待付款",name:"1"}}),e._v(" "),a("el-tab-pane",{attrs:{label:"待发货",name:"2"}}),e._v(" "),a("el-tab-pane",{attrs:{label:"部分发货",name:"7"}}),e._v(" "),a("el-tab-pane",{attrs:{label:"已发货",name:"3"}}),e._v(" "),a("el-tab-pane",{attrs:{label:"交易成功",name:"4"}}),e._v(" "),a("el-tab-pane",{attrs:{label:"交易关闭",name:"0"}}),e._v(" "),a("el-tab-pane",{attrs:{label:"退款中",name:"11"}})],1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"order-wrap-padding"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:16}},[a("div",{staticClass:"order-selects"},[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{type:"datetimerange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions2},on:{change:e.changeTime},model:{value:e.dateValue,callback:function(t){e.dateValue=t},expression:"dateValue"}})],1),e._v(" "),a("div",{staticClass:"fl"},[a("el-input",{attrs:{placeholder:"请输入会员/商品/订单信息",clearable:"","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.getSearchOrderList()}},model:{value:e.searchparams,callback:function(t){e.searchparams="string"==typeof t?t.trim():t},expression:"searchparams"}})],1)])]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"fr"},[a("el-button",{attrs:{type:"primary"},on:{click:e.batchDeliveryView}},[e._v("批量发货")]),a("el-button",{attrs:{plain:""},on:{click:function(t){e.exportOrderList()}}},[a("i",{staticClass:"iconfont icon-icon_yunxiazai",staticStyle:{"margin-right":"5px"}}),e._v("导出订单")])],1)])],1),e._v(" "),a("div",{staticStyle:{"margin-top":"24px"}},[a("layoutTable",{attrs:{orderList:e.orderList,orderObj:e.orderObj},on:{listonupdate:e.getOrderList}})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.orderList.length>0,expression:"orderList.length > 0"}],staticClass:"block-page-wrap"},[a("div",{staticClass:"block-page"},[0!=e.total?a("el-pagination",{attrs:{background:"","current-page":e.pageNum,"page-sizes":[20,40,60,80],"page-size":20,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)])],1)],1)]),e._v(" "),a("vue-gic-export-excel",{attrs:{dataArr:e.orderList,dialogVisible:e.dialogVisible,type:2,excelUrl:e.excelUrl,params:e.params,projectName:e.projectName},on:{"update:dialogVisible":function(t){e.dialogVisible=t}}})],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("所有订单")])])}]};var ta=a("VU/8")(Xt,ea,!1,function(e){a("1HiJ")},"data-v-44d74c1e",null).exports,aa={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,getTime:C.getTime,getSeconds:C.getSeconds,show3:!0,order:{},orderDetails:"",length:0,freightOrderDialog:!1,freightOrderForm:{actualFreight:"",orderId:""},closeOrderDialog:!1,closeOrderForm:{closeReason:"",mallOrderId:""},logistics:[],errordialogVisible:!1,deliveryOrder:{},deliveryOrderDialog:!1,deliveryOrderForm:{logisticsCompanyId:"",courierNumber:"",mallOrderId:""},splitOrderInfo:{},canDeliveryNum:0,splitDeliveryOrderDialog:!1,parcelList:[],dialogOrderEvaluation:!1,orderEvalationAllList:[],orderEvalationList:[],goodsEvalationList:[],goodsEvalationTime:"",mallSaleNum:0,deliverNum:0,windowUrl:window.location.origin,favorablePrice:0,logisticsVisible:!1,logisticsEditNum:"",logisticsEdiOldtNum:"",parcelId:"",discountTotal:0,otherLogistics:!1,otherLogisticsName:"",orderItemOnlyOne:!1,deliveryLoading:!1,splitLoading:!1,logisticsLoading:!1,closeOrderLoading:!1,actualFreightLoading:!1}},mounted:function(){window.onbeforeunload=function(e){localStorage.removeItem("orderObj")},this.mallOrderId=this.$route.params.orderId,this.getOrderDetails(this.mallOrderId),this.getParcelList()},computed:{},filters:{timesOther:function(e){var t=new Date(e);return t.getFullYear()+"-"+((t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-")+((t.getDate()<10?"0"+t.getDate():t.getDate())+" ")+((t.getHours()<10?"0"+t.getHours():t.getHours())+":")+((t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":")+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())},afterSales:function(e){return 1==e||4==e||5==e||6==e?"退款中":2==e?"退款成功":3==e?"退款关闭":"--"},orderStepName:function(e){return 0==e?"交易关闭":1==e?"待付款":2==e?"买家已付款":3==e?"已发货":4==e?"交易完成":4==e?"部分发货":""}},methods:{logisticsEditNumLimit:function(e){var t=this;this.$nextTick(function(){t.logisticsEditNum=C.getInputValSin(e,30)})},showLogistics:function(e){this.logisticsEditNum=e.courierNumber,this.logisticsEdiOldtNum=e.courierNumber,this.parcelId=e.mallOrderLogisticsId,this.logisticsVisible=!0},submitLogistics:function(){var e=this;if(""===this.logisticsEdiOldtNum)return this.$message.error("请填写物流单号"),!1;if(this.logisticsEdiOldtNum===this.logisticsEditNum)return this.$message.error("请修改物流单号"),!1;if(/^[0-9a-zA-Z]+$/.test(this.logisticsEditNum)){var t={mallOrderLogisticsId:this.parcelId,courierNumber:this.logisticsEditNum};this.logisticsLoading=!0,A.post("/api-mall/update-courier-number",_.a.stringify(t)).then(function(t){0==t.data.errorCode?(e.$message.success("修改成功"),e.getParcelList(),e.logisticsVisible=!1,e.logisticsLoading=!1):(e.$message.error(t.data.message),e.logisticsLoading=!1)})}else this.$message.error("物流单号只能是数字或字母")},cancelSubmitLogistics:function(){this.logisticsEditNum="",this.parcelId="",this.logisticsVisible=!1},getEvaluationList:function(){var e=this,t={mallOrderId:this.mallOrderId};A.post("/api-mall/mall-order-evaluate",_.a.stringify(t)).then(function(t){if(0==t.data.errorCode){for(var a in e.orderEvalationList=[],e.goodsEvalationList=[],t.data.result)2===t.data.result[a].evaluateType?e.goodsEvalationList.push(t.data.result[a]):e.orderEvalationList.push(t.data.result[a]);e.goodsEvalationTime=e.orderEvalationList[0].createTime}else e.$message.error(t.data.message)})},getOrderDetails:function(e){var t=this,a={orderId:e,requestProject:"mall"};A.get("/api-mall/get-mall-order-detail",{params:a}).then(function(e){if(0==e.data.errorCode){t.orderDetails=e.data.result,t.logistics=e.data.result.logistiesList;var a=0;for(var s in t.orderDetails.order.orderItemList)a+=t.orderDetails.order.orderItemList[s].mallProNumber;t.mallSaleNum=a;var i=0,r=!0,o=!1,l=void 0;try{for(var n,d=b()(t.orderDetails.discountInformation);!(r=(n=d.next()).done);r=!0){var c=n.value;i+=Number(c.amountValue)}}catch(e){o=!0,l=e}finally{try{!r&&d.return&&d.return()}finally{if(o)throw l}}t.favorablePrice=i.toFixed(2)}else t.$message.error(e.data.message);var u=!0,m=!1,p=void 0;try{for(var h,g=b()(t.orderDetails.order.orderItemList);!(u=(h=g.next()).done);u=!0){var v=h.value;v.discountTotal=0;var f=!0,y=!1,_=void 0;try{for(var C,I=b()(v.discountInformation);!(f=(C=I.next()).done);f=!0){var S=C.value;v.discountTotal+=S.amountValue}}catch(e){y=!0,_=e}finally{try{!f&&I.return&&I.return()}finally{if(y)throw _}}v.discountTotal=v.discountTotal.toFixed(2)}}catch(e){m=!0,p=e}finally{try{!u&&g.return&&g.return()}finally{if(m)throw p}}})},freightOrder:function(){this.freightOrderForm.orderId=this.mallOrderId,this.freightOrderDialog=!0},freightOrderDeal:function(){var e=this;if(Number(this.freightOrderForm.actualFreight)<0)return this.$message.error("快递运费不可为负"),this.freightOrderForm.actualFreight=0,!1;var t={actualFreight:this.freightOrderForm.actualFreight,orderId:this.freightOrderForm.orderId,requestProject:"mall"};this.actualFreightLoading=!0,A.post("/api-mall/modify-order-freight",_.a.stringify(t)).then(function(t){0==t.data.errorCode?(e.$message({message:t.data.result,type:"success"}),e.$emit("listonupdate"),e.freightOrderDialog=!1,e.actualFreightLoading=!1):(e.$message.error(t.data.message),e.actualFreightLoading=!1)})},cancelFreightOrderDeal:function(){this.freightOrderDialog=!1,this.freightOrderForm.actualFreight=""},closeOrderShow:function(e){this.closeOrderDialog=!0,this.closeOrderForm.mallOrderId=this.mallOrderId},closeOrderDeal:function(){var e=this;if(""!=this.closeOrderForm.closeReason){var t={closeReason:this.closeOrderForm.closeReason,mallOrderId:this.closeOrderForm.mallOrderId,requestProject:"mall"};this.closeOrderLoading=!0,A.post("/api-mall/close-mall-order",_.a.stringify(t)).then(function(t){0==t.data.errorCode?(e.$message({message:t.data.result,type:"success"}),e.$emit("listonupdate"),e.closeOrderDialog=!1,e.closeOrderLoading=!1):(e.$message.error(t.data.message),e.closeOrderLoading=!1)})}else this.$message.error("请填写关闭原因！")},cancelCloseOrderDeal:function(){this.closeOrderDialog=!1,this.closeOrderForm.closeReason=""},showdeliveryOrder:function(){this.orderDetails.order.orderItemList&&(1!==this.orderDetails.order.orderItemList.length?this.orderItemOnlyOne=!1:this.orderItemOnlyOne=!0),this.deliveryOrderForm.mallOrderId=this.mallOrderId,this.deliveryOrderDialog=!0},changeLogisticsCompanyName:function(e){e?"QITA"===this.logistics.find(function(t){return t.logisticsCompanyId===e}).logisticsCompanyCode?this.otherLogistics=!0:(this.otherLogistics=!1,this.otherLogisticsName=""):(this.otherLogistics=!1,this.otherLogisticsName="")},logisticsNameLimit:function(e){var t=this;this.$nextTick(function(){t.otherLogisticsName=C.getInputVal(e,8)})},courierNumberLimit:function(e){var t=this;this.$nextTick(function(){t.deliveryOrderForm.courierNumber=C.getInputVal(e,15)})},deliveryOrderDeal:function(){var e=this;if(this.deliveryOrderForm.logisticsCompanyId)if(this.deliveryOrderForm.courierNumber){if(/^[0-9a-zA-Z]+$/.test(this.deliveryOrderForm.courierNumber)){for(var t="",a="",s=0;s<this.logistics.length;s++)if(this.logistics[s].logisticsCompanyId==this.deliveryOrderForm.logisticsCompanyId){t=this.logistics[s].logisticsCompanyName,a=this.logistics[s].logisticsCompanyCode;break}if("QITA"!==a||""!==this.otherLogisticsName){var i={paramsJson:O()({deliverData:[{logisticsCompanyId:this.deliveryOrderForm.logisticsCompanyId,courierNumber:this.deliveryOrderForm.courierNumber,mallOrderId:this.deliveryOrderForm.mallOrderId,logisticsCompanyName:"QITA"===a?this.otherLogisticsName:t,logisticsCompanyCode:a}]}),type:0,requestProject:"mall"};this.deliveryLoading=!0,A.post("/api-mall/do-order-deliver",_.a.stringify(i)).then(function(t){0==t.data.errorCode?(e.$message({message:t.data.result,type:"success"}),e.deliveryLoading=!1,e.deliveryOrderDialog=!1,e.getOrderDetails(e.mallOrderId),e.getParcelList()):(e.deliveryLoading=!1,e.$message.error(t.data.message))})}else this.$message.error("请填写物流名称")}else this.$message.error("物流单号只能是数字或字母")}else this.$message.error("请填写物流单号！！");else this.$message.error("请选择物流公司！！")},cancelDeliveryOrderDeal:function(){this.deliveryOrderDialog=!1,this.deliveryOrderForm.logisticsCompanyId="",this.deliveryOrderForm.courierNumber="",this.otherLogisticsName="",this.otherLogistics=!1},getParcelList:function(){var e=this,t={mallOrderId:this.mallOrderId,requestProject:"mall"};A.get("/api-mall/order-logistics",{params:t}).then(function(t){if(0==t.data.errorCode){for(var a=0,s=0;s<t.data.result.length;s++)t.data.result[s].show=!1;for(var i in t.data.result)for(var r in t.data.result[i].orderItems)a+=t.data.result[i].orderItems[r].orderItemNumCount;e.parcelList=t.data.result,e.deliverNum=a}else e.$message.error(t.data.message)})},showParcelLoginstics:function(e){this.parcelList[e].show=!this.parcelList[e].show},goSplitDeliveryOrder:function(){var e=this.orderDetails.order;this.deliveryOrderDialog=!1,this.splitDeliveryOrder(e)},splitDeliveryOrder:function(e){for(var t=0,a=0;a<e.orderItemList.length;a++){var s=0;if(null==e.orderItemList[a].orderLogistics)e.orderItemList[a].orderLogistics=[{courierNumber:"",logisticsCompanyId:"",orderItemNum:"",isNew:!0,logisticsCompanyCode:"",otherLogistics:!1,otherLogisticsName:""}],s+=e.orderItemList[a].refundCount?parseInt(e.orderItemList[a].refundCount):0;else for(var i=0;i<e.orderItemList[a].orderLogistics.length;i++)s+=e.orderItemList[a].orderLogistics[i].orderItemNum?parseInt(e.orderItemList[a].orderLogistics[i].orderItemNum):0;s<e.orderItemList[a].mallProNumber&&(t+=1)}this.canDeliveryNum=t,this.splitOrderInfo=e,this.splitDeliveryOrderDialog=!0},changeLogisticsItem:function(e,t){e?"QITA"===this.logistics.find(function(t){return t.logisticsCompanyId===e}).logisticsCompanyCode?t.otherLogistics=!0:(t.otherLogistics=!1,t.otherLogisticsName=""):(t.otherLogistics=!1,t.otherLogisticsName="")},logisticsItemNameLimit:function(e,t){this.$nextTick(function(){t.otherLogisticsName=C.getInputVal(e,8)})},courierNumberItemLimit:function(e,t){this.$nextTick(function(){t.courierNumber=C.getInputVal(e,15)})},splitDeliveryOrderDeal:function(){for(var e=this,t=[],a="",s=0;s<this.splitOrderInfo.orderItemList.length;s++)for(var i=0;i<this.splitOrderInfo.orderItemList[s].orderLogistics.length;i++)if(this.splitOrderInfo.orderItemList[s].orderLogistics[i].isNew){if(""!==this.splitOrderInfo.orderItemList[s].orderLogistics[i].orderItemNum&&0===Number(this.splitOrderInfo.orderItemList[s].orderLogistics[i].orderItemNum)){a="拆单数量不能为0！！";break}if(!this.splitOrderInfo.orderItemList[s].orderLogistics[i].logisticsCompanyId&&this.splitOrderInfo.orderItemList[s].orderLogistics[i].courierNumber){a="请选择物流公司！！";break}if(!this.splitOrderInfo.orderItemList[s].orderLogistics[i].courierNumber&&this.splitOrderInfo.orderItemList[s].orderLogistics[i].logisticsCompanyId){a="请填写物流单号！！";break}var r=/^[0-9a-zA-Z]+$/;if(!r.test(this.splitOrderInfo.orderItemList[s].orderLogistics[i].courierNumber)&&this.splitOrderInfo.orderItemList[s].orderLogistics[i].logisticsCompanyId||!r.test(this.splitOrderInfo.orderItemList[s].orderLogistics[i].courierNumber)&&this.splitOrderInfo.orderItemList[s].orderLogistics[i].logisticsCompanyId){a="物流单号只能是数字或字母";break}for(var o={mallOrderId:this.splitOrderInfo.orderItemList[s].orderId,orderItemNum:this.splitOrderInfo.orderItemList[s].mallProNumber,logisticsCompanyId:this.splitOrderInfo.orderItemList[s].orderLogistics[i].logisticsCompanyId,logisticsCompanyName:"",logisticsCompanyCode:"",courierNumber:this.splitOrderInfo.orderItemList[s].orderLogistics[i].courierNumber,orderItemId:this.splitOrderInfo.orderItemList[s].orderItemId,orderItemSunNum:this.splitOrderInfo.orderItemList[s].mallProNumber,otherLogisticsName:this.splitOrderInfo.orderItemList[s].orderLogistics[i].otherLogistics?this.splitOrderInfo.orderItemList[s].orderLogistics[i].otherLogisticsName:""},l=0;l<this.logistics.length;l++)if(this.logistics[l].logisticsCompanyId==this.splitOrderInfo.orderItemList[s].orderLogistics[i].logisticsCompanyId){o.logisticsCompanyName=this.logistics[l].logisticsCompanyName,o.logisticsCompanyCode=this.logistics[l].logisticsCompanyCode,"QITA"===this.logistics[l].logisticsCompanyCode&&(o.logisticsCompanyName=o.otherLogisticsName);break}t.push(o)}var n=!0,d=!1,c=void 0;try{for(var u,m=b()(t);!(n=(u=m.next()).done);n=!0){var p=u.value;if("QITA"===p.logisticsCompanyCode&&""===p.logisticsCompanyName)return this.$message.error("请填写物流公司名称"),!1}}catch(e){d=!0,c=e}finally{try{!n&&m.return&&m.return()}finally{if(d)throw c}}for(var h=0;h<t.length;h++)t[h].logisticsCompanyCode||t[h].logisticsCompanyId||(t.splice(h,1),h=-1);if(a)this.$message.error(a);else{if(0===t.length)return this.$message.error("发货信息不能为空"),!1;var g={paramsJson:O()({deliverData:t}),type:0,requestProject:"mall"};this.splitLoading=!0,A.post("/api-mall/split-order-deliver",_.a.stringify(g)).then(function(t){0==t.data.errorCode?(e.$message({message:t.data.result,type:"success"}),e.splitLoading=!1,e.$emit("listonupdate"),e.splitDeliveryOrderDialog=!1):(e.splitLoading=!1,e.$message.error(t.data.message))})}},splitOrder:function(e){this.splitOrderInfo.orderItemList[e].orderLogistics.length+this.splitOrderInfo.orderItemList[e].refundCount>=this.splitOrderInfo.orderItemList[e].mallProNumber?this.$message.error("拆单数量不得大于当前单量！"):this.splitOrderInfo.orderItemList[e].orderLogistics.push({ordernum:0,wuliuName:"",wuliuNum:"",isNew:!0})},deleteOrder:function(e,t){this.splitOrderInfo.orderItemList[e].orderLogistics.splice(t,1)},limitOrderNumDeal:function(e,t){for(var a=0,s=0;s<this.splitOrderInfo.orderItemList[e].orderLogistics.length;s++){a+=this.splitOrderInfo.orderItemList[e].orderLogistics[s].orderItemNum?parseInt(this.splitOrderInfo.orderItemList[e].orderLogistics[s].orderItemNum):0}return a<0?(this.$message.error("输入正确的拆单数量！"),this.splitOrderInfo.orderItemList[e].orderLogistics[t].orderItemNum="",!1):a+this.splitOrderInfo.orderItemList[e].refundCount>this.splitOrderInfo.orderItemList[e].mallProNumber?(this.$message.error("输入数量之和不得大于当前单量！"),void(this.splitOrderInfo.orderItemList[e].orderLogistics[t].orderItemNum="")):void 0},showEvaluationDialog:function(){this.getEvaluationList(),this.dialogOrderEvaluation=!0}},components:{}},sa={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[""!=e.orderDetails?a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("订单管理")]),e._v(" "),a("el-breadcrumb-item",{attrs:{to:{path:"/orderAll"}}},[e._v("所有订单")]),e._v(" "),a("el-breadcrumb-item",[e._v("订单详情")])],1),e._v(" "),e._m(0)],1),e._v(" "),a("div",{staticClass:"mall-section"},[0!=e.orderDetails.order.orderStep?a("div",{staticClass:"progress-wrap"},[a("div",{staticClass:"progress-info progress-infoed"},[a("div",{on:{click:e.getParcelList}},[e._v("买家下单")]),e._v(" "),a("div",{staticClass:"progress-info-time"},[e._v(e._s(e._f("timesOther")(e.orderDetails.order.createTime)))])]),e._v(" "),a("div",{class:{"progress-ing":1==e.orderDetails.order.orderStep,"progress-ed":1!=e.orderDetails.order.orderStep}},[a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("i",{staticClass:"el-icon-arrow-right"})]),e._v(" "),a("div",{staticClass:"progress-info",class:{"progress-infoed":e.orderDetails.order.orderStep>=2}},[a("div",[e._v("买家付款")]),e._v(" "),"2"==e.orderDetails.order.orderStep||"3"==e.orderDetails.order.orderStep||"4"==e.orderDetails.order.orderStep||"7"==e.orderDetails.order.orderStep?a("div",{staticClass:"progress-info-time"},[e._v(e._s(e._f("timesOther")(e.orderDetails.order.payTime)))]):e._e()]),e._v(" "),a("div",{class:{"progress-ing":2==e.orderDetails.order.orderStep,"progress-no":1==e.orderDetails.order.orderStep,"progress-ed":1!=e.orderDetails.order.orderStep&&2!=e.orderDetails.order.orderStep}},[a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("i",{staticClass:"el-icon-arrow-right"})]),e._v(" "),a("div",{staticClass:"progress-info",class:{"progress-infoed":e.orderDetails.order.orderStep>=3}},[a("div",[e._v("商家发货")]),e._v(" "),"3"==e.orderDetails.order.orderStep||"4"==e.orderDetails.order.orderStep||"7"==e.orderDetails.order.orderStep?a("div",{staticClass:"progress-info-time"},[e._v(e._s(e._f("timesOther")(e.orderDetails.order.deliverDate)))]):e._e()]),e._v(" "),a("div",{class:{"progress-ing":3==e.orderDetails.order.orderStep,"progress-no":e.orderDetails.order.orderStep<3,"progress-ed":e.orderDetails.order.orderStep>3}},[a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("i",{staticClass:"el-icon-arrow-right"})]),e._v(" "),a("div",{staticClass:"progress-info",class:{"progress-infoed":4==e.orderDetails.order.orderStep}},[a("div",[e._v("交易成功")]),e._v(" "),"4"==e.orderDetails.order.orderStep?a("div",{staticClass:"progress-info-time"},[e._v(e._s(e._f("timesOther")(e.orderDetails.order.updateTime)))]):e._e()])]):e._e(),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"left-wrap"},[a("div",{staticClass:"left-header"},[e._v("\n              订单信息\n            ")]),e._v(" "),a("div",{staticClass:"left-list-info"},[a("div",[a("span",[e._v("订单编号")]),e._v(" "),a("span",[e._v(e._s(e.orderDetails.order.orderNumber))]),e._v(" "),a("el-popover",{attrs:{width:"260",trigger:"hover"}},[a("div",{staticClass:"popover-hover-wrap"},[a("div",{staticClass:"popover-hover"},[a("span",[e._v("支付编号")]),e._v(e._s(e.orderDetails.order.payNumber))]),e._v(" "),a("div",{staticClass:"popover-hover"},[a("span",[e._v("下单时间")]),e._v(e._s(e._f("timesOther")(e.orderDetails.order.createTime)))]),e._v(" "),a("div",{staticClass:"popover-hover"},[a("span",[e._v("付款时间")]),e._v(" "),e.orderDetails.order.payTime?a("p",{staticStyle:{display:"inline-block"}},[e._v(e._s(e.getTime(e.orderDetails.order.payTime))+" "+e._s(e.getSeconds(e.orderDetails.order.payTime)))]):a("span",[e._v("--")])])]),e._v(" "),a("span",{attrs:{slot:"reference",type:"text"},slot:"reference"},[a("i",{staticClass:"iconfont icon-gengduo",staticStyle:{"font-size":"12px","margin-left":"5px",cursor:"pointer"}})])])],1),e._v(" "),a("div",[a("span",[e._v("买家昵称")]),e._v(" "),a("span",[e._v(e._s(e.orderDetails.memberDTO?e.orderDetails.memberDTO.nickName:""))])]),e._v(" "),a("div",[a("span",[e._v("收货信息")]),e._v(" "),a("span",[e._v(e._s(e.orderDetails.order.buyerName)+","+e._s(e.orderDetails.order.buyerPhone)+","+e._s(e.orderDetails.area)+" "+e._s(e.orderDetails.order.addressInfo))])]),e._v(" "),a("div",[a("span",[e._v("买家卡号")]),e._v(" "),a("span",[a("a",{attrs:{href:e.windowUrl+"/member/#/wechatmemberDetail?memberId="+e.orderDetails.order.memberId,target:"_blank"}},[e._v(e._s(e.orderDetails.order.memberCardNum?e.orderDetails.order.memberCardNum:""))])])]),e._v(" "),a("div",[a("span",[e._v("买家留言")]),e._v(" "),a("span",[e._v(e._s(""==e.orderDetails.order.remarks?"无":e.orderDetails.order.remarks))])])])])]),e._v(" "),a("el-col",{attrs:{span:18}},[a("div",{staticClass:"right-wrap"},[1==e.orderDetails.order.orderStep?a("div",{staticClass:"right-header"},[a("p",{staticClass:"right-header-title"},[e._v("等待买家付款")]),e._v(" "),a("p",{staticClass:"right-header-instructions"},[e._v("订单已提交成功")]),e._v(" "),a("div",{staticClass:"right-header-btns"},[a("el-button",{staticStyle:{width:"98px"},attrs:{type:"primary",size:"small"},on:{click:e.freightOrder}},[e._v("修改运费")]),e._v(" "),a("el-button",{staticStyle:{color:"#409EFF","border-color":"#409EFF",width:"98px"},attrs:{size:"small"},on:{click:e.closeOrderShow}},[e._v("关闭订单")])],1),e._v(" "),a("el-dialog",{attrs:{title:"修改运费",visible:e.freightOrderDialog,width:"464px"},on:{"update:visible":function(t){e.freightOrderDialog=t},close:e.cancelFreightOrderDeal}},[a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"close-reason"},[e._v("快递运费")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[a("el-input",{attrs:{type:"number"},model:{value:e.freightOrderForm.actualFreight,callback:function(t){e.$set(e.freightOrderForm,"actualFreight",t)},expression:"freightOrderForm.actualFreight"}},[a("template",{slot:"append"},[e._v("\n                        元\n                      ")])],2)],1)]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelFreightOrderDeal}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.actualFreightLoading},on:{click:e.freightOrderDeal}},[e._v("确定修改")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"关闭订单",visible:e.closeOrderDialog,width:"464px"},on:{"update:visible":function(t){e.closeOrderDialog=t},close:e.cancelCloseOrderDeal}},[a("div",{staticClass:"close-reason"},[e._v("关闭原因")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[a("el-input",{attrs:{type:"textarea",rows:3},model:{value:e.closeOrderForm.closeReason,callback:function(t){e.$set(e.closeOrderForm,"closeReason",t)},expression:"closeOrderForm.closeReason"}})],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelCloseOrderDeal}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.closeOrderLoading},on:{click:e.closeOrderDeal}},[e._v("确 定")])],1)])],1):2==e.orderDetails.order.orderStep?a("div",{staticClass:"right-header"},[a("p",{staticClass:"right-header-title"},[e._v("等待商家发货")]),e._v(" "),a("p",{staticClass:"right-header-instructions"},[e._v("买家已付款到商家账户")]),e._v(" "),a("div",{staticClass:"right-header-btns"},[a("el-button",{staticStyle:{width:"98px"},attrs:{type:"primary",size:"small"},on:{click:function(t){e.showdeliveryOrder()}}},[e._v("发货")])],1)]):7==e.orderDetails.order.orderStep?a("div",{staticClass:"right-header"},[a("p",{staticClass:"right-header-title"},[e._v("商家已部分发货")]),e._v(" "),a("p",{staticClass:"right-header-instructions"},[e._v("商家已发出"+e._s(e.deliverNum)+"件商品，还有"+e._s(e.mallSaleNum-e.deliverNum)+"件商品等待发出")]),e._v(" "),a("div",{staticClass:"right-header-btns"},[a("el-button",{staticStyle:{width:"98px"},attrs:{type:"primary",size:"small"},on:{click:function(t){e.goSplitDeliveryOrder()}}},[e._v("发货")])],1)]):3==e.orderDetails.order.orderStep?a("div",{staticClass:"right-header"},[a("p",{staticClass:"right-header-title"},[e._v("等待买家确认收货")]),e._v(" "),a("p",{staticClass:"right-header-instructions"},[e._v("商家已发货，等待交易成功")])]):4==e.orderDetails.order.orderStep?a("div",[a("div",{staticClass:"right-header",staticStyle:{height:"50px"}},[a("p",{staticClass:"right-header-title",staticStyle:{margin:"10px 0"}},[e._v("交易成功")]),e._v(" "),a("p",{staticClass:"right-header-instructions"},[e._v("订单完成")])]),e._v(" "),a("div",{staticClass:"right-header",staticStyle:{height:"50px","border-bottom":"none","margin-top":"30px",cursor:"pointer"}},[a("p",{staticClass:"right-header-title",staticStyle:{margin:"10px 0"}},[e._v("订单评价")]),e._v(" "),1==e.orderDetails.order.evaluationStatus?a("p",{staticClass:"right-header-instructions",on:{click:e.showEvaluationDialog}},[e._v("\n                  买家已评\n                ")]):a("p",{staticClass:"right-header-instructions"},[e._v("买家未评")])])]):0==e.orderDetails.order.orderStep?a("div",{staticClass:"right-header"},[a("p",{staticClass:"right-header-title error-color"},[e._v("交易关闭")]),e._v(" "),a("p",{staticClass:"right-header-instructions"},[e._v(e._s(e.orderDetails.order.tradeCloseReason))])]):e._e()])])],1),e._v(" "),a("el-dialog",{attrs:{title:"发货失败",visible:e.errordialogVisible,width:"464px"},on:{"update:visible":function(t){e.errordialogVisible=t}}},[a("span",[e._v("当前有待处理的仅退款单据，请优先处理退款再进行发货操作。")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.errordialogVisible=!1}}},[e._v("确 定")])],1)]),e._v(" "),a("el-dialog",{attrs:{visible:e.deliveryOrderDialog,width:"464px"},on:{"update:visible":function(t){e.deliveryOrderDialog=t},close:e.cancelDeliveryOrderDeal}},[a("div",{staticClass:"all-delivery",attrs:{slot:"title"},slot:"title"},[e._v("\n          整单发货\n          "),0==e.orderDetails.order.splitDeliverGoodsOnOff||e.orderItemOnlyOne?e._e():a("div",{staticClass:"go-split-delivery",on:{click:function(t){e.goSplitDeliveryOrder()}}},[a("a",{attrs:{href:"javascript:;"}},[e._v("去拆单发货")])])]),e._v(" "),a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"close-reason"},[e._v("收货信息:")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[e._v(e._s(e.orderDetails.order.buyerName)+","+e._s(e.orderDetails.order.buyerPhone)+","+e._s(e.orderDetails.area)+" "+e._s(e.orderDetails.order.addressInfo))])]),e._v(" "),a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"close-reason"},[e._v("物流公司")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[a("el-select",{staticClass:"width-style",attrs:{clearable:"",placeholder:"请选择",filterable:""},on:{change:e.changeLogisticsCompanyName},model:{value:e.deliveryOrderForm.logisticsCompanyId,callback:function(t){e.$set(e.deliveryOrderForm,"logisticsCompanyId",t)},expression:"deliveryOrderForm.logisticsCompanyId"}},e._l(e.logistics,function(e){return a("el-option",{key:e.logisticsCompanyId,attrs:{label:e.logisticsCompanyName,value:e.logisticsCompanyId}})}))],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.otherLogistics,expression:"otherLogistics"}],staticStyle:{"margin-left":"75px",width:"340px","margin-bottom":"22px"}},[a("el-input",{attrs:{placeholder:"请输入快递公司"},on:{input:function(t){return e.logisticsNameLimit(t)}},model:{value:e.otherLogisticsName,callback:function(t){e.otherLogisticsName=t},expression:"otherLogisticsName"}}),e._v(" "),a("span",{staticClass:"other-name-warm"},[e._v("若设置为其他快递公司，则系统不提供物流信息查询")])],1),e._v(" "),a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"close-reason"},[e._v("物流单号")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[a("el-input",{attrs:{type:"text"},on:{input:function(t){return e.courierNumberLimit(t)}},model:{value:e.deliveryOrderForm.courierNumber,callback:function(t){e.$set(e.deliveryOrderForm,"courierNumber",t)},expression:"deliveryOrderForm.courierNumber"}})],1)]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelDeliveryOrderDeal}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.deliveryLoading},on:{click:e.deliveryOrderDeal}},[e._v("确 定")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"拆单发货",visible:e.splitDeliveryOrderDialog,width:"88%"},on:{"update:visible":function(t){e.splitDeliveryOrderDialog=t}}},[a("el-row",{staticClass:"split-title"},[a("el-col",{attrs:{span:12}},[e._v(" 当前收货信息共有可发货 "+e._s(e.canDeliveryNum)+"个订单 ")]),e._v(" "),a("el-col",{attrs:{span:12}},[e._v(" 收货信息： "+e._s(e.splitOrderInfo.buyerName)+","+e._s(e.splitOrderInfo.buyerPhone)+","+e._s(e.orderDetails.area)+" "+e._s(e.splitOrderInfo.addressInfo)+" ")])],1),e._v(" "),a("el-row",{staticClass:"order-list-title"},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[e._v("\n              商品\n            ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n              购买数量\n            ")])]),e._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content"},[e._v("\n              物流公司\n            ")])]),e._v(" "),a("el-col",{attrs:{span:5}},[a("div",{staticClass:"grid-content"},[e._v("\n              物流单号\n            ")])]),e._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content"},[e._v("\n              交易状态\n            ")])])],1),e._v(" "),a("div",{staticClass:"order-item-title"},[a("span",[e._v("订单编号："+e._s(e.splitOrderInfo.orderNumber))]),e._v(" "),a("span",[e._v("下单时间："+e._s(e._f("timesOther")(e.splitOrderInfo.createTime)))])]),e._v(" "),a("div",{staticClass:"order-item-wrap"},[a("table",{staticClass:"split-table"},[a("tbody",e._l(e.splitOrderInfo.orderItemList,function(t,s){return a("tr",{key:s},[a("td",[a("div",{staticClass:"goods-info"},[a("div",[a("a",{attrs:{href:"javascript:;"}},[a("img",{staticClass:"imgs-style",attrs:{src:t.mallProImageUrl,alt:""}})])]),e._v(" "),a("div",{staticClass:"goods-text"},[a("div",{staticClass:"goods-text-name"},[1===t.isGift?a("span",{staticClass:"zeng-pin"},[e._v("赠品")]):e._e(),a("span",[e._v(e._s(t.mallProName))])]),e._v(" "),a("div",{staticClass:"goods-text-info"},[a("div",e._l(JSON.parse(t.mallProSkuAttr),function(t,s){return a("span",{key:s},[e._v(e._s(t.propName)+"："+e._s(t.valueName)+"   ")])})),e._v(" "),a("div",[e._v("SKU编码："+e._s(t.mallProSkuCode))])])])])]),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[a("span",[e._v(e._s(t.mallProNumber)+" ")]),e._v(" "),t.refundCount>0?a("span",[e._v("(已退"+e._s(t.refundCount)+") ")]):e._e()])]),e._v(" "),a("td",e._l(t.orderLogistics,function(t){return a("div",{key:t.logisticsCompanyId,staticClass:"split-logistics-other"},[a("p",[a("el-select",{attrs:{disabled:!t.isNew,clearable:"",placeholder:"请选择"},on:{change:function(a){return e.changeLogisticsItem(a,t)}},model:{value:t.logisticsCompanyId,callback:function(a){e.$set(t,"logisticsCompanyId",a)},expression:"itemss.logisticsCompanyId"}},e._l(e.logistics,function(e){return a("el-option",{key:e.logisticsCompanyId,attrs:{label:e.logisticsCompanyName,value:e.logisticsCompanyId}})}))],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.otherLogistics,expression:"itemss.otherLogistics"}],staticStyle:{"margin-top":"14px"}},[a("el-input",{attrs:{placeholder:"请输入快递公司"},on:{input:function(a){return e.logisticsItemNameLimit(a,t)}},model:{value:t.otherLogisticsName,callback:function(a){e.$set(t,"otherLogisticsName",a)},expression:"itemss.otherLogisticsName"}}),e._v(" "),a("span",{staticClass:"other-name-warm"},[e._v("若设置为其他快递公司，则系统不提供物流信息查询")])],1)])})),e._v(" "),a("td",e._l(t.orderLogistics,function(t,i){return a("div",{key:i,staticClass:"split-content-other"},[a("p",{staticClass:"split-order-wuliunum"},[a("el-input",{attrs:{disabled:!t.isNew,placeholder:"请输入内容"},on:{input:function(a){return e.courierNumberItemLimit(a,t)}},model:{value:t.courierNumber,callback:function(a){e.$set(t,"courierNumber",a)},expression:"itemss.courierNumber"}})],1),e._v(" "),i>0&&t.isNew?a("p",[a("el-button",{attrs:{type:"text"},on:{click:function(t){e.deleteOrder(s,i)}}},[e._v("删除")])],1):a("p",{staticStyle:{visibility:"hidden"}},[e._v("\n                      删除\n                    ")])])})),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[a("span",[e._v(e._s(e._f("orderStepName")(t.orderItemStatus)))])])])])}))])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.splitDeliveryOrderDialog=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.splitLoading},on:{click:e.splitDeliveryOrderDeal}},[e._v("确 定")])],1)],1),e._v(" "),e.orderDetails.order.orderStep>=3&&e.parcelList.length>0?a("div",[a("el-row",{staticClass:"order-list-title",attrs:{id:"parcel-list-title"}},[a("el-col",{attrs:{span:5}},[a("div",{staticClass:"grid-content"},[e._v("\n              包裹名称\n            ")])]),e._v(" "),a("el-col",{attrs:{span:5}},[a("div",{staticClass:"grid-content"},[e._v("\n              快递\n            ")])]),e._v(" "),a("el-col",{attrs:{span:5}},[a("div",{staticClass:"grid-content"},[e._v("\n              物流单号\n            ")])]),e._v(" "),a("el-col",{attrs:{span:5}},[a("div",{staticClass:"grid-content"},[e._v("\n              发货时间\n            ")])]),e._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content"},[e._v("\n              操作\n            ")])])],1),e._v(" "),e._l(e.parcelList,function(t,s){return a("div",{key:s,staticClass:"parcel-list-content"},[a("el-row",{staticClass:"order-list-title"},[a("el-col",{attrs:{span:5}},[a("div",{staticClass:"grid-content"},[e._v("包裹-"+e._s(s+1))])]),e._v(" "),a("el-col",{attrs:{span:5}},[a("div",{staticClass:"grid-content"},[e._v("\n                "+e._s(t.logisticsCompanyName?t.logisticsCompanyName:" 无 ")+"\n              ")])]),e._v(" "),a("el-col",{attrs:{span:5}},[a("div",{staticClass:"grid-content"},[a("span",[e._v(e._s(t.courierNumber?t.courierNumber:" 无 "))]),a("i",{staticClass:"el-icon-edit",on:{click:function(a){e.showLogistics(t)}}})])]),e._v(" "),a("el-col",{attrs:{span:5}},[a("div",{staticClass:"grid-content"},[e._v("\n                "+e._s(e._f("timesOther")(t.createTime))+"\n              ")])]),e._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content",on:{click:function(t){e.showParcelLoginstics(s)}}},[t.show?a("span",{staticClass:"operation-color"},[e._v("收起物流详情"),a("i",{staticClass:"iconfont icon-arrowdown operation-color updown"})]):a("span",{staticClass:"operation-color"},[e._v("展开物流详情"),a("i",{staticClass:"iconfont icon-arrowdown operation-color"})])])])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"item.show"}],staticClass:"parcel-detail"},[a("div",{staticClass:"dotted-line-wrap"},e._l(t.orderItems,function(s,i){return a("div",{key:i,staticClass:"dotted-line"},[a("div",{staticClass:"goods-info"},[a("div",[a("a",{attrs:{href:"javascript:;"}},[a("img",{staticClass:"imgs-style",attrs:{src:s.mallProImageUrl,alt:""}})])]),e._v(" "),a("div",{staticClass:"goods-text"},[a("div",{staticClass:"goods-text-name"},[e._v(e._s(s.mallProName))]),e._v(" "),a("div",{staticClass:"goods-text-info"},[a("div",e._l(JSON.parse(s.mallProSkuAttr),function(t,s){return a("span",{key:s},[e._v(e._s(t.propName)+"："+e._s(t.valueName)+"   ")])})),e._v(" "),a("div",[e._v("SKU编码："+e._s(s.mallProSkuCode))])])])]),e._v(" "),0===t.mallOrderDTO.deliveryType?a("div",{staticClass:"parcel-item-num"},[e._v("X"+e._s(s.mallProNumber))]):e._e(),e._v(" "),1===t.mallOrderDTO.deliveryType?a("div",{staticClass:"parcel-item-num"},[e._v("X"+e._s(s.orderItemNumCount))]):e._e()])})),e._v(" "),a("div",[t.logisticsInformation?a("div",e._l(JSON.parse(t.logisticsInformation).Traces,function(t,s){return a("div",{key:s,staticClass:"parcel-detail-right"},[a("div",{staticClass:"dot-line"},[a("div",0==s?{staticClass:"line-line-new"}:{staticClass:"line-line"}),e._v(" "),a("div",0==s?{staticClass:"dot-dot-new"}:{staticClass:"dot-dot"})]),e._v(" "),a("div",{staticClass:"parcel-detail-step"},[e._v(e._s(t.AcceptTime))]),e._v(" "),a("div",{staticClass:"parcel-detail-info"},[e._v("\n                    "+e._s(t.AcceptStation)+"\n                  ")])])})):e._e()])])],1)})],2):e._e(),e._v(" "),a("div",[a("el-row",{staticClass:"order-list-title"},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[e._v("\n              商品\n            ")])]),e._v(" "),a("el-col",{attrs:{span:2}},[a("div",{staticClass:"grid-content"},[e._v("\n              单价\n            ")])]),e._v(" "),a("el-col",{attrs:{span:2}},[a("div",{staticClass:"grid-content"},[e._v("\n              数量\n            ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n              售后\n            ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n              优惠\n            ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n              小计\n            ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n              状态\n            ")])])],1),e._v(" "),e._l(e.orderDetails.order.orderItemList,function(t,s){return a("div",{key:s,staticClass:"order-list-wrap"},[a("div",{staticClass:"order-item-wrap"},[a("table",[a("tbody",[a("tr",[a("td",[a("div",{staticClass:"goods-info"},[a("div",[a("a",{attrs:{href:"javascript:;"}},[a("img",{staticClass:"imgs-style",attrs:{src:t.mallProImageUrl,alt:""}})])]),e._v(" "),a("div",{staticClass:"goods-text"},[a("div",{staticClass:"goods-text-name"},[1===t.isGift?a("span",{staticClass:"zeng-pin"},[e._v("赠品")]):e._e(),a("span",[e._v(e._s(t.mallProName))])]),e._v(" "),a("div",{staticClass:"goods-text-info"},[a("div",e._l(JSON.parse(t.mallProSkuAttr),function(t,s){return a("span",{key:s},[e._v(" "+e._s(t.propName)+"："+e._s(t.valueName)+"   ")])})),e._v(" "),a("div",[e._v("SKU编码："+e._s(t.mallProSkuCode))])])])])]),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[a("span",[e._v("￥"+e._s(t.mallProPrice))])])]),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[a("span",[e._v(e._s(t.mallProNumber))])])]),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[a("span",[e._v(e._s(e._f("afterSales")(t.refundStatus)))])])]),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[a("span",[e._v("-￥"+e._s(t.discountTotal))]),e._v(" "),a("el-popover",{attrs:{width:"200",trigger:"hover"}},[a("div",{staticClass:"popover-hove-wrap"},e._l(t.discountInformation,function(t,s){return a("div",{key:s,staticClass:"item-hover"},[a("span",[e._v(e._s(t.itemName))]),e._v("-￥"+e._s(t.amountValue)+"\n                          ")])})),e._v(" "),a("span",{attrs:{slot:"reference",type:"text"},slot:"reference"},[a("i",{staticClass:"iconfont icon-gengduo",staticStyle:{"font-size":"12px","margin-left":"5px",cursor:"pointer"}})])])],1)]),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[0===t.isGift?a("span",[e._v("￥"+e._s(t.mallProPrice*t.mallProNumber))]):a("span",[e._v("￥0")])])]),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[a("span",[e._v(e._s(e._f("orderStepName")(t.orderItemStatus)))])])])])])])])])})],2),e._v(" "),a("div",{staticClass:"order-price-wrap"},[a("div",{staticClass:"return-integral"},[e._v("返"+e._s(e.orderDetails.order.getPoints)+"积分")]),e._v(" "),a("div",[a("div",{staticClass:"return-items"},[a("span",{staticClass:"return-items-span"},[e._v("商品总价")]),a("span",[e._v("￥"+e._s(e.orderDetails.order.mallProAllPrice))])]),e._v(" "),a("div",{staticClass:"return-items"},[a("span",{staticClass:"return-items-span"},[e._v("优惠")]),a("span",[e._v("-￥"+e._s(e.favorablePrice))]),e._v(" "),a("el-popover",{attrs:{width:"200",trigger:"hover"}},[a("div",{staticClass:"popover-hove-wrap"},e._l(e.orderDetails.discountInformation,function(t,s){return a("div",{key:s,staticClass:"item-hover"},[a("span",[e._v(e._s(t.itemName))]),e._v("-￥"+e._s(t.amountValue)+"\n                ")])})),e._v(" "),a("span",{attrs:{slot:"reference",type:"text"},slot:"reference"},[a("i",{staticClass:"iconfont icon-gengduo",staticStyle:{"font-size":"12px","margin-left":"3px",cursor:"pointer"}})])])],1),e._v(" "),a("div",{staticClass:"return-items"},[a("span",{staticClass:"return-items-span"},[e._v("运费")]),a("span",[e._v("￥"+e._s(e.orderDetails.order.actualFreight))])]),e._v(" "),a("div",{staticClass:"return-items"},[a("span",{staticClass:"return-items-span"},[e._v("实付金额")]),a("span",{staticClass:"pay-style"},[e._v("￥"+e._s(e.orderDetails.order.payAmountAll))])])])])],1)]):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"订单评价",visible:e.dialogOrderEvaluation,width:"800px"},on:{"update:visible":function(t){e.dialogOrderEvaluation=t}}},[a("div",{staticClass:"dialog-body"},[a("div",{staticClass:"dialog-body-item"},[a("h3",[e._v("订单评价")]),e._v(" "),a("div",{staticClass:"body-list"},[a("div",{staticClass:"body-item"},[a("span",{staticClass:"body-item-left"},[e._v("评价时间")]),e._v(" "),a("span",{staticClass:"body-item-right"},[e._v(e._s(e.getTime(e.goodsEvalationTime))+" "+e._s(e.getSeconds(e.goodsEvalationTime)))])]),e._v(" "),e._l(e.orderEvalationList,function(t,s){return a("div",{key:s,staticClass:"body-item"},[0===t.evaluateType?a("div",[a("span",{staticClass:"body-item-left"},[e._v("服务态度")]),e._v(" "),a("span",{staticClass:"body-item-right"},[e._l(t.evaluateScore/2,function(e,t){return a("i",{key:t,staticClass:"el-icon-star-on"})}),e._v(" "),e._l(5-t.evaluateScore/2,function(e,t){return a("i",{key:t,staticClass:"el-icon-star-off"})})],2)]):e._e(),e._v(" "),1===t.evaluateType?a("div",[a("span",{staticClass:"body-item-left"},[e._v("快递服务")]),e._v(" "),a("span",{staticClass:"body-item-right"},[e._l(t.evaluateScore/2,function(e,t){return a("i",{key:t,staticClass:"el-icon-star-on"})}),e._v(" "),e._l(5-t.evaluateScore/2,function(e,t){return a("i",{key:t,staticClass:"el-icon-star-off"})})],2)]):e._e()])})],2)]),e._v(" "),a("div",{staticClass:"dialog-body-item"},[a("h3",[e._v("商品评价")]),e._v(" "),a("div",{staticClass:"body-list"},e._l(e.goodsEvalationList,function(t,s){return a("div",{key:s,staticClass:"body-item-goods"},[a("div",{staticClass:"eva-left"},[a("div",{staticClass:"left-item"},[a("span",{staticClass:"body-item-left"},[e._v("评分")]),e._v(" "),a("span",{staticClass:"body-item-left"},[e._l(t.evaluateScore/2,function(e,t){return a("i",{key:t,staticClass:"el-icon-star-on"})}),e._v(" "),e._l(5-t.evaluateScore/2,function(e,t){return a("i",{key:t,staticClass:"el-icon-star-off"})})],2)]),e._v(" "),a("div",{staticClass:"left-item"},[a("span",{staticClass:"body-item-left"},[e._v("商品评语")]),e._v(" "),a("span",[e._v(e._s(t.evaluateContent))])]),e._v(" "),a("div",{staticClass:"left-item"},[a("span",{staticClass:"body-item-left"},[e._v("分享图片")]),e._v(" "),t.shareImageList?a("div",{staticStyle:{display:"inline-block","vertical-align":"top"}},e._l(t.shareImageList,function(e,t){return a("img",{key:t,staticStyle:{width:"20px",height:"20px","margin-right":"6px"},attrs:{src:e.imageUrl,alt:""}})})):a("span",[e._v("无")])])]),e._v(" "),a("div",{staticClass:"eva-right"},[a("img",{attrs:{src:t.mallProImageUrl,alt:""}}),e._v(" "),a("div",{staticClass:"img-text"},[a("p",[e._v(e._s(t.mallProName))]),e._v(" "),a("p",{staticClass:"sku-info"},e._l(JSON.parse(t.mallProSkuAttr),function(t,s){return a("span",{key:s},[e._v(e._s(t.propName)+" :"+e._s(t.valueName))])})),e._v(" "),a("p",[e._v(e._s(t.mallProSkuCode))])])])])}))])])]),e._v(" "),a("el-dialog",{attrs:{title:"修改物流单号",visible:e.logisticsVisible,width:"420px"},on:{"update:visible":function(t){e.logisticsVisible=t},close:e.cancelSubmitLogistics}},[a("div",{staticStyle:{"margin-bottom":"22px"}},[a("el-input",{attrs:{placeholder:"请输入内容"},on:{input:function(t){return e.logisticsEditNumLimit(t)}},model:{value:e.logisticsEditNum,callback:function(t){e.logisticsEditNum=t},expression:"logisticsEditNum"}})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:e.logisticsLoading},on:{click:e.submitLogistics}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:e.cancelSubmitLogistics}},[e._v("取 消")])],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("订单详情")])])}]};var ia=a("VU/8")(aa,sa,!1,function(e){a("miNb")},"data-v-60c69ac8",null).exports,ra={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,logistics:[],logisticsCompanyId:"",dateValue:"",startDate:"",endDate:"",importUrl:"",requestProject:{requestProject:"mall"},uploadExcelFile:"uploadExcelFile",cookieCredentials:!0,showFileList:!1,orderList:[],list:[],beatchSetOther:!1,otherLoginsticsName:"",refash:!1,loading:!1,projectName:"mall",dialogVisible:!1,excelUrl:"/api-mall/export_order_deliver",params:{},tableData:[]}},mounted:function(){this.importUrl=this.testHost+"/api-mall/upload_yundan",this.searchData=this.$route.params.searchObj,this.getDeliveryList()},computed:{},filters:{times:function(e){var t=new Date(e);return t.getFullYear()+"-"+((t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-")+((t.getDate()<10?"0"+t.getDate():t.getDate())+" ")+((t.getHours()<10?"0"+t.getHours():t.getHours())+":")+((t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":")+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())}},methods:{logisticsNameLimit:function(e){var t=this;this.$nextTick(function(){t.otherLoginsticsName=C.getInputVal(e,8)})},logisticsItemNameLimit:function(e,t){this.$nextTick(function(){t.otherLoginsticsName=C.getInputVal(e,8)})},setAllItemLoginstics:function(e){if(e){var t=this.logistics.find(function(t){return t.logisticsCompanyId===e}).logisticsCompanyCode;if("QITA"===t)for(var a=0;a<this.list.length;a++)this.list[a].logisticsCompanyId=this.logisticsCompanyId,this.list[a].beatchSetOther=!0,this.list[a].otherLoginsticsName=this.otherLoginsticsName;else for(var s=0;s<this.list.length;s++)this.list[s].logisticsCompanyId=this.logisticsCompanyId,this.list[s].beatchSetOther=!1;this.beatchSetOther="QITA"===t}else{this.beatchSetOther=!1,this.otherLoginsticsName="";for(var i=0;i<this.list.length;i++)this.list[i].beatchSetOther=!1,this.list[i].otherLoginsticsName="",this.list[i].logisticsCompanyId=""}},setLogisticsName:function(){for(var e=0;e<this.list.length;e++)this.list[e].otherLoginsticsName=this.otherLoginsticsName;this.refash=!this.refash},changeLogisticsCompany:function(e,t){if(e){var a=this.logistics.find(function(t){return t.logisticsCompanyId===e}).logisticsCompanyCode;t.beatchSetOther="QITA"===a}else t.beatchSetOther=!1},sendBatchDelivery:function(){for(var e=this,t={logisticsInfo:{deliverData:[]},type:"1",requestProject:"mall"},a=void 0,s=0;s<this.list.length;s++)if(this.list[s].beatchSetOther&&(this.list[s].logisticsCompanyName=this.list[s].otherLoginsticsName),this.list[s].logisticsCompanyId&&this.list[s].logisticsNum){a={mallOrderId:this.list[s].orderId,orderNumber:this.list[s].orderNumber,logisticsCompanyId:this.list[s].logisticsCompanyId,logisticsCompanyName:"",logisticsCompanyCode:"",courierNumber:this.list[s].logisticsNum};for(var i=0;i<this.logistics.length;i++)this.list[s].logisticsCompanyId==this.logistics[i].logisticsCompanyId&&(a.logisticsCompanyName="QITA"===this.logistics[i].logisticsCompanyCode?this.list[s].otherLoginsticsName:this.logistics[i].logisticsCompanyName,a.logisticsCompanyCode=this.logistics[i].logisticsCompanyCode);t.logisticsInfo.deliverData.push(a)}if(!a)return this.$message.error("请至少完善一条数据才能提交"),!1;t.logisticsInfo=O()(t.logisticsInfo),A.post("/api-mall/batch_order_deliver",_.a.stringify(t)).then(function(t){0==t.data.errorCode?(e.$message({message:t.data.result,type:"success"}),e.getDeliveryList()):e.$message.error(t.data.message)})},getDeliveryList:function(){var e=this;this.loading=!0;var t=this.searchData;A.post("/api-mall/load_order_batch_deliver_list",_.a.stringify(t)).then(function(t){if(0==t.data.errorCode){t.data.result.orderPage.result?e.list=t.data.result.orderPage.result:e.list=[];var a=!0,s=!1,i=void 0;try{for(var r,o=b()(e.list);!(a=(r=o.next()).done);a=!0){var l=r.value;l.beatchSetOther=!1,l.otherLoginsticsName=""}}catch(e){s=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw i}}e.logistics=t.data.result.company,e.loading=!1}else e.$message.error(t.data.message),e.loading=!1})},downloadTemplate:function(){var e=this.testHost+"/api-mall/download-yundan-template?requestProject=mall";window.location=e},exportTemplate:function(){this.params={orderIds:this.searchData.orderIds,beginTime:this.searchData.startDate,endTime:this.searchData.endDate,searchParam:this.searchData.searchInput,requestProject:"mall"},this.dialogVisible=!0},uploadSuccess:function(e,t,a){var s=this;if(0==e.errorCode){this.$message.success("文件上传成功!");var i={batchId:e.result.response.returnMap.batchId,type:"0",requestProject:"mall"};A.post("/api-mall/batch_order_deliver",_.a.stringify(i)).then(function(e){0==e.data.errorCode?(s.$message({message:e.data.result,type:"success"}),s.getDeliveryList()):s.$message.error(e.data.message)})}}},components:{}},oa={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("订单管理")]),e._v(" "),a("el-breadcrumb-item",{attrs:{to:{path:"/orderAll"}}},[e._v("订单列表")]),e._v(" "),a("el-breadcrumb-item",[e._v("批量发货")])],1),e._v(" "),e._m(0)],1),e._v(" "),a("div",{staticClass:"mall-section"},[a("div",{staticClass:"order-wrap-padding"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:15}},[a("div",{staticClass:"order-selects"},[a("div",{staticClass:"block",staticStyle:{height:"32px"}},[a("el-select",{staticStyle:{display:"inline-block"},attrs:{clearable:"",placeholder:"设置快递公司"},on:{change:e.setAllItemLoginstics},model:{value:e.logisticsCompanyId,callback:function(t){e.logisticsCompanyId=t},expression:"logisticsCompanyId"}},e._l(e.logistics,function(e){return a("el-option",{key:e.logisticsCompanyId,attrs:{label:e.logisticsCompanyName,value:e.logisticsCompanyId}})})),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.beatchSetOther,expression:"beatchSetOther"}],staticStyle:{display:"inline-block","margin-left":"5px","vertical-align":"top"}},[a("el-input",{staticStyle:{width:"160px"},attrs:{placeholder:"请输入快递公司"},on:{input:function(t){return e.logisticsNameLimit(t)},blur:e.setLogisticsName},model:{value:e.otherLoginsticsName,callback:function(t){e.otherLoginsticsName=t},expression:"otherLoginsticsName"}}),e._v(" "),a("span",{staticClass:"other-name-warm"},[e._v("若设置为其他快递公司，则系统不提供物流信息查询")]),e._v(" "),a("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refash))])],1)],1)])]),e._v(" "),a("el-col",{attrs:{span:9}},[a("div",{staticClass:"fr"},[a("el-button",{attrs:{type:"primary"},on:{click:e.downloadTemplate}},[e._v("下载模板\n                "),a("i",{staticClass:"iconfont icon-icon_yunxiazai"})]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.exportTemplate}},[e._v("导出发货单\n                "),a("i",{staticClass:"iconfont icon-icon_yunxiazai"})]),e._v(" "),a("el-upload",{staticClass:"upload-demo",attrs:{"show-file-list":e.showFileList,"with-credentials":e.cookieCredentials,data:e.requestProject,name:e.uploadExcelFile,action:e.importUrl,"on-success":e.uploadSuccess,limit:1}},[a("el-button",{attrs:{type:"primary"}},[e._v("导入运单\n                  "),a("i",{staticClass:"el-icon-upload el-icon--right"})])],1)],1)])],1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"margin-top":"24px"}},[e._l(e.list,function(t,s){return a("div",{key:s,staticClass:"order-list-wrap"},[a("div",{staticClass:"order-item-title"},[a("span",{staticStyle:{"margin-right":"30px"}},[e._v("订单编号："+e._s(t.orderNumber))]),e._v(" "),a("span",{staticStyle:{"margin-right":"30px"}},[e._v("会员卡号："+e._s(t.memberCardNum))]),e._v(" "),a("span",[e._v("付款时间："+e._s(e._f("times")(t.payTime)))])]),e._v(" "),a("div",{staticClass:"order-item-wrap"},[a("table",[a("tbody",e._l(t.orderItemList,function(s,i){return a("tr",{key:i},[a("td",[a("div",{staticClass:"goods-info"},[a("div",[a("a",{attrs:{href:"javascript:;"}},[a("img",{staticClass:"imgs-style",attrs:{src:s.mallProImageUrl,alt:""}})])]),e._v(" "),a("div",{staticClass:"goods-text"},[a("div",{staticClass:"goods-text-name"},[e._v(e._s(s.mallProName))]),e._v(" "),a("div",{staticClass:"goods-text-info"},[a("div",e._l(JSON.parse(s.mallProSkuAttr),function(t,s){return a("span",{key:s},[e._v(e._s(t.propName)+"："+e._s(t.valueName)+"   ")])})),e._v(" "),a("div",[e._v("SKU编码："+e._s(s.mallProSkuCode))])])])])]),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[a("span",[e._v("￥"+e._s(s.mallProPrice))])])]),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[a("span",[e._v(e._s(s.mallProNumber))])])]),e._v(" "),0==i&&t.orderItemList.length>1?a("td",{staticClass:"border-left",attrs:{rowspan:t.orderItemList.length}},[a("div",{staticClass:"grid-content-other"},[a("p",{staticClass:"payer-info"},[a("span",{staticClass:"payer-title"},[e._v("收件人：")]),e._v(" "),a("span",{staticClass:"payer-content"},[e._v(e._s(t.buyerName))])]),e._v(" "),a("p",{staticClass:"payer-info"},[a("span",{staticClass:"payer-title"},[e._v("联系方式：")]),e._v(" "),a("span",{staticClass:"payer-content"},[e._v(e._s(t.buyerPhone))])]),e._v(" "),a("p",{staticClass:"payer-info"},[a("span",{staticClass:"payer-title"},[e._v("收货地址：")]),e._v(" "),a("span",{staticClass:"payer-content"},[e._v(e._s(t.areaName)+" "+e._s(t.addressInfo))])]),e._v(" "),a("p",{staticClass:"payer-info"},[a("span",{staticClass:"payer-title"},[e._v("买家留言：")]),e._v(" "),a("span",{staticClass:"payer-content"},[e._v(e._s(t.remarks))])])])]):0==i?a("td",{attrs:{rowspan:t.orderItemList.length}},[a("div",{staticClass:"grid-content-other"},[a("p",{staticClass:"payer-info"},[a("span",{staticClass:"payer-title"},[e._v("收件人：")]),e._v(" "),a("span",{staticClass:"payer-content"},[e._v(e._s(t.buyerName))])]),e._v(" "),a("p",{staticClass:"payer-info"},[a("span",{staticClass:"payer-title"},[e._v("联系方式：")]),e._v(" "),a("span",{staticClass:"payer-content"},[e._v(e._s(t.buyerPhone))])]),e._v(" "),a("p",{staticClass:"payer-info"},[a("span",{staticClass:"payer-title"},[e._v("收货地址：")]),e._v(" "),a("span",{staticClass:"payer-content"},[e._v(e._s(t.areaName)+" "+e._s(t.addressInfo))])]),e._v(" "),a("p",{staticClass:"payer-info"},[a("span",{staticClass:"payer-title"},[e._v("买家留言：")]),e._v(" "),a("span",{staticClass:"payer-content"},[e._v(e._s(t.remarks))])])])]):e._e(),e._v(" "),0==i?a("td",{attrs:{rowspan:t.orderItemList.length}},[a("div",{staticClass:"grid-content-other"},[a("el-select",{attrs:{clearable:"",placeholder:"设置快递公司",size:"small"},on:{change:function(a){return e.changeLogisticsCompany(a,t)}},model:{value:t.logisticsCompanyId,callback:function(a){e.$set(t,"logisticsCompanyId",a)},expression:"item.logisticsCompanyId"}},e._l(e.logistics,function(e){return a("el-option",{key:e.logisticsCompanyId,attrs:{label:e.logisticsCompanyName,value:e.logisticsCompanyId}})})),e._v(" "),a("el-input",{directives:[{name:"show",rawName:"v-show",value:t.beatchSetOther,expression:"item.beatchSetOther"}],attrs:{size:"small",placeholder:"请输入快递公司"},on:{input:function(a){return e.logisticsItemNameLimit(a,t)}},model:{value:t.otherLoginsticsName,callback:function(a){e.$set(t,"otherLoginsticsName",a)},expression:"item.otherLoginsticsName"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.beatchSetOther,expression:"item.beatchSetOther"}],staticClass:"other-name-warm",staticStyle:{margin:"5px 0 12px 0px"}},[e._v("若设置为其他快递公司，则系统不提供物流信息查询")]),e._v(" "),a("el-input",{attrs:{size:"small",placeholder:"请输入快递单号"},model:{value:t.logisticsNum,callback:function(a){e.$set(t,"logisticsNum",a)},expression:"item.logisticsNum"}})],1)]):e._e()])}))])])])}),e._v(" "),a("div",{staticClass:"send-delivery-btn"},[a("el-button",{attrs:{type:"primary"},on:{click:e.sendBatchDelivery}},[e._v("批量发货")])],1)],2)],1)])]),e._v(" "),a("vue-gic-export-excel",{attrs:{dataArr:e.list,dialogVisible:e.dialogVisible,type:2,excelUrl:e.excelUrl,params:e.params,projectName:e.projectName},on:{"update:dialogVisible":function(t){e.dialogVisible=t}}})],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("批量发货")])])}]};var la=a("VU/8")(ra,oa,!1,function(e){a("6mbZ")},"data-v-f1c0b5ba",null).exports,na={props:{orderList:{type:Array,default:function(){return[]}},refundObj:{type:Object,default:function(){return{}}}},data:function(){return{list:[]}},filters:{times:function(e){var t=new Date(e);return t.getFullYear()+"-"+((t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-")+((t.getDate()<10?"0"+t.getDate():t.getDate())+" ")+((t.getHours()<10?"0"+t.getHours():t.getHours())+":")+((t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":")+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())},typeName:function(e){var t="";return 1==e?t="仅退款":2==e&&(t="退货退款"),t},refundStatusName:function(e){var t="";return 1==e?t="退款待处理":2==e?t="退款成功":3==e?t="退款关闭":4==e?t="待买家退货":5==e?t="待商家收货":6==e&&(t="拒绝退款"),t}},watch:{orderList:function(e){this.list=e}},methods:{goToDetail:function(e){window.localStorage.setItem("refundObj",O()(this.refundObj)),this.$router.push({name:"refundOrderDetails",params:{orderRefundId:e}})}}},da={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{staticClass:"order-list-title"},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[e._v("\n        商品\n      ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n        退款方式\n      ")])]),e._v(" "),a("el-col",{attrs:{span:2}},[a("div",{staticClass:"grid-content"},[e._v("\n        订单金额\n      ")])]),e._v(" "),a("el-col",{attrs:{span:2}},[a("div",{staticClass:"grid-content"},[e._v("\n        申请金额\n      ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n        申请时间\n      ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n        退货物流\n      ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n        售后状态\n      ")])])],1),e._v(" "),e.list.length>0?a("div",e._l(e.list,function(t,s){return a("div",{key:s,staticClass:"order-list-wrap"},[a("div",{staticClass:"order-item-title"},[a("span",[e._v("退款编号："+e._s(t.orderRefundNumber))]),e._v(" "),a("span",[e._v("订单编号："+e._s(t.orderNumber))]),e._v(" "),a("span",{staticClass:"order-detail",on:{click:function(a){e.goToDetail(t.orderRefundId)}}},[e._v("\n          退款详情\n          "),a("i",{staticClass:"el-icon-arrow-right"})])]),e._v(" "),a("div",{staticClass:"order-item-wrap"},[a("table",[a("tbody",[a("tr",[a("td",[a("div",{staticClass:"goods-info"},[a("div",[a("a",{attrs:{href:"javascript:;"}},[a("img",{staticClass:"imgs-style",attrs:{src:t.mallProImageUrl,alt:""}})])]),e._v(" "),a("div",{staticClass:"goods-text"},[a("div",{staticClass:"goods-name"},[e._v(e._s(t.mallProName))]),e._v(" "),a("div",{staticClass:"goods-text-info"},[a("div",e._l(JSON.parse(t.mallProSkuAttr),function(t,s){return a("span",{key:s},[e._v(e._s(t.propName)+"："+e._s(t.valueName)+"   ")])})),e._v(" "),a("div",[e._v("SKU编码："+e._s(t.mallProSkuCode))])])])])]),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[a("span",[e._v(e._s(e._f("typeName")(t.refundType)))])])]),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[a("span",[e._v("￥"+e._s(t.maxRefundPrice))])])]),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[a("span",[e._v("￥"+e._s(t.applyRefundPrice))])])]),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[a("span",[e._v(e._s(e._f("times")(t.createTime)))])])]),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[a("span",[e._v(e._s(t.logisticsName))]),e._v(" "),a("br"),e._v(" "),a("span",[e._v(e._s(t.logisticsNumber))])])]),e._v(" "),a("td",[a("div",{staticClass:"grid-content-other"},[a("span",[e._v(e._s(e._f("refundStatusName")(t.refundStatus)))])])])])])])])])})):a("div",[e._m(0)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"no-data-wrap"},[t("div",{staticClass:"no-data-icon"},[t("img",{attrs:{src:a("8Td+")}})]),this._v(" "),t("p",[this._v("暂无数据")])])}]};var ca={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,pickerOptions2:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},getTimeAll:C.formatDate,length:0,activeName:"-1",dateValue:[new Date-7776e6,(new Date).valueOf()],startDate:"",endDate:"",orderStatus:-1,searchparams:"",refundType:"",loading:!0,orderList:[],pageSize:20,pageNum:1,currentPage4:1,total:0,refundObj:{pageNum:1,pageSize:20,searchparams:"",activeName:"-1",startDate:"",endDate:"",refundType:""},projectName:"mall",dialogVisible:!1,excelUrl:"/api-mall/export-order-refund-list-excel",params:{},tableData:[]}},mounted:function(){localStorage.getItem("refundObj")&&(this.refundObj=JSON.parse(localStorage.getItem("refundObj")),this.pageNum=this.refundObj.pageNum,this.pageSize=this.refundObj.pageSize,this.searchparams=this.refundObj.searchparams,this.refundType=this.refundObj.refundType,this.activeName=this.refundObj.activeName,this.startDate=this.refundObj.startDate,this.endDate=this.refundObj.endDate,this.refundObj.startDate?(this.dateValue=[],this.dateValue[0]=this.refundObj.startDate,this.dateValue[1]=this.refundObj.endDate,this.orderStatus=this.refundObj.activeName):this.dateValue="",localStorage.removeItem("refundObj")),this.getOrderList()},computed:{},methods:{handleSizeChange:function(e){this.pageSize=e,this.refundObj.pageSize=e,this.getOrderList()},handleCurrentChange:function(e){this.pageNum=e,this.refundObj.pageNum=e,this.getOrderList()},handleClick:function(e,t){this.refundObj.activeName=e.name,this.orderStatus=e.name,this.getOrderList()},changeTime:function(){this.dateValue?(this.refundObj.startDate=this.dateValue[0],this.refundObj.endDate=this.dateValue[1]):(this.refundObj.startDate="",this.refundObj.endDate=""),this.pageNum=1,this.getOrderList()},getSearchOrderList:function(){this.pageNum=1,this.refundObj.searchparams=this.searchparams,this.refundObj.pageNum=this.pageNum,this.getOrderList()},getRefundOrderList:function(){this.pageNum=1,this.refundObj.refundType=this.refundType,this.refundObj.pageNum=this.pageNum,this.getOrderList()},getOrderList:function(){var e=this;this.loading=!0,this.dateValue?(this.startDate=this.getTimeAll(this.dateValue[0]),this.endDate=this.getTimeAll(this.dateValue[1])):(this.startDate="",this.endDate="");var t={pageNum:this.pageNum,pageSize:this.pageSize,orderStatus:this.orderStatus,startDate:this.startDate,endDate:this.endDate,searchparams:this.searchparams,requestProject:"mall"};""!==this.refundType&&(t.refundType=this.refundType),A.post("/api-mall/page-mall-order-refund",_.a.stringify(t)).then(function(t){0===t.data.errorCode?(t.data.result.result?(e.orderList=t.data.result.result,e.total=t.data.result.totalCount):(e.orderList=[],e.total=0),e.loading=!1):e.$message.error(t.data.message)})},formatDig:function(e){return e>9?""+e:"0"+e},formatDate:function(e){var t=new Date(e),a=t.getFullYear(),s=t.getMonth()+1,i=t.getDate(),r=t.getHours(),o=t.getMinutes(),l=t.getSeconds();return a+"-"+this.formatDig(s)+"-"+this.formatDig(i)+" "+this.formatDig(r)+":"+this.formatDig(o)+":"+this.formatDig(l)},exportOrderList:function(){if(!this.dateValue)return this.startDate="",this.endDate="",void this.$message.error("导出订单必须选择时间段！！");this.startDate=this.formatDate(this.dateValue[0]),this.endDate=this.formatDate(this.dateValue[1]),this.dialogVisible=!0,this.params={orderStatus:this.orderStatus,startDate:this.startDate,endDate:this.endDate,searchparams:this.searchparams,requestProject:"mall"}}},components:{layoutTable:a("VU/8")(na,da,!1,function(e){a("n1Oe")},"data-v-33fc4d3a",null).exports}},ua={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title",staticStyle:{position:"relative",border:"none"}},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("订单管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("退款管理")])],1),e._v(" "),e._m(0)],1),e._v(" "),a("div",{staticClass:"mall-section"},[a("el-tabs",{staticStyle:{background:"#fff","padding-left":"25px"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"全部",name:"-1"}}),e._v(" "),a("el-tab-pane",{attrs:{label:"待商家处理",name:"4"}}),e._v(" "),a("el-tab-pane",{attrs:{label:"待买家处理",name:"5"}}),e._v(" "),a("el-tab-pane",{attrs:{label:"退款成功",name:"2"}}),e._v(" "),a("el-tab-pane",{attrs:{label:"退款关闭",name:"3"}})],1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"order-wrap-padding"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:16}},[a("div",{staticClass:"order-selects"},[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{type:"datetimerange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions2},on:{change:e.changeTime},model:{value:e.dateValue,callback:function(t){e.dateValue=t},expression:"dateValue"}})],1),e._v(" "),a("div",{staticClass:"fl"},[a("el-input",{attrs:{placeholder:"请输入商品/订单信息","prefix-icon":"el-icon-search",clearable:""},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.getSearchOrderList()}},model:{value:e.searchparams,callback:function(t){e.searchparams="string"==typeof t?t.trim():t},expression:"searchparams"}})],1),e._v(" "),a("div",{staticClass:"fl"},[a("el-select",{attrs:{placeholder:"请选择退款方式",clearable:""},on:{change:e.getRefundOrderList},model:{value:e.refundType,callback:function(t){e.refundType=t},expression:"refundType"}},[a("el-option",{attrs:{label:"仅退款",value:1}}),e._v(" "),a("el-option",{attrs:{label:"退货退款",value:2}})],1)],1)])]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"fr"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.exportOrderList()}}},[a("i",{staticClass:"iconfont icon-icon_yunxiazai",staticStyle:{"margin-right":"5px"}}),e._v("导出订单")])],1)])],1),e._v(" "),a("div",{staticStyle:{"margin-top":"24px"}},[a("layoutTable",{attrs:{orderList:e.orderList,refundObj:e.refundObj}})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.orderList.length>0,expression:"orderList.length > 0"}],staticClass:"block-page-wrap"},[a("div",{staticClass:"block-page"},[0!=e.total?a("el-pagination",{attrs:{background:"","current-page":e.pageNum,"page-sizes":[20,40,60,80],"page-size":20,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)])],1)],1)]),e._v(" "),a("vue-gic-export-excel",{attrs:{dataArr:e.orderList,dialogVisible:e.dialogVisible,type:2,excelUrl:e.excelUrl,params:e.params,projectName:e.projectName},on:{"update:dialogVisible":function(t){e.dialogVisible=t}}})],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("退款管理")])])}]};var ma=a("VU/8")(ca,ua,!1,function(e){a("+U9w")},"data-v-119d9cce",null).exports,pa={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,getTime:C.getTime,getSeconds:C.getSeconds,getTimeAll:C.formatDate,updateDom:!1,order:{},orderRefundId:"",orderDetails:{refundDTO:{},orderItem:{},order:{}},agreedRefundDialog:!1,agreedNewRefundDialog:!1,refundTotalMax:99999,refundTotalMaxLength:9,refundPriceMax:99999,agreedRefundForm:{refundPrice:"",refundPriceNew:"",refundPoints:"",refundFailReason:"",refundTotal:"",orderItemNum:0,moreMoney:0,morePoint:0,showMoney:!1,realRefundPoint:""},maxRefundPointText:"",closeRefundDialog:!1,pointRule:0,moneyRule:1,pointRuleComputed:0,moneyRuleComputed:0,pageUrl:"",pageUrlAddress:"",closeRefundForm:{refundFailReason:""},refundFailReasonLen:0,consultationRecords:[],confirmStatus:!1,sendAddressDialog:!1,refundAddressList:{addressList:[]},refundSellerDesc:"",refundSellerAddressId:"",refundSellerAddress:"",refundSellerDescLen:0,defaultAddress:0,refundDialogTitle:"拒绝退款",editNum:!1,dialogVisibleImg:!1,dialogEnlargeImageUrl:"",sendLoading:!1,refundLoading:!1,disagreeRefundStatus:!1}},mounted:function(){window.onbeforeunload=function(e){localStorage.removeItem("refundObj")},this.consultationRecord()},created:function(){this.orderRefundId=this.$route.params.orderRefundId,this.getOrderDetails(this.orderRefundId)},computed:{},watch:{orderDetails:function(e){e!=={}&&(this.updateDom=!0)}},methods:{getOrderDetails:function(e){var t=this,a={orderRefundId:e,requestProject:"mall"};A.get("/api-mall/get-mall-order-refund-detail",{params:a}).then(function(e){0===e.data.errorCode?(t.orderDetails=e.data.result,t.agreedRefundForm.refundPrice=t.orderDetails.refundDTO.refundPriceNew,t.agreedRefundForm.refundPriceNew=t.orderDetails.refundDTO.refundPriceNew,t.refundTotalMax="最多可退￥"+t.orderDetails.refundDTO.maxRefundPrice,t.refundTotalMaxLength=(""+t.orderDetails.refundDTO.maxRefundPrice).length,t.refundPriceMax="最多可退￥"+t.orderDetails.refundDTO.refundPriceNew,t.maxRefundPointText="最大可退积分"+t.orderDetails.orderItem.usePoints,t.pointRule=((t.orderDetails.orderItem.maxRefundPrice-t.orderDetails.orderItem.payAmount-t.orderDetails.orderItem.orderItemFreight)/t.orderDetails.orderItem.usePoints).toFixed(2),t.pointRuleComputed=t.pointRule,t.moneyRuleComputed=t.moneyRule,t.pageUrl=window.location.origin+"/member/#/wechatmemberDetail?memberId="+t.orderDetails.refundDTO.memberId,t.pageUrlAddress=window.location.origin+"/mall/#/addressEdit/-1",1===t.orderDetails.refundDTO.refundStatus&&2===t.orderDetails.refundDTO.refundType?t.refundDialogTitle="拒绝退货":5===t.orderDetails.refundDTO.refundStatus&&2===t.orderDetails.refundDTO.refundType?t.refundDialogTitle="拒绝收货":t.refundDialogTitle="拒绝退款"):t.$message.error(e.data.message)})},refundTotalMaxDeal:function(e){var t=this;if(this.agreedRefundForm.refundTotal>=this.orderDetails.refundDTO.maxRefundPrice)this.$nextTick(function(){if(t.agreedRefundForm.refundTotal=t.orderDetails.refundDTO.maxRefundPrice,t.agreedRefundForm.refundTotal>=t.orderDetails.refundDTO.refundPriceNew)if(t.agreedRefundForm.showMoney=!0,t.agreedRefundForm.refundPrice=t.orderDetails.refundDTO.refundPriceNew,t.agreedRefundForm.moreMoney=(t.agreedRefundForm.refundTotal-t.orderDetails.refundDTO.refundPriceNew).toFixed(2),0==t.agreedRefundForm.moreMoney)t.agreedRefundForm.showMoney=!1,t.agreedRefundForm.morePoint=0;else{var e=t.agreedRefundForm.refundTotal-t.orderDetails.refundDTO.refundPriceNew,a=t.orderDetails.refundDTO.maxRefundPrice-t.orderDetails.refundDTO.refundPriceNew;t.agreedRefundForm.morePoint=parseInt(t.orderDetails.orderItem.usePoints*(e/a))}else t.agreedRefundForm.showMoney=!1,t.agreedRefundForm.refundPrice=t.agreedRefundForm.refundTotal});else if(this.agreedRefundForm.refundTotal>=this.orderDetails.refundDTO.refundPriceNew){this.agreedRefundForm.showMoney=!0,this.agreedRefundForm.refundPrice=this.orderDetails.refundDTO.refundPriceNew,this.agreedRefundForm.moreMoney=(this.agreedRefundForm.refundTotal-this.orderDetails.refundDTO.refundPriceNew).toFixed(2);var a=this.agreedRefundForm.refundTotal-this.orderDetails.refundDTO.refundPriceNew,s=this.orderDetails.refundDTO.maxRefundPrice-this.orderDetails.refundDTO.refundPriceNew;this.agreedRefundForm.morePoint=parseInt(this.orderDetails.orderItem.usePoints*(a/s))}else this.agreedRefundForm.showMoney=!1,this.agreedRefundForm.refundPrice=this.agreedRefundForm.refundTotal},refundPointMaxDeal:function(e){var t=this;/^([1-9]\d*|[0]{1,1})$/.test(e)||this.$nextTick(function(){t.$message.error("请输入数字"),t.agreedRefundForm.realRefundPoint=""}),Number(this.agreedRefundForm.realRefundPoint)>Number(this.orderDetails.orderItem.usePoints)&&this.$nextTick(function(){t.agreedRefundForm.realRefundPoint=t.orderDetails.orderItem.usePoints,t.$message.error("不可超过最大可退积分"),t.pointRuleComputed=t.agreedRefundForm.realRefundPoint,t.moneyRuleComputed=(t.agreedRefundForm.realRefundPoint*t.pointRule).toFixed(2)}),this.pointRuleComputed=this.agreedRefundForm.realRefundPoint,this.moneyRuleComputed=(this.agreedRefundForm.realRefundPoint*this.pointRule).toFixed(2)},agreedRefundDeal:function(){var e=this;this.confirmStatus=!0;var t={orderRefundId:this.orderRefundId,refundStatus:2,orderItemNum:this.agreedRefundForm.orderItemNum,refundPrice:this.agreedRefundForm.refundPrice,refundPoints:this.agreedRefundForm.morePoint,refundFailReason:this.agreedRefundForm.refundFailReason,requestProject:"mall",token:this.orderDetails.token};A.post("/api-mall/do-mall-order-refund",_.a.stringify(t)).then(function(t){0==t.data.errorCode?(e.$message({message:t.data.message,type:"success"}),e.agreedRefundDialog=!1,e.confirmStatus=!1,e.getOrderDetails(e.orderDetails.refundDTO.orderRefundId),e.consultationRecord()):e.$message.error(t.data.message)})},agreedRefundNew:function(){0===this.orderDetails.refundDTO.refundDeliverType?2===this.orderDetails.orderItem.orderItemStatus&&1===this.orderDetails.refundDTO.refundType&&(this.editNum=!0):1===this.orderDetails.refundDTO.refundDeliverType&&1===this.orderDetails.refundDTO.refundType&&(this.editNum=!0),this.agreedNewRefundDialog=!0,1===this.orderDetails.refundDTO.refundType?this.agreedRefundForm.orderItemNum=this.orderDetails.refundDTO.refundNumber:2===this.orderDetails.refundDTO.refundType&&(this.agreedRefundForm.orderItemNum=0)},agreedRefundDealNew:function(){var e=this;if(this.orderDetails.orderItem.usePoints>0&&0!==this.agreedRefundForm.realRefundPoint&&!this.agreedRefundForm.realRefundPoint)return this.$message.error("请输入退回积分"),!1;var t={orderRefundId:this.orderRefundId,refundStatus:2,orderItemNum:this.agreedRefundForm.orderItemNum,refundPrice:this.agreedRefundForm.refundPriceNew,refundPoints:this.agreedRefundForm.realRefundPoint?this.agreedRefundForm.realRefundPoint:0,requestProject:"mall",token:this.orderDetails.token,refundFailReason:""};this.refundLoading=!0,A.post("/api-mall/do-mall-order-refund",_.a.stringify(t)).then(function(t){0==t.data.errorCode?(e.$message({message:t.data.message,type:"success"}),e.agreedRefundDialog=!1,e.agreedNewRefundDialog=!1,e.confirmStatus=!1,e.getOrderDetails(e.orderDetails.refundDTO.orderRefundId),e.consultationRecord(),e.refundLoading=!1):(e.$message.error(t.data.message),e.refundLoading=!1)})},closeRefundDeal:function(){var e=this;if(""!=this.closeRefundForm.refundFailReason){var t={orderRefundId:this.orderRefundId,refundStatus:3,orderItemNum:0,refundPrice:0,refundPoints:0,refundFailReason:this.closeRefundForm.refundFailReason,requestProject:"mall",token:this.orderDetails.token};null!==this.orderDetails.order.orderVersion?t.refundStatus=6:t.refundStatus=3,this.disagreeRefundStatus=!0,A.post("/api-mall/do-mall-order-refund",_.a.stringify(t)).then(function(t){0==t.data.errorCode?(e.$message({message:t.data.message,type:"success"}),e.closeRefundDialog=!1,e.getOrderDetails(e.orderDetails.refundDTO.orderRefundId),e.consultationRecord(),e.disagreeRefundStatus=!1):(e.$message.error(t.data.message),e.disagreeRefundStatus=!1)})}else this.$message.error("请填写关闭原因！")},cancelRefund:function(){this.closeRefundDialog=!1,this.refundFailReasonLen=0,this.closeRefundForm.refundFailReason=""},sendRefundAddress:function(){var e=this;this.sendAddressDialog=!0;var t={orderRefundId:this.orderRefundId};A.get("/api-mall/refund_address",{params:t}).then(function(t){if(0==t.data.errorCode){if(t.data.result){e.refundAddressList=t.data.result;for(var a=0;a<e.refundAddressList.addressList.length;a++)1===e.refundAddressList.addressList[a].ifDefault&&(e.defaultAddress=a,e.refundSellerAddressId=e.refundAddressList.addressList[a].sellerAddressId,e.refundSellerAddress=e.refundAddressList.addressList[a].provinceName+e.refundAddressList.addressList[a].cityName+e.refundAddressList.addressList[a].areaName+e.refundAddressList.addressList[a].addressDetail)}}else e.$message.error(t.data.message)})},takeGoodsRefund:function(){this.agreedNewRefundDialog=!0,3===this.orderDetails.orderItem.orderItemStatus&&(0!==this.orderDetails.refundDTO.refundDeliverType?1===this.orderDetails.refundDTO.refundType?this.agreedRefundForm.realRefundPoint=this.orderDetails.noDeliverUsePrice:2===this.orderDetails.refundDTO.refundType&&(this.agreedRefundForm.realRefundPoint=this.orderDetails.deliverUsePrice):this.agreedRefundForm.realRefundPoint)},sendMessageConfirm:function(){var e=this;if(0===this.refundAddressList.addressList.length)return this.$message.error("请去地址库添加退货地址"),!1;this.sendAddressDialog=!1;var t={orderRefundId:this.orderRefundId,refundStatus:4,refundSellerAddressId:this.refundSellerAddressId,refundSellerAddress:this.refundSellerAddress,refundSellerDesc:this.refundSellerDesc,token:this.orderDetails.token};this.sendLoading=!0,A.post("/api-mall/do-mall-order-refund",_.a.stringify(t)).then(function(t){0==t.data.errorCode?(e.$message({message:t.data.message,type:"success"}),e.agreedRefundDialog=!1,e.agreedNewRefundDialog=!1,e.confirmStatus=!1,e.getOrderDetails(e.orderDetails.refundDTO.orderRefundId),e.consultationRecord(),e.sendLoading=!1):(e.$message.error(t.data.message),e.sendLoading=!1)})},remarkLimit:function(e){var t=this;this.$nextTick(function(){t.refundSellerDesc=C.getInputVal(e,150),t.refundSellerDescLen=C.getZhLen(t.refundSellerDesc)})},refundFailReasonLimit:function(e){var t=this;this.$nextTick(function(){t.closeRefundForm.refundFailReason=C.getInputVal(e,200),t.refundFailReasonLen=C.getZhLen(t.closeRefundForm.refundFailReason)})},radioChange:function(e,t){for(var a=0;a<this.refundAddressList.addressList.length;a++)this.refundAddressList.addressList[a].ifDefault=0;this.refundAddressList.addressList[t].ifDefault=1,this.refundSellerAddressId=this.refundAddressList.addressList[t].sellerAddressId,this.refundSellerAddress=this.refundAddressList.addressList[t].provinceName+this.refundAddressList.addressList[t].cityName+this.refundAddressList.addressList[t].areaName+this.refundAddressList.addressList[t].addressDetail},consultationRecord:function(){var e=this,t={orderRefundId:this.orderRefundId,requestProject:"mall"};A.get("/api-mall/find_refund_consult_record",{params:t}).then(function(t){0==t.data.errorCode?e.consultationRecords=t.data.result:e.$message.error(t.data.message)})},enlargeDialogImageUrl:function(e,t){this.dialogVisibleImg=!0,this.dialogEnlargeImageUrl=e},goOrderDetail:function(e){this.$router.push({name:"orderDetails",params:{orderId:e}})},goAddressList:function(){this.$router.push({name:"addressEdit",params:{sellerAddressId:"-1"}})}},filters:{changeTimes:function(e){var t=new Date(e);return t.getFullYear()+"-"+((t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-")+((t.getDate()<10?"0"+t.getDate():t.getDate())+" ")+((t.getHours()<10?"0"+t.getHours():t.getHours())+":")+((t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":")+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds())},refundTypeName:function(e){var t="";return 1==e?t="仅退款":2==e&&(t="退货退款"),t}},components:{}},ha={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[e.updateDom?a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("订单管理")]),e._v(" "),a("el-breadcrumb-item",{attrs:{to:{path:"/refundManage"}}},[e._v("退款管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("退款详情")])],1),e._v(" "),e._m(0)],1),e._v(" "),a("div",{staticClass:"mall-section"},[3!=e.orderDetails.refundDTO.refundStatus&&null===e.orderDetails.order.orderVersion?a("div",{staticClass:"progress-wrap"},[a("div",{staticClass:"progress-info progress-infoed"},[a("div",[e._v("买家申请退款")]),e._v(" "),a("div",{staticClass:"progress-info-time"},[e._v(e._s(e._f("changeTimes")(e.orderDetails.refundDTO.createTime)))])]),e._v(" "),a("div",{class:{"progress-ing":1==e.orderDetails.refundDTO.refundStatus,"progress-ed":2==e.orderDetails.refundDTO.refundStatus}},[a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("i",{staticClass:"el-icon-arrow-right"})]),e._v(" "),a("div",{staticClass:"progress-info",class:{"progress-infoed":2==e.orderDetails.refundDTO.refundStatus}},[a("div",[e._v("商家处理退款申请")]),e._v(" "),2==e.orderDetails.refundDTO.refundStatus||3==e.orderDetails.refundDTO.refundStatus?a("div",{staticClass:"progress-info-time progress-info-time-left"},[e._v(e._s(e._f("changeTimes")(e.orderDetails.refundDTO.updateTime)))]):e._e()]),e._v(" "),a("div",{class:{"progress-no":1==e.orderDetails.refundDTO.refundStatus,"progress-ed":2==e.orderDetails.refundDTO.refundStatus}},[a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("i",{staticClass:"el-icon-arrow-right"})]),e._v(" "),a("div",{staticClass:"progress-info",class:{"progress-infoed":2==e.orderDetails.refundDTO.refundStatus}},[a("div",[e._v("退款成功")]),e._v(" "),2==e.orderDetails.refundDTO.refundStatus?a("div",{staticClass:"progress-info-time progress-info-time-left-b"},[e._v(e._s(e._f("changeTimes")(e.orderDetails.refundDTO.updateTime)))]):e._e()])]):e._e(),e._v(" "),3!=e.orderDetails.refundDTO.refundStatus&&null!==e.orderDetails.order.orderVersion?a("div",{staticClass:"progress-wrap"},[a("div",{staticClass:"progress-info progress-infoed"},[a("div",[e._v("买家申请退款")]),e._v(" "),a("div",{staticClass:"progress-info-time"},[e._v(e._s(e.getTimeAll(e.orderDetails.refundDTO.createTime)))])]),e._v(" "),a("div",{class:{"progress-ing":1==e.orderDetails.refundDTO.refundStatus,"progress-ed":2==e.orderDetails.refundDTO.refundStatus||6==e.orderDetails.refundDTO.refundStatus||5==e.orderDetails.refundDTO.refundStatus||4==e.orderDetails.refundDTO.refundStatus}},[a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("i",{staticClass:"el-icon-arrow-right"})]),e._v(" "),a("div",{staticClass:"progress-info",class:{"progress-infoed":2==e.orderDetails.refundDTO.refundStatus||6==e.orderDetails.refundDTO.refundStatus||5==e.orderDetails.refundDTO.refundStatus}},[a("div",[e._v("商家处理退款申请")]),e._v(" "),2==e.orderDetails.refundDTO.refundStatus||3==e.orderDetails.refundDTO.refundStatus||6==e.orderDetails.refundDTO.refundStatus||5==e.orderDetails.refundDTO.refundStatus?a("div",{staticClass:"progress-info-time progress-info-time-left"},[e._v(e._s(e.getTimeAll(e.orderDetails.refundDTO.refundProcessTime)))]):e._e()]),e._v(" "),a("div",{class:{"progress-no":1==e.orderDetails.refundDTO.refundStatus,"progress-ed":2==e.orderDetails.refundDTO.refundStatus||3==e.orderDetails.refundDTO.refundStatus||6==e.orderDetails.refundDTO.refundStatus||5==e.orderDetails.refundDTO.refundStatus||4==e.orderDetails.refundDTO.refundStatus}},[a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("i",{staticClass:"el-icon-arrow-right"})]),e._v(" "),2===e.orderDetails.refundDTO.refundType?a("div",{staticClass:"progress-info",class:{"progress-infoed":2==e.orderDetails.refundDTO.refundStatus||5==e.orderDetails.refundDTO.refundStatus}},[a("div",[e._v("买家退货给商家")]),e._v(" "),2==e.orderDetails.refundDTO.refundStatus||5==e.orderDetails.refundDTO.refundStatus?a("div",{staticClass:"progress-info-time progress-info-time-left"},[e._v(e._s(e.getTimeAll(e.orderDetails.refundDTO.refundGoodsTime)))]):e._e()]):e._e(),e._v(" "),2===e.orderDetails.refundDTO.refundType?a("div",{class:{"progress-no":1==e.orderDetails.refundDTO.refundStatus||2===e.orderDetails.refundDTO.refundType,"progress-ed":2==e.orderDetails.refundDTO.refundStatus,"progress-ing":5==e.orderDetails.refundDTO.refundStatus}},[a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("div"),e._v(" "),a("i",{staticClass:"el-icon-arrow-right"})]):e._e(),e._v(" "),a("div",{staticClass:"progress-info",class:{"progress-infoed":2==e.orderDetails.refundDTO.refundStatus}},[a("div",[e._v("退款完成")]),e._v(" "),2==e.orderDetails.refundDTO.refundStatus?a("div",{staticClass:"progress-info-time progress-info-time-left"},[e._v(e._s(e.getTimeAll(e.orderDetails.refundDTO.updateTime)))]):e._e()])]):e._e(),e._v(" "),a("el-row",[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"left-wrap"},[a("div",{staticClass:"left-header"},[e._v("\n              退款信息\n            ")]),e._v(" "),a("div",{staticClass:"goods-info"},[a("div",[a("a",{attrs:{href:"javascript:;"}},[a("img",{staticClass:"imgs-style",attrs:{src:e.orderDetails.orderItem.mallProImageUrl,alt:""}})])]),e._v(" "),a("div",{staticClass:"goods-text"},[a("div",[e._v(e._s(e.orderDetails.orderItem.mallProName))]),e._v(" "),a("div",{staticClass:"goods-text-info"},[a("div",e._l(JSON.parse(e.orderDetails.orderItem.mallProSkuAttr),function(t,s){return a("span",{key:s},[e._v(e._s(t.propName)+"："+e._s(t.valueName)+"   ")])})),e._v(" "),a("div",[e._v("SKU编码："+e._s(e.orderDetails.orderItem.mallProSkuCode))])])])]),e._v(" "),a("div",{staticClass:"left-list-info"},[a("div",[a("span",[e._v("退款编号")]),e._v(" "),a("span",[e._v(e._s(e.orderDetails.refundDTO.orderRefundNumber))])]),e._v(" "),a("div",[a("span",[e._v("退款方式")]),e._v(" "),a("span",[e._v(e._s(e._f("refundTypeName")(e.orderDetails.refundDTO.refundType)))])]),e._v(" "),a("div",[a("span",[e._v("申请金额")]),e._v(" "),a("span",[e._v(e._s(e.orderDetails.refundDTO.applyRefundPrice))])]),e._v(" "),a("div",[a("span",[e._v("申请件数")]),e._v(" "),a("span",[e._v(e._s(e.orderDetails.orderItem.mallProNumber))])]),e._v(" "),a("div",{staticClass:"refund-reason"},[a("span",[e._v("退款原因")]),e._v(" "),a("span",[e._v(e._s(e.orderDetails.refundDTO.refundReason))])]),e._v(" "),a("div",[a("span",[e._v("订单编号")]),e._v(" "),a("span",{staticClass:"a-link",on:{click:function(t){e.goOrderDetail(e.orderDetails.order.orderId)}}},[e._v(e._s(e.orderDetails.order.orderNumber))])]),e._v(" "),a("div",[a("span",[e._v("付款时间")]),e._v(" "),a("span",[e._v(e._s(e._f("changeTimes")(e.orderDetails.order.payTime)))])]),e._v(" "),a("div",[a("span",[e._v("会员昵称")]),e._v(" "),a("span",[e._v(e._s(e.orderDetails.nickName))])]),e._v(" "),a("div",[a("span",[e._v("会员卡号")]),e._v(" "),a("span",[a("a",{attrs:{href:e.pageUrl,target:"_blank"}},[e._v(e._s(e.orderDetails.order.memberCardNum))])])]),e._v(" "),a("div",[a("span",[e._v("合计优惠")]),e._v(" "),a("span",[e._v("-￥"+e._s(e.orderDetails.order.discountSum))])]),e._v(" "),a("div",[a("span",[e._v("运费")]),e._v(" "),a("span",[e._v("￥"+e._s(e.orderDetails.order.mallOrderFreight))])]),e._v(" "),a("div",[a("span",[e._v("实收金额")]),e._v(" "),a("span",[e._v("￥"+e._s(e.orderDetails.order.payAmountAll))])])])])]),e._v(" "),a("el-col",{attrs:{span:18}},[a("div",{staticClass:"right-wrap"},[""===e.orderDetails.order.orderVersion||null===e.orderDetails.order.orderVersion?a("div",[1==e.orderDetails.refundDTO.refundStatus?a("div",{staticClass:"right-header"},[a("p",{staticClass:"right-header-title"},[e._v("等待商家处理退款申请")]),e._v(" "),a("p",{staticClass:"right-header-instructions"},[e._v("买家发起退款申请，等待商家处理")]),e._v(" "),a("div",{staticClass:"right-header-btns"},[a("el-button",{staticStyle:{width:"98px"},attrs:{type:"primary",size:"small"},on:{click:function(t){e.agreedRefundDialog=!0}}},[e._v("同意")]),e._v(" "),a("el-button",{staticStyle:{color:"#409EFF","border-color":"#409EFF",width:"98px"},attrs:{size:"small"},on:{click:function(t){e.closeRefundDialog=!0}}},[e._v("拒绝")])],1),e._v(" "),a("el-dialog",{attrs:{title:"同意退款",visible:e.agreedRefundDialog,width:"464px"},on:{"update:visible":function(t){e.agreedRefundDialog=t}}},[a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"close-reason"},[e._v("申请金额：")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[e._v("￥"+e._s(e.orderDetails.refundDTO.applyRefundPrice)+"（实付金额￥"+e._s(e.orderDetails.orderItem.payAmount)+"，积分"+e._s(e.orderDetails.orderItem.usePoints)+"分）")])]),e._v(" "),a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"close-reason"},[e._v("邮费：")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[e._v("￥"+e._s(e.orderDetails.orderItem.orderItemFreight))])]),e._v(" "),a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"close-reason"},[e._v("数量：")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[a("el-select",{staticClass:"width-style",attrs:{clearable:"",placeholder:"请选择"},model:{value:e.agreedRefundForm.orderItemNum,callback:function(t){e.$set(e.agreedRefundForm,"orderItemNum",t)},expression:"agreedRefundForm.orderItemNum"}},e._l(e.orderDetails.orderItem.mallProNumber+1,function(e){return a("el-option",{key:e-1,attrs:{label:e-1,value:e-1}})}))],1)]),e._v(" "),a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"close-reason"},[e._v("退款总额：")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[a("el-input",{attrs:{type:"number",placeholder:e.refundTotalMax},on:{input:e.refundTotalMaxDeal},model:{value:e.agreedRefundForm.refundTotal,callback:function(t){e.$set(e.agreedRefundForm,"refundTotal",e._n(t))},expression:"agreedRefundForm.refundTotal"}})],1)]),e._v(" "),a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"close-reason"},[e._v("退款金额：")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[a("el-input",{attrs:{type:"text",placeholder:e.refundPriceMax,disabled:!0},model:{value:e.agreedRefundForm.refundPrice,callback:function(t){e.$set(e.agreedRefundForm,"refundPrice",t)},expression:"agreedRefundForm.refundPrice"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.agreedRefundForm.showMoney,expression:"agreedRefundForm.showMoney"}],staticStyle:{"margin-top":"8px",color:"#909399",display:"inline-block"}},[e._v(" 剩余￥"+e._s(e.agreedRefundForm.moreMoney)+"折和"+e._s(e.agreedRefundForm.morePoint)+"积分进行返还 ")])],1)]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.agreedRefundDialog=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{disabled:e.confirmStatus,type:"primary"},on:{click:e.agreedRefundDeal}},[e._v("确 定")])],1)])],1):2==e.orderDetails.refundDTO.refundStatus?a("div",{staticClass:"right-header"},[a("p",{staticClass:"right-header-title"},[e._v("退款成功")]),e._v(" "),a("p",{staticClass:"right-header-instructions"},[e._v("商家退款成功，退回金额：￥"+e._s(e.orderDetails.refundDTO.refundPrice)+"； 退回积分："+e._s(e.orderDetails.refundDTO.refundPoints)+"分；退款数量："+e._s(e.orderDetails.refundDTO.refundNumber))])]):3==e.orderDetails.refundDTO.refundStatus?a("div",{staticClass:"right-header"},[a("p",{staticClass:"right-header-title error-color"},[e._v("退款关闭")])]):e._e()]):e._e(),e._v(" "),""!==e.orderDetails.order.orderVersion&&null!==e.orderDetails.order.orderVersion?a("div",[1===e.orderDetails.refundDTO.refundType?a("div",[1===e.orderDetails.refundDTO.refundStatus?a("div",{staticClass:"right-header"},[a("p",{staticClass:"right-header-title"},[e._v("等待商家处理退款申请")]),e._v(" "),a("p",{staticClass:"right-header-instructions"},[e._v("买家发起退款申请，等待商家处理")]),e._v(" "),a("div",{staticClass:"right-header-btns"},[a("el-button",{staticStyle:{width:"98px"},attrs:{type:"primary",size:"small"},on:{click:e.agreedRefundNew}},[e._v("同意")]),e._v(" "),a("el-button",{staticStyle:{color:"#409EFF","border-color":"#409EFF",width:"98px"},attrs:{size:"small"},on:{click:function(t){e.closeRefundDialog=!0}}},[e._v("拒绝")])],1)]):6===e.orderDetails.refundDTO.refundStatus?a("div",{staticClass:"right-header"},[a("p",{staticClass:"right-header-instructions"},[e._v("商家拒绝退款，等待买家修改退款申请")])]):2===e.orderDetails.refundDTO.refundStatus?a("div",{staticClass:"right-header"},[a("p",{staticClass:"right-header-instructions"},[e._v("商家退款成功，退回金额：￥"+e._s(e.orderDetails.refundDTO.refundPrice)+"； 退回积分："+e._s(e.orderDetails.refundDTO.refundPoints)+"分；退款数量："+e._s(e.orderDetails.refundDTO.refundNumber))])]):3===e.orderDetails.refundDTO.refundStatus?a("div",{staticClass:"right-header"},[a("p",{staticClass:"right-header-instructions"},[e._v("买家撤销退款申请，退款关闭")])]):e._e()]):e._e(),e._v(" "),2===e.orderDetails.refundDTO.refundType?a("div",[1===e.orderDetails.refundDTO.refundStatus?a("div",{staticClass:"right-header"},[a("p",{staticClass:"right-header-title"},[e._v("等待商家处理退款申请")]),e._v(" "),a("p",{staticClass:"right-header-instructions"},[e._v("买家发起退货退款申请，等待商家处理")]),e._v(" "),a("div",{staticClass:"right-header-btns"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.sendRefundAddress}},[e._v("同意退货，发送退货地址")]),e._v(" "),a("el-button",{staticStyle:{color:"#409EFF","border-color":"#409EFF"},attrs:{size:"small"},on:{click:function(t){e.closeRefundDialog=!0}}},[e._v("拒绝退货")])],1)]):2===e.orderDetails.refundDTO.refundStatus?a("div",{staticClass:"right-header"},[a("p",{staticClass:"right-header-title"},[e._v("退款成功")]),e._v(" "),a("p",{staticClass:"right-header-instructions"},[e._v("商家收到退货，同意退款")])]):3===e.orderDetails.refundDTO.refundStatus?a("div",{staticClass:"right-header"},[a("p",{staticClass:"right-header-title"},[e._v("退款关闭")]),e._v(" "),a("p",{staticClass:"right-header-instructions"},[e._v("买家在7天内未退货，退款申请关闭")])]):4===e.orderDetails.refundDTO.refundStatus?a("div",{staticClass:"right-header"},[a("p",{staticClass:"right-header-title"},[e._v("商家已同意退款，等待买家将货退回")]),e._v(" "),a("p",{staticClass:"right-header-instructions"},[e._v("你已同意退货，请等待买家将货寄回")])]):5===e.orderDetails.refundDTO.refundStatus?a("div",{staticClass:"right-header"},[a("p",{staticClass:"right-header-title"},[e._v("买家已退货，等待商家确认收货")]),e._v(" "),a("div"),e._v(" "),e.orderDetails.refundDTO.mallOrderRefundLogisticsDTO?a("p",{staticClass:"right-header-instructions"},[e._v("买家已退货，物流公司："+e._s(e.orderDetails.refundDTO.mallOrderRefundLogisticsDTO.logisticsCompanyName)+"；物流单号："+e._s(e.orderDetails.refundDTO.mallOrderRefundLogisticsDTO.courierNumber))]):e._e(),e._v(" "),a("div",{staticClass:"right-header-btns"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.takeGoodsRefund}},[e._v("确认收货并退款")]),e._v(" "),a("el-button",{staticStyle:{color:"#409EFF","border-color":"#409EFF",width:"98px"},attrs:{size:"small"},on:{click:function(t){e.closeRefundDialog=!0}}},[e._v("拒绝收货")])],1)]):6===e.orderDetails.refundDTO.refundStatus?a("div",{staticClass:"right-header"},[a("p",{staticClass:"right-header-title"},[e._v("商家不同意退款申请")]),e._v(" "),a("p",{staticClass:"right-header-instructions"},[e._v("你已拒绝本次退款申请，买家修改退货申请后，需要你重新处理")])]):e._e()]):e._e()]):e._e(),e._v(" "),a("div",{staticClass:"right-body"},[a("div",{staticClass:"right-title"},[e._v("\n                协商记录\n              ")]),e._v(" "),e._l(e.consultationRecords,function(t,s){return a("div",{key:s},[1===t.role?a("div",{staticClass:"right-body-wrap"},[a("div",{staticClass:"buyers-sell-title"},[a("span",{staticStyle:{"font-weight":"600"}},[e._v("买家")]),e._v(" "),a("span",[e._v(e._s(e._f("changeTimes")(t.createTime)))])]),e._v(" "),a("div",[a("p",[e._v(e._s(""===t.msg?"买家发起退款申请，等待商家处理":t.msg))])]),e._v(" "),a("div",[a("div",{staticStyle:{display:"inline-block","margin-right":"40px"}},[a("span",{staticClass:"prompt-info"},[e._v("退款原因")]),e._v(" "),a("span",{staticStyle:{"margin-right":"20px"}},[e._v(e._s(t.refundReason))])]),e._v(" "),a("div",{staticStyle:{display:"inline-block","margin-right":"40px"}},[a("span",{staticClass:"prompt-info prompt-info-a"},[e._v("退款方式")]),e._v(" "),a("span",{staticStyle:{"margin-right":"20px"}},[e._v(e._s(e._f("refundTypeName")(t.refundType)))])]),e._v(" "),a("div",{staticStyle:{display:"inline-block","margin-right":"40px"}},[0!==t.refundDeliverType?a("span",{staticClass:"prompt-info prompt-info-a"},[e._v("发货状态")]):e._e(),e._v(" "),1===t.refundDeliverType?a("span",[e._v("未发货")]):e._e(),e._v(" "),2===t.refundDeliverType?a("span",[e._v("已发货")]):e._e()]),e._v(" "),a("div",{staticStyle:{display:"inline-block"}},[a("span",{staticClass:"prompt-info"},[e._v("退款金额")]),e._v(" "),a("span",{staticStyle:{"margin-right":"20px"}},[e._v("￥"+e._s(t.refundPrice))])])]),e._v(" "),a("div"),e._v(" "),a("div",{staticClass:"refund-info"},[a("div",{staticClass:"prompt-info"},[e._v("退款说明")]),e._v(" "),a("p",{staticStyle:{width:"700px"}},[e._v(e._s(t.description))])]),e._v(" "),a("div",{staticStyle:{"margin-left":"65px"}},[e._l(t.imgUrl?t.imgUrl.split(","):[],function(t,s){return a("div",{key:s,staticClass:"img-box"},[a("img",{staticStyle:{width:"40px",height:"40px"},attrs:{src:t,alt:""}}),e._v(" "),a("i",{staticClass:"el-icon-zoom-in",on:{click:function(a){e.enlargeDialogImageUrl(t,s)}}}),e._v(" "),a("div",{staticClass:"dialog-img"})])}),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisibleImg},on:{"update:visible":function(t){e.dialogVisibleImg=t}}},[a("img",{attrs:{width:"100%",src:e.dialogEnlargeImageUrl,alt:""}})])],2)]):a("div",{staticClass:"right-body-wrap"},[a("div",{staticClass:"buyers-sell-title"},[a("span",{staticStyle:{"font-weight":"600"}},[e._v("商家")]),e._v(" "),a("span",[e._v(e._s(e._f("changeTimes")(t.createTime)))])]),e._v(" "),a("div",[a("p",[e._v(e._s(t.msg))])])])])})],2)])])],1)],1)]):e._e(),e._v(" "),a("el-dialog",{attrs:{title:e.refundDialogTitle,visible:e.closeRefundDialog,width:"464px"},on:{"update:visible":function(t){e.closeRefundDialog=t},close:e.cancelRefund}},[a("div",{staticClass:"close-reason"},[e._v("拒绝原因")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[a("el-input",{attrs:{type:"textarea",rows:3},on:{input:function(t){return e.refundFailReasonLimit(t)}},model:{value:e.closeRefundForm.refundFailReason,callback:function(t){e.$set(e.closeRefundForm,"refundFailReason",t)},expression:"closeRefundForm.refundFailReason"}}),e._v(" "),a("span",{staticClass:"remark-num"},[e._v(e._s(e.refundFailReasonLen)+"/200")])],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:e.cancelRefund}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.disagreeRefundStatus},on:{click:e.closeRefundDeal}},[e._v("确 定")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"发送退货地址",visible:e.sendAddressDialog,width:"500px"},on:{"update:visible":function(t){e.sendAddressDialog=t}}},[a("div",{staticClass:"dialog-content-box"},[a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"close-reason"},[e._v("退款方式：")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[e._v("退货退款")])]),e._v(" "),a("div",{staticClass:"dialog-content-new"},[a("div",{staticClass:"close-reason"},[e._v("退款金额：")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[e._v("￥"+e._s(e.refundAddressList.applyRefundPrice))])]),e._v(" "),a("div",{staticClass:"dialog-content-new"},[a("div",{staticClass:"close-reason"},[e._v("退货地址：")]),e._v(" "),e.refundAddressList.addressList.length>0?a("div",{staticClass:"close-reason-info reason-radio-align"},e._l(e.refundAddressList.addressList,function(t,s){return a("el-radio",{key:s,staticClass:"radio-block",attrs:{label:s},on:{change:function(a){e.radioChange(t,s)}},model:{value:e.defaultAddress,callback:function(t){e.defaultAddress=t},expression:"defaultAddress"}},[e._v("\n            "+e._s(t.provinceName)+e._s(t.cityName)+e._s(t.areaName)+e._s(t.addressDetail)+"\n            "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.ifDefault,expression:"item.ifDefault"}],staticClass:"default-remark"},[e._v("默认")])])})):a("div",[a("span",[a("a",{attrs:{href:e.pageUrlAddress,target:"_blank"}},[e._v("添加退货地址")])])])]),e._v(" "),a("div",{staticClass:"dialog-content-new"},[a("div",{staticClass:"close-reason"},[e._v("备注：")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[a("el-input",{attrs:{type:"textarea",rows:3},on:{input:function(t){return e.remarkLimit(t)}},model:{value:e.refundSellerDesc,callback:function(t){e.refundSellerDesc=t},expression:"refundSellerDesc"}}),e._v(" "),a("span",{staticClass:"remark-num"},[e._v(e._s(e.refundSellerDescLen)+"/150")])],1)])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.sendAddressDialog=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.sendLoading},on:{click:e.sendMessageConfirm}},[e._v("确 定")])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"同意退款",visible:e.agreedNewRefundDialog,width:"464px"},on:{"update:visible":function(t){e.agreedNewRefundDialog=t}}},[a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"close-reason"},[e._v("申请金额：")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[e._v("￥"+e._s(e.orderDetails.refundDTO.applyRefundPrice)+"（实付金额￥"+e._s(e.orderDetails.orderItem.payAmount)+"，积分"+e._s(e.orderDetails.orderItem.usePoints)+"分）")])]),e._v(" "),a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"close-reason"},[e._v("邮费：")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[e._v("￥"+e._s(e.orderDetails.orderItem.orderItemFreight))])]),e._v(" "),a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"close-reason"},[e._v("数量：")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[a("el-select",{staticClass:"width-style",attrs:{clearable:"",placeholder:"请选择",disabled:e.editNum},model:{value:e.agreedRefundForm.orderItemNum,callback:function(t){e.$set(e.agreedRefundForm,"orderItemNum",t)},expression:"agreedRefundForm.orderItemNum"}},[a("el-option",{key:0,attrs:{label:0,value:0}}),e._v(" "),e._l(e.orderDetails.orderItem.mallProNumber,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})],2)],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.orderDetails.orderItem.usePoints>0,expression:"orderDetails.orderItem.usePoints > 0"}],staticClass:"dialog-content"},[a("div",{staticClass:"close-reason"},[e._v("退回积分：")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[a("el-input",{attrs:{type:"text",placeholder:e.maxRefundPointText},on:{input:e.refundPointMaxDeal},model:{value:e.agreedRefundForm.realRefundPoint,callback:function(t){e.$set(e.agreedRefundForm,"realRefundPoint",e._n(t))},expression:"agreedRefundForm.realRefundPoint"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.agreedRefundForm.realRefundPoint,expression:"agreedRefundForm.realRefundPoint"}],staticStyle:{"margin-top":"8px",color:"#909399",display:"inline-block"}},[e._v(" "+e._s(e.pointRuleComputed)+"积分抵"+e._s(e.moneyRuleComputed)+"元 ")])],1)]),e._v(" "),a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"close-reason"},[e._v("退款金额：")]),e._v(" "),a("div",{staticClass:"close-reason-info"},[a("el-input",{attrs:{type:"text",placeholder:e.refundPriceMax,disabled:!0},model:{value:e.agreedRefundForm.refundPriceNew,callback:function(t){e.$set(e.agreedRefundForm,"refundPriceNew",t)},expression:"agreedRefundForm.refundPriceNew"}})],1)]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.agreedNewRefundDialog=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.refundLoading},on:{click:e.agreedRefundDealNew}},[e._v("确 定")])],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("退款详情")])])}]};var ga=a("VU/8")(pa,ha,!1,function(e){a("cooY")},"data-v-52055c5d",null).exports,va={data:function(){return{pickerOptions2:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},length:0,activeName:"first",value7:""}},computed:{},methods:{dataLen:function(e){return this.length=e.length,e.length}}},fa={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container"},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("订单管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("所有订单")])],1),e._v(" "),e._m(0)],1),e._v(" "),a("div",{staticClass:"mall-section"},[a("el-tabs",{staticClass:"bread-content",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"全部",name:"first"}},[a("div",{staticClass:"order-wrap-padding"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:16}},[a("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions2},model:{value:e.value7,callback:function(t){e.value7=t},expression:"value7"}})],1)]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"fl"},[a("el-input",{attrs:{placeholder:"请输入内容",size:"medium","prefix-icon":"el-icon-search"}})],1)])],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"fr"},[a("el-button",{attrs:{type:"primary"}},[e._v("批量发货")]),e._v(" "),a("el-button",{attrs:{type:"primary"}},[e._v("导出订单")])],1)])],1)],1)]),e._v(" "),a("el-tab-pane",{attrs:{label:"待付款",name:"second"}},[e._v("待付款2")]),e._v(" "),a("el-tab-pane",{attrs:{label:"待发货",name:"third"}},[e._v("待发货3")]),e._v(" "),a("el-tab-pane",{attrs:{label:"部分发货",name:"fourth"}},[e._v("部分发货")]),e._v(" "),a("el-tab-pane",{attrs:{label:"已发货",name:"fifth"}},[e._v("已发货")]),e._v(" "),a("el-tab-pane",{attrs:{label:"交易成功",name:"sixth"}},[e._v("交易成功")]),e._v(" "),a("el-tab-pane",{attrs:{label:"交易关闭",name:"seventh"}},[e._v("交易关闭")]),e._v(" "),a("el-tab-pane",{attrs:{label:"退款中",name:"eighth"}},[e._v("退款中")])],1)],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("所有订单")])])}]};var ba=a("VU/8")(va,fa,!1,function(e){a("fvXX")},"data-v-f64ee340",null).exports,ya={data:function(){return{pickerOptions2:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},length:0,activeName:"first",value7:""}},computed:{},methods:{dataLen:function(e){return this.length=e.length,e.length}}},_a={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container"},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("订单管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("所有订单")])],1),e._v(" "),e._m(0)],1),e._v(" "),a("div",{staticClass:"mall-section"},[a("el-tabs",{staticClass:"bread-content",model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"全部",name:"first"}},[a("div",{staticClass:"order-wrap-padding"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:16}},[a("el-row",{staticClass:"row-bg",attrs:{type:"flex"}},[a("el-col",{attrs:{span:7}},[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions2},model:{value:e.value7,callback:function(t){e.value7=t},expression:"value7"}})],1)]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"fl"},[a("el-input",{attrs:{placeholder:"请输入内容",size:"medium","prefix-icon":"el-icon-search"}})],1)])],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"fr"},[a("el-button",{attrs:{type:"primary"}},[e._v("批量发货")]),e._v(" "),a("el-button",{attrs:{type:"primary"}},[e._v("导出订单")])],1)])],1)],1)]),e._v(" "),a("el-tab-pane",{attrs:{label:"待付款",name:"second"}},[e._v("待付款2")]),e._v(" "),a("el-tab-pane",{attrs:{label:"待发货",name:"third"}},[e._v("待发货3")]),e._v(" "),a("el-tab-pane",{attrs:{label:"部分发货",name:"fourth"}},[e._v("部分发货")]),e._v(" "),a("el-tab-pane",{attrs:{label:"已发货",name:"fifth"}},[e._v("已发货")]),e._v(" "),a("el-tab-pane",{attrs:{label:"交易成功",name:"sixth"}},[e._v("交易成功")]),e._v(" "),a("el-tab-pane",{attrs:{label:"交易关闭",name:"seventh"}},[e._v("交易关闭")]),e._v(" "),a("el-tab-pane",{attrs:{label:"退款中",name:"eighth"}},[e._v("退款中")])],1)],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("所有订单")])])}]};var Ca=a("VU/8")(ya,_a,!1,function(e){a("PtMU")},"data-v-b48189d2",null).exports,Ia={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,searchValue:"",currentPage:1,pageSizes:[20,40,60,80],pageSize:20,total:0,sortColumn:"asc",sortType:0,multipleSelection:[],getTime:C.getTime,getSeconds:C.getSeconds,dialogVisible:!1,goodsList:[]}},created:function(){this.getList()},computed:{},methods:{getList:function(){var e=this,t={pageNum:this.currentPage,pageSize:this.pageSize,keyWord:this.searchValue.trim(),timeOrder:this.sortType};A.get("/api-mall/page-sync-error-log-goods",{params:t}).then(function(t){0===t.data.errorCode?t.data.result.result?(e.goodsList=t.data.result.result,e.total=t.data.result.totalCount):(e.goodsList=[],e.total=0):e.$message.error(t.data.message)})},handleSizeChange:function(e){this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currentPage=e,this.getList()},handleSearch:function(e){this.currentPage=1,this.searchValue=e,this.getList()},sortChange:function(e){this.sortColumn=e.prop,"ascending"==e.order?this.sortType=1:"descending"==e.order&&(this.sortType=2),this.getList()},batchSync:function(){var e=this;A.get("/api-mall/resync-goods").then(function(t){0===t.data.errorCode?(e.dialogVisible=!0,e.getList()):e.$message.error(t.data.message)})}},components:{}},Sa={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[s("div",{staticClass:"mall-content-section"},[s("div",{staticClass:"mall-content-title"},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",{attrs:{to:{path:"/goodsList"}}},[e._v("微商城")]),e._v(" "),s("el-breadcrumb-item",{staticClass:"bread-menu",attrs:{to:{path:"/goodsList"}}},[e._v("商品管理")]),e._v(" "),s("el-breadcrumb-item",{staticClass:"bread-menu",attrs:{to:{path:"/goodsList"}}},[e._v("商品列表")]),e._v(" "),s("el-breadcrumb-item",{staticClass:"bread-menu"},[e._v("同步失败商品")])],1),e._v(" "),e._m(0)],1),e._v(" "),s("div",{staticClass:"mall-section"},[s("div",{staticClass:"operate-top"},[s("div",{staticClass:"fl"},[s("el-input",{attrs:{placeholder:"请输入商品货号或名称","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleSearch(e.searchValue)}},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1),e._v(" "),s("div",{staticClass:"fr"},[s("el-button",{attrs:{type:"primary"},on:{click:e.batchSync}},[e._v("重新同步")])],1)]),e._v(" "),[s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.goodsList},on:{"sort-change":e.sortChange}},[s("el-table-column",{attrs:{prop:"proNo",label:"商品货号"}}),e._v(" "),s("el-table-column",{attrs:{prop:"proName",label:"商品名称"}}),e._v(" "),s("el-table-column",{attrs:{prop:"createTime",label:"同步时间",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticStyle:{"line-height":"18px"}},[e._v(e._s(e.getTime(t.row.createTime)))]),e._v(" "),s("p",{staticClass:"gray-color",staticStyle:{"line-height":"18px"}},[e._v(e._s(e.getSeconds(t.row.createTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"errorMessage",label:"失败原因"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:t.row.errorMessage}},[s("p",{staticClass:"error-mess",attrs:{slot:"reference"},slot:"reference"},[e._v(e._s(t.row.errorMessage))])])]}}])}),e._v(" "),s("template",{slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2)],e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.goodsList.length,expression:"goodsList.length"}],staticClass:"pagination-conteiner"},[s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])],2)]),e._v(" "),s("el-dialog",{staticClass:"center-item",attrs:{title:"",visible:e.dialogVisible,width:"400px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("h3",{staticStyle:{"margin-bottom":"20px","text-align":"center"}},[s("i",{staticClass:"el-icon-success",staticStyle:{color:"#67c23a","font-size":"24px","margin-right":"10px"}}),e._v("同步任务已提交")]),e._v(" "),s("p",{staticStyle:{"margin-bottom":"10px",color:"rgb(144, 147, 153)","margin-left":"15px","text-align":"center"}},[e._v("请耐心等待1分钟，同步成功后，")]),e._v(" "),s("p",{staticStyle:{"margin-bottom":"10px",color:"rgb(144, 147, 153)","margin-left":"15px","text-align":"center"}},[e._v("可去仓库中完善这些商品的主图等信息后，上架商品")]),e._v(" "),s("span",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("同步失败商品")])])}]};var wa=a("VU/8")(Ia,Sa,!1,function(e){a("5cle"),a("KIo0")},"data-v-262ffe08",null).exports,xa={props:{selectCateData:{type:Array,default:function(){return[]}}},data:function(){return{allDate:[],firstCate:[],classIndex1:0,refreshStatus:!1,seceltIndex1:"",seceltIndex2:"",showDrag:!1,showCateDrag:!0}},created:function(){this.getFirstCateList()},methods:{showDragClick:function(){this.showDrag=!this.showDrag,this.showDrag||this.getFirstCateList()},getFirstCateList:function(){var e=this;A.get("/api-mall/list-mall-goods-all-category").then(function(t){0===t.data.errorCode?(e.allDate=[],e.allDate.push({search:"",arr:t.data.result})):e.$message.error(t.data.message)})},getNextCateList:function(e,t,a,s){var i=this;this.seceltIndex1=s,this.seceltIndex2=t,this.allDate.length=s+1,this.refreshStatus=!this.refreshStatus;var r=!0,o=!1,l=void 0;try{for(var n,d=b()(a.arr);!(r=(n=d.next()).done);r=!0){n.value.classIndex=-1}}catch(e){o=!0,l=e}finally{try{!r&&d.return&&d.return()}finally{if(o)throw l}}e.classIndex=t;var c={categoryId:e.categoryId};A.get("/api-mall/list-mall-goods-children-category",{params:c}).then(function(e){0===e.data.errorCode?e.data.result.length&&(i.allDate[s+1]={search:"",arr:e.data.result},i.refreshStatus=!i.refreshStatus):i.$message.error(e.data.message)})},handaleConfirmCate:function(){if(""===this.seceltIndex1||""===this.seceltIndex2){for(var e in this.showDrag=!1,this.allDate)for(var t in this.allDate[e].arr)this.allDate[e].arr[t].classIndex=-1;return!1}for(var a in this.selectCateData)this.allDate[this.seceltIndex1].arr[this.seceltIndex2].categoryGroupId===this.selectCateData[a].categoryGroupId&&this.selectCateData.splice(a,1);this.selectCateData.push(this.allDate[this.seceltIndex1].arr[this.seceltIndex2]);var s=[];for(var i in this.selectCateData)s.push(this.selectCateData[i].categoryId);this.$emit("getCateIds",s)},cancelConfirmCate:function(){for(var e in this.allDate)for(var t in this.allDate[e].arr)this.allDate[e].arr[t].classIndex=-1;this.getFirstCateList(),this.showDrag=!1,this.$emit("deleteSkuMess")},handleClose:function(e){this.selectCateData.splice(this.selectCateData.indexOf(e),1);var t=[];for(var a in this.selectCateData)t.push(this.selectCateData[a].categoryId);this.$emit("getCateIds",t),this.$emit("deleteSkuMess")},searchCate:function(e,t,a,s){var i=this;if(s.cancelBubble=!0,this.allDate.length=t+1,0===t){var r={search:e};A.get("/api-mall/list-mall-goods-all-category",{params:r}).then(function(t){0===t.data.errorCode?(i.allDate=[],i.allDate.push({search:""!==e?e:"",arr:t.data.result})):i.$message.error(t.data.message)})}else{var o="";for(var l in this.allDate[t-1].arr)-1!==this.allDate[t-1].arr[l].classIndex&&(o=this.allDate[t-1].arr[l].categoryId);var n={search:e,categoryId:o};A.get("/api-mall/list-mall-goods-children-category",{params:n}).then(function(a){0===a.data.errorCode?(i.allDate[t]={search:""!==e?e:"",arr:a.data.result},i.refreshStatus=!i.refreshStatus):i.$message.error(a.data.message)})}},searchBlur:function(e){return!1}},components:{}},La={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"goods-cate-content"},[a("div",{staticClass:"goods-cate-title",on:{click:function(t){return t.stopPropagation(),e.showDragClick(t)}}},[e._l(e.selectCateData,function(t,s){return a("el-tag",{key:s,staticClass:"select-tag",attrs:{closable:"","disable-transitions":!1,size:"small"},on:{close:function(a){e.handleClose(t)}}},[e._v("\n      "+e._s(t.categoryName)+"\n    ")])}),e._v(" "),a("i",{class:e.showDrag?"el-icon-arrow-down":"el-icon-arrow-up"})],2),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showDrag,expression:"showDrag"}],staticClass:"goods-cate-list-container",on:{click:function(t){return t.stopPropagation(),e.searchBlur(t)}}},[a("div",{staticClass:"goods-cate-list-content",on:{click:function(t){return t.stopPropagation(),e.searchBlur(t)}}},e._l(e.allDate,function(t,s){return a("div",{key:s,staticClass:"goods-cate-box",on:{click:function(t){return t.stopPropagation(),e.searchBlur(t)}}},[a("el-input",{staticClass:"cate-search",attrs:{placeholder:"请输入内容","prefix-icon":"el-icon-search",size:"small",clearable:""},nativeOn:{keyup:function(a){return"button"in a||!e._k(a.keyCode,"enter",13,a.key,"Enter")?function(a){return e.searchCate(t.search,s,t,a)}(a):null}},model:{value:t.search,callback:function(a){e.$set(t,"search",a)},expression:"item.search"}}),e._v(" "),a("div",{staticClass:"goods-cate-list"},e._l(t.arr,function(i,r){return a("div",{key:i.categoryId,staticClass:"goods-cate-item",class:i.classIndex===r?"cate-item-active":"",on:{click:function(a){a.stopPropagation(),e.getNextCateList(i,r,t,s)}}},[a("span",[e._v(e._s(i.categoryName))]),e._v(" "),i.isChildren?a("i",{staticClass:"el-icon-arrow-right"}):e._e()])})),e._v(" "),a("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refreshStatus))])],1)})),e._v(" "),a("div",{staticClass:"goods-cate-footer"},[a("el-button",{staticClass:"cancel-cate",attrs:{type:"text"},on:{click:e.cancelConfirmCate}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"confirm-cate",attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.handaleConfirmCate(t)}}},[e._v("确认")])],1)])])},staticRenderFns:[]};var ka=a("VU/8")(xa,La,!1,function(e){a("KY6x")},"data-v-831ae838",null).exports,Na={data:function(){return{value3:!0,mallHeight:document.documentElement.clientHeight-64-98,fixedWidth:document.documentElement.clientWidth-200,getInputVal:C,getTime:C.getTime,getSeconds:C.getSeconds,goodsForm:{goodsName:"",mallProId:"",createSource:0,goodsBrand:[],goodsBrandSelect:"",categoryIds:[],goodsClassifyData:[],goodsPropertyData:[],goodsClassifySelect:null,goodsStandardData:[],goodsStandardSelect:[],tableStandardList:[],goodsStandardValueData:[],goodsStandardValueSelect:"",tableStandardValueList:[],dataIndex:0,standardKeyList:[],combineKeyValueList:[],standardKeyHeaderList:[],skuImageJson:[],mallProStandardJson:[],skuJson:[],editSkuKeyJson:[],editSkuKeyHeader:[],combineKeyAllValueList:[],standardUnkeyList:[],standardUnkeyHeaderList:[],combineAllList:[],standardAllHeaderList:[],stockStatus:"0",stock:0,mallProSpuPrice:0,proCode:0,proCodeQuery:0,imgTextEdit:"",templateList:[],templateSelect:"",putaway:"1",putawayTime:""},tinymceHtml:"请输入内容",goodsRules:{goodsName:[{required:!0,message:"请输入商品名称",trigger:"blur"}],goodsBrandSelect:[{required:!0,message:"请选择商品品牌",trigger:"blur"}],goodsClassifySelect:[{required:!0,message:"请选择商品分类",trigger:"blur"}],templateSelect:[{required:!0,message:"请选择运费模板",trigger:"blur"}]},goodsFormLen:{nameLen:0},uploadAction:window.location.origin+"/api-plug/upload-img?requestProject=mall",headersUpload:{sign:""},dialogVisible:!1,dialogStandardValue:!1,dialogImageUrl:[],dialogVisibleImg:!1,projectName:"mall",batchPrice:"",batchStock:"",batchSku:"",batchBar:"",uploadStatus:!0,selectCateData:[],refash:!0,dialogEnlargeImageUrl:!1,activeName:"",submitLoading:!1,pickerOptions:{disabledDate:function(e){return e.getTime()<(new Date).getTime()}}}},mounted:function(){window.onbeforeunload=function(e){localStorage.removeItem("goodsSearch")}},created:function(){this.getGoodsBrandList(),this.getClassifyList(),this.getTemplateList(),this.goodsForm.mallProId=this.$route.params.mallProId,this.goodsForm.createSource=this.$route.params.createSource,this.activeName=this.$route.params.activeName,"-1"!==this.goodsForm.mallProId&&(this.getEditMes(),this.getStandardImg())},computed:{},methods:{getEditMes:function(){var e=this,t={mallProId:this.goodsForm.mallProId};A.get("/api-mall/get-mall-good",{params:t}).then(function(t){if(0===t.data.errorCode){for(var a in t.data.result.mallCategories)e.goodsForm.categoryIds.push(t.data.result.mallCategories[a].categoryId);for(var s in e.selectCateData=t.data.result.mallCategories,e.getProperyList(),e.goodsForm.imgTextEdit=t.data.result.detailDescription,e.goodsForm.goodsClassifySelect=t.data.result.mallProTagId,e.goodsForm.goodsName=t.data.result.proName,e.goodsFormLen.nameLen=C.getZhLen(e.goodsForm.goodsName),t.data.result.mallProStandardJson&&(e.goodsForm.tableStandardList=JSON.parse(t.data.result.mallProStandardJson)),e.goodsForm.tableStandardList)e.goodsForm.goodsStandardSelect.push(e.goodsForm.tableStandardList[s].standardId);if(t.data.result.mallProImageUrl?e.dialogImageUrl=t.data.result.mallProImageUrl:e.dialogImageUrl=[],e.dialogImageUrl.length>=10?e.uploadStatus=!1:e.uploadStatus=!0,e.goodsForm.goodsBrandSelect="-1"===t.data.result.brandId?"":t.data.result.brandId,t.data.result.skuJson){var i=void 0;for(var r in i=t.data.result.skuJson.length>0?JSON.parse(t.data.result.skuJson[0].mallPropValues):[])e.goodsForm.standardAllHeaderList.push({standardName:i[r].propName,standardId:i[r].propId})}for(var o in t.data.result.skuJson){var l=JSON.parse(t.data.result.skuJson[o].mallPropValues);l.push({valueName:t.data.result.skuJson[o].mallProSkuPrice}),l.push({valueName:t.data.result.skuJson[o].stock}),l.push({valueName:t.data.result.skuJson[o].mallProSkuCode}),l.push({valueName:t.data.result.skuJson[o].mallProSkuBarCode}),l.push({valueName:t.data.result.skuJson[o].hidden}),e.goodsForm.combineKeyAllValueList.push(l)}e.goodsForm.proCode=t.data.result.proCode,e.goodsForm.proCodeQuery=t.data.result.proCodeQuery,e.goodsForm.mallProSpuPrice=t.data.result.mallProSpuPrice,e.goodsForm.stock=t.data.result.stock,e.goodsForm.templateSelect=t.data.result.freightTemplateId,1===t.data.result.status?e.goodsForm.putaway="3":e.goodsForm.putaway=String(t.data.result.upShelvesStatus),e.goodsForm.putawayTime=t.data.result.upShelvesTime}else e.$message.error(t.data.message)})},getEditOldMes:function(){var e=this,t={mallProId:this.goodsForm.mallProId};A.get("/api-mall/get-mall-good",{params:t}).then(function(t){0===t.data.errorCode?(e.goodsForm.imgTextEdit=t.data.result.detailDescription,e.goodsForm.goodsClassifySelect=t.data.result.mallProTagId,e.goodsForm.goodsName=t.data.result.proName,e.goodsFormLen.nameLen=C.getZhLen(e.goodsForm.goodsName),e.dialogImageUrl=t.data.result.mallProImageUrl,e.goodsForm.goodsBrandSelect="-1"===t.data.result.brandId?"":t.data.result.brandId,e.goodsForm.templateSelect=t.data.result.freightTemplateId,e.goodsForm.putaway=String(t.data.result.upShelvesStatus),e.goodsForm.putawayTime=t.data.result.upShelvesTime):e.$message.error(t.data.message)})},getStandardImg:function(){var e=this,t={mallProId:this.goodsForm.mallProId,isErp:!0};A.get("/api-mall/list-mall-goods-standard-image",{params:t}).then(function(t){if(0===t.data.errorCode){var a=void 0;for(var s in a=t.data.result.length>0?t.data.result[0].standardValues:[])e.goodsForm.standardKeyHeaderList.push({standardName:a[s].standardName,standardId:a[s].standardId});for(var i in t.data.result){var r=t.data.result[i].standardValues;r.push({valueName:t.data.result[i].imageUrl}),e.goodsForm.combineKeyValueList.push(r)}}else e.$message.error(t.data.message)})},goodsLimit:function(e){var t=this;this.$nextTick(function(){t.goodsForm.goodsName=C.getInputVal(e,30),t.goodsFormLen.nameLen=C.getZhLen(t.goodsForm.goodsName)})},remarkLimit:function(e){this.$nextTick(function(){e.remark=C.getInputVal(e.remark,10)})},getGoodsBrandList:function(){var e=this;A.get("/api-mall/list-enterprise-brand").then(function(t){0===t.data.errorCode?e.goodsForm.goodsBrand=t.data.result:e.$message.error(t.data.message)})},getClassifyList:function(){var e=this;A.get("/api-mall/list_mall_goods_tag_tree").then(function(t){0===t.data.errorCode?(e.goodsForm.goodsClassifyData.push({childTagList:t.data.result.childTagList,mallProTagId:t.data.result.mallProTagId,tagName:t.data.result.tagName}),e.getTree(e.goodsForm.goodsClassifyData)):e.$message.error(t.data.message)})},getTree:function(e){for(var t in e)e[t].label=e[t].tagName,e[t].id=e[t].mallProTagId,e[t].children=e[t].childTagList,e[t].children&&e[t].children.length?this.getTree(e[t].children):delete e[t].children},getProperyList:function(){var e=this;this.goodsForm.goodsPropertyData=[];var t={categoryIds:this.goodsForm.categoryIds.join(",")};"-1"!==this.goodsForm.mallProId&&(t.mallProId=this.goodsForm.mallProId),A.get("/api-mall/list-mall-goods-property",{params:t}).then(function(t){if(0===t.data.errorCode){var a=[];for(var s in a=t.data.result)if(a[s].propertyEditStatus=!0,a[s].fromErp)if(a[s].propertyEditStatus=!0,"TYP_TEXT"===a[s].propertyType||"TYP_NUM"===a[s].propertyType||"TYP_REAL_NUM"===a[s].propertyType||"TYP_TIME"===a[s].propertyType||"TYP_CURRENCY"===a[s].propertyType||"TYP_PERCENT"===a[s].propertyType)a[s].mallPropValues=a[s].mallPropValues[0].valueName;else if("TYP_MULTI"===a[s].propertyType){for(var i in a[s].children)a[s].children[i].label=a[s].children[i].valueName,a[s].children[i].id=a[s].children[i].valueId;var r=[];for(var o in a[s].mallPropValues)r.push(a[s].children[o].valueId);a[s].mallPropValues=r}else if("TYP_SINGLE"===a[s].propertyType)a[s].mallPropValues=a[s].mallPropValues[0];else{var l=[];for(var n in a[s].mallPropValues)l.push({valueId:a[s].mallPropValues[n].valueId,valueName:a[s].mallPropValues[n].valueName});a[s].mallPropValues=l}else if(a[s].propertyEditStatus=!1,"TYP_TEXT"===a[s].propertyType||"TYP_NUM"===a[s].propertyType||"TYP_REAL_NUM"===a[s].propertyType||"TYP_TIME"===a[s].propertyType||"TYP_CURRENCY"===a[s].propertyType||"TYP_PERCENT"===a[s].propertyType)a[s].mallPropValues.length?a[s].mallPropValues=a[s].mallPropValues[0].valueName:a[s].mallPropValues="";else if("TYP_MULTI"===a[s].propertyType){for(var d in a[s].children)a[s].children[d].label=a[s].children[d].valueName,a[s].children[d].id=a[s].children[d].valueId;if(a[s].mallPropValues.length){var c=[];for(var u in a[s].mallPropValues)c.push(a[s].mallPropValues[u].valueId);a[s].mallPropValues=c}else a[s].mallPropValues=null}else if("TYP_SINGLE"===a[s].propertyType)a[s].mallPropValues.length?a[s].mallPropValues=a[s].mallPropValues[0]:a[s].mallPropValues="";else{var m=[];for(var p in a[s].mallPropValues)m.push({valueId:a[s].mallPropValues[p].valueId,valueName:a[s].mallPropValues[p].valueName});a[s].mallPropValues=m}e.goodsForm.goodsPropertyData=a}else e.$message.error(t.data.message)})},beforeUpload:function(e){if(this.dialogImageUrl.length>9)return this.$message.warning("最多上传10张商品主图"),!1;if(e.size>2097152)return this.$message.error("请上传小于2MB的图片"),!1;localStorage.getItem("sign")?this.headersUpload.sign=localStorage.getItem("sign"):this.headersUpload.sign="";var t=this;return new S.a(function(a,s){var i=new FileReader;i.onload=function(e){var i=new Image;i.onload=function(){var e=this.width,i=this.height;(e<700||e/i<.5)&&(t.$message.error("请上传正确的图片尺寸"),s()),a()},i.src=e.target.result},i.readAsDataURL(e)})},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisibleImg=!0},uploadSuccess:function(e,t,a){0===e.errorCode?(this.dialogImageUrl.push({imageUrl:e.result[0].qcloudImageUrl,imageCode:e.result[0].imageFiledCode}),this.$message.success("上传成功"),10===this.dialogImageUrl.length?this.uploadStatus=!1:this.uploadStatus=!0):this.$message.error(e.message)},deteletDialogImageUrl:function(e){this.uploadStatus=!0,this.dialogImageUrl.splice(e,1)},enlargeDialogImageUrl:function(e){this.dialogEnlargeImageUrl=this.dialogImageUrl[e].imageUrl,this.dialogVisibleImg=!0},moveLeft:function(e){this.swapArray(this.dialogImageUrl,e,e-1)},moveRight:function(e){this.swapArray(this.dialogImageUrl,e,e+1)},swapArray:function(e,t,a){return e[t]=e.splice(a,1,e[t])[0],e},getStandardSelectList:function(){this.goodsForm.goodsStandardSelect=[];var e=[],t=!0,a=!1,s=void 0;try{for(var i,r=b()(this.goodsForm.tableStandardList);!(t=(i=r.next()).done);t=!0){var o=i.value;e.push(o.standardId)}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}for(var l in this.goodsForm.goodsStandardSelect)if(-1===e.indexOf(this.goodsForm.goodsStandardSelect[l]))for(var n in this.goodsForm.goodsStandardData)this.goodsForm.goodsStandardSelect[l]===this.goodsForm.goodsStandardData[n].standardId&&this.goodsForm.tableStandardList.push({standardName:this.goodsForm.goodsStandardData[n].standardName,standardId:this.goodsForm.goodsStandardData[n].standardId,pivotal:this.goodsForm.goodsStandardData[n].pivotal});this.handleDate(this.goodsForm.tableStandardList),this.dialogVisible=!1},handleAddStandardValue:function(e,t){var a=this;this.dataIndex=t,this.dialogStandardValue=!0;var s={categoryIds:this.goodsForm.categoryIds.join(","),standardId:e};for(var i in A.get("/api-mall/list-mall-goods-standard-values",{params:s}).then(function(e){0===e.data.errorCode?a.goodsForm.goodsStandardValueData=e.data.result:a.$message.error(e.data.message)}),this.goodsForm.tableStandardList[t].standardValues)this.goodsForm.goodsStandardValueSelect.push(this.goodsForm.tableStandardList[t].standardValues[i].valueId)},getStandardSelectValueList:function(){for(var e in this.goodsForm.tableStandardValueList=[],this.goodsForm.goodsStandardValueSelect)for(var t in this.goodsForm.goodsStandardValueData)this.goodsForm.goodsStandardValueSelect[e]===this.goodsForm.goodsStandardValueData[t].valueId&&this.goodsForm.tableStandardValueList.push({valueName:this.goodsForm.goodsStandardValueData[t].valueName,valueId:this.goodsForm.goodsStandardValueData[t].valueId,remark:""});this.goodsForm.tableStandardList[this.dataIndex].standardValues=this.goodsForm.tableStandardValueList,this.dialogStandardValue=!1,this.handleDate(this.goodsForm.tableStandardList)},handleDate:function(e){for(var t in this.goodsForm.standardKeyHeaderList=[],e)e[t].pivotal&&this.goodsForm.standardKeyHeaderList.push(e[t]);this.goodsForm.standardKeyList=[];for(var a=0;a<e.length;a++)e[a].pivotal&&(e[a].standardValues?this.goodsForm.standardKeyList.push(e[a].standardValues):this.goodsForm.standardKeyList.push([{valueName:"",valueId:""}]));this.goodsForm.standardKeyList.push([{valueName:"",valueId:""}]);var s=he(this.goodsForm.standardKeyList);this.goodsForm.combineKeyValueList=he(this.combine(he(this.goodsForm.standardKeyList))),this.handleStandard(e,s)},tableBeforeUpload:function(e){if(e.size>2097152)return this.$message.error("请上传小于2MB的图片"),!1;if("image/jpeg"!==e.type&&"image/png"!==e.type)return this.$message.error("图片格式错误"),!1;localStorage.getItem("sign")?this.headersUpload.sign=localStorage.getItem("sign"):this.headersUpload.sign="";var t=this;return new S.a(function(a,s){var i=new FileReader;i.onload=function(e){var i=new Image;i.onload=function(){var e=this.width,i=this.height;(e<200||e/i<.5||i<200)&&(t.$message.error("请上传正确的图片尺寸"),s()),a()},i.src=e.target.result},i.readAsDataURL(e)})},tableUploadSuccess:function(e,t,a,s){0===e.errorCode?(s.valueName=e.result[0].qcloudImageUrl,s.valueId=e.result[0].imageFiledCode,this.$message.success("上传成功")):this.$message.error(e.message)},handleStandard:function(e,t){for(var a in t.pop(),this.goodsForm.standardUnkeyHeaderList=[],e)e[a].pivotal||this.goodsForm.standardUnkeyHeaderList.push(e[a]);this.goodsForm.standardAllHeaderList=this.goodsForm.standardKeyHeaderList.concat(this.goodsForm.standardUnkeyHeaderList),this.goodsForm.standardUnkeyList=[];for(var s=[],i=0;i<e.length;i++)e[i].pivotal?e[i].standardValues?s.push(e[i].standardValues):s.push([{valueName:"",valueId:""}]):e[i].standardValues?this.goodsForm.standardUnkeyList.push(e[i].standardValues):this.goodsForm.standardUnkeyList.push([{valueName:"",valueId:""}]);this.goodsForm.standardUnkeyList.push([{valueName:"",valueId:""}]),this.goodsForm.standardUnkeyList.push([{valueName:"",valueId:""}]),this.goodsForm.standardUnkeyList.push([{valueName:"",valueId:""}]),this.goodsForm.standardUnkeyList.push([{valueName:"",valueId:""}]),this.goodsForm.combineAllList=t.concat(this.goodsForm.standardUnkeyList),this.goodsForm.combineKeyAllValueList=he(this.combine(he(this.goodsForm.combineAllList)))},cancelSelectValueList:function(){this.goodsForm.goodsStandardValueSelect=[],this.dialogStandardValue=!1},combine:function(e){e.reverse();var t=[];return function e(a,s,i){if(0==i)return t.push(a);for(var r=0;r<s[i-1].length;r++)e(a.concat(s[i-1][r]),s,i-1)}([],e,e.length),t},getTemplateList:function(){var e=this;A.get("/api-mall/list-mall-goods-freight").then(function(t){0===t.data.errorCode?e.goodsForm.templateList=t.data.result:e.$message.error(t.data.message)})},handleStandSku:function(){var e=he(this.goodsForm.combineKeyAllValueList),t=void 0,a=void 0,s=[],i=[];for(var r in e){for(var o in a=(t=he(e[r])).splice(t.length-5,5),t)delete t[o].remark,t[o].propName=this.goodsForm.standardAllHeaderList[o].standardName,t[o].propId=this.goodsForm.standardAllHeaderList[o].standardId;this.goodsForm.skuJson=[],i.push(t),s.push(a)}for(var l in e)this.goodsForm.skuJson.push({mallProSkuPrice:s[l][0].valueName,stock:s[l][1].valueName,mallProSkuCode:s[l][2].valueName,mallProSkuBarCode:s[l][3].valueName,mallPropValues:i[l],hidden:s[l][4].valueName})},addStock:function(e,t,a){e.length-a==5&&t&&(t.valueName=Number(t.valueName).toFixed(2)),e.length-a==4&&t&&(t.valueName=Number(t.valueName).toFixed(2));var s=0;for(var i in this.goodsForm.combineKeyAllValueList)for(var r in this.goodsForm.combineKeyAllValueList[i])this.goodsForm.combineKeyAllValueList[i].length-r==3&&""!==this.goodsForm.combineKeyAllValueList[i][r].valueName&&(s+=Number(this.goodsForm.combineKeyAllValueList[i][r].valueName));this.goodsForm.stock=s},submitGoodsForm:function(e){var t=this;return this.goodsForm.putawayTime=this.getTime(this.goodsForm.putawayTime)+" "+this.getSeconds(this.goodsForm.putawayTime),this.goodsForm.imgTextEdit=this.$refs.tinymceWrap.tinymceHtml,0===this.goodsForm.categoryIds.length?(this.$message.error("请选择商品品类"),!1):0===this.dialogImageUrl.length?(this.$message.error("请选择商品主图"),!1):""!==this.goodsForm.imgTextEdit&&this.goodsForm.imgTextEdit?0===this.goodsForm.tableStandardList.length?(this.$message.error("请添加规格信息"),!1):void this.$refs[e].validate(function(e){if(!e)return t.submitLoading=!1,!1;var a=!0,s=!1,i=void 0;try{for(var r,o=b()(t.goodsForm.combineKeyValueList);!(a=(r=o.next()).done);a=!0){var l=r.value;if(!l[l.length-1].valueName&&1!==l.length)return t.$message.error("请上传规格图片"),!1}}catch(e){s=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw i}}var n=!0,d=!1,c=void 0;try{for(var u,m=b()(t.goodsForm.combineKeyAllValueList);!(n=(u=m.next()).done);n=!0){var p=u.value;if(!p[p.length-3].valueName&&!p[p.length-1].valueName)return t.$message.error("请上传SKU编码"),!1;if(!p[p.length-4].valueName&&0!==p[p.length-4].valueName&&!p[p.length-1].valueName)return t.$message.error("请上传库存"),!1;if(!p[p.length-5].valueName&&!p[p.length-1].valueName)return t.$message.error("请上传sku价格"),!1}}catch(e){d=!0,c=e}finally{try{!n&&m.return&&m.return()}finally{if(d)throw c}}for(var h in t.handleStandSku(),t.goodsForm.skuImageJson=[],t.goodsForm.combineKeyValueList){for(var g="",v=0;v<t.goodsForm.combineKeyValueList[h].length-1;v++)g=g+"_"+t.goodsForm.combineKeyValueList[h][v].valueId;t.goodsForm.skuImageJson.push({valueId:g,imageUrl:he(t.goodsForm.combineKeyValueList[h]).pop().valueName,imageFileCode:he(t.goodsForm.combineKeyValueList[h]).pop().valueId})}var f=[];for(var y in t.goodsForm.goodsPropertyData)if(f.push({mallPropId:t.goodsForm.goodsPropertyData[y].propertyId}),f[y].mallPropValues=[],"TYP_TEXT"===t.goodsForm.goodsPropertyData[y].propertyType||"TYP_NUM"===t.goodsForm.goodsPropertyData[y].propertyType||"TYP_REAL_NUM"===t.goodsForm.goodsPropertyData[y].propertyType||"TYP_TIME"===t.goodsForm.goodsPropertyData[y].propertyType||"TYP_CURRENCY"===t.goodsForm.goodsPropertyData[y].propertyType||"TYP_PERCENT"===t.goodsForm.goodsPropertyData[y].propertyType)f[y].mallPropValues.push({valueName:t.goodsForm.goodsPropertyData[y].mallPropValues,valueId:""});else if("TYP_MULTI"===t.goodsForm.goodsPropertyData[y].propertyType)for(var C in t.goodsForm.goodsPropertyData[y].mallPropValues)f[y].mallPropValues.push({valueName:"",valueId:t.goodsForm.goodsPropertyData[y].mallPropValues[C]});else if("TYP_SINGLE"===t.goodsForm.goodsPropertyData[y].propertyType)f[y].mallPropValues.push({valueName:t.goodsForm.goodsPropertyData[y].mallPropValues.valueName,valueId:t.goodsForm.goodsPropertyData[y].mallPropValues.valueId});else for(var I in t.goodsForm.goodsPropertyData[y].mallPropValues)f[y].mallPropValues.push({valueName:t.goodsForm.goodsPropertyData[y].mallPropValues[I].valueName,valueId:t.goodsForm.goodsPropertyData[y].mallPropValues[I].valueId});var S={mallCategoryIds:t.goodsForm.categoryIds.join(","),mallProTagId:t.goodsForm.goodsClassifySelect.join(","),proName:t.goodsForm.goodsName.trim(),brandId:t.goodsForm.goodsBrandSelect,mallProImageUrl:O()(t.dialogImageUrl),mallProStandardJson:O()(t.goodsForm.tableStandardList),skuImageJson:O()(t.goodsForm.skuImageJson),propJson:O()(f),skuJson:O()(t.goodsForm.skuJson),stock:t.goodsForm.stock,mallProSpuPrice:t.goodsForm.mallProSpuPrice,proCode:t.goodsForm.proCode,proCodeQuery:t.goodsForm.proCodeQuery,detailDescription:t.goodsForm.imgTextEdit,stockOptType:1,freightTemplateId:t.goodsForm.templateSelect,upShelvesStatus:t.goodsForm.putaway,upShelvesTime:"2"===t.goodsForm.putaway?t.goodsForm.putawayTime:"",status:"3"===t.goodsForm.putaway?1:2,proType:"TYP_ERP"};if("-1"!==t.goodsForm.mallProId&&(S.mallProId=t.goodsForm.mallProId),0===t.goodsForm.stock&&1==t.goodsForm.putaway||0===t.goodsForm.stock&&2==t.goodsForm.putaway)return t.$message.error("商品总库存为0的商品不可上架"),!1;t.submitLoading=!0,A.post("/api-mall/save-gic-mall-goods",_.a.stringify(S)).then(function(e){0===e.data.errorCode?(t.$message.success("保存成功"),t.$router.push({name:"goodsList"}),t.submitLoading=!1):(t.$message.error(e.data.message),t.submitLoading=!1)})}):(this.$message.error("请编辑图文详情"),!1)},cancelGoodsForm:function(){this.$router.go(-1)}},components:{Treeselect:ce.a,goodsCate:ka,tinymceEdit:Pe}},Ta={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/goodsList"}}},[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",{staticClass:"bread-menu"},[e._v("商品管理")]),e._v(" "),a("el-breadcrumb-item",{attrs:{to:{path:"/goodsList"}}},[e._v("商品列表")]),e._v(" "),a("el-breadcrumb-item",[e._v("新建商品")])],1),e._v(" "),e._m(0)],1),e._v(" "),a("div",{staticClass:"mall-section"},[a("el-form",{ref:"goodsForm",staticClass:"demo-ruleForm",attrs:{model:e.goodsForm,rules:e.goodsRules,"label-width":"90px","label-position":"right"}},[a("div",{staticClass:"form-group"},[a("p",{staticClass:"title"},[e._v("基本信息")]),e._v(" "),a("el-form-item",{attrs:{label:"商品类型"}},[a("span",[e._v("ERP同步")])]),e._v(" "),a("el-form-item",{attrs:{label:"商品品类"}},[a("div",{staticClass:"edit-erp-cate"},e._l(e.selectCateData,function(t){return a("el-tag",{key:t.categoryId,staticClass:"tag",attrs:{closable:"","disable-transitions":!1,size:"small"}},[e._v("\n                "+e._s(t.categoryName)+"\n              ")])})),e._v(" "),a("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refash))])]),e._v(" "),a("el-form-item",{attrs:{label:"商品名称",prop:"goodsName"}},[a("el-input",{staticClass:"w-900",attrs:{type:"text"},on:{input:function(t){return e.goodsLimit(t)}},model:{value:e.goodsForm.goodsName,callback:function(t){e.$set(e.goodsForm,"goodsName",t)},expression:"goodsForm.goodsName"}},[a("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.goodsFormLen.nameLen)+"/30")])])],1),e._v(" "),a("el-form-item",{attrs:{label:"商品品牌",prop:"goodsBrandSelect"}},[a("el-select",{staticClass:"w-320",attrs:{placeholder:"请选择","value-key":"brandId",disabled:""},model:{value:e.goodsForm.goodsBrandSelect,callback:function(t){e.$set(e.goodsForm,"goodsBrandSelect",t)},expression:"goodsForm.goodsBrandSelect"}},e._l(e.goodsForm.goodsBrand,function(e){return a("el-option",{key:e.brandId,attrs:{label:e.brandName,value:e.brandId}})}))],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.goodsForm.categoryIds.length>0,expression:"goodsForm.categoryIds.length > 0"}],staticStyle:{display:"inline-block"},attrs:{label:"商品属性",required:""}}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.goodsForm.categoryIds.length>0,expression:"goodsForm.categoryIds.length > 0"}],staticClass:"goods-nature",staticStyle:{"margin-bottom":"22px"}},e._l(e.goodsForm.goodsPropertyData,function(t,s){return a("div",{key:s,staticStyle:{display:"inline-block"}},[t.bizRequire?a("el-form-item",{key:t.propertyId,staticClass:"goods-nature-item",attrs:{prop:"goodsPropertyData."+s+".mallPropValues",label:t.propertyName,rules:[{required:!0,message:"请输入"+t.propertyName,trigger:"blur"}]}},["TYP_TEXT"===t.propertyType||"TYP_NUM"===t.propertyType||"TYP_REAL_NUM"===t.propertyType?a("el-input",{staticClass:"w-260",attrs:{type:"text",disabled:t.propertyEditStatus},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}}):e._e(),e._v(" "),"TYP_SINGLE"===t.propertyType?a("el-select",{staticClass:"w-260",attrs:{placeholder:"请选择","value-key":"valueId",disabled:t.propertyEditStatus,filterable:"",clearable:""},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}},e._l(t.children,function(e){return a("el-option",{key:e.valueId,attrs:{label:e.valueName,value:e}})})):e._e(),e._v(" "),"TYP_CHECK"===t.propertyType?a("el-select",{staticClass:"w-260",attrs:{placeholder:"请选择",multiple:"","value-key":"valueId",disabled:t.propertyEditStatus,filterable:"",size:"small"},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}},e._l(t.children,function(e){return a("el-option",{key:e.valueId,attrs:{label:e.valueName,value:e}})})):e._e(),e._v(" "),"TYP_MULTI"===t.propertyType?a("treeselect",{staticClass:"w-260 tree-select",attrs:{multiple:!0,size:"small",options:t.children,placeholder:"请选择",disabled:t.propertyEditStatus},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}}):e._e(),e._v(" "),"TYP_TIME"===t.propertyType?a("el-date-picker",{staticClass:"w-260",attrs:{type:"datetime",placeholder:"选择日期时间",format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",disabled:t.propertyEditStatus},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}}):e._e(),e._v(" "),"TYP_CURRENCY"===t.propertyType?a("div",[a("el-input",{staticClass:"w-220",attrs:{type:"text",disabled:t.propertyEditStatus},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}}),e._v(" "),a("span",{staticClass:"property-unit"},[e._v(e._s(t.units))])],1):e._e(),e._v(" "),"TYP_PERCENT"===t.propertyType?a("div",[a("el-input",{staticClass:"w-220",attrs:{type:"text",disabled:t.propertyEditStatus},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}}),e._v(" "),a("span",{staticClass:"property-unit"},[e._v("%")])],1):e._e()],1):a("el-form-item",{key:t.propertyId,staticClass:"goods-nature-item",attrs:{prop:t.propertyName,label:t.propertyName}},["TYP_TEXT"===t.propertyType||"TYP_NUM"===t.propertyType||"TYP_REAL_NUM"===t.propertyType?a("el-input",{staticClass:"w-260",attrs:{type:"text",disabled:t.propertyEditStatus},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}}):e._e(),e._v(" "),"TYP_SINGLE"===t.propertyType?a("el-select",{staticClass:"w-260",attrs:{placeholder:"请选择","value-key":"valueId",disabled:t.propertyEditStatus,filterable:"",clearable:""},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}},e._l(t.children,function(e){return a("el-option",{key:e.valueId,attrs:{label:e.valueName,value:e}})})):e._e(),e._v(" "),"TYP_CHECK"===t.propertyType?a("el-select",{staticClass:"w-260",attrs:{placeholder:"请选择",multiple:"","value-key":"valueId",disabled:t.propertyEditStatus,filterable:"",size:"small"},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}},e._l(t.children,function(e){return a("el-option",{key:e.valueId,attrs:{label:e.valueName,value:e}})})):e._e(),e._v(" "),"TYP_MULTI"===t.propertyType?a("treeselect",{staticClass:"w-260 tree-select",attrs:{multiple:!0,size:"small",options:t.children,placeholder:"请选择",disabled:t.propertyEditStatus},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}}):e._e(),e._v(" "),"TYP_TIME"===t.propertyType?a("el-date-picker",{staticClass:"w-260",attrs:{type:"datetime",placeholder:"选择日期时间",disabled:t.propertyEditStatus,format:"yyyy-MM-dd HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}}):e._e(),e._v(" "),"TYP_CURRENCY"===t.propertyType?a("div",[a("el-input",{staticClass:"w-220",attrs:{type:"text",disabled:t.propertyEditStatus},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}}),e._v(" "),a("span",{staticClass:"property-unit"},[e._v(e._s(t.units))])],1):e._e(),e._v(" "),"TYP_PERCENT"===t.propertyType?a("div",[a("el-input",{staticClass:"w-220",attrs:{type:"text",disabled:t.propertyEditStatus},model:{value:t.mallPropValues,callback:function(a){e.$set(t,"mallPropValues",a)},expression:"item.mallPropValues"}}),e._v(" "),a("span",{staticClass:"property-unit"},[e._v("%")])],1):e._e()],1)],1)})),e._v(" "),a("el-form-item",{staticStyle:{width:"856px"},attrs:{label:"商品主图"}},[a("div",{staticClass:"upload-list-box"},[a("div",{staticStyle:{display:"inline-block","vertical-align":"top","margin-right":"5px"}},[e._l(e.dialogImageUrl,function(t,s){return a("div",{key:s,staticClass:"img-box"},[a("img",{attrs:{width:"100%",src:t.imageUrl,alt:""}}),e._v(" "),a("i",{staticClass:"el-icon-arrow-left",on:{click:function(t){e.moveLeft(s)}}}),e._v(" "),a("i",{staticClass:"el-icon-arrow-right",on:{click:function(t){e.moveRight(s)}}}),e._v(" "),a("i",{staticClass:"el-icon-delete",on:{click:function(t){e.deteletDialogImageUrl(s)}}}),e._v(" "),a("i",{staticClass:"el-icon-zoom-in",on:{click:function(t){e.enlargeDialogImageUrl(s)}}}),e._v(" "),a("div",{staticClass:"dialog-img"})])}),e._v(" "),a("el-upload",{directives:[{name:"show",rawName:"v-show",value:e.uploadStatus,expression:"uploadStatus"}],staticStyle:{display:"inline-block","vertical-align":"top"},attrs:{action:e.uploadAction,headers:e.headersUpload,"list-type":"picture-card","on-preview":e.handlePictureCardPreview,"before-upload":e.beforeUpload,"on-success":e.uploadSuccess,"with-credentials":"","show-file-list":!1}},[a("i",{staticClass:"el-icon-plus"})])],2),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisibleImg},on:{"update:visible":function(t){e.dialogVisibleImg=t}}},[a("img",{attrs:{width:"100%",src:e.dialogEnlargeImageUrl,alt:""}})])],1),e._v(" "),a("span",{staticStyle:{"font-size":"12px",color:"rgb(144, 147, 153)"},attrs:{"data-v-75235512":""}},[e._v("图片规格宽度大于等于700px，高度不大于宽度的2倍，单张图片大小不超过 2 MB，至少上传1张，最多可上传 10 张。")])]),e._v(" "),a("el-form-item",{attrs:{label:"图文详情",required:""}},[a("div",{staticClass:"tinymce-wrap"},[a("tinymce-edit",{ref:"tinymceWrap",attrs:{bodyHtml:e.goodsForm.imgTextEdit,projectName:e.projectName}})],1)]),e._v(" "),a("el-form-item",{attrs:{label:"商品分类",prop:"goodsClassifySelect"}},[a("treeselect",{staticClass:"w-320",attrs:{multiple:!0,options:e.goodsForm.goodsClassifyData,"disable-branch-nodes":!0,placeholder:"所有分类"},model:{value:e.goodsForm.goodsClassifySelect,callback:function(t){e.$set(e.goodsForm,"goodsClassifySelect",t)},expression:"goodsForm.goodsClassifySelect"}})],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.goodsForm.categoryIds.length>0,expression:"goodsForm.categoryIds.length > 0"}],staticClass:"form-group"},[a("p",{staticClass:"title"},[e._v("规格信息")]),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.goodsForm.tableStandardList.length>0,expression:"goodsForm.tableStandardList.length > 0"}],attrs:{label:"商品规格"}},e._l(e.goodsForm.tableStandardList,function(t,s){return a("table",{key:s,staticClass:"border-table w-900"},[a("thead",[a("tr",[a("th",{staticStyle:{width:"300px"}},[e._v(e._s(t.standardName))]),e._v(" "),a("th",{staticStyle:{width:"300px"}},[e._v("备注")])])]),e._v(" "),a("tbody",e._l(t.standardValues,function(t,s){return a("tr",{key:s},[a("td",[e._v(e._s(t.valueName))]),e._v(" "),a("td",[a("el-input",{attrs:{size:"small",placeholder:"请输入内容"},on:{input:function(a){e.remarkLimit(t)}},model:{value:t.remark,callback:function(a){e.$set(t,"remark",a)},expression:"valueItem.remark"}})],1)])}))])})),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.goodsForm.tableStandardList.length>0,expression:"goodsForm.tableStandardList.length > 0"}],attrs:{label:"规格图片"}},[a("span",{staticStyle:{"font-size":"12px",color:"#909399"}},[e._v("图片规格≥200*200，高度不大于宽度的2倍 ，单张图片大小不超过 2 MB")]),e._v(" "),a("table",{staticClass:"border-table w-900"},[a("thead",[a("tr",[e._l(e.goodsForm.standardKeyHeaderList,function(t,s){return a("th",{key:s},[e._v("\n                    "+e._s(t.standardName)+"\n                  ")])}),e._v(" "),a("th",[e._v("图片")])],2)]),e._v(" "),a("tbody",e._l(e.goodsForm.combineKeyValueList,function(t,s){return a("tr",{key:s},e._l(t,function(s,i){return a("td",{key:i},[t.length-i<2?a("div",{staticClass:"table-upload"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.uploadAction,headers:e.headersUpload,"show-file-list":!1,"on-success":function(t,a,i){return e.tableUploadSuccess(t,a,i,s)},"before-upload":e.tableBeforeUpload,"with-credentials":""}},[s.valueName?a("img",{staticClass:"avatar",attrs:{src:s.valueName}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1):a("div",[e._v(e._s(s.valueName))])])}))}))])]),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.goodsForm.tableStandardList.length>0,expression:"goodsForm.tableStandardList.length > 0"}],attrs:{label:"sku信息"}},[a("div",{staticClass:"w-900",staticStyle:{position:"relative"}},[a("div",{staticClass:"sku-top"}),e._v(" "),a("table",{staticClass:"border-table w-900"},[a("thead",[a("tr",[e._l(e.goodsForm.standardAllHeaderList,function(t,s){return a("th",{key:s},[e._v("\n                      "+e._s(t.standardName)+"\n                    ")])}),e._v(" "),a("th",[e._v("价格")]),e._v(" "),a("th",[e._v("库存")]),e._v(" "),a("th",[e._v("SKU编码")]),e._v(" "),a("th",[e._v("商品条形码")]),e._v(" "),a("th",{staticStyle:{width:"80px"}},[e._v("\n                      隐藏"),a("el-tooltip",{attrs:{effect:"dark",content:"若开启按钮，则被隐藏的SKU的库存和价格等信息不填写或全部为0亦可保存和上架，小程序端也无法购买",placement:"top-start"}},[a("i",{staticClass:"iconfont icon-xinxixianshi",staticStyle:{"margin-left":"5px"}})])],1)],2)]),e._v(" "),a("tbody",e._l(e.goodsForm.combineKeyAllValueList,function(t,s){return a("tr",{key:s},e._l(t,function(s,i){return a("td",{key:i,staticStyle:{width:"120px"}},[t.length-i<6?a("span",[t.length-i!=1?a("a",{attrs:{href:"javaScript:void(0)",title:s.valueName}},["0"==e.goodsForm.stockStatus?a("el-input",{attrs:{disabled:(t.length,!0),size:"small"},on:{input:function(a){e.addStock(t,s,i)}},model:{value:s.valueName,callback:function(t){e.$set(s,"valueName",t)},expression:"item2.valueName"}}):a("el-input",{attrs:{disabled:t.length-i!=4,size:"small"},on:{input:function(a){e.addStock(t,s,i)}},model:{value:s.valueName,callback:function(t){e.$set(s,"valueName",t)},expression:"item2.valueName"}})],1):e._e(),e._v(" "),t.length-i==1?a("el-switch",{model:{value:s.valueName,callback:function(t){e.$set(s,"valueName",t)},expression:"item2.valueName"}}):e._e()],1):a("span",[e._v(e._s(s.valueName?s.valueName:""))])])}))}))])])]),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.goodsForm.tableStandardList.length>0,expression:"goodsForm.tableStandardList.length > 0"}],attrs:{label:"spu信息"}},[a("table",{staticClass:"border-table w-900"},[a("thead",[a("tr",[a("th",[e._v("商品货号")]),e._v(" "),a("th",[e._v("价格")]),e._v(" "),a("th",[e._v("库存")]),e._v(" "),a("th",[e._v("商品条形码")])])]),e._v(" "),a("tbody",[a("tr",[a("td",[a("el-input",{attrs:{size:"small",placeholder:"请输入内容",disabled:""},model:{value:e.goodsForm.proCode,callback:function(t){e.$set(e.goodsForm,"proCode",t)},expression:"goodsForm.proCode"}})],1),e._v(" "),a("td",[a("el-input",{attrs:{size:"small",placeholder:"请输入内容",disabled:""},model:{value:e.goodsForm.mallProSpuPrice,callback:function(t){e.$set(e.goodsForm,"mallProSpuPrice",t)},expression:"goodsForm.mallProSpuPrice"}})],1),e._v(" "),a("td",[a("el-input",{attrs:{size:"small",placeholder:"",disabled:""},model:{value:e.goodsForm.stock,callback:function(t){e.$set(e.goodsForm,"stock",t)},expression:"goodsForm.stock"}})],1),e._v(" "),a("td",[a("el-input",{attrs:{size:"small",placeholder:"请输入内容",disabled:""},model:{value:e.goodsForm.proCodeQuery,callback:function(t){e.$set(e.goodsForm,"proCodeQuery",t)},expression:"goodsForm.proCodeQuery"}})],1)])])])])],1),e._v(" "),a("div",{staticClass:"form-group"},[a("p",{staticClass:"title"},[e._v("销售信息")]),e._v(" "),a("el-form-item",{attrs:{label:"运费模板",prop:"templateSelect"}},[a("el-select",{staticClass:"w-320",attrs:{placeholder:"请选择"},model:{value:e.goodsForm.templateSelect,callback:function(t){e.$set(e.goodsForm,"templateSelect",t)},expression:"goodsForm.templateSelect"}},e._l(e.goodsForm.templateList,function(e,t){return a("el-option",{key:t,attrs:{label:e.templateName,value:e.freightTemplateId}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"上架方式"}},[[a("el-radio",{attrs:{label:"1"},model:{value:e.goodsForm.putaway,callback:function(t){e.$set(e.goodsForm,"putaway",t)},expression:"goodsForm.putaway"}},[e._v("立即上架")]),e._v(" "),a("el-radio",{attrs:{label:"2"},model:{value:e.goodsForm.putaway,callback:function(t){e.$set(e.goodsForm,"putaway",t)},expression:"goodsForm.putaway"}},[e._v("定时上架")]),e._v(" "),a("el-radio",{attrs:{label:"3"},model:{value:e.goodsForm.putaway,callback:function(t){e.$set(e.goodsForm,"putaway",t)},expression:"goodsForm.putaway"}},[e._v("放入仓库")])]],2),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"2"===e.goodsForm.putaway,expression:"goodsForm.putaway === '2'"}],attrs:{label:"上架时间"}},[a("el-date-picker",{staticClass:"w-320",attrs:{type:"datetime",placeholder:"选择日期时间",pickerOptions:e.pickerOptions},model:{value:e.goodsForm.putawayTime,callback:function(t){e.$set(e.goodsForm,"putawayTime",t)},expression:"goodsForm.putawayTime"}})],1),e._v(" "),a("div",{staticClass:"confim-btn",style:{width:e.fixedWidth+"px"}},[a("el-form-item",{staticClass:"fix-btn"},[a("el-button",{attrs:{type:"primary",loading:e.submitLoading,size:"small"},on:{click:function(t){e.submitGoodsForm("goodsForm")}}},[e._v("保存")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.cancelGoodsForm}},[e._v("返回")])],1)],1)],1)])],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("新建商品")])])}]};var Da=a("VU/8")(Na,Ta,!1,function(e){a("PkPf"),a("Kuzc")},"data-v-3540b260",null).exports,Pa=function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2]?window.localStorage.setItem(e,O()(t)):window.sessionStorage.setItem(e,O()(t))},Fa=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{return t?JSON.parse(window.localStorage.getItem(e)):JSON.parse(window.sessionStorage.getItem(e))}catch(e){return null}},Aa={},Ma=function(e){Aa["set"+e]=function(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Pa(e,t,a)},Aa["get"+e]=function(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Fa(e,a)}},Oa=!0,$a=!1,Va=void 0;try{for(var Ra,Ua=b()(["NewActivity","NewReductActivity","NewMailActivity","User"]);!(Oa=(Ra=Ua.next()).done);Oa=!0){Ma(Ra.value)}}catch(e){$a=!0,Va=e}finally{try{!Oa&&Ua.return&&Ua.return()}finally{if($a)throw Va}}var Ea=Aa,Ga={data:function(){return{length:0,mallHeight:document.documentElement.clientHeight-64-98,loading:!0,pageSize:20,pageNum:1,currentPage:1,total:0,selectArr:[{value:"0",label:"未开始"},{value:"1",label:"进行中"},{value:"2",label:"已结束"}],startStatus:"",search:"",activityList:[]}},mounted:function(){this.getActivityList(),Ea.setNewActivity("")},created:function(){localStorage.removeItem("importInfoObj")},filters:{activityStatus:function(e){return 0==e?"未开始":1==e?"进行中":2==e?"已结束":"--"}},computed:{},methods:{handleSizeChange:function(e){this.pageSize=e,this.getActivityList()},handleCurrentChange:function(e){this.currentPage=e,this.getActivityList()},getSearchActivityList:function(){this.currentPage=1,this.getActivityList()},getActivityList:function(){var e=this,t={pageSize:this.pageSize,startStatus:this.startStatus,currentPage:this.currentPage,search:this.search};A.post("/api-mall/page-discount-activity",_.a.stringify(t)).then(function(t){0===t.data.errorCode?(t.data.result.result?e.activityList=t.data.result.result:e.activityList=[],e.total=t.data.result.totalCount,e.loading=!1):e.$message.error("获取活动数据失败！！")})},deleteActivity:function(e,t){var a=this,s={activityId:e};A.post("/api-mall/delete-discount-activity",_.a.stringify(s)).then(function(e){0===e.data.errorCode?(a.activityList.splice(t,1),0===a.activityList.length&&a.currentPage>1&&(a.currentPage=a.currentPage-1),a.$message.success("删除活动成功！！"),a.getActivityList()):a.$message.error(e.data.message)})},seeActivity:function(e){var t=this,a={activityId:e};A.get("/api-mall/get-discount-activity",{params:a}).then(function(a){0===a.data.errorCode?(Ea.setNewActivity(a.data.result),t.$router.push({name:"seediscountActivity",query:{id:e}})):t.$message.error("获取活动数据失败！！")})},editActivity:function(e){this.$router.push({name:"createActivity",query:{id:e,isNew:"false"}})},goCreateActivity:function(){this.$router.push({name:"createActivity",query:{id:"-1",isNew:"true"}})}},components:{}},Ba={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("促销活动")]),e._v(" "),a("el-breadcrumb-item",[e._v("折扣/减价")])],1),e._v(" "),e._m(0)],1),e._v(" "),a("div",{staticClass:"mall-section"},[a("div",{staticClass:"content-wrap-padding"},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:16}},[a("div",{staticClass:"order-selects"},[a("div",{staticClass:"block"},[a("el-select",{staticClass:"width-style",attrs:{clearable:"",placeholder:"活动状态"},on:{change:e.getSearchActivityList},model:{value:e.startStatus,callback:function(t){e.startStatus=t},expression:"startStatus"}},e._l(e.selectArr,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("div",{staticClass:"fl"},[a("el-input",{attrs:{placeholder:"请输入活动名称/活动标签",clearable:"","prefix-icon":"el-icon-search"},on:{clear:e.getSearchActivityList},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.getSearchActivityList(t):null}},model:{value:e.search,callback:function(t){e.search="string"==typeof t?t.trim():t},expression:"search"}})],1)])]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"fr"},[a("el-button",{attrs:{type:"primary"},on:{click:e.goCreateActivity}},[e._v("创建活动")])],1)])],1),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("el-row",{staticClass:"order-list-title"},[a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content"},[e._v("\n                活动名称\n              ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n                活动标签\n              ")])]),e._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content"},[e._v("\n                活动时间\n              ")])]),e._v(" "),a("el-col",{attrs:{span:2}},[a("div",{staticClass:"grid-content"},[e._v("\n                状态\n              ")])]),e._v(" "),a("el-col",{attrs:{span:2}},[a("div",{staticClass:"grid-content"},[e._v("\n                商品数量\n              ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n                购买限制\n              ")])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[a("span",[e._v("优惠人群\n                  "),a("el-popover",{attrs:{placement:"top-start",width:"200",trigger:"hover",content:"当一个会员处于多个会员分组时，可能造成该会员同时命中多个折扣/减价活动，此时默认只参与优惠力度最大的那个活动。"}},[a("i",{staticClass:"iconfont icon-xinxixianshi",attrs:{slot:"reference"},slot:"reference"})])],1)])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[e._v("\n                操作\n              ")])])],1),e._v(" "),e.activityList.length>0?a("div",e._l(e.activityList,function(t,s){return a("el-row",{key:s,staticClass:"order-list-content"},[a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content grid-content-a"},[a("p",[e._v(e._s(t.activityName))])])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content grid-content-a"},[a("p",[e._v(e._s(t.activityTag))])])]),e._v(" "),a("el-col",{attrs:{span:4}},[a("div",{staticClass:"grid-content grid-content-a"},[a("p",{staticStyle:{"line-height":"18px"}},[e._v(e._s(e._f("getTime")(t.beginTime))+" "+e._s(e._f("getSeconds")(t.beginTime))+" ~")]),e._v(" "),a("p",{staticStyle:{"line-height":"18px"}},[e._v(e._s(e._f("getTime")(t.endTime))+" "+e._s(e._f("getSeconds")(t.endTime)))])])]),e._v(" "),a("el-col",{attrs:{span:2}},[a("div",{staticClass:"grid-content grid-content-a"},[a("p",[e._v(e._s(e._f("activityStatus")(t.actType)))])])]),e._v(" "),a("el-col",{attrs:{span:2}},[a("div",{staticClass:"grid-content grid-content-a"},[a("p",[e._v(e._s(t.proNum))])])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content grid-content-a"},[a("p",[e._v(e._s(t.buyLimit))])])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[1===t.memberLabelType?a("div",[e._v("全部会员")]):e._e(),e._v(" "),2===t.memberLabelType?a("div",[e._v(e._s(t.memberTagCount)+"个会员分组")]):e._e(),e._v(" "),3===t.memberLabelType?a("div",[e._v("会员筛选")]):e._e()])]),e._v(" "),a("el-col",{attrs:{span:3}},[a("div",{staticClass:"grid-content"},[a("div",[a("a",{attrs:{href:"javascript:;"},on:{click:function(a){e.editActivity(t.activityId)}}},[e._v("编辑")]),e._v(" "),a("el-popover",{staticStyle:{"margin-left":"8px"},attrs:{placement:"top",width:"160"},model:{value:t.visible2,callback:function(a){e.$set(t,"visible2",a)},expression:"item.visible2"}},[a("p",{staticStyle:{"line-height":"1.5",padding:"10px 10px 20px"}},[e._v("确定删除该活动吗？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.visible2=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.deleteActivity(t.activityId,s)}}},[e._v("确定")])],1),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除")])],1)],1)])])],1)})):a("div",{staticClass:"empty"},[e._m(1)])],1),e._v(" "),a("div",{staticClass:"block-page-wrap"},[e.total>0?a("div",{staticClass:"block-page"},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[20,40,60,80],"page-size":20,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e()])],1)])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("折扣/减价")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"no-data-wrap"},[t("div",{staticClass:"no-data-icon"},[t("img",{attrs:{src:a("8Td+")}})]),this._v(" "),t("p",[this._v("暂无数据")])])}]};var za=a("VU/8")(Ga,Ba,!1,function(e){a("XCWS"),a("zskF")},"data-v-7fbe1cd5",null).exports,ja={props:{selectCateData:{type:Array,default:function(){return[]}}},data:function(){return{allDate:[],firstCate:[],classIndex1:0,refreshStatus:!1,seceltIndex1:"",seceltIndex2:"",showDrag:!1}},created:function(){this.getFirstCateList()},methods:{showDragClick:function(){this.showDrag=!this.showDrag},getFirstCateList:function(){var e=this;A.get("/api-mall/list-mall-goods-all-category").then(function(t){0===t.data.errorCode?(e.allDate=[],e.allDate.push({search:"",arr:t.data.result})):e.$message.error(t.data.message)})},getNextCateList:function(e,t,a,s){var i=this;this.seceltIndex1=s,this.seceltIndex2=t,this.allDate.length=s+1,this.refreshStatus=!this.refreshStatus;var r=!0,o=!1,l=void 0;try{for(var n,d=b()(a.arr);!(r=(n=d.next()).done);r=!0){n.value.classIndex=-1,e.selectBgcolor=!1}}catch(e){o=!0,l=e}finally{try{!r&&d.return&&d.return()}finally{if(o)throw l}}e.classIndex=t,e.selectBgcolor=!0;var c={categoryId:e.categoryId};A.get("/api-mall/list-mall-goods-children-category",{params:c}).then(function(e){0===e.data.errorCode?e.data.result.length&&(i.allDate[s+1]={search:"",arr:e.data.result},i.refreshStatus=!i.refreshStatus):i.$message.error(e.data.message)})},handaleConfirmCate:function(){if(""===this.seceltIndex1||""===this.seceltIndex2)return this.showDrag=!1,!1;for(var e in this.selectCateData)if(this.allDate[this.seceltIndex1].arr[this.seceltIndex2].categoryId===this.selectCateData[e].categoryId)return this.$message.error("不要重复插入"),!1;this.selectCateData.push(this.allDate[this.seceltIndex1].arr[this.seceltIndex2]);var t=[];for(var a in this.selectCateData)t.push(this.selectCateData[a].categoryId);this.$emit("getCateIds",t)},cancelConfirmCate:function(){for(var e in this.allDate)for(var t in this.allDate[e].arr)this.allDate[e].arr[t].classIndex=-1;this.getFirstCateList(),this.showDrag=!1,this.$emit("getCateIds",[])},handleClose:function(e){this.selectCateData.splice(this.selectCateData.indexOf(e),1);var t=[];for(var a in this.selectCateData)t.push(this.selectCateData[a].categoryId);this.$emit("getCateIds",t)},searchCate:function(e,t,a){var s=this;if(this.allDate.length=t+1,0===t){var i={search:e};A.get("/api-mall/list-mall-goods-all-category",{params:i}).then(function(t){0===t.data.errorCode?(s.allDate=[],s.allDate.push({search:""!==e?e:"",arr:t.data.result})):s.$message.error(t.data.message)})}else{var r="";for(var o in this.allDate[t-1].arr)-1!==this.allDate[t-1].arr[o].classIndex&&(r=this.allDate[t-1].arr[o].categoryId);var l={search:e,categoryId:r};A.get("/api-mall/list-mall-goods-children-category",{params:l}).then(function(a){0===a.data.errorCode?(s.allDate[t]={search:""!==e?e:"",arr:a.data.result},s.refreshStatus=!s.refreshStatus):s.$message.error(a.data.message)})}},searchBlur:function(e){return!1}},components:{}},Ha={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"goods-cate-content"},[a("div",{staticClass:"goods-cate-title",on:{click:function(t){return t.stopPropagation(),e.showDragClick(t)}}},[e._l(e.selectCateData,function(t,s){return a("el-tag",{key:s,staticClass:"select-tag",attrs:{closable:"","disable-transitions":!1,size:"small"},on:{close:function(a){e.handleClose(t)}}},[e._v("\n      "+e._s(t.categoryName)+"\n    ")])}),e._v(" "),a("i",{class:e.showDrag?"el-icon-arrow-down":"el-icon-arrow-up"})],2),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showDrag,expression:"showDrag"}],staticClass:"goods-cate-list-container",on:{click:function(t){return t.stopPropagation(),e.searchBlur(t)}}},[a("div",{staticClass:"goods-cate-list-content"},e._l(e.allDate,function(t,s){return a("div",{key:s,staticClass:"goods-cate-box",on:{click:function(t){return t.stopPropagation(),e.searchBlur(t)}}},[a("el-input",{staticClass:"cate-search",attrs:{placeholder:"请输入内容","prefix-icon":"el-icon-search",size:"medium",clearable:""},nativeOn:{keyup:function(a){if(!("button"in a)&&e._k(a.keyCode,"enter",13,a.key,"Enter"))return null;e.searchCate(t.search,s,t)}},model:{value:t.search,callback:function(a){e.$set(t,"search",a)},expression:"item.search"}}),e._v(" "),a("div",{staticClass:"goods-cate-list"},e._l(t.arr,function(i,r){return a("div",{key:i.categoryId,staticClass:"goods-cate-item",class:i.classIndex===r?"cate-item-active":"",on:{click:function(a){a.stopPropagation(),e.getNextCateList(i,r,t,s)}}},[a("span",[e._v(e._s(i.categoryName))]),e._v(" "),i.isChildren?a("i",{staticClass:"el-icon-arrow-right"}):e._e()])})),e._v(" "),a("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refreshStatus))])],1)})),e._v(" "),a("div",{staticClass:"goods-cate-footer"},[a("el-button",{staticClass:"cancel-cate",attrs:{type:"text"},on:{click:e.cancelConfirmCate}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"confirm-cate",attrs:{type:"text"},on:{click:e.handaleConfirmCate}},[e._v("确认")])],1)])])},staticRenderFns:[]};var Ya=a("VU/8")(ja,Ha,!1,function(e){a("pROI")},"data-v-c4f16e08",null).exports,Za={data:function(){return{length:0,mallHeight:document.documentElement.clientHeight-64-98,limitInputLength:0,limitInputLength2:0,isold:!1,searchId:"",isOpenBol:!1,form:{isOpen:0,activityId:"",activityName:"",activityDescription:"",proRelationType:1,personGroupStatus:0,relationId:"",addProIdsStr:"",removeIdsStr:"",brandId:"",proNum:0,freeConditionPrice:0,freeConditionNumber:0,memberLabelType:1,removeProIdsArr:[],addProIdsArr:[]},goodIdStatus:!1,rules:{activityName:[{required:!0,message:"请输入活动名称",trigger:"blur"}],activityDescription:[{required:!0,message:"请输入活动说明",trigger:"blur"}]},selectArr:[{value:1,label:"所有商品"},{value:2,label:"按商品品牌"},{value:3,label:"按商品品类"},{value:4,label:"按商品分类"},{value:5,label:"按单个商品"}],companyBrand:[],value:[],options:[],selectCateData:[],defaltSelected:[],height:543,projectName:"mall",headerList:[],effectiveStatus:1,proNum:0,submitLoading:!1,selectNum:0,channel:0,peopleFilterInfo:"",searchBackTxt:"",getSaveData:"",conditionList:[],usePeopleFilter:!1,sceneValue:"member",useId:"",hasSearchData:"",operateType:!0,toggleTag:!1,saveTag:!1,searchParams:{},responseParams:[]}},mounted:function(){""!==this.searchBackTxt&&this.$refs.peopleFilter.getAbInfo(this.searchBackTxt),this.getCompanyBrand(),this.getListTags()},created:function(){Ea.getNewMailActivity()&&"-1"===this.$route.query.id?(this.form=Ea.getNewMailActivity(),this.defaltSelected=this.form.tagGroupList,this.limitInputLength=C.getZhLen(this.form.activityName),this.limitInputLength2=C.getZhLen(this.form.activityDescription),this.selectNum=this.form.proNum,this.proNum=this.form.proNum,this.form.proNum=this.proNum-this.form.removeProIdsArr.length+this.form.addProIdsArr.length,this.responseParams=this.form.responseParams,this.searchParams=this.form.searchParams,this.searchBackTxt=this.form.searchBackTxt,this.channel=this.form.channel,1===this.channel&&this.getPeopleFilter(),this.form.proNum>0?this.goodIdStatus=!1:this.goodIdStatus=!0,1===Ea.getNewMailActivity().isOpen?this.isOpenBol=!0:0===Ea.getNewMailActivity().isOpen&&(this.isOpenBol=!1),this.defaltSelected=this.form.tagGroupList,Ea.setNewMailActivity("")):this.getMaillActivity(),Ea.setNewMailActivity("")},filters:{},computed:{},methods:{onSubmit:function(e){this.isOpenBol?(this.form.isOpen=1,this.saveMaillActivity(e)):(this.form.isOpen=0,this.stopMaillActivity())},getCompanyBrand:function(){var e=this;A.get("/api-mall/list-enterprise-brand").then(function(t){0===t.data.errorCode?t.data.result&&(e.companyBrand=t.data.result):e.$message.error(t.data.message)})},getListTags:function(){var e=this;A.get("/api-mall/list_mall_goods_tag_tree").then(function(t){0===t.data.errorCode?(e.options.push({childTagList:t.data.result.childTagList,mallProTagId:t.data.result.mallProTagId,tagName:t.data.result.tagName}),e.getTree(e.options)):e.$message.error(t.data.message)})},getTree:function(e){for(var t in e)e[t].label=e[t].tagName,e[t].id=e[t].mallProTagId,e[t].children=e[t].childTagList,e[t].children&&e[t].children.length?this.getTree(e[t].children):delete e[t].children},getMaillActivity:function(){var e=this;A.get("/api-mall/get-freight-activity").then(function(t){if(0===t.data.errorCode)if(e.usePeopleFilter=!1,t.data.result){if(e.form=t.data.result,1==e.form.isOpen?e.isOpenBol=!0:e.isOpenBol=!1,e.form.tagGroupList?e.defaltSelected=e.form.tagGroupList:e.defaltSelected=[],3===e.form.memberLabelType&&(e.useId=t.data.result.activityId,e.searchParams=t.data.result.searchParams,e.responseParams=t.data.result.responseParams,e.hasSearchData=t.data.result.searchParams,e.searchBackTxt=JSON.parse(t.data.result.searchParams)),e.channel=t.data.result.channel,1===e.channel&&e.getPeopleFilter(),e.selectNum=e.form.proNum,e.limitInputLength=C.getZhLen(e.form.activityName),e.limitInputLength2=C.getZhLen(e.form.activityDescription),4==e.form.proRelationType&&e.form.relationId&&(e.value=e.form.relationId.split(",")),3==e.form.proRelationType){e.form.relationId&&(e.searchId=e.form.relationId.split(","));var a=e.form.relationId;e.showCateName(a)}5==e.form.proRelationType&&(e.proNum=e.form.proNum,e.form.proNum>0?e.goodIdStatus=!1:e.goodIdStatus=!0),e.form.addProIdsArr||(e.form.addProIdsArr=[]),e.form.removeProIdsArr||(e.form.removeProIdsArr=[]),e.useId=t.data.result.activityId}else Ea.setNewMailActivity(""),e.form.proNum=0;else e.$message.error(t.data.message)})},getPeopleFilter:function(){var e=this,t={params:this.searchParams};A.post("/api-plug/screening-show-back",_.a.stringify(t)).then(function(t){0===t.data.errorCode?e.peopleFilterInfo=t.data.result:e.$message.error(t.data.message)})},stopMaillActivity:function(){var e=this;this.submitLoading=!0,A.get("/api-mall/cancel-freight-activity").then(function(t){0===t.data.errorCode?t.data.result&&(e.$message.success("停用活动成功！！"),e.getMaillActivity(),e.form.isOpen=0,e.form.activityId="",e.form.activityName="",e.form.activityDescription="",e.form.proRelationType=1,e.form.personGroupStatus=0,e.form.relationId="",e.form.addProIdsStr="",e.form.removeIdsStr="",e.form.brandId="",e.form.proNum=0,e.form.addProIdsArr=[],e.form.removeProIdsArr=[],e.form.freeConditionPrice=0,e.form.freeConditionNumber=0,e.form.searchParams="",e.form.responseParams="",e.submitLoading=!1):(e.submitLoading=!1,e.$message.error(t.data.message))})},saveMaillActivity:function(e){var t=this;this.$refs[e].validate(function(e){if(t.defaltSelected.length<1&&2===t.form.memberLabelType)return t.$message.error("请选择会员分组"),!1;if(!t.form.memberLabelType)return t.$message.error("请选择适用对象"),!1;if(3===t.form.memberLabelType&&(console.log(t.toggleTag,!t.getSaveData),t.toggleTag&&!t.getSaveData))return t.$message.error("请选中人群筛选器的数据"),!1;var a=void 0;if(1===t.form.memberLabelType)a="",t.searchParams="",t.responseParams="";else if(2===t.form.memberLabelType){a=[];var s=!0,i=!1,r=void 0;try{for(var o,l=b()(t.defaltSelected);!(s=(o=l.next()).done);s=!0){var n=o.value;a.push(n.memberTagGroupId)}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}a=a.join(","),t.searchParams="",t.responseParams=""}else 3===t.form.memberLabelType&&(a="");2!=t.form.proRelationType&&(t.form.brandId=""),4==t.form.proRelationType?t.form.relationId=t.value.join(","):3==t.form.proRelationType&&t.searchId.length?t.form.relationId=t.searchId.join(","):t.form.relationId="";var d="";if(t.form.addProIdsStr instanceof Array&&(d=t.form.addProIdsStr.join(",")),2===t.form.proRelationType&&""===t.form.brandId)return t.$message.error("请选择商品品牌"),!1;if(3===t.form.proRelationType&&""===t.form.relationId)return t.$message.error("请选择商品品类"),!1;if(4===t.form.proRelationType&&""===t.form.relationId)return t.$message.error("请选择商品分类"),!1;if(5===t.form.proRelationType&&t.form.proNum<=0)return t.$message.error("请选择商品"),!1;var c={isOpen:t.form.isOpen,activityId:t.form.activityId,activityName:t.form.activityName,activityDescription:t.form.activityDescription,proRelationType:t.form.proRelationType,personGroupStatus:t.form.personGroupStatus,relationId:t.form.relationId,addProIdsStr:d,removeIdsStr:t.form.removeIdsStr,brandId:t.form.brandId,freeConditionPrice:t.form.freeConditionPrice,freeConditionNumber:t.form.freeConditionNumber,memberLabelId:a,memberLabelType:t.form.memberLabelType,searchParams:t.searchParams,responseParams:t.responseParams};if(c.addProIdsStr=t.form.addProIdsArr?t.form.addProIdsArr.join(","):"",c.removeProIdsStr=t.form.removeProIdsArr?t.form.removeProIdsArr.join(","):"",t.submitLoading=!0,!e)return t.submitLoading=!1,!1;A.post("/api-mall/create-or-update-freight-activity",c).then(function(e){0===e.data.errorCode?(3==t.form.proRelationType&&t.getMaillActivity(),t.$message.success("保存活动成功！！"),t.submitLoading=!1,t.form.tagGroupList=t.defaltSelected,t.getMaillActivity()):(t.submitLoading=!1,t.$message.error(e.data.message))})})},limitInput:function(){var e=this,t=this.form.activityName;this.$nextTick(function(){e.form.activityName=C.getInputVal(t,15),e.limitInputLength=C.getZhLen(e.form.activityName)})},limitInput2:function(){var e=this,t=this.form.activityDescription;this.$nextTick(function(){e.form.activityDescription=C.getInputVal(t,50),e.limitInputLength2=C.getZhLen(e.form.activityDescription)})},getCateIds:function(e){this.searchId=e,e.length||(this.selectCateData=[])},showCateName:function(e){var t=this,a={categorys:e};A.get("/api-goods/list-categorys",{params:a}).then(function(e){0===e.data.errorCode&&(t.selectCateData=e.data.result)})},goSelectGoods:function(){if(this.usePeopleFilter&&this.$refs.peopleFilter.saveSelectData(),this.isOpenBol?this.form.isOpen=1:this.form.isOpen=0,3===this.form.memberLabelType&&this.toggleTag&&!this.getSaveData)return this.$message.error("请选中人群筛选器的数据"),!1;this.form.tagGroupList=this.defaltSelected,this.form.proNum=this.proNum,this.form.searchBackTxt=this.searchBackTxt,this.form.conditionList=this.conditionList,this.form.searchParams=this.searchParams,this.form.responseParams=this.responseParams,this.form.conditionList=this.conditionList,this.form.channel=this.channel,Ea.setNewMailActivity(this.form),this.$router.push({name:"mailActivityGoods",query:{selectNum:this.selectNum}})},goBack:function(){this.$router.back(-1),Ea.setNewMailActivity("")},hideDrag:function(){var e=this;this.$nextTick(function(){e.$refs.modal&&(e.$refs.modal.showDrag=!1)})},handleDataTransferred:function(e){this.defaltSelected=e},handleDataLeft:function(e,t){this.defaltSelected=e},getData:function(){this.$refs.peopleFilter.confirmSet(),this.usePeopleFilter=!0},findFilter:function(e){this.searchParams=e},cancelFilter:function(){this.$refs.peopleFilter.cancelSet()},getBackData:function(e){this.responseParams=e,this.getSaveData=e},editShow:function(){this.toggleTag=!0,this.saveTag=!1},editHide:function(){this.toggleTag=!1,this.saveTag=!0},hideBtn:function(e){0===e&&(this.memberSearchStr=-1,this.toggleTag=!1)}},watch:{},components:{goodsCatediff:Ya,Treeselect:ce.a}},Ka={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"},on:{click:function(t){return t.stopPropagation(),e.hideDrag(t)}}},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("促销活动")]),e._v(" "),a("el-breadcrumb-item",[e._v("包邮活动")])],1),e._v(" "),e._m(0)],1),e._v(" "),a("div",{staticClass:"mall-section"},[a("div",{staticClass:"content-wrap-padding"},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[a("el-form-item",{attrs:{label:"活动状态"}},[a("el-switch",{model:{value:e.isOpenBol,callback:function(t){e.isOpenBol=t},expression:"isOpenBol"}})],1),e._v(" "),e.isOpenBol?a("div",[a("el-form-item",{attrs:{label:"活动名称",prop:"activityName"}},[a("el-input",{staticClass:"width-600",on:{input:e.limitInput},model:{value:e.form.activityName,callback:function(t){e.$set(e.form,"activityName",t)},expression:"form.activityName"}},[a("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.limitInputLength)+"/15")])])],1),e._v(" "),a("el-form-item",{attrs:{label:"活动说明",prop:"activityDescription"}},[a("el-input",{staticClass:"width-600",attrs:{type:"textarea",rows:3,placeholder:"请输入内容"},on:{input:e.limitInput2},model:{value:e.form.activityDescription,callback:function(t){e.$set(e.form,"activityDescription",t)},expression:"form.activityDescription"}}),e._v(" "),a("span",{staticClass:"input-position"},[e._v(e._s(e.limitInputLength2)+"/50")])],1),e._v(" "),a("el-form-item",{attrs:{label:"适用对象",required:""}},[[a("el-radio",{attrs:{label:1},model:{value:e.form.memberLabelType,callback:function(t){e.$set(e.form,"memberLabelType",t)},expression:"form.memberLabelType"}},[e._v("全部会员")]),e._v(" "),a("el-radio",{attrs:{label:2},model:{value:e.form.memberLabelType,callback:function(t){e.$set(e.form,"memberLabelType",t)},expression:"form.memberLabelType"}},[e._v("会员分组")]),e._v(" "),a("el-radio",{attrs:{label:3},model:{value:e.form.memberLabelType,callback:function(t){e.$set(e.form,"memberLabelType",t)},expression:"form.memberLabelType"}},[e._v("会员筛选")])]],2),e._v(" "),2===e.form.memberLabelType?a("div",{staticStyle:{margin:"-30px 0 0 70px",width:"856px"}},[a("vue-gic-member-group",{attrs:{defaltSelected:e.defaltSelected,height:e.height,headerList:e.headerList,projectName:e.projectName,effectiveStatus:e.effectiveStatus},on:{handleDataTransferred:e.handleDataTransferred,handleDataLeft:e.handleDataLeft}})],1):e._e(),e._v(" "),3===e.form.memberLabelType?a("div",{staticClass:"fiter-class-container"},[0===e.channel?a("div",[a("vue-gic-people",{ref:"peopleFilter",attrs:{projectName:e.projectName,isAdd:e.isAdd,searchBackTxt:e.searchBackTxt,conditionList:e.conditionList,triggerReset:!0,useId:e.useId,hasSearchData:e.hasSearchData,sceneValue:e.sceneValue},on:{"update:searchBackTxt":function(t){e.searchBackTxt=t},"update:conditionList":function(t){e.conditionList=t},findFilter:e.findFilter,getBackData:e.getBackData,editHide:e.editHide,editShow:e.editShow,hideBtn:e.hideBtn}}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.toggleTag,expression:"toggleTag"}],staticClass:"gic-people--button"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.getData}},[e._v("确 定")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.cancelFilter}},[e._v("取 消")])],1)],1):e._e(),e._v(" "),a("el-popover",{attrs:{placement:"top-start",width:"400",trigger:"hover",content:e.searchParams}},[a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v(e._s(e.peopleFilterInfo))])],1)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"活动商品范围"}},[a("div",{staticClass:"goods-area"},[a("el-select",{staticClass:"width-style",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.form.proRelationType,callback:function(t){e.$set(e.form,"proRelationType",t)},expression:"form.proRelationType"}},e._l(e.selectArr,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("div",{staticClass:"goods-selected"},[a("goodsCatediff",{directives:[{name:"show",rawName:"v-show",value:3==e.form.proRelationType,expression:"form.proRelationType == 3"}],ref:"modal",attrs:{selectCateData:e.selectCateData},on:{getCateIds:e.getCateIds}}),e._v(" "),a("el-select",{directives:[{name:"show",rawName:"v-show",value:2==e.form.proRelationType,expression:"form.proRelationType == 2"}],staticClass:"width-style",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请选择"},model:{value:e.form.brandId,callback:function(t){e.$set(e.form,"brandId",t)},expression:"form.brandId"}},e._l(e.companyBrand,function(e){return a("el-option",{key:e.brandId,attrs:{label:e.brandName,value:e.brandId}})})),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:4==e.form.proRelationType,expression:"form.proRelationType == 4"}],staticClass:"goods-nature-item"},[a("treeselect",{staticClass:"tree-select",staticStyle:{width:"400px"},attrs:{multiple:!0,options:e.options,placeholder:"选择分类","disable-branch-nodes":!0},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:5==e.form.proRelationType,expression:"form.proRelationType == 5"}]},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:5===e.form.proRelationType,expression:"form.proRelationType === 5"}],staticClass:"w-200",staticStyle:{width:"200px"},on:{click:e.goSelectGoods}},[e._v(e._s(e.goodIdStatus?"选择商品":"已选择"+e.form.proNum+"件数"))])],1)],1)],1)]),e._v(" "),a("el-form-item",{attrs:{label:"包邮条件"}},[a("div",{staticClass:"width-600"},[a("el-row",{staticClass:"order-list-title"},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[e._v("\n                      阶段\n                    ")])]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[e._v("\n                      消费满（元）\n                    ")])]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[e._v("\n                      消费满（件）\n                    ")])])],1),e._v(" "),a("el-row",{staticClass:"order-list-content"},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[e._v("\n                      默认\n                    ")])]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("el-input",{staticClass:"input-limit",attrs:{size:"small",placeholder:"请输入内容"},model:{value:e.form.freeConditionPrice,callback:function(t){e.$set(e.form,"freeConditionPrice",t)},expression:"form.freeConditionPrice"}})],1)]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("el-input",{staticClass:"input-limit",attrs:{size:"small",placeholder:"请输入内容"},model:{value:e.form.freeConditionNumber,callback:function(t){e.$set(e.form,"freeConditionNumber",t)},expression:"form.freeConditionNumber"}})],1)])],1)],1)])],1):e._e(),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:function(t){e.onSubmit("form")}}},[e._v("保存活动")])],1)],1)],1)])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("创建包邮活动")])])}]};var Ja=a("VU/8")(Za,Ka,!1,function(e){a("07AF"),a("fY5I")},"data-v-ee949a00",null).exports,Wa={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,fixWidth:document.documentElement.clientWidth-200,length:0,selecting:!0,activeName:"first",goodsStatus:2,order:"asc",sortField:"mallProSpuPrice",pageSizes:[20,40,60,80],salingpageNum:1,salingpageSize:20,salingtotal:0,librarypageNum:1,librarypageSize:20,librarytotal:0,selectpageNum:1,selectpageSize:20,checked:!1,isHide:0,checkedInventory:!1,isHideInventory:0,storeNum:0,tableData:[],selectAllbol:!1,startStatus:"",search:"",proTagId:"",loading:!0,formActivity:{activityId:""},tableInventoryData:[],selectAllInventorybol:!1,tableSelectData:[],proTagvalue:void 0,options:[],activeId:"",removeArr:[],addArr:[],deleteSelectArr:[],selectAllArr:[],selectAllStatus:!1,selecttotal:0}},mounted:function(){this.selecttotal=this.$route.query.selectNum,this.getListTags();var e=Ea.getNewMailActivity();this.activeId=e.activityId,this.formActivity=e,e.activityId,this.getGoodsList(e.activityId)},created:function(){Ea.getNewMailActivity().addProIdsArr&&(this.addProIdsArr=Ea.getNewMailActivity().addProIdsArr,this.removeProIdsArr=Ea.getNewMailActivity().removeProIdsArr)},filters:{},computed:{},methods:{handleClick:function(e){this.selectAllStatus=!1,this.pageNum=1,this.getGoodsList(this.activeId)},salingSizeChange:function(e){this.salingpageSize=e,this.getGoodsList(this.activeId)},salingCurrentChange:function(e){this.salingpageNum=e,this.getGoodsList(this.activeId)},getCateIds:function(e){this.searchId=e.categoryIds},getproTagId:function(e,t){this.proTagId=e||"",this.getGoodsList(this.activeId),this.getGoodsInventoryList(this.activeId)},getListTags:function(){var e=this;A.get("/api-mall/list_mall_goods_tag_tree").then(function(t){0===t.data.errorCode?(e.options.push({childTagList:t.data.result.childTagList,mallProTagId:t.data.result.mallProTagId,tagName:t.data.result.tagName}),e.getTree(e.options)):e.$message.error(t.data.message)})},getTree:function(e){for(var t in e)e[t].label=e[t].tagName,e[t].id=e[t].mallProTagId,e[t].children=e[t].childTagList,e[t].children&&e[t].children.length?this.getTree(e[t].children):delete e[t].children},checkedSelected:function(){this.salingpageNum=1,this.checked?(this.isHide=1,this.getGoodsList(this.activeId)):(this.isHide=0,this.getGoodsList(this.activeId))},getSearchGoodsList:function(){this.salingpageNum=1,this.getGoodsList(this.activeId)},getGoodsList:function(e){var t=this;this.loading=!0;var a=void 0,s=void 0;"first"===this.activeName?(a={activityId:e||null,pageNum:this.salingpageNum,pageSize:this.salingpageSize,sortKey:"create_time",sortValue:"",isSaling:2,type:3,categoryId:"",proTagId:this.proTagId,isHide:this.isHide,search:this.search},s="/api-mall/page-activity-goods"):"second"===this.activeName?(a={activityId:e||null,pageNum:this.salingpageNum,pageSize:this.salingpageSize,sortKey:"create_time",sortValue:"",isSaling:1,type:3,categoryId:"",proTagId:this.proTagId,isHide:this.isHideInventory,search:this.search},s="/api-mall/page-activity-goods"):"fouth"===this.activeName&&(a={activityId:e||null,pageNum:this.salingpageNum,pageSize:this.salingpageSize,sortKey:"create_time",sortValue:"",isSaling:2,type:3,search:""},s="/api-mall/page-selected-activity-goods"),A.post(s,_.a.stringify(a)).then(function(e){if(0===e.data.errorCode){e.data.result.result?(t.tableData=e.data.result.result,t.salingtotal=e.data.result.totalCount):(t.tableData=[],t.salingtotal=0),t.loading=!1;var a=function(e){2===e.isSelStatus?(e.checked=!0,t.selectAllArr.find(function(t){return t.mallProId===e.mallProId})||(-1===t.deleteSelectArr.indexOf(e.mallProId)?t.selectAllArr.push(e):e.checked=!1)):e.checked=!1},s=!0,i=!1,r=void 0;try{for(var o,l=b()(t.tableData);!(s=(o=l.next()).done);s=!0){a(p=o.value)}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}var n=!0,d=!1,c=void 0;try{for(var u,m=b()(t.tableData);!(n=(u=m.next()).done);n=!0){var p=u.value,h=!0,g=!1,v=void 0;try{for(var f,y=b()(t.selectAllArr);!(h=(f=y.next()).done);h=!0){var _=f.value;p.mallProId===_.mallProId&&(-1===t.deleteSelectArr.indexOf(p.mallProId)?p.checked=!0:p.checked=!1)}}catch(e){g=!0,v=e}finally{try{!h&&y.return&&y.return()}finally{if(g)throw v}}}}catch(e){d=!0,c=e}finally{try{!n&&m.return&&m.return()}finally{if(d)throw c}}var C=[],I=[];C=Ea.getNewMailActivity().addProIdsArr,I=Ea.getNewMailActivity().removeProIdsArr;var S=function(e){C.find(function(t){return t===e.mallProId})&&(e.checked=!0)},w=!0,x=!1,L=void 0;try{for(var k,N=b()(t.tableData);!(w=(k=N.next()).done);w=!0){S(k.value)}}catch(e){x=!0,L=e}finally{try{!w&&N.return&&N.return()}finally{if(x)throw L}}var T=function(e){I.find(function(t){return t===e.mallProId})&&(e.checked=!1)},D=!0,P=!1,F=void 0;try{for(var A,M=b()(t.tableData);!(D=(A=M.next()).done);D=!0){T(A.value)}}catch(e){P=!0,F=e}finally{try{!D&&M.return&&M.return()}finally{if(P)throw F}}t.selectAllStatus=t.tableData.every(function(e){return e.checked});var O=!0,$=!1,V=void 0;try{for(var R,U=b()(t.tableData);!(O=(R=U.next()).done);O=!0){var E=R.value;null!==E.discountNameList&&(E.discountNameList=E.discountNameList.join(";"))}}catch(e){$=!0,V=e}finally{try{!O&&U.return&&U.return()}finally{if($)throw V}}var G=function(e){2===e.isSelStatus&&!1===e.checked?t.removeArr.find(function(t){return t.mallProId===e.mallProId})||t.removeArr.push(e):2!==e.isSelStatus&&e.checked&&(t.addArr.find(function(t){return t.mallProId===e.mallProId})||t.addArr.push(e))},B=!0,z=!1,j=void 0;try{for(var H,Y=b()(t.tableData);!(B=(H=Y.next()).done);B=!0){G(H.value)}}catch(e){z=!0,j=e}finally{try{!B&&Y.return&&Y.return()}finally{if(z)throw j}}}else t.$message.error(e.data.message),t.loading=!1})},sortChange:function(e){"createTime"===e.prop?this.sortKey="create_time":this.sortKey=e.prop,"ascending"===e.order?this.sortValue="asc":"descending"==e.order&&(this.sortValue="desc"),this.getGoodsList()},selectAllsaling:function(){var e=this;if(this.selectAllbol=!this.selectAllbol,this.selectAllStatus){var t=function(t){t.checked=!0,e.selectAllArr.find(function(e){return e.mallProId===t.mallProId})||e.selectAllArr.push(t)},a=!0,s=!1,i=void 0;try{for(var r,o=b()(this.tableData);!(a=(r=o.next()).done);a=!0){t(r.value)}}catch(e){s=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw i}}for(var l in this.deleteSelectArr)-1!==this.deleteSelectArr.indexOf(l.mallProId)&&this.deleteSelectArr.splice(l,1);for(var n=function(t){2===e.tableData[t].isSelStatus&&!1===e.tableData[t].checked?e.removeArr.find(function(a){return a.mallProId===e.tableData[t].mallProId})||e.removeArr.push(e.tableData[t]):2!==e.tableData[t].isSelStatus&&e.tableData[t].checked&&(e.addArr.find(function(a){return a.mallProId===e.tableData[t].mallProId})||e.removeArr.find(function(a){return a.mallProId===e.tableData[t].mallProId})||e.addArr.push(e.tableData[t]))},d=0;d<this.tableData.length;d++)n(d)}else{var c=function(t){for(var a in t.checked=!1,e.selectAllArr)t.mallProId===e.selectAllArr[a].mallProId&&(e.selectAllArr.splice(a,1),e.deleteSelectArr.find(function(e){e.mallProId,t.mallProId})||e.deleteSelectArr.push(t.mallProId));for(var s in e.addArr)e.addArr.find(function(e){return e.mallProId===t.mallProId})&&e.addArr.splice(s,1);2===t.isSelStatus&&!1===t.checked?e.removeArr.find(function(e){return e.mallProId===t.mallProId})||e.removeArr.push(t):2!==t.isSelStatus&&t.checked&&(e.addArr.find(function(e){return e.mallProId===t.mallProId})||e.removeArr.find(function(e){return e.mallProId===t.mallProId})||e.addArr.push(t))},u=!0,m=!1,p=void 0;try{for(var h,g=b()(this.tableData);!(u=(h=g.next()).done);u=!0){c(h.value)}}catch(e){m=!0,p=e}finally{try{!u&&g.return&&g.return()}finally{if(m)throw p}}}},selectSaleThis:function(e){if(this.selectAllbol=!this.selectAllbol,e.checked)for(var t in this.selectAllArr.push(e),this.deleteSelectArr)-1!==this.deleteSelectArr.indexOf(e.mallProId)&&this.deleteSelectArr.splice(t,1);else{for(var a in this.selectAllArr)e.mallProId===this.selectAllArr[a].mallProId&&(this.deleteSelectArr.splice(a,1),this.deleteSelectArr.find(function(t){t.mallProId,e.mallProId})||this.deleteSelectArr.push(e.mallProId));for(var s in this.addArr)this.addArr[s].mallProId===e.mallProId&&(this.addArr.splice(s,1),s=0)}2===e.isSelStatus&&!1===e.checked?this.removeArr.find(function(t){return t.mallProId===e.mallProId})||this.removeArr.push(e):2!==e.isSelStatus&&e.checked&&(this.addArr.find(function(t){return t.mallProId===e.mallProId})||this.addArr.push(e)),this.selectAllStatus=this.tableData.every(function(e){return e.checked})},confirmSelect:function(){(Ea.getNewMailActivity().proNum?Ea.getNewMailActivity().proNum:0)+this.addArr.length-this.removeArr.length<=0?this.$message.error("没有选择商品！！"):(this.selecting=!1,this.getSelectGoods())},getSelectGoods:function(){for(var e=[],t=0;t<this.tableSelectData.length;t++)e.push(this.tableSelectData[t].mallProId);var a=Ea.getNewMailActivity(),s=!0,i=!1,r=void 0;try{for(var o,l=b()(this.removeArr);!(s=(o=l.next()).done);s=!0){var n=o.value;-1==this.removeProIdsArr.indexOf(n.mallProId)&&this.removeProIdsArr.push(n.mallProId)}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}var d=!0,c=!1,u=void 0;try{for(var m,p=b()(this.addArr);!(d=(m=p.next()).done);d=!0){var h=m.value;-1==this.addProIdsArr.indexOf(h.mallProId)&&this.addProIdsArr.push(h.mallProId)}}catch(e){c=!0,u=e}finally{try{!d&&p.return&&p.return()}finally{if(c)throw u}}a.addProIdsArr=this.addProIdsArr,a.removeProIdsArr=this.removeProIdsArr,Ea.setNewMailActivity(a),this.$router.push({name:"packageMail",query:{id:"-1"}})},goBack:function(){this.$router.back(-1)}},components:{Treeselect:ce.a,cateSelect:fe}},qa={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[s("div",{staticClass:"mall-content-section"},[s("div",{staticClass:"mall-content-title",staticStyle:{border:"none"}},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),s("el-breadcrumb-item",[e._v("促销活动")]),e._v(" "),s("el-breadcrumb-item",{attrs:{to:{path:"/packageMail"}}},[e._v("包邮活动")]),e._v(" "),s("el-breadcrumb-item",[e._v("选择单件商品")])],1),e._v(" "),e._m(0)],1),e._v(" "),s("div",{staticClass:"mall-section"},[s("div",[s("el-tabs",{staticClass:"bread-content",on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},["first"===e.activeName||"second"===e.activeName?s("div",{staticClass:"operate-top"},[s("div",{staticClass:"fl"},[s("div",{staticClass:"search-item"},[s("treeselect",{staticClass:"tree-select",staticStyle:{width:"400px"},attrs:{options:e.options,placeholder:"选择分类"},on:{input:e.getproTagId},model:{value:e.proTagvalue,callback:function(t){e.proTagvalue=t},expression:"proTagvalue"}})],1),e._v(" "),s("div",{staticClass:"search-item"},[s("el-input",{staticStyle:{"flex-shrink":"0"},attrs:{placeholder:"请输入商分名称/货号/商家编码",clearable:"","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.getSearchGoodsList()}},model:{value:e.search,callback:function(t){e.search="string"==typeof t?t.trim():t},expression:"search"}})],1),e._v(" "),s("div",{staticClass:"search-item",staticStyle:{"line-height":"32px"}},[s("el-checkbox",{on:{change:e.checkedSelected},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("隐藏已参加活动的商品")])],1)]),e._v(" "),s("div",{staticClass:"fr"},[s("el-checkbox",{attrs:{label:"全选本页",border:""},on:{change:e.selectAllsaling},model:{value:e.selectAllStatus,callback:function(t){e.selectAllStatus=t},expression:"selectAllStatus"}})],1)]):e._e(),e._v(" "),s("el-tab-pane",{attrs:{label:"出售中",name:"first"}}),e._v(" "),s("el-tab-pane",{attrs:{label:"仓库中",name:"second"}}),e._v(" "),s("el-tab-pane",{attrs:{label:"已选择("+e.selecttotal+")",name:"fouth"}}),e._v(" "),s("div",{staticClass:"goods-list-content",class:"fouth"===e.activeName?"select-third":""},[[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{"sort-change":e.sortChange}},[s("el-table-column",{attrs:{prop:"goodsinfo",label:"商品信息",width:"500px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"goods-info"},[s("div",[s("a",{attrs:{href:"javascript:;"}},[null===t.row.mallProImageUrl?s("img",{staticClass:"imgs-style",attrs:{src:"http://pic01-10001430.image.myqcloud.com/img-icon-pro.png",alt:""}}):s("img",{staticClass:"imgs-style",attrs:{src:t.row.mallProImageUrl,alt:""}})])]),e._v(" "),s("div",{staticClass:"goods-text"},[s("div",{staticClass:"goods-text-name"},[e._v(e._s(t.row.proName))]),e._v(" "),s("div",{staticClass:"goods-text-info"},[s("div",[e._v("货号："+e._s(t.row.proCode))]),e._v(" "),s("div",[e._v("￥"+e._s(t.row.mallProSpuPrice))])])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"createTime",label:"创建时间",sortable:"",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticClass:"line-18"},[e._v(e._s(e._f("getTime")(t.row.createTime)))]),e._v(" "),s("p",{staticClass:"line-18"},[e._v(e._s(e._f("getSeconds")(t.row.createTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"stock",label:"库存",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"saleNum",label:"总销量",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"eltoop-box"},[null!==t.row.discountNameList?s("el-tooltip",{staticClass:"item",staticStyle:{width:"160px"},attrs:{effect:"dark",content:"已参加其他折扣减价活动："+t.row.discountNameList,placement:"top"}},[s("el-checkbox",{attrs:{label:"已参加活动",border:""},on:{change:function(a){e.selectSaleThis(t.row)}},model:{value:t.row.checked,callback:function(a){e.$set(t.row,"checked",a)},expression:"scope.row.checked"}})],1):s("el-checkbox",{attrs:{label:"选择商品",border:""},on:{change:function(a){e.selectSaleThis(t.row)}},model:{value:t.row.checked,callback:function(a){e.$set(t.row,"checked",a)},expression:"scope.row.checked"}})],1),e._v(" "),s("span",{staticStyle:{display:"none"}},[e._v(e._s(e.selectAllbol))])]}}])}),e._v(" "),s("template",{slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2)],e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length,expression:"tableData.length"}],staticClass:"pagination-conteiner"},[s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{background:"","current-page":e.salingpageNum,"page-sizes":e.pageSizes,"page-size":e.salingpageSize,layout:"total, sizes, prev, pager, next",total:e.salingtotal},on:{"size-change":e.salingSizeChange,"current-change":e.salingCurrentChange}})],1)])],2)],1),e._v(" "),s("div",{staticClass:"confirm-wrap",style:{width:e.fixWidth+"px"}},[s("div",{staticStyle:{"font-size":"0"}},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirmSelect}},[e._v("确认选择")]),e._v(" "),s("el-button",{attrs:{size:"small"},on:{click:e.goBack}},[e._v("返 回")])],1)])],1)])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("选择单件商品")])])}]};var Qa=a("VU/8")(Wa,qa,!1,function(e){a("S/2A"),a("MTDY")},"data-v-26889328",null).exports,Xa={data:function(){return{getTimeAll:C.formatDate,length:0,mallHeight:document.documentElement.clientHeight-64-98,limitInputLength:0,limitInputLength2:0,times:[],form:{activityName:"",activityTag:"",beginTime:"",endTime:"",times:[],buyLimitFlag:0,buyLimit:0,proNum:0,groupProList:[],personGroupStatus:0,activityGroupList:[{mallActivityGroupId:"-1",sort:1}],memberLabelType:1},rules:{activityName:[{required:!0,message:"请输入活动名称",trigger:"blur"}],activityTag:[{required:!0,message:"请输入活动标签",trigger:"blur"}],times:[{required:!0,message:"请选择日期",trigger:"blur"}]},defaltSelected:[],height:543,projectName:"mall",headerList:[],effectiveStatus:1,activityId:"",refash:!1,proNum:0,dialogVisible:!1,dialogForm:{},showList:!1,uploadData:{type:1,activityId:""},action:window.location.origin+"/api-mall/upload-goods-selected-goods?requestProject=mall",headersUpload:{sign:""},loading:!1,isNew:"true",submitLoading:!1,selectNum:0,addProIdsArr:[],removeProIdsArr:[],channel:0,peopleFilterInfo:"",searchBackTxt:"",getSaveData:"",conditionList:[],usePeopleFilter:!1,sceneValue:"member",useId:"",hasSearchData:"",operateType:!0,toggleTag:!1,saveTag:!1,searchParams:{},responseParams:[]}},created:function(){this.activityId=this.$route.query.id,"-1"!==this.activityId?this.uploadData.activityId=this.activityId:this.uploadData.activityId="",localStorage.removeItem("importInfoObj"),this.isNew=this.$route.query.isNew,""!==Ea.getNewActivity()?(this.form=Ea.getNewActivity(),this.selectNum=this.form.proNum,this.defaltSelected=this.form.tagGroupList,this.limitInputLength=C.getZhLen(this.form.activityName),this.limitInputLength2=C.getZhLen(this.form.activityTag),this.addProIdsArr=this.form.addProIdsArr,this.removeProIdsArr=this.form.removeProIdsArr,this.searchBackTxt=this.form.searchBackTxt,this.searchParams=this.form.searchParams,this.responseParams=this.form.responseParams,this.conditionList=this.form.conditionList,this.channel=this.form.channel,1===this.channel&&3===this.form.memberLabelType&&this.getPeopleFilter(),Ea.setNewActivity("")):"false"===this.isNew&&this.getActiveMess()},mounted:function(){""!==this.searchBackTxt&&this.$refs.peopleFilter.getAbInfo(this.searchBackTxt)},filters:{},computed:{},methods:{changeTime:function(){this.form.times&&new Date(this.form.times[1]).valueOf()<new Date((new Date).toLocaleDateString()).valueOf()&&this.$message.error("结束时间不能小于当前时间！")},blurTime:function(){this.refash=!this.refash},getActiveMess:function(){var e=this,t={activityId:this.activityId};A.get("/api-mall/get-discount-activity",{params:t}).then(function(t){0===t.data.errorCode?(e.usePeopleFilter=!1,e.form=t.data.result,e.form.times=[],e.form.times.push(e.form.beginTime),e.form.times.push(e.form.endTime),e.limitInputLength=C.getZhLen(e.form.activityName),e.limitInputLength2=C.getZhLen(e.form.activityTag),e.selectNum=e.form.proNum,3===e.form.memberLabelType&&(e.useId=e.form.activityId,e.searchParams=e.form.searchParams,e.responseParams=e.form.responseParams,e.hasSearchData=t.data.result.searchParams,e.searchBackTxt=JSON.parse(t.data.result.searchParams)),e.channel=t.data.result.channel,1===e.channel&&3===e.form.memberLabelType&&e.getPeopleFilter(),e.form.tagGroupList?e.defaltSelected=e.form.tagGroupList:e.defaltSelected=[]):e.$message.error(t.data.message)})},getPeopleFilter:function(){var e=this,t={params:this.searchParams};A.post("/api-plug/screening-show-back",_.a.stringify(t)).then(function(t){0===t.data.errorCode?e.peopleFilterInfo=t.data.result:e.$message.error(t.data.message)})},onSubmit:function(e){if(!this.form.memberLabelType)return this.$message.error("请选择适用对象"),!1;"false"===this.isNew?this.oldActivitySave(e):this.newActivitySave(e)},newActivitySave:function(e){var t=this;this.$refs[e].validate(function(e){if(0==t.form.buyLimitFlag&&(t.form.buyLimit=0),new Date&&new Date(t.form.times[1]).valueOf()<new Date((new Date).toLocaleDateString()).valueOf())return t.$message.error("结束时间不能小于当前时间！"),!1;if(t.defaltSelected.length<1&&2===t.form.memberLabelType)return t.$message.error("请选择会员分组"),!1;if(3===t.form.memberLabelType&&t.toggleTag&&!t.getSaveData)return t.$message.error("请选中人群筛选器的数据"),!1;var a=void 0;if(1===t.form.memberLabelType)a="",t.searchParams="",t.responseParams="";else if(2===t.form.memberLabelType){a=[];var s=!0,i=!1,r=void 0;try{for(var o,l=b()(t.defaltSelected);!(s=(o=l.next()).done);s=!0){var n=o.value;a.push(n.memberTagGroupId)}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}a=a.join(","),t.searchParams="",t.responseParams=""}else 3===t.form.memberLabelType&&(a="");var d=t.form;if(d.beginTime=t.form.times?t.getTimeAll(t.form.times[0]):"",d.endTime=t.form.times?t.getTimeAll(t.form.times[1]):"",d.memberLabelId=a,d.searchParams=t.searchParams,d.responseParams=t.responseParams,t.submitLoading=!0,!e)return t.submitLoading=!1,!1;A.post("/api-mall/create-discount-activity",d).then(function(e){0===e.data.errorCode?(t.$message.success("新活动创建成功！！"),t.$router.push({name:"discountSale"}),t.submitLoading=!1):(t.$message.error(e.data.message),t.submitLoading=!1)})})},oldActivitySave:function(e){var t=this;this.$refs[e].validate(function(e){if(t.form.times&&new Date(t.form.times[1]).valueOf()<new Date((new Date).toLocaleDateString()).valueOf())return t.$message.error("结束时间不能小于当前时间！"),!1;if(t.defaltSelected.length<1&&2===t.form.memberLabelType)return t.$message.error("请选择会员分组"),!1;if(3===t.form.memberLabelType&&t.toggleTag&&!t.getSaveData)return t.$message.error("请选中人群筛选器的数据"),!1;var a=void 0;if(1===t.form.memberLabelType)a="",t.searchParams="",t.responseParams="";else if(2===t.form.memberLabelType){a=[];var s=!0,i=!1,r=void 0;try{for(var o,l=b()(t.defaltSelected);!(s=(o=l.next()).done);s=!0){var n=o.value;a.push(n.memberTagGroupId)}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}a=a.join(","),t.searchParams="",t.responseParams=""}else 3===t.form.memberLabelType&&(a="");0==t.form.buyLimitFlag&&(t.form.buyLimit=0);var d={groupProList:t.form.groupProList},c={activityId:t.form.activityId,activityName:t.form.activityName,activityTag:t.form.activityTag,beginTime:t.form.times?t.getTimeAll(t.form.times[0]):"",endTime:t.form.times?t.getTimeAll(t.form.times[1]):"",buyLimitFlag:t.form.buyLimitFlag,buyLimit:t.form.buyLimit,proEditData:d,proList:t.form.proList,personGroupStatus:t.form.personGroupStatus,activityGroupList:t.form.activityGroupList,memberLabelType:t.form.memberLabelType,memberLabelId:a,searchParams:t.searchParams,responseParams:t.responseParams};if(t.submitLoading=!0,!e)return t.submitLoading=!1,!1;A.post("/api-mall/update-discount-activity",c).then(function(e){0===e.data.errorCode?(t.$message.success("保存活动成功！！"),t.$router.push({name:"discountSale"}),t.submitLoading=!1):(t.$message.error(e.data.message),t.submitLoading=!1)})})},limitInput:function(){var e=this,t=this.form.activityName;this.$nextTick(function(){e.form.activityName=C.getInputVal(t,15),e.limitInputLength=C.getZhLen(e.form.activityName)})},limitInput2:function(){var e=this,t=this.form.activityTag;this.$nextTick(function(){e.form.activityTag=C.getInputVal(t,5),e.limitInputLength2=C.getZhLen(e.form.activityTag)})},goSelectGoods:function(){if(3===this.form.memberLabelType&&this.toggleTag&&!this.getSaveData)return this.$message.error("请选中人群筛选器的数据"),!1;this.usePeopleFilter&&this.$refs.peopleFilter.saveSelectData(),this.form.addProIdsArr=this.addProIdsArr,this.form.removeProIdsArr=this.removeProIdsArr,this.form.tagGroupList=this.defaltSelected,this.form.searchBackTxt=this.searchBackTxt,this.form.searchParams=this.searchParams,this.form.responseParams=this.responseParams,this.form.conditionList=this.conditionList,this.form.channel=this.channel,Ea.setNewActivity(this.form),this.$router.push({name:"createActivityGoods",query:{isNew:this.isNew,selectNum:this.selectNum}})},goBack:function(){this.$router.push({name:"discountSale"})},handleDataTransferred:function(e){this.defaltSelected=e},handleDataLeft:function(e,t){this.defaltSelected=e},uploadDialogVisible:function(){this.dialogVisible=!0},downloadFile:function(){window.open("static/折扣减价活动商品导入模板.xlsx")},uploadFileBefore:function(e){return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!==e.type&&"application/vnd.ms-excel"!==e.type?(this.$message.error("文件格式错误，请导入.xlsx .csv格式的文件"),!1):e.size>5242880?(this.$message.error("请上传小于5MB的文件"),!1):(localStorage.getItem("sign")?this.headersUpload.sign=localStorage.getItem("sign"):this.headersUpload.sign="",this.loading=!0,void(this.fileName=e.name))},uploadFile:function(e,t){if(this.loading=!0,0===e.errorCode){this.loading=!1,this.form.tagGroupList=this.defaltSelected,this.uploadData.activityId=e.result.activityId,this.form.temActivityId=e.result.activityId;var a=[];a=e.result.failDetail?e.result.failDetail:[],window.localStorage.setItem("importInfoObj",O()(a)),Ea.setNewActivity(this.form),this.$router.push({path:"/createActivityGoods",query:{falseNum:e.result.falseNum,successNum:e.result.successNum,selectedProIds:e.result.selectedProIds,isNew:this.isNew,activityId:e.result.activityId,import:!0}})}else this.loading=!1,this.$message.error(e.message)},getData:function(){this.$refs.peopleFilter.confirmSet(),this.usePeopleFilter=!0},findFilter:function(e){this.searchParams=e},cancelFilter:function(){this.$refs.peopleFilter.cancelSet()},getBackData:function(e){this.responseParams=e,this.getSaveData=e},editShow:function(){this.toggleTag=!0,this.saveTag=!1},editHide:function(){this.toggleTag=!1,this.saveTag=!0},hideBtn:function(e){0===e&&(this.memberSearchStr=-1,this.toggleTag=!1)}},components:{}},es={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("促销活动")]),e._v(" "),a("el-breadcrumb-item",{attrs:{to:{path:"/discountSale"}}},[e._v("折扣/减价")]),e._v(" "),a("el-breadcrumb-item",[e._v("创建折扣/减价活动")])],1),e._v(" "),e._m(0)],1),e._v(" "),a("div",{staticClass:"mall-section"},[a("div",{staticClass:"content-wrap-padding"},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px",rules:e.rules}},[a("el-form-item",{attrs:{label:"活动名称",prop:"activityName"}},[a("el-input",{staticClass:"width-450",on:{input:e.limitInput},model:{value:e.form.activityName,callback:function(t){e.$set(e.form,"activityName",t)},expression:"form.activityName"}},[a("span",{staticClass:"input-prompt",attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.limitInputLength)+"/15")])])],1),e._v(" "),a("el-form-item",{attrs:{label:"活动标签",prop:"activityTag"}},[a("el-input",{staticClass:"width-450",on:{input:e.limitInput2},model:{value:e.form.activityTag,callback:function(t){e.$set(e.form,"activityTag",t)},expression:"form.activityTag"}},[a("span",{staticClass:"input-prompt",attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.limitInputLength2)+"/5")])])],1),e._v(" "),a("el-form-item",{attrs:{label:"时间范围",prop:"times"}},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.changeTime,blur:e.blurTime},model:{value:e.form.times,callback:function(t){e.$set(e.form,"times",t)},expression:"form.times"}})],1),e._v(" "),a("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refash))]),e._v(" "),a("el-form-item",{attrs:{label:"适用对象",required:""}},[[a("el-radio",{attrs:{label:1},model:{value:e.form.memberLabelType,callback:function(t){e.$set(e.form,"memberLabelType",t)},expression:"form.memberLabelType"}},[e._v("全部会员")]),e._v(" "),a("el-radio",{attrs:{label:2},model:{value:e.form.memberLabelType,callback:function(t){e.$set(e.form,"memberLabelType",t)},expression:"form.memberLabelType"}},[e._v("会员分组")]),e._v(" "),a("el-radio",{attrs:{label:3},model:{value:e.form.memberLabelType,callback:function(t){e.$set(e.form,"memberLabelType",t)},expression:"form.memberLabelType"}},[e._v("会员筛选")])]],2),e._v(" "),2===e.form.memberLabelType?a("div",{staticStyle:{margin:"-30px 0 0 70px",width:"856px"}},[a("vue-gic-member-group",{attrs:{defaltSelected:e.defaltSelected,height:e.height,projectName:e.projectName,headerList:e.headerList,effectiveStatus:e.effectiveStatus},on:{handleDataTransferred:e.handleDataTransferred,handleDataLeft:e.handleDataLeft}})],1):e._e(),e._v(" "),3===e.form.memberLabelType?a("div",{staticClass:"fiter-class-container"},[0===e.channel?a("div",[a("vue-gic-people",{ref:"peopleFilter",attrs:{projectName:e.projectName,isAdd:e.isAdd,searchBackTxt:e.searchBackTxt,conditionList:e.conditionList,triggerReset:!0,useId:e.useId,hasSearchData:e.hasSearchData,sceneValue:e.sceneValue},on:{"update:searchBackTxt":function(t){e.searchBackTxt=t},"update:conditionList":function(t){e.conditionList=t},findFilter:e.findFilter,getBackData:e.getBackData,editHide:e.editHide,editShow:e.editShow,hideBtn:e.hideBtn}}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.toggleTag,expression:"toggleTag"}],staticClass:"gic-people--button"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.getData}},[e._v("确 定")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.cancelFilter}},[e._v("取 消")])],1)],1):e._e(),e._v(" "),a("el-popover",{attrs:{placement:"top-start",width:"400",trigger:"hover",content:e.searchParams}},[a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v(e._s(e.peopleFilterInfo))])],1)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"购买限制"}},[a("el-radio-group",{model:{value:e.form.buyLimitFlag,callback:function(t){e.$set(e.form,"buyLimitFlag",t)},expression:"form.buyLimitFlag"}},[a("el-radio",{attrs:{label:0}},[e._v("不限制")]),e._v(" "),a("el-radio",{attrs:{label:1}},[e._v("限制")])],1),e._v(" "),1==e.form.buyLimitFlag?a("el-input-number",{staticStyle:{width:"130px","margin-left":"12px"},model:{value:e.form.buyLimit,callback:function(t){e.$set(e.form,"buyLimit",t)},expression:"form.buyLimit"}}):e._e(),e._v(" "),a("template",{slot:"append"},[e._v("\n              件\n            ")])],2),e._v(" "),a("el-form-item",{attrs:{label:"活动商品范围"}},[a("div",{staticStyle:{display:"inline-block"}},[e.form.groupProList?a("div",[a("el-button",{staticStyle:{width:"200px"},on:{click:e.goSelectGoods}},[e._v(e._s(e.form.groupProList.length>0?"已添加"+e.form.groupProList[0].priceArr.length+"件商品":"选择商品"))])],1):e.form.proNum>0?a("div",[a("el-button",{staticStyle:{width:"200px"},on:{click:function(t){e.goSelectGoods(e.form.activityId)}}},[e._v("已添加"+e._s(e.form.proNum)+"件商品")])],1):a("div",[a("el-button",{on:{click:function(t){e.goSelectGoods()}}},[e._v("选择商品")])],1)]),e._v(" "),a("a",{staticStyle:{"margin-left":"30px"},attrs:{href:"javaScript:void(0)"},on:{click:e.uploadDialogVisible}},[e._v("（或）通过EXCEL导入活动商品")])]),e._v(" "),a("el-form-item",{staticStyle:{"font-size":"0px"}},[a("el-button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:function(t){e.onSubmit("form")}}},[e._v("保存活动")]),e._v(" "),a("el-button",{on:{click:e.goBack}},[e._v("返 回")])],1)],1)],1)])]),e._v(" "),a("el-dialog",{attrs:{title:"导入活动商品",visible:e.dialogVisible,width:"620px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{model:e.dialogForm,"label-position":"right","label-width":"80px"}},[a("el-form-item",{attrs:{label:"选择文件",required:""}},[a("div",{staticClass:"upload-btn"},[a("el-upload",{staticClass:"upload-ele",attrs:{action:e.action,headers:e.headersUpload,"before-upload":e.uploadFileBefore,"on-success":e.uploadFile,"with-credentials":"","show-file-list":e.showList,data:e.uploadData}},[a("el-button",{attrs:{size:"small"}},[a("i",{staticClass:"el-icon-upload2",staticStyle:{"margin-right":"5px"}}),e._v("点击上传")])],1)],1),e._v(" "),a("el-button",{attrs:{type:"info",plain:""},on:{click:e.downloadFile}},[e._v("下载EXCEL模板")])],1),e._v(" "),a("el-form-item",{attrs:{label:"导入规则"}},[a("div",{staticClass:"line"}),e._v(" "),a("div",{staticClass:"upload-rules"},[a("p",[e._v("1. 每个文件最多300个宝贝，文件大小不超过2M")]),e._v(" "),a("p",[e._v("2. 只需要填写SPU（货号）和实售价")]),e._v(" "),a("p",[e._v("3. 仅支持.xlsx .csv文件的导入（建议直接下载模板，在模板的基础上进行数据的填充）")])])])],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("创建折扣/减价活动")])])}]};var ts=a("VU/8")(Xa,es,!1,function(e){a("KSrJ"),a("KKaX")},"data-v-2b21ba36",null).exports,as={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,fixWidth:document.documentElement.clientWidth-200,length:0,selecting:!0,activeName:"first",goodsStatus:2,order:"asc",sortField:"mallProSpuPrice",pageSizes:[20,40,60,80],salingpageNum:1,salingpageSize:20,salingtotal:0,selectArr:[{value:0,label:"批量操作"},{value:1,label:"打折"},{value:2,label:"减价"},{value:3,label:"设置实售价"}],startStatus:0,discountFormVisible:!1,discountform:{discount:10,formLabelWidth:"100px"},reduceFormVisible:!1,reduceform:{reduce:0,formLabelWidth:"100px"},realFormVisible:!1,realform:{real:0,formLabelWidth:"100px"},cancalFormVisible:!1,wipePointsFormVisible:!1,wipeAngleFormVisible:!1,checked:!1,isHide:0,checkedInventory:!1,isHideInventory:0,storeNum:0,tableData:[],selectAllbol:!1,search:"",proTagId:"",loading:!0,formActivity:{activityId:""},setTableData:[],dialogFormVisible:!1,skuOld:{},skuData:[],proTagvalue:void 0,options:[],activeId:"",selectAllArr:[],deleteSelectArr:[],addArr:[],removeArr:[],addProIdsArr:[],removeProIdArr:[],falseNum:0,successNum:0,isImport:!1,isNew:!0,selectAllStatus:!1,selecttotal:0,importInfo:{dialogVisible:!1,infoList:[]},tableLoading:!0}},mounted:function(){this.getListTags();var e=Ea.getNewActivity();if(e.activityId?this.activeId=e.activityId:this.activeId="",this.formActivity=e,e.activityId,e.temActivityId&&(this.activeId=e.temActivityId),this.getGoodsList(this.activeId),this.isNew=this.$route.query.isNew,this.selecttotal=this.$route.query.selectNum,this.$route.query.import){this.isImport=!0,this.successNum=this.$route.query.successNum,this.falseNum=this.$route.query.falseNum,this.selecting=!1,this.activeId=this.$route.query.activityId,this.addProIdsArr=this.$route.query.selectedProIds.split(",");var t=Ea.getNewActivity();t.addProIdsArr=this.addProIdsArr,t.removeProIdsArr=this.removeProIdArr,Ea.setNewActivity(t),this.getSelectGoods()}localStorage.getItem("importInfoObj")&&(this.importInfo.infoList=JSON.parse(localStorage.getItem("importInfoObj")),localStorage.removeItem("importInfoObj")),Ea.getNewActivity().addProIdsArr&&(this.addProIdsArr=Ea.getNewActivity().addProIdsArr,this.removeProIdArr=Ea.getNewActivity().removeProIdsArr)},filters:{},computed:{},watch:{},methods:{handleClick:function(e){this.selectAllStatus=!1,this.pageNum=1,this.getGoodsList(this.activeId)},salingSizeChange:function(e){this.salingpageSize=e,this.getGoodsList(this.activeId)},salingCurrentChange:function(e){this.salingpageNum=e,this.getGoodsList(this.activeId)},getCateIds:function(e){this.searchId=e.categoryIds},getproTagId:function(e,t){this.proTagId=e||"",this.getGoodsList(this.activeId)},getListTags:function(){var e=this;A.get("/api-mall/list_mall_goods_tag_tree").then(function(t){0===t.data.errorCode?(e.options.push({childTagList:t.data.result.childTagList,mallProTagId:t.data.result.mallProTagId,tagName:t.data.result.tagName}),e.getTree(e.options)):e.$message.error(t.data.message)})},getTree:function(e){for(var t in e)e[t].label=e[t].tagName,e[t].id=e[t].mallProTagId,e[t].children=e[t].childTagList,e[t].children&&e[t].children.length?this.getTree(e[t].children):delete e[t].children},checkedSelected:function(){this.salingpageNum=1,this.checked?(this.isHide=1,this.getGoodsList(this.activeId)):(this.isHide=0,this.getGoodsList(this.activeId))},getSearchGoodsList:function(){this.salingpageNum=1,this.getGoodsList(this.activeId)},getGoodsList:function(e){var t=this;this.tableLoading=!0;var a=void 0,s=void 0;"first"===this.activeName?(a={activityId:e,pageNum:this.salingpageNum,pageSize:this.salingpageSize,sortKey:"create_time",sortValue:"",isSaling:2,type:1,categoryId:"",proTagId:this.proTagId,isHide:this.isHide,search:this.search},s="/api-mall/page-activity-goods"):"second"===this.activeName?(a={activityId:e,pageNum:this.salingpageNum,pageSize:this.salingpageSize,sortKey:"create_time",sortValue:"",isSaling:1,type:1,categoryId:"",proTagId:this.proTagId,isHide:this.isHideInventory,search:this.search},s="/api-mall/page-activity-goods"):"fouth"===this.activeName&&(a={activityId:e,pageNum:this.salingpageNum,pageSize:this.salingpageSize,sortKey:"create_time",sortValue:"",isSaling:2,type:1,search:""},s="/api-mall/page-selected-activity-goods"),A.post(s,_.a.stringify(a)).then(function(e){if(0===e.data.errorCode){e.data.result.result?(t.tableData=e.data.result.result,t.salingtotal=e.data.result.totalCount):(t.tableData=[],t.salingtotal=0),t.tableLoading=!1;var a=function(e){2===e.isSelStatus?(e.checked=!0,t.selectAllArr.find(function(t){return t.mallProId===e.mallProId})||(-1===t.deleteSelectArr.indexOf(e.mallProId)?t.selectAllArr.push(e):e.checked=!1)):e.checked=!1},s=!0,i=!1,r=void 0;try{for(var o,l=b()(t.tableData);!(s=(o=l.next()).done);s=!0){a(p=o.value)}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}var n=!0,d=!1,c=void 0;try{for(var u,m=b()(t.tableData);!(n=(u=m.next()).done);n=!0){var p=u.value,h=!0,g=!1,v=void 0;try{for(var f,y=b()(t.selectAllArr);!(h=(f=y.next()).done);h=!0){var _=f.value;p.mallProId===_.mallProId&&(-1===t.deleteSelectArr.indexOf(p.mallProId)?p.checked=!0:p.checked=!1)}}catch(e){g=!0,v=e}finally{try{!h&&y.return&&y.return()}finally{if(g)throw v}}}}catch(e){d=!0,c=e}finally{try{!n&&m.return&&m.return()}finally{if(d)throw c}}t.selectAllStatus=t.tableData.every(function(e){return e.checked});var C=[],I=[];C=Ea.getNewActivity().addProIdsArr,I=Ea.getNewActivity().removeProIdsArr;var S=function(e){C.find(function(t){return t===e.mallProId})&&(e.checked=!0)},w=!0,x=!1,L=void 0;try{for(var k,N=b()(t.tableData);!(w=(k=N.next()).done);w=!0){S(k.value)}}catch(e){x=!0,L=e}finally{try{!w&&N.return&&N.return()}finally{if(x)throw L}}var T=function(e){I.find(function(t){return t===e.mallProId})&&(e.checked=!1)},D=!0,P=!1,F=void 0;try{for(var A,M=b()(t.tableData);!(D=(A=M.next()).done);D=!0){T(A.value)}}catch(e){P=!0,F=e}finally{try{!D&&M.return&&M.return()}finally{if(P)throw F}}t.selectAllStatus=t.tableData.every(function(e){return e.checked});var O=!0,$=!1,V=void 0;try{for(var R,U=b()(t.tableData);!(O=(R=U.next()).done);O=!0){var E=R.value;null!==E.discountNameList&&(E.discountNameList=E.discountNameList.join(";"))}}catch(e){$=!0,V=e}finally{try{!O&&U.return&&U.return()}finally{if($)throw V}}var G=function(e){2===e.isSelStatus&&!1===e.checked?t.removeArr.find(function(t){return t.mallProId===e.mallProId})||t.removeArr.push(e):2!==e.isSelStatus&&e.checked&&(t.addArr.find(function(t){return t.mallProId===e.mallProId})||t.removeArr.find(function(t){return t.mallProId===e.mallProId})||t.addArr.push(e))},B=!0,z=!1,j=void 0;try{for(var H,Y=b()(t.tableData);!(B=(H=Y.next()).done);B=!0){G(H.value)}}catch(e){z=!0,j=e}finally{try{!B&&Y.return&&Y.return()}finally{if(z)throw j}}}else t.$message.error(e.data.message),t.tableLoading=!1})},sortChange:function(e){"createTime"===e.prop?this.sortKey="create_time":this.sortKey=e.prop,"ascending"===e.order?this.sortValue="asc":"descending"==e.order&&(this.sortValue="desc"),this.getGoodsList(this.activeId)},selectAllsaling:function(){var e=this;if(this.selectAllbol=!this.selectAllbol,this.selectAllStatus){var t=function(t){t.checked=!0,e.selectAllArr.find(function(e){return e.mallProId===t.mallProId})||e.selectAllArr.push(t)},a=!0,s=!1,i=void 0;try{for(var r,o=b()(this.tableData);!(a=(r=o.next()).done);a=!0){t(r.value)}}catch(e){s=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw i}}for(var l in this.deleteSelectArr)-1!==this.deleteSelectArr.indexOf(l.mallProId)&&this.deleteSelectArr.splice(l,1);for(var n=function(t){2===e.tableData[t].isSelStatus&&!1===e.tableData[t].checked?e.removeArr.find(function(a){return a.mallProId===e.tableData[t].mallProId})||e.removeArr.push(e.tableData[t]):2!==e.tableData[t].isSelStatus&&e.tableData[t].checked&&(e.addArr.find(function(a){return a.mallProId===e.tableData[t].mallProId})||e.removeArr.find(function(a){return a.mallProId===e.tableData[t].mallProId})||e.addArr.push(e.tableData[t]))},d=0;d<this.tableData.length;d++)n(d)}else{var c=function(t){for(var a in t.checked=!1,e.selectAllArr)t.mallProId===e.selectAllArr[a].mallProId&&(e.selectAllArr.splice(a,1),e.deleteSelectArr.find(function(e){e.mallProId,t.mallProId})||e.deleteSelectArr.push(t.mallProId));for(var s in e.addArr)e.addArr.find(function(e){return e.mallProId===t.mallProId})&&e.addArr.splice(s,1);2===t.isSelStatus&&!1===t.checked?e.removeArr.find(function(e){return e.mallProId===t.mallProId})||e.removeArr.push(t):2!==t.isSelStatus&&t.checked&&(e.addArr.find(function(e){return e.mallProId===t.mallProId})||e.removeArr.find(function(e){return e.mallProId===t.mallProId})||e.addArr.push(t))},u=!0,m=!1,p=void 0;try{for(var h,g=b()(this.tableData);!(u=(h=g.next()).done);u=!0){c(h.value)}}catch(e){m=!0,p=e}finally{try{!u&&g.return&&g.return()}finally{if(m)throw p}}}},selectSaleThis:function(e,t){if(this.selectAllbol=!this.selectAllbol,e)for(var a in this.selectAllArr.push(t),this.deleteSelectArr)-1!==this.deleteSelectArr.indexOf(t.mallProId)&&this.deleteSelectArr.splice(a,1);else{for(var s in this.selectAllArr)t.mallProId===this.selectAllArr[s].mallProId&&(this.deleteSelectArr.splice(s,1),this.deleteSelectArr.find(function(e){e.mallProId,t.mallProId})||this.deleteSelectArr.push(t.mallProId));for(var i in this.addArr)this.addArr[i].mallProId===t.mallProId&&(this.addArr.splice(i,1),i=0)}2===t.isSelStatus&&!1===t.checked?this.removeArr.find(function(e){return e.mallProId===t.mallProId})||this.removeArr.push(t):2!==t.isSelStatus&&t.checked&&(this.addArr.find(function(e){return e.mallProId===t.mallProId})||this.addArr.push(t)),this.selectAllStatus=this.tableData.every(function(e){return e.checked})},confirmSelect:function(){(Ea.getNewActivity().proNum?Ea.getNewActivity().proNum:0)+this.addArr.length-this.removeArr.length<=0?this.$message.error("没有选择商品！！"):(this.selecting=!1,this.getSelectGoods())},getSelectGoods:function(){var e=this,t=!0,a=!1,s=void 0;try{for(var i,r=b()(this.removeArr);!(t=(i=r.next()).done);t=!0){var o=i.value;-1==this.removeProIdArr.indexOf(o.mallProId)&&this.removeProIdArr.push(o.mallProId)}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}var l=!0,n=!1,d=void 0;try{for(var c,u=b()(this.addArr);!(l=(c=u.next()).done);l=!0){var m=c.value;-1==this.addProIdsArr.indexOf(m.mallProId)&&this.addProIdsArr.push(m.mallProId)}}catch(e){n=!0,d=e}finally{try{!l&&u.return&&u.return()}finally{if(n)throw d}}this.$route.query.selectedProIds&&(this.addProIdsArr=this.$route.query.selectedProIds.split(","));var p={activityId:this.activeId,addProIdsStr:this.addProIdsArr.join(","),removeIdsStr:this.removeProIdArr.join(","),personGroupStatus:"",groupId:-1};A.post("/api-mall/list-selected-activity-goods",_.a.stringify(p)).then(function(t){if(0===t.data.errorCode){if(t.data.result.list){for(var a=0;a<t.data.result.list.length;a++)t.data.result.list[a].mallProDiscount||(t.data.result.list[a].mallProDiscount=10),t.data.result.list[a].mallProRealPrice||(t.data.result.list[a].mallProRealPrice=t.data.result.list[a].mallProSpuPrice),t.data.result.list[a].mallProReducePrice||(t.data.result.list[a].mallProReducePrice=0),t.data.result.list[a].isReduce||(t.data.result.list[a].isReduce=0);e.setTableData=t.data.result.list}e.loading=!1}else e.$message.error(t.data.message),e.loading=!1})},showSelcted:function(e){e||(1==this.startStatus&&(this.discountFormVisible=!0),2==this.startStatus&&(this.reduceFormVisible=!0),3==this.startStatus&&(this.realFormVisible=!0),4==this.startStatus&&(this.cancalFormVisible=!0),5==this.startStatus&&(this.wipePointsFormVisible=!0),5==this.startStatus&&(this.wipeAngleFormVisible=!0))},setdiscountForm:function(){for(var e=0;e<this.setTableData.length;e++)this.setTableData[e].mallProDiscount=this.discountform.discount,this.setTableData[e].mallProRealPrice=(this.setTableData[e].mallProSpuPrice*this.discountform.discount*.1).toFixed(2),this.setTableData[e].mallProReducePrice=(this.setTableData[e].mallProSpuPrice-this.setTableData[e].mallProRealPrice).toFixed(2),this.setTableData[e].isReduce=0;this.discountFormVisible=!1},setreduceform:function(){for(var e=0;e<this.setTableData.length;e++)this.setTableData[e].mallProReducePrice=parseFloat(this.reduceform.reduce).toFixed(2),this.setTableData[e].isReduce=1,this.setTableData[e].mallProSpuPrice>this.setTableData[e].mallProReducePrice?(this.setTableData[e].mallProRealPrice=(this.setTableData[e].mallProSpuPrice-this.setTableData[e].mallProReducePrice).toFixed(2),this.setTableData[e].mallProDiscount=(this.setTableData[e].mallProRealPrice/this.setTableData[e].mallProSpuPrice*10).toFixed(2)):(this.setTableData[e].mallProReducePrice=this.setTableData[e].mallProSpuPrice,this.setTableData[e].mallProRealPrice=0,this.setTableData[e].mallProDiscount=0);this.reduceFormVisible=!1},setrealForm:function(){for(var e=0;e<this.setTableData.length;e++)this.setTableData[e].mallProRealPrice=parseFloat(this.realform.real).toFixed(2),this.setTableData[e].mallProSpuPrice>this.setTableData[e].mallProRealPrice?(this.setTableData[e].mallProReducePrice=(this.setTableData[e].mallProSpuPrice-this.setTableData[e].mallProRealPrice).toFixed(2),this.setTableData[e].mallProDiscount=(this.setTableData[e].mallProRealPrice/this.setTableData[e].mallProSpuPrice*10).toFixed(2)):(this.setTableData[e].mallProRealPrice=this.setTableData[e].mallProSpuPrice,this.setTableData[e].mallProReducePrice=0,this.setTableData[e].mallProDiscount=10);this.realFormVisible=!1},setcancalForm:function(){for(var e=0;e<this.setTableData.length;e++)this.setTableData[e].mallProRealPrice=(this.setTableData[e].mallProSpuPrice*this.setTableData[e].mallProDiscount*.1).toFixed(2),this.setTableData[e].mallProReducePrice=(this.setTableData[e].mallProSpuPrice-this.setTableData[e].mallProRealPrice).toFixed(2);this.cancalFormVisible=!1},setwipePointsForm:function(){for(var e=0;e<this.setTableData.length;e++)parseFloat(this.setTableData[e].mallProSpuPrice)>.1&&(this.setTableData[e].mallProRealPrice=Math.floor(10*parseFloat(this.setTableData[e].mallProRealPrice))/10+"0");this.wipePointsFormVisible=!1},setwipeAngleForm:function(){for(var e=0;e<this.setTableData.length;e++)parseFloat(this.setTableData[e].mallProSpuPrice)>1&&(this.setTableData[e].mallProRealPrice=Math.floor(parseFloat(this.setTableData[e].mallProRealPrice))+".00");this.wipeAngleFormVisible=!1},changeOtherPrice:function(e,t){t.mallProDiscount>10?t.mallProDiscount=10:t.mallProDiscount<0&&(t.mallProDiscount=0),this.setTableData[e].mallProDiscount=parseFloat(this.setTableData[e].mallProDiscount).toFixed(2),this.setTableData[e].mallProRealPrice=parseFloat(this.setTableData[e].mallProSpuPrice*this.setTableData[e].mallProDiscount*.1).toFixed(2),this.setTableData[e].mallProReducePrice=parseFloat(this.setTableData[e].mallProSpuPrice-this.setTableData[e].mallProRealPrice).toFixed(2)},discountFocus:function(e){e.isReduce=0},changeReducPrice:function(e,t){t.mallProReducePrice<0?t.mallProReducePrice=0:t.mallProReducePrice>t.mallMinProSkuPrice&&(t.mallProReducePrice=t.mallMinProSkuPrice),this.setTableData[e].mallProRealPrice=parseFloat(this.setTableData[e].mallProSpuPrice-this.setTableData[e].mallProReducePrice).toFixed(2),this.setTableData[e].mallProDiscount=parseFloat(this.setTableData[e].mallProRealPrice/this.setTableData[e].mallProSpuPrice*10).toFixed(2)},reduceFocus:function(e){e.isReduce=1},changeRealPrice:function(e,t){t.mallProRealPrice<0?t.mallProRealPrice=0:t.mallProRealPrice>t.mallMinProSkuPrice&&(t.mallProRealPrice=t.mallMinProSkuPrice),this.setTableData[e].mallProReducePrice=parseFloat(this.setTableData[e].mallProSpuPrice-this.setTableData[e].mallProRealPrice).toFixed(2),this.setTableData[e].mallProDiscount=parseFloat(this.setTableData[e].mallProRealPrice/this.setTableData[e].mallProSpuPrice*10).toFixed(2)},seeSku:function(e,t,a){var s=this;this.dialogFormVisible=!0;var i=t,r={mallproId:e,cutSmallChange:0};A.get("/api-mall/get-activity-goods-sku",{params:r}).then(function(e){if(0===e.data.errorCode){s.skuOld=e.data.result;var t=[],r=parseFloat(s.setTableData[i].mallProDiscount);for(var o in s.skuOld){var l=s.skuOld[o],n=void 0,d=void 0,c=void 0;0===a.isReduce?(n=(s.skuOld[o].price*r*.1).toFixed(2),d=(s.skuOld[o].price-s.skuOld[o].price*r*.1).toFixed(2),c=r):1===a.isReduce&&(n=s.skuOld[o].price-a.mallProReducePrice,d=a.mallProReducePrice,c=a.mallProDiscount),l.mallProDiscount=c,l.mallProRealPrice=n,l.mallProReducePrice=d,t.push(l)}s.skuData=t}else s.$message.error("获取sku数据失败！！")})},confirmGoodsSet:function(){var e=!0,t=!1,a=void 0;try{for(var s,i=b()(this.setTableData);!(e=(s=i.next()).done);e=!0){var r=s.value;if(1===r.isReduce&&r.mallProReducePrice>r.mallMinProSkuPrice)return this.$message.error(r.proCode+"实售价不得低于sku价格"),!1}}catch(e){t=!0,a=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw a}}var o=Ea.getNewActivity();this.isImport&&(o.proNum=this.successNum);for(var l=[{sort:1,cutSmallChange:"0",groupId:"-1",priceArr:[]}],n=[],d=0;d<this.setTableData.length;d++){var c={mallProDiscount:this.setTableData[d].mallProDiscount,mallProReducePrice:this.setTableData[d].mallProReducePrice,mallProRealPrice:this.setTableData[d].mallProRealPrice,activityProRelationId:this.setTableData[d].activityProRelationId,relationId:this.setTableData[d].mallProId,isReduce:this.setTableData[d].isReduce};l[0].priceArr.push(c),n.push(c)}o.groupProList=l,o.proList=n,o.addProIdsArr=this.addProIdsArr,o.removeProIdsArr=this.removeProIdArr,Ea.setNewActivity(o),this.$router.push({name:"createActivity",query:{id:this.activeId,isNew:this.isNew}})},goBackEdit:function(){this.$router.push({name:"createActivity",query:{id:this.activeId,isNew:this.isNew}})},goBack:function(){this.$router.back(-1)},showInfo:function(){this.importInfo.dialogVisible=!0}},components:{Treeselect:ce.a,cateSelect:fe,importInfo:Ye}},ss={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[s("div",{staticClass:"mall-content-section"},[s("div",{staticClass:"mall-content-title",staticStyle:{border:"none"}},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),s("el-breadcrumb-item",[e._v("促销活动")]),e._v(" "),s("el-breadcrumb-item",{attrs:{to:{path:"/discountSale"}}},[e._v("折扣/减价")]),e._v(" "),s("el-breadcrumb-item",{attrs:{to:{name:"createActivity",query:{id:e.activeId}}}},[e._v("创建折扣/减价")]),e._v(" "),s("el-breadcrumb-item",[e._v("选择单件商品")])],1),e._v(" "),e._m(0)],1),e._v(" "),s("div",{staticClass:"mall-section"},[e.selecting?s("div",[s("el-tabs",{staticClass:"bread-content",on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},["first"===e.activeName||"second"===e.activeName?s("div",{staticClass:"operate-top"},[s("div",{staticClass:"fl"},[s("div",{staticClass:"search-item"},[s("treeselect",{staticClass:"tree-select",staticStyle:{width:"400px"},attrs:{options:e.options,placeholder:"选择分类"},on:{input:e.getproTagId},model:{value:e.proTagvalue,callback:function(t){e.proTagvalue=t},expression:"proTagvalue"}})],1),e._v(" "),s("div",{staticClass:"search-item"},[s("el-input",{staticStyle:{"flex-shrink":"0"},attrs:{placeholder:"请输入商分名称/货号/商家编码",clearable:"","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.getSearchGoodsList()}},model:{value:e.search,callback:function(t){e.search="string"==typeof t?t.trim():t},expression:"search"}})],1),e._v(" "),s("div",{staticClass:"search-item",staticStyle:{"line-height":"32px"}},[s("el-checkbox",{on:{change:e.checkedSelected},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("隐藏已参加活动的商品")])],1)]),e._v(" "),s("div",{staticClass:"fr"},[s("el-checkbox",{attrs:{label:"全选本页",border:""},on:{change:e.selectAllsaling},model:{value:e.selectAllStatus,callback:function(t){e.selectAllStatus=t},expression:"selectAllStatus"}})],1)]):e._e(),e._v(" "),s("el-tab-pane",{attrs:{label:"出售中",name:"first"}}),e._v(" "),s("el-tab-pane",{attrs:{label:"仓库中",name:"second"}}),e._v(" "),s("el-tab-pane",{attrs:{label:"已选择("+e.selecttotal+")",name:"fouth"}}),e._v(" "),s("div",{staticClass:"goods-list-content",class:"fouth"===e.activeName?"select-third":""},[[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{"sort-change":e.sortChange}},[s("el-table-column",{attrs:{prop:"goodsinfo",label:"商品信息",width:"500px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"goods-info"},[s("div",[s("a",{attrs:{href:"javascript:;"}},[null===t.row.mallProImageUrl?s("img",{staticClass:"imgs-style",attrs:{src:"http://pic01-10001430.image.myqcloud.com/img-icon-pro.png",alt:""}}):s("img",{staticClass:"imgs-style",attrs:{src:t.row.mallProImageUrl,alt:""}})])]),e._v(" "),s("div",{staticClass:"goods-text"},[s("div",{staticClass:"goods-text-name"},[e._v(e._s(t.row.proName))]),e._v(" "),s("div",{staticClass:"goods-text-info"},[s("div",[e._v("货号："+e._s(t.row.proCode))]),e._v(" "),s("div",[e._v("￥"+e._s(t.row.mallProSpuPrice))])])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"createTime",label:"创建时间",sortable:"",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticClass:"line-18"},[e._v(e._s(e._f("getTime")(t.row.createTime)))]),e._v(" "),s("p",{staticClass:"line-18"},[e._v(e._s(e._f("getSeconds")(t.row.createTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"stock",label:"库存",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"saleNum",label:"总销量",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"eltoop-box"},[null!==t.row.discountNameList?s("el-tooltip",{staticClass:"item",staticStyle:{width:"160px"},attrs:{effect:"dark",content:"已参加其他折扣减价活动："+t.row.discountNameList,placement:"top"}},[s("el-checkbox",{attrs:{label:"已参加活动",border:""},on:{change:function(a){return e.selectSaleThis(a,t.row)}},model:{value:t.row.checked,callback:function(a){e.$set(t.row,"checked",a)},expression:"scope.row.checked"}})],1):s("el-checkbox",{attrs:{label:"选择商品",border:""},on:{change:function(a){return e.selectSaleThis(a,t.row)}},model:{value:t.row.checked,callback:function(a){e.$set(t.row,"checked",a)},expression:"scope.row.checked"}})],1),e._v(" "),s("span",{staticStyle:{display:"none"}},[e._v(e._s(e.selectAllbol))])]}}])}),e._v(" "),s("template",{slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2)],e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length,expression:"tableData.length"}],staticClass:"pagination-conteiner"},[s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{background:"","current-page":e.salingpageNum,"page-sizes":e.pageSizes,"page-size":e.salingpageSize,layout:"total, sizes, prev, pager, next",total:e.salingtotal},on:{"size-change":e.salingSizeChange,"current-change":e.salingCurrentChange}})],1)])],2)],1),e._v(" "),s("div",{staticClass:"confirm-wrap",style:{width:e.fixWidth+"px"}},[s("div",{staticStyle:{"font-size":"0"}},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirmSelect}},[e._v("确认选择")]),e._v(" "),s("el-button",{attrs:{size:"small"},on:{click:e.goBack}},[e._v("返 回")])],1)])],1):s("div",[s("div",{staticClass:"content-wrap-padding"},[s("el-row",{staticClass:"margin-bottom",attrs:{gutter:10}},[s("el-col",{attrs:{span:16}},[s("div",[e._v("\n                第一阶段\n                "),s("span",{directives:[{name:"show",rawName:"v-show",value:e.isImport,expression:"isImport"}],staticClass:"import-tip"},[e._v("本次共导入"+e._s(e.successNum+e.falseNum)+"个商品，其中成功"+e._s(e.successNum)+"个，失败"+e._s(e.falseNum)+"个")]),e._v(" "),s("a",{directives:[{name:"show",rawName:"v-show",value:e.falseNum>0,expression:"falseNum > 0"}],staticStyle:{"margin-left":"10px","font-size":"14px"},attrs:{href:"javaScript:void(0)"},on:{click:e.showInfo}},[e._v("查看失败原因")])])]),e._v(" "),s("el-col",{attrs:{span:8}},[s("div",{staticClass:"fr"},[s("div",{staticClass:"block"},[s("el-select",{staticClass:"width-style",attrs:{clearable:"",placeholder:"请选择"},on:{"visible-change":e.showSelcted},model:{value:e.startStatus,callback:function(t){e.startStatus=t},expression:"startStatus"}},e._l(e.selectArr,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)])])],1),e._v(" "),1==e.startStatus?s("div",[s("el-dialog",{staticClass:"discount-dialog",attrs:{title:"批量打折",visible:e.discountFormVisible},on:{"update:visible":function(t){e.discountFormVisible=t}}},[s("el-form",{attrs:{model:e.discountform}},[s("el-form-item",{attrs:{label:"折扣率","label-width":e.discountform.formLabelWidth}},[s("div",{staticStyle:{width:"200px"}},[s("el-input",{model:{value:e.discountform.discount,callback:function(t){e.$set(e.discountform,"discount",t)},expression:"discountform.discount"}})],1)])],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.discountFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.setdiscountForm}},[e._v("确 定")])],1)],1)],1):e._e(),e._v(" "),2==e.startStatus?s("div",[s("el-dialog",{staticClass:"discount-dialog",attrs:{title:"批量减价",visible:e.reduceFormVisible},on:{"update:visible":function(t){e.reduceFormVisible=t}}},[s("el-form",{attrs:{model:e.reduceform}},[s("el-form-item",{attrs:{label:"减价","label-width":e.reduceform.formLabelWidth}},[s("div",{staticStyle:{width:"200px"}},[s("el-input",{model:{value:e.reduceform.reduce,callback:function(t){e.$set(e.reduceform,"reduce",t)},expression:"reduceform.reduce"}},[s("template",{slot:"append"},[e._v("\n                        元\n                      ")])],2)],1)])],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.reduceFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.setreduceform}},[e._v("确 定")])],1)],1)],1):e._e(),e._v(" "),3==e.startStatus?s("div",[s("el-dialog",{staticClass:"discount-dialog",attrs:{title:"批量设置实售价",visible:e.realFormVisible},on:{"update:visible":function(t){e.realFormVisible=t}}},[s("el-form",{attrs:{model:e.realform}},[s("el-form-item",{attrs:{label:"实售价","label-width":e.realform.formLabelWidth}},[s("div",{staticStyle:{width:"200px"}},[s("el-input",{model:{value:e.realform.real,callback:function(t){e.$set(e.realform,"real",t)},expression:"realform.real"}},[s("template",{slot:"append"},[e._v("\n                        元\n                      ")])],2)],1)])],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.realFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.setrealForm}},[e._v("确 定")])],1)],1)],1):e._e(),e._v(" "),4==e.startStatus?s("div",[s("el-dialog",{staticClass:"discount-dialog",attrs:{title:"批量撤消抹角抹分",visible:e.cancalFormVisible},on:{"update:visible":function(t){e.cancalFormVisible=t}}},[s("div",[e._v("确认批量撤消抹角抹分?")]),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.cancalFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.setcancalForm}},[e._v("确 定")])],1)])],1):e._e(),e._v(" "),5==e.startStatus?s("div",[s("el-dialog",{staticClass:"discount-dialog",attrs:{title:"批量抹分",visible:e.wipePointsFormVisible},on:{"update:visible":function(t){e.wipePointsFormVisible=t}}},[s("div",[e._v("*单价< 0.10的SKU无法抹分，  确认批量抹分?")]),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.wipePointsFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.setwipePointsForm}},[e._v("确 定")])],1)])],1):e._e(),e._v(" "),6==e.startStatus?s("div",[s("el-dialog",{staticClass:"discount-dialog",attrs:{title:"批量抹角",visible:e.wipeAngleFormVisible},on:{"update:visible":function(t){e.wipeAngleFormVisible=t}}},[s("div",{},[e._v("*单价< 1.00的SKU无法抹角，  确认批量抹角？")]),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.wipeAngleFormVisible=!1}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.setwipeAngleForm}},[e._v("确 定")])],1)])],1):e._e(),e._v(" "),s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"cover-problem"},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.setTableData}},[s("el-table-column",{attrs:{prop:"goodsinfo",label:"商品信息"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"goods-info",staticStyle:{"line-height":"20px"}},[s("div",[s("a",{attrs:{href:"javascript:;"}},[null===t.row.mallProImageUrl?s("img",{staticClass:"imgs-style",attrs:{src:"http://pic01-10001430.image.myqcloud.com/img-icon-pro.png",alt:""}}):s("img",{staticClass:"imgs-style",attrs:{src:t.row.mallProImageUrl,alt:""}})])]),e._v(" "),s("div",{staticClass:"goods-text goods-text-set"},[s("div",{staticClass:"goods-text-name"},[e._v(e._s(t.row.proName))]),e._v(" "),s("div",[e._v("货号："+e._s(t.row.proCode))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"mallProSpuPrice",label:"单价(元)",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                  ￥"+e._s(t.row.mallProSpuPrice)+"\n                ")]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"mallProDiscount",label:"打折(折)",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{class:1===t.row.isReduce?"main-way":""},[s("el-input",{attrs:{size:"small",placeholder:""},on:{focus:function(a){e.discountFocus(t.row)},blur:function(a){e.changeOtherPrice(t.$index,t.row)}},model:{value:t.row.mallProDiscount,callback:function(a){e.$set(t.row,"mallProDiscount",a)},expression:"scope.row.mallProDiscount"}})],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"mallProReducePrice",label:"减价(元)",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{class:0===t.row.isReduce?"main-way":""},[s("el-input",{attrs:{size:"small",placeholder:""},on:{focus:function(a){e.reduceFocus(t.row)},blur:function(a){e.changeReducPrice(t.$index,t.row)}},model:{value:t.row.mallProReducePrice,callback:function(a){e.$set(t.row,"mallProReducePrice",a)},expression:"scope.row.mallProReducePrice"}})],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"mallProRealPrice",label:"实售价(元)",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[s("el-input",{attrs:{size:"small",placeholder:""},on:{focus:function(a){e.reduceFocus(t.row)},blur:function(a){e.changeRealPrice(t.$index,t.row)}},model:{value:t.row.mallProRealPrice,callback:function(a){e.$set(t.row,"mallProRealPrice",a)},expression:"scope.row.mallProRealPrice"}})],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{fixed:"right",label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[s("el-button",{attrs:{type:"text"},on:{click:function(a){e.seeSku(t.row.mallProId,t.$index,t.row)}}},[e._v("查看SKU单价")])],1)]}}])}),e._v(" "),s("template",{slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2)],1)],1),e._v(" "),s("div",{staticClass:"confirm-wrap"},[s("div",{staticStyle:{"font-size":"0"}},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirmGoodsSet}},[e._v("确认设置")]),e._v(" "),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.goBackEdit}},[e._v("返 回")])],1)]),e._v(" "),s("el-dialog",{attrs:{title:"SKU单价",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.skuData}},[s("el-table-column",{attrs:{prop:"prop",label:"规格",width:"180"}}),e._v(" "),s("el-table-column",{attrs:{prop:"price",label:"单价(元)",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"mallProDiscount",label:"打折(折)",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"mallProReducePrice",label:"减价(元)",width:"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"mallProRealPrice",label:"实售价(元)"}})],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("关 闭")])],1)],1)],1)])]),e._v(" "),s("importInfo",{attrs:{importInfo:e.importInfo}})],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("选择单件商品")])])}]};var is=a("VU/8")(as,ss,!1,function(e){a("31Vc"),a("ll1g"),a("AMGG")},"data-v-a432115e",null).exports,rs={data:function(){return{getTime:C.getTime,getSeconds:C.getSeconds,mallHeight:document.documentElement.clientHeight-64-98,grade:"",reply:"",proParams:"",memberParams:"",currentPage:1,pageSize:20,pageSizes:[20,40,60,80],total:0,tableData:[],loading:!0,dialogFormVisible:!1,evaluateForm:{msg:"",evaluateId:""},evaluateRules:{msg:[{required:!0,message:"请输入回复内容",trigger:"blur"}]},windowUrl:window.location.origin,dialogVisibleImg:!1,dialogEnlargeImageUrl:"",msgLen:0}},created:function(){this.getList()},computed:{},methods:{getList:function(){var e=this,t={currentPage:this.currentPage,pageSize:this.pageSize,grade:this.grade?this.grade:"-1",reply:this.reply?this.reply:"-1",proParams:this.proParams.trim(),memberParams:this.memberParams.trim()};A.get("/api-mall/evaluates",{params:t}).then(function(t){if(0===t.data.errorCode){e.loading=!1,t.data.result.result?(e.tableData=t.data.result.result,e.total=t.data.result.totalCount):(e.tableData=[],e.total=0);var a=!0,s=!1,i=void 0;try{for(var r,o=b()(e.tableData);!(a=(r=o.next()).done);a=!0){var l=r.value;l.evaluateScore=l.evaluateScore/2,l.serviceScore=l.serviceScore/2,l.expressScore=l.expressScore/2}}catch(e){s=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw i}}}else e.$message.error(t.data.message)})},handleSizeChange:function(e){this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currentPage=e,this.getList()},getSearchList:function(){this.currentPage=1,this.getList()},msgLimit:function(e){var t=this;this.$nextTick(function(){t.evaluateForm.msg=C.getInputVal(e,150),t.msgLen=C.getZhLen(t.evaluateForm.msg)})},replyEvaluate:function(e,t){this.dialogFormVisible=!0,this.evaluateForm.evaluateId=e.evaluateId,this.evaluateForm.msg=1===t?e.replyContent:""},submitReplay:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var a={msg:t.evaluateForm.msg,evaluateId:t.evaluateForm.evaluateId};A.post("/api-mall/reply_msg",_.a.stringify(a)).then(function(e){0===e.data.errorCode?(t.$message.success("保存成功"),t.dialogFormVisible=!1,t.msgLen=0,t.getList()):t.$message.error(e.data.message)})})},cancelReplay:function(e){this.$refs[e].resetFields(),this.dialogFormVisible=!1,this.msgLen=0},enlargeDialogImageUrl:function(e,t){this.dialogVisibleImg=!0,this.dialogEnlargeImageUrl=e.imageUrl}},components:{}},os={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[s("div",{staticClass:"mall-content-section"},[s("div",{staticClass:"mall-content-title"},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),s("el-breadcrumb-item",[e._v("订单管理")]),e._v(" "),s("el-breadcrumb-item",[e._v("评价管理")])],1),e._v(" "),e._m(0)],1),e._v(" "),s("div",{staticClass:"mall-section"},[s("div",{staticClass:"operate-top"},[s("div",{staticClass:"fl"},[s("div",{staticClass:"search-item"},[s("el-select",{staticClass:"w-120",attrs:{placeholder:"评价等级",clearable:""},on:{change:e.getSearchList},model:{value:e.grade,callback:function(t){e.grade=t},expression:"grade"}},[s("el-option",{attrs:{label:"好评",value:"3"}}),e._v(" "),s("el-option",{attrs:{label:"中评",value:"2"}}),e._v(" "),s("el-option",{attrs:{label:"差评",value:"1"}})],1)],1),e._v(" "),s("div",{staticClass:"search-item"},[s("el-select",{staticClass:"w-120",attrs:{placeholder:"回复状态",clearable:""},on:{change:e.getSearchList},model:{value:e.reply,callback:function(t){e.reply=t},expression:"reply"}},[s("el-option",{attrs:{label:"未回复",value:"0"}}),e._v(" "),s("el-option",{attrs:{label:"已回复",value:"1"}})],1)],1),e._v(" "),s("div",{staticClass:"search-item"},[s("el-input",{attrs:{placeholder:"请输入商品名称/货号","prefix-icon":"el-icon-search",clearable:""},on:{clear:e.getSearchList},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.getSearchList(t):null}},model:{value:e.proParams,callback:function(t){e.proParams=t},expression:"proParams"}})],1),e._v(" "),s("div",{staticClass:"search-item"},[s("el-input",{staticClass:"w-320",attrs:{placeholder:"请输入买家昵称/卡号/订单编号","prefix-icon":"el-icon-search",clearable:""},on:{clear:e.getSearchList},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.getSearchList(t):null}},model:{value:e.memberParams,callback:function(t){e.memberParams=t},expression:"memberParams"}})],1)])]),e._v(" "),s("div",{staticClass:"table-content"},[[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[s("el-table-column",{attrs:{label:"商品评价",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[s("span",[s("el-rate",{attrs:{disabled:"","text-color":"#ff9900"},model:{value:t.row.evaluateScore,callback:function(a){e.$set(t.row,"evaluateScore",a)},expression:"scope.row.evaluateScore"}})],1)]),e._v(" "),s("p",[e._v(e._s(t.row.evaluateContent))]),e._v(" "),e._l(t.row.shareImageList,function(t,a){return s("div",{key:a,staticClass:"evaluate-img"},[s("img",{attrs:{src:t.imageUrl}}),e._v(" "),s("i",{staticClass:"el-icon-zoom-in",on:{click:function(s){e.enlargeDialogImageUrl(t,a)}}}),e._v(" "),s("div",{staticClass:"dialog-img"})])}),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogVisibleImg},on:{"update:visible":function(t){e.dialogVisibleImg=t}}},[s("img",{attrs:{width:"100%",src:e.dialogEnlargeImageUrl,alt:""}})])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"商品信息",prop:"mallProName",width:"300px"}}),e._v(" "),s("el-table-column",{attrs:{label:"订单",width:"240px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("a",{staticStyle:{"line-height":"1.2"},attrs:{href:e.windowUrl+"/mall/#/orderDetails/"+t.row.mallOrderId,target:"_blank"}},[e._v(e._s(t.row.orderNumber))]),e._v(" "),s("div",{staticStyle:{"line-height":"1.2"}},[e._v("\n                  服务态度：\n                  "),s("span",[s("el-rate",{staticStyle:{display:"inline-block"},attrs:{disabled:"","text-color":"#ff9900"},model:{value:t.row.serviceScore,callback:function(a){e.$set(t.row,"serviceScore",a)},expression:"scope.row.serviceScore"}})],1)]),e._v(" "),s("div",{staticStyle:{"line-height":"1.2"}},[e._v("\n                  快递服务：\n                  "),s("span",[s("el-rate",{staticStyle:{display:"inline-block"},attrs:{disabled:"","text-color":"#ff9900"},model:{value:t.row.expressScore,callback:function(a){e.$set(t.row,"expressScore",a)},expression:"scope.row.expressScore"}})],1)])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"买家"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticStyle:{"line-height":"1.2"}},[e._v(e._s(t.row.memberNickname))]),e._v(" "),s("a",{staticStyle:{"line-height":"1.2"},attrs:{href:e.windowUrl+"/member/#/wechatmemberDetail?memberId="+t.row.memberId,target:"_blank"}},[e._v(e._s(t.row.memberCardNo))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"评价时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticStyle:{"line-height":"1.2"}},[e._v(e._s(t.row.createTime?e.getTime(t.row.createTime):"--"))]),e._v(" "),s("p",{staticStyle:{"line-height":"1.2"}},[e._v(e._s(t.row.createTime?e.getSeconds(t.row.createTime):"--"))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.replyStatus?s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.row.replyContent,placement:"top-start"}},[s("el-button",{attrs:{type:"text"}},[e._v("已回复")])],1):e._e(),e._v(" "),0===t.row.replyStatus?s("el-button",{attrs:{type:"text"},on:{click:function(a){e.replyEvaluate(t.row,0)}}},[e._v("未回复")]):e._e()]}}])}),e._v(" "),s("template",{slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2)],e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length,expression:"tableData.length"}],staticClass:"pagination-conteiner"},[s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])],2)])]),e._v(" "),s("el-dialog",{attrs:{title:"评价回复",visible:e.dialogFormVisible,width:"450px"},on:{"update:visible":function(t){e.dialogFormVisible=t},close:function(t){e.cancelReplay("evaluateForm")}}},[s("el-form",{ref:"evaluateForm",staticClass:"evaluate-form",attrs:{model:e.evaluateForm,rules:e.evaluateRules,"label-position":"left"}},[s("el-form-item",{staticStyle:{position:"relative"},attrs:{label:"回复内容",prop:"msg"}},[s("el-input",{staticClass:"w-320",attrs:{type:"textarea",rows:4},on:{input:function(t){return e.msgLimit(t)}},model:{value:e.evaluateForm.msg,callback:function(t){e.$set(e.evaluateForm,"msg",t)},expression:"evaluateForm.msg"}}),e._v(" "),s("span",{staticClass:"msg-limit"},[e._v(e._s(e.msgLen)+"/150")])],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.cancelReplay("evaluateForm")}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitReplay("evaluateForm")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("评价管理")])])}]};var ls=a("VU/8")(rs,os,!1,function(e){a("+ObS"),a("dQI6")},"data-v-5b741b1e",null).exports,ns={data:function(){return{getTime:C.getTime,getSeconds:C.getSeconds,mallHeight:document.documentElement.clientHeight-64-98,tableData:[],loading:!0}},created:function(){this.getList()},computed:{},methods:{getList:function(){var e=this;A.get("/api-mall/seller/listAddress").then(function(t){0===t.data.errorCode?t.data.result?(e.tableData=t.data.result,e.loading=!1):(e.tableData=[],e.total=0):e.$message.error(t.data.message)})},deleteAddress:function(e){var t=this;if(1===e.ifDefault)return this.$message.error("默认地址请勿删除"),!1;A.post("/api-mall/seller/del_address/"+e.sellerAddressId).then(function(e){0===e.data.errorCode?(t.$message.success("删除成功!"),t.getList()):t.$message.error(e.data.message)})},newAddress:function(){if(this.tableData.length>20)return this.$message.error("最多可新建20条地址"),!1;this.$router.push({name:"addressEdit",params:{sellerAddressId:"-1"}})},editAddress:function(e){this.$router.push({name:"addressEdit",params:{sellerAddressId:e}})}},components:{}},ds={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[s("div",{staticClass:"mall-content-section"},[s("div",{staticClass:"mall-content-title"},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),s("el-breadcrumb-item",[e._v("商城设置")]),e._v(" "),s("el-breadcrumb-item",[e._v("地址库")])],1),e._v(" "),e._m(0)],1),e._v(" "),s("div",{staticClass:"mall-section"},[s("div",{staticClass:"operate-top"},[s("div",{staticClass:"fr"},[s("el-button",{attrs:{type:"primary",disabled:e.tableData.length>19},on:{click:e.newAddress}},[e._v("新增地址")])],1)]),e._v(" "),s("div",{staticClass:"table-content"},[[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[s("el-table-column",{attrs:{label:"联系人",prop:"contactName"}}),e._v(" "),s("el-table-column",{attrs:{label:"联系方式","min-width":"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.areaNumber||t.row.seatMachine||t.row.extension?s("p",[e._v(e._s(t.row.areaNumber)+e._s(t.row.areaNumber?"-":"")+e._s(t.row.seatMachine)+e._s(t.row.extension?"-":"")+e._s(t.row.extension))]):s("p",[e._v(e._s(t.row.contactPhone))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"地址",prop:"addressDetail"}}),e._v(" "),s("el-table-column",{attrs:{label:"地址类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.addressType?s("p",{staticClass:"address-type"},[e._v("收货地址"),1===t.row.ifDefault?s("span",[e._v("默认")]):e._e()]):s("p",{staticClass:"address-type"},[e._v("退货地址"),1===t.row.ifDefault?s("span",[e._v("默认")]):e._e()])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"text"},on:{click:function(a){e.editAddress(t.row.sellerAddressId)}}},[e._v("编辑")]),e._v(" "),s("el-popover",{staticStyle:{"margin-left":"8px"},attrs:{placement:"top",width:"160"},model:{value:t.row.visible2,callback:function(a){e.$set(t.row,"visible2",a)},expression:"scope.row.visible2"}},[s("p",{staticStyle:{"line-height":"1.5",padding:"10px 10px 20px"}},[e._v("确定删除该地址吗？")]),e._v(" "),s("div",{staticStyle:{"text-align":"right",margin:"0"}},[s("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.row.visible2=!1}}},[e._v("取消")]),e._v(" "),s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.deleteAddress(t.row)}}},[e._v("确定")])],1),e._v(" "),s("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除")])],1)]}}])}),e._v(" "),s("template",{slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2)]],2)])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("地址库")])])}]};var cs=a("VU/8")(ns,ds,!1,function(e){a("cV0v")},"data-v-2a0bfa98",null).exports,us={data:function(){return{getTime:C.getTime,getSeconds:C.getSeconds,mallHeight:document.documentElement.clientHeight-64-98,addressForm:{addressType:2,contactName:"",contactPhone:"",allAddress:"",ifDefault:!1,areaNumber:"",seatMachine:"",extension:""},areaOptions:{provinceName:"",provinceId:"",cityName:"",cityId:"",countryName:"",countyId:""},areaOptionsNew:{},contactNameLen:0,allAddressLen:0,addressRules:{contactName:[{required:!0,message:"联系人不能为空",trigger:"blur"}],contactPhone:[{validator:function(e,t,a){""!==t?/^1[34578]\d{9}$/.test(t)?a():a(new Error("手机号码不符合规则")):a()},trigger:"blur"}],allAddress:[{required:!0,message:"详细地址不能为空",trigger:"blur"}],seatMachine:[{validator:function(e,t,a){""!==t?/^[0-9]*$/.test(t)?a():a(new Error("请输入数字")):a()},trigger:"blur"}],areaNumber:[{validator:function(e,t,a){""!==t?/^[0-9]*$/.test(t)?a():a(new Error("请输入数字")):a()},trigger:"blur"}],extension:[{validator:function(e,t,a){""!==t?/^[0-9]*$/.test(t)?a():a(new Error("请输入数字")):a()},trigger:"blur"}]},addressError:!1,sellerAddressId:"",titleName:"",addressItem:{},defaultAddress:!1}},created:function(){this.sellerAddressId=this.$route.params.sellerAddressId,"-1"!==this.sellerAddressId?(this.titleName="编辑地址",this.getMess()):this.titleName="新建地址"},computed:{},methods:{getMess:function(){var e=this;A.get("/api-mall/seller/address/"+this.sellerAddressId).then(function(t){if(0===t.data.errorCode){var a=t.data.result;e.addressForm.contactName=a.contactName,e.contactNameLen=C.getZhLen(e.addressForm.contactName),e.addressForm.contactPhone=a.contactPhone,e.addressForm.addressType=a.addressType,e.areaOptionsNew.provinceName=a.provinceName,e.areaOptionsNew.provinceId=a.provinceId,e.areaOptionsNew.cityId=a.cityId,e.areaOptionsNew.cityName=a.cityName,e.areaOptionsNew.countyId=a.areaId,e.areaOptionsNew.countryName=a.areaName,e.addressItem=e.areaOptionsNew,e.areaOptions=e.areaOptionsNew,1===a.ifDefault?(e.addressForm.ifDefault=!0,e.defaultAddress=!0):(e.addressForm.ifDefault=!1,e.defaultAddress=!1),e.addressForm.areaNumber=a.areaNumber,e.addressForm.seatMachine=a.seatMachine,e.addressForm.extension=a.extension,e.addressForm.allAddress=a.addressDetail,e.allAddressLen=C.getZhLen(e.addressForm.allAddress)}else e.$message.error(t.data.message)})},contactNameLimit:function(e){var t=this;this.$nextTick(function(){t.addressForm.contactName=C.getInputVal(e,20),t.contactNameLen=C.getZhLen(t.addressForm.contactName)})},allAddressLimit:function(e){var t=this;this.$nextTick(function(){t.addressForm.allAddress=C.getInputVal(e,50),t.allAddressLen=C.getZhLen(t.addressForm.allAddress)})},areaNumberLimit:function(e){var t=this;this.$nextTick(function(){t.addressForm.areaNumber=C.getInputVal(e,5)})},seatMachineLimit:function(e){var t=this;this.$nextTick(function(){t.addressForm.seatMachine=C.getInputVal(e,5)})},extensionLimit:function(e){var t=this;this.$nextTick(function(){t.addressForm.extension=C.getInputVal(e,5)})},selected:function(e){this.addressItem.provinceName=e.provinceName,this.addressItem.provinceId=e.provience,this.addressItem.cityId=e.city,this.addressItem.cityName=e.cityName,this.addressItem.countyId=e.country,this.addressItem.countryName=e.countryName,""!==this.addressItem.provienceName&&""!==this.addressItem.cityName&&""!==this.addressItem.countryName&&(this.addressError=!1)},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(""===t.addressItem.countyId||!t.addressItem.countyId)return t.addressError=!0,!1;if(t.addressError=!1,!e)return!1;var a={operatorType:t.operatorType,contactName:t.addressForm.contactName.trim(),contactPhone:t.addressForm.contactPhone,addressType:t.addressForm.addressType,ifDefault:t.addressForm.ifDefault?1:0,areaNumber:t.addressForm.areaNumber,seatMachine:t.addressForm.seatMachine,extension:t.addressForm.extension,provinceId:t.addressItem.provinceId,provinceName:t.addressItem.provinceName,cityId:t.addressItem.cityId,cityName:t.addressItem.cityName,areaId:t.addressItem.countyId,areaName:t.addressItem.countryName,addressDetail:t.addressForm.allAddress.trim()};"-1"!==t.sellerAddressId?(a.operatorType=2,a.sellerAddressId=t.sellerAddressId):a.operatorType=1,A.post("/api-mall/seller/save_update",_.a.stringify(a)).then(function(e){0===e.data.errorCode?(t.$message.success("保存成功!"),t.$router.push({name:"addressList"})):t.$message.error(e.data.message)})})},resetForm:function(e){this.$refs[e].resetFields(),this.$router.push({name:"addressList"})}},components:{}},ms={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("商城设置")]),e._v(" "),a("el-breadcrumb-item",{attrs:{to:{path:"/addressList"}}},[e._v("地址库")]),e._v(" "),a("el-breadcrumb-item",[e._v(e._s(e.titleName))])],1),e._v(" "),a("h3",[a("span",[e._v(e._s(e.titleName))])])],1),e._v(" "),a("div",{staticClass:"mall-section"},[a("el-form",{ref:"addressForm",staticClass:"demo-ruleForm",attrs:{model:e.addressForm,rules:e.addressRules,"label-width":"90px","label-position":"right"}},[a("el-form-item",{attrs:{label:"地址类型"}},[[a("el-radio",{attrs:{label:2},model:{value:e.addressForm.addressType,callback:function(t){e.$set(e.addressForm,"addressType",t)},expression:"addressForm.addressType"}},[e._v("退货地址")])]],2),e._v(" "),a("el-form-item",{attrs:{label:"是否默认"}},[[a("el-switch",{attrs:{disabled:e.defaultAddress},model:{value:e.addressForm.ifDefault,callback:function(t){e.$set(e.addressForm,"ifDefault",t)},expression:"addressForm.ifDefault"}})]],2),e._v(" "),a("el-form-item",{attrs:{label:"联系人",prop:"contactName"}},[a("el-input",{staticClass:"w-492",attrs:{type:"text"},on:{input:function(t){return e.contactNameLimit(t)}},model:{value:e.addressForm.contactName,callback:function(t){e.$set(e.addressForm,"contactName",t)},expression:"addressForm.contactName"}},[a("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.contactNameLen)+"/20")])])],1),e._v(" "),a("el-form-item",{attrs:{label:"座机"}},[a("el-col",{staticClass:"inline-item"},[a("el-form-item",{attrs:{prop:"areaNumber"}},[a("el-input",{attrs:{type:"number",placeholder:"请填写区号"},on:{input:function(t){return e.areaNumberLimit(t)}},model:{value:e.addressForm.areaNumber,callback:function(t){e.$set(e.addressForm,"areaNumber",t)},expression:"addressForm.areaNumber"}})],1)],1),e._v(" "),a("el-col",{staticClass:"line",staticStyle:{width:"20px","text-align":"center"}},[e._v("-")]),e._v(" "),a("el-col",{staticClass:"inline-item"},[a("el-form-item",{attrs:{prop:"seatMachine"}},[a("el-input",{attrs:{type:"number",placeholder:"请填写座机号"},on:{input:function(t){return e.seatMachineLimit(t)}},model:{value:e.addressForm.seatMachine,callback:function(t){e.$set(e.addressForm,"seatMachine",t)},expression:"addressForm.seatMachine"}})],1)],1),e._v(" "),a("el-col",{staticClass:"line",staticStyle:{width:"20px","text-align":"center"}},[e._v("-")]),e._v(" "),a("el-col",{staticClass:"inline-item"},[a("el-form-item",{attrs:{prop:"extension"}},[a("el-input",{attrs:{type:"number",placeholder:"请填写分机号"},on:{input:function(t){return e.extensionLimit(t)}},model:{value:e.addressForm.extension,callback:function(t){e.$set(e.addressForm,"extension",t)},expression:"addressForm.extension"}})],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"手机",prop:"contactPhone"}},[a("el-input",{staticClass:"w-492",attrs:{type:"number"},model:{value:e.addressForm.contactPhone,callback:function(t){e.$set(e.addressForm,"contactPhone",t)},expression:"addressForm.contactPhone"}})],1),e._v(" "),a("el-form-item",{class:{"is-error":e.addressError},attrs:{label:"所在地区",required:""}},[a("vue-area-ab",{attrs:{areaOptions:e.areaOptions},on:{selected:e.selected}}),e._v(" "),a("p",{directives:[{name:"show",rawName:"v-show",value:e.addressError,expression:"addressError"}],staticClass:"address-error"},[e._v("请选择所在地区")])],1),e._v(" "),a("el-form-item",{staticStyle:{position:"relative","margin-bottom":"32px"},attrs:{label:"详细地址",prop:"allAddress"}},[a("el-input",{staticClass:"w-492",attrs:{type:"textarea",rows:4,placeholder:"请不要重复输入省市区"},on:{input:function(t){return e.allAddressLimit(t)}},model:{value:e.addressForm.allAddress,callback:function(t){e.$set(e.addressForm,"allAddress",t)},expression:"addressForm.allAddress"}}),e._v(" "),a("p",{staticClass:"num-textarea"},[e._v(e._s(e.allAddressLen)+"/50")])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("addressForm")}}},[e._v("保 存")]),e._v(" "),a("el-button",{on:{click:function(t){e.resetForm("addressForm")}}},[e._v("返 回")])],1)],1)],1)])])},staticRenderFns:[]};var ps=a("VU/8")(us,ms,!1,function(e){a("7W8b")},"data-v-6704ae44",null).exports,hs={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"container"},[t("vue-gic-header",{attrs:{projectName:this.projectName,collapseFlag:this.collapseFlag},on:{collapseTag:this.collapseTag,toRouterView:this.toRouterView}}),this._v(" "),t("div",{staticClass:"mall-content-container"},[t("div",{staticClass:"goods-manege-content"},[t("router-view")],1)])],1)},staticRenderFns:[]};var gs=a("VU/8")({data:function(){return{collapseFlag:!1,menuRouter:[],leftMenuRouter:[],leftModulesName:"微商城",projectName:"mall"}},computed:{},methods:{toRouterView:function(e){this.$router.push({path:e.path})},collapseTag:function(e){this.collapseFlag=e,this.collapseFlag?this.widthData="64px":this.widthData="200px"}},components:{}},hs,!1,function(e){a("7u0u")},"data-v-a6ec1f18",null).exports,vs={props:{tableData:{type:Array,default:function(){return[]}}},data:function(){return{getTime:C.getTime,getSeconds:C.getSeconds,multipleSelection:[],imgUrl:""}},computed:{},methods:{handleSelectionChange:function(e){this.multipleSelection=e;var t,a=[],s=!0,i=!1,r=void 0;try{for(var o,l=b()(this.multipleSelection);!(s=(o=l.next()).done);s=!0){var n=o.value;a.push(n.id)}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}t=a.join(","),this.$emit("beforeRececyle",t)}},components:{}},fs={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),s("el-table-column",{attrs:{label:"名称",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"img-box"},["folder"===t.row.type?s("img",{attrs:{src:a("Ajnd"),alt:""}}):s("div",{staticStyle:{"border-radius":"2px",display:"inline-block",border:"1px solid #E4E7ED"}},[s("img",{attrs:{src:t.row.imgUrl,alt:""},on:{dblclick:function(a){e.openImgDetail(t.row,t.$index)}}})]),e._v(" "),s("span",[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"类型"},scopedSlots:e._u([{key:"default",fn:function(t){return["image"===t.row.type?s("p",[e._v(e._s(t.row.imgType))]):e._e()]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"尺寸（px）"},scopedSlots:e._u([{key:"default",fn:function(t){return["image"===t.row.type?s("p",[e._v(e._s(t.row.width)+"x"+e._s(t.row.length))]):e._e()]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"大小"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s((t.row.size/1024).toFixed(2)))]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"图片引用状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{directives:[{name:"show",rawName:"v-show",value:"image"===t.row.type,expression:"scope.row.type === 'image'"}]},[1===t.row.quoteStatus?s("p",[s("span",{staticClass:"dm-status--primary"},[e._v("已引用")])]):s("p",[s("span",{staticClass:"dm-status--info"},[e._v("未引用")])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"更新时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticStyle:{"line-height":"1.2"}},[e._v(e._s(t.row.updateTime?e.getTime(t.row.updateTime):"--"))]),e._v(" "),s("p",{staticStyle:{"line-height":"1.2"}},[e._v(e._s(t.row.updateTime?e.getSeconds(t.row.updateTime):"--"))])]}}])}),e._v(" "),s("template",{staticStyle:{display:"none"},slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2)],1)},staticRenderFns:[]};var bs=a("VU/8")(vs,fs,!1,function(e){a("/nfb")},"data-v-96129450",null).exports,ys={props:{tableData:{type:Array,default:function(){return[]}},shuaxin:{type:Boolean,default:!1}},data:function(){return{inputVisible:!1,refash:!1}},computed:{},methods:{selectItemClick:function(e){this.$emit("changeStatus",e,2),this.refash=!this.refash},deleteFile:function(e){this.$emit("cardListDelete",e.id)},recycleFile:function(e){this.$emit("cardListRece",e.id)}},components:{}},_s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"card-content"},[e._l(e.tableData,function(t,s){return a("div",{key:s,staticClass:"card-item",class:t.selectItem?"select-item":""},[a("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refash)+e._s(e.shuaxin))]),e._v(" "),a("div",{staticClass:"img-box"},[a("img",{attrs:{src:t.imgUrl,alt:""},on:{click:function(a){e.selectItemClick(t)}}}),e._v(" "),1===t.quoteStatus&&"image"===t.type?a("div",{staticClass:"used-pic"},[e._v("引")]):e._e()]),e._v(" "),a("div",{staticClass:"folder-name"},[a("span",[e._v(e._s(t.name))]),e._v(" "),a("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refash))]),e._v(" "),a("div",{staticClass:"img-operate"},[a("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"center"}},[a("a",{attrs:{href:"javaScript:void(0)",title:"恢复"}},[a("i",{staticClass:"iconfont icon-10chexiao",on:{click:function(a){a.stopPropagation(),e.recycleFile(t)}}})]),e._v(" "),a("a",{attrs:{href:"javaScript:void(0)",title:"彻底删除"}},[a("i",{staticClass:"el-icon-delete",on:{click:function(a){a.stopPropagation(),e.deleteFile(t)}}})])])])])])}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.tableData.length,expression:"tableData.length === 0"}],staticClass:"no-data-wrap",staticStyle:{"text-align":"center"}},[e._m(0),e._v(" "),a("p",{staticStyle:{color:"#909399","font-size":"14px"}},[e._v("暂无数据")])])],2)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"no-data-icon"},[t("img",{attrs:{src:a("8Td+")}})])}]};var Cs={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,searchParams:"",checked:!1,sortType:"timeDesc",activeIndex:"2",currentPage:1,pageSize:20,pageSizes:[20,40,60,80],total:0,tableData:[],rececyleIds:"",deleteIds:"",shuaxin:!1}},created:function(){this.getImgList()},computed:{},methods:{toggleClick:function(e){this.currentPage=1,this.pageSize=20,this.sortType="timeDesc",this.searchParams="","1"===e?this.activeIndex="1":"2"===e&&(this.activeIndex="2"),this.checked=!1,this.getImgList()},getImgList:function(){var e=this,t={currentPage:this.currentPage,pageSize:this.pageSize,sortType:this.sortType,searchParams:this.searchParams.trim()};A.get("/api-mall/gic-cloud-image-recycleList",{params:t}).then(function(t){0===t.data.errorCode?t.data.result.result?(e.tableData=t.data.result.result,e.total=t.data.result.totalCount):e.tableData=[]:e.$message.error(t.data.message)})},getSearchImgList:function(){this.currentPage=1,this.getImgList()},handleSizeChange:function(e){this.checked=!1,this.pageSize=e,this.getImgList()},handleCurrentChange:function(e){this.checked=!1,this.currentPage=e,this.getImgList()},beforeRececyle:function(e){this.rececyleIds=e,this.deleteIds=e},imgRecyFile:function(e){var t=this;if("-1"===e)if("2"===this.activeIndex){var a=[],s=!0,i=!1,r=void 0;try{for(var o,l=b()(this.tableData);!(s=(o=l.next()).done);s=!0){var n=o.value;n.selectItem&&a.push(n.id)}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}if(a.length<=0)return this.$message.error("请至少选择一个要恢复的文件"),!1;this.rececyleIds=a.join(",")}else if(""===this.rececyleIds)return this.$message.error("请至少选择一个要恢复的文件"),!1;var d={ids:this.rececyleIds};A.get("/api-mall/gic-cloud-image-recycleRecover",{params:d}).then(function(e){0===e.data.errorCode?(t.$message.success("恢复成功"),t.getImgList()):t.$message.error(e.data.message)})},deleteFile:function(e){var t=this;if("-1"===e)if("2"===this.activeIndex){var a=[],s=!0,i=!1,r=void 0;try{for(var o,l=b()(this.tableData);!(s=(o=l.next()).done);s=!0){var n=o.value;n.selectItem&&a.push(n.id)}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}if(a.length<=0)return this.$message.error("请至少选择一个要彻底删除的文件"),!1;this.deleteIds=a.join(",")}else if("1"===this.activeIndex&&""===this.deleteIds)return this.$message.error("请至少选择一个要彻底删除的文件"),!1;var d={ids:this.deleteIds};this.$confirm("此操作将彻底删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){A.get("/api-mall/gic-cloud-image-recycleDelete",{params:d}).then(function(e){0===e.data.errorCode?(t.$message.success("删除成功!"),t.getImgList(),t.checked=!1):t.$message.error(e.data.message)})})},cardListDelete:function(e){this.deleteIds=e,this.deleteFile()},cardListRece:function(e){this.rececyleIds=e,this.imgRecyFile()},selectAll:function(){if(this.checked){var e=!0,t=!1,a=void 0;try{for(var s,i=b()(this.tableData);!(e=(s=i.next()).done);e=!0){s.value.selectItem=!0}}catch(e){t=!0,a=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw a}}}else{var r=!0,o=!1,l=void 0;try{for(var n,d=b()(this.tableData);!(r=(n=d.next()).done);r=!0){n.value.selectItem=!1}}catch(e){o=!0,l=e}finally{try{!r&&d.return&&d.return()}finally{if(o)throw l}}}this.shuaxin=!this.shuaxin},moveFile:function(e){if("-1"===e){if("2"===this.activeIndex){var t=[],a=!0,s=!1,i=void 0;try{for(var r,o=b()(this.tableData);!(a=(r=o.next()).done);a=!0){var l=r.value;l.selectItem&&t.push(l.id)}}catch(e){s=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw i}}if(t.length<=0)return this.$message.error("请选择要移动的文件"),!1;if(this.moveIds=t.join(","),""===this.moveIds||!this.moveIds)return this.$message.error("请选择要移动的文件"),!1}this.moveIds=e}this.getFileData(),this.dialogFormVisible2=!0,this.moveParentId=null},changeStatus:function(e,t,a){2===t&&(e.selectItem=!e.selectItem);var s=!0,i=!1,r=void 0;try{for(var o,l=b()(this.tableData);!(s=(o=l.next()).done);s=!0){o.value.selectItem||(this.checked=!1)}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}var n=[],d=!0,c=!1,u=void 0;try{for(var m,p=b()(this.tableData);!(d=(m=p.next()).done);d=!0){var h=m.value;h.selectItem&&n.push(h)}}catch(e){c=!0,u=e}finally{try{!d&&p.return&&p.return()}finally{if(c)throw u}}n.length===this.tableData.length&&(this.checked=!0)}},components:{imgList:bs,imgCard:a("VU/8")(ys,_s,!1,function(e){a("ZmCn")},"data-v-fb475aaa",null).exports,Treeselect:ce.a}},Is={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("商品管理")]),e._v(" "),a("el-breadcrumb-item",{attrs:{to:{path:"/imgSpaceList"}}},[e._v("图片空间")]),e._v(" "),a("el-breadcrumb-item",[e._v("回收站")])],1),e._v(" "),e._m(0)],1),e._v(" "),a("div",{staticClass:"mall-section"},[a("div",{staticClass:"operate-top"},[a("div",{staticClass:"search-box"},[a("el-input",{staticClass:"w-260",attrs:{placeholder:"请输入图片名称/文件夹名称","prefix-icon":"el-icon-search",clearable:""},on:{clear:e.getSearchImgList},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.getSearchImgList(t):null}},model:{value:e.searchParams,callback:function(t){e.searchParams=t},expression:"searchParams"}})],1)]),e._v(" "),a("div",{staticClass:"space-list-container"},[a("div",{staticClass:"space-list-title"},[a("div",{staticClass:"fl"},["2"===e.activeIndex?a("el-checkbox",{staticClass:"check-box",attrs:{disabled:0===e.tableData.length},on:{change:e.selectAll},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("全选")]):e._e(),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(t){e.imgRecyFile("-1")}}},[e._v("恢复")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(t){e.deleteFile("-1")}}},[e._v("彻底删除")])],1),e._v(" "),a("div",{staticClass:"fr"},[a("el-select",{staticStyle:{width:"130px"},attrs:{placeholder:"图片引用状态"},on:{change:e.getSearchImgList},model:{value:e.sortType,callback:function(t){e.sortType=t},expression:"sortType"}},[a("el-option",{attrs:{label:"时间升序",value:"timeAsc"}}),e._v(" "),a("el-option",{attrs:{label:"时间降序",value:"timeDesc"}}),e._v(" "),a("el-option",{attrs:{label:"大小升序",value:"sizeAsc1"}}),e._v(" "),a("el-option",{attrs:{label:"大小降序",value:"sizeDesc"}}),e._v(" "),a("el-option",{attrs:{label:"名称升序",value:"nameAsc"}}),e._v(" "),a("el-option",{attrs:{label:"名称降序",value:"nameDesc"}})],1),e._v(" "),a("ul",{staticClass:"toggle-list"},[a("li",{staticClass:"icon-item",class:"1"===e.activeIndex?"icon-item-active":"",on:{click:function(t){e.toggleClick("1")}}},[a("i",{staticClass:"icon-toggle-list"})]),e._v(" "),a("li",{staticClass:"icon-item",class:"2"===e.activeIndex?"icon-item-active":"",on:{click:function(t){e.toggleClick("2")}}},[a("i",{staticClass:"icon-toggle-card"})])])],1)]),e._v(" "),a("div",{staticClass:"space-list-content"},["1"===e.activeIndex?a("imgList",{attrs:{tableData:e.tableData},on:{beforeRececyle:e.beforeRececyle}}):e._e(),e._v(" "),"2"===e.activeIndex?a("imgCard",{attrs:{tableData:e.tableData,shuaxin:e.shuaxin},on:{changeStatus:e.changeStatus,cardListDelete:e.cardListDelete,cardListRece:e.cardListRece}}):e._e(),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length>0,expression:"tableData.length > 0"}],staticClass:"pagination-conteiner"},[a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])],1)])])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("回收站")])])}]};var Ss={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98-149,parentId:"",highlightCurrent:!0,clickNodeExpand:!0,data:[],defaultProps:{children:"chlidren",label:"name"}}},computed:{},methods:{},components:{imgRececyleRight:a("VU/8")(Cs,Is,!1,function(e){a("9Z+r")},"data-v-07093f60",null).exports}},ws={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"mall-section-container"},[t("div",{staticClass:"img-right-content"},[t("div",{staticClass:"img-right"},[t("imgRececyleRight",{ref:"childEvent",attrs:{parentId:this.parentId}}),this._v(" "),t("vue-gic-footer",{staticStyle:{"padding-bottom":"80px"}})],1)])])},staticRenderFns:[]};var xs=a("VU/8")(Ss,ws,!1,function(e){a("u/OI"),a("E3Op")},"data-v-a24067c0",null).exports,Ls={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,setForm:{mallScale:0},refash:!1}},created:function(){this.getMess()},computed:{},methods:{getMess:function(){var e=this;A.post("/api-mall/mall_advanced_setting").then(function(t){0===t.data.errorCode?(e.setForm.mallScale=t.data.result.mallScale,e.refash=!e.refash):e.$message.error(t.data.message)})},onSubmit:function(e){var t=this,a={scaleType:this.setForm.mallScale};this.$refs[e].validate(function(e){if(!e)return!1;A.post("/api-mall/update-order-scale",_.a.stringify(a)).then(function(e){0===e.data.errorCode?t.$message.success("保存成功"):t.$message.error(e.data.message)})})}},components:{}},ks={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("商城设置")]),e._v(" "),a("el-breadcrumb-item",[e._v("数据精度")])],1),e._v(" "),e._m(0)],1),e._v(" "),a("div",{staticClass:"mall-section"},[a("div",{staticClass:"set-content"},[a("el-form",{ref:"setForm",staticClass:"demo-ruleForm",attrs:{model:e.setForm,"label-width":"80px","label-position":"right"}},[a("div",{staticClass:"title-tip"},[a("i",{staticClass:"el-icon-info"}),e._v(" "),a("span",[e._v("若数据精度设置为整数，则订单中金额相关的数据精度都是四舍五入为整数。请谨慎设置或修改！")])]),e._v(" "),a("el-form-item",{attrs:{label:"数据精度"}},[[a("el-radio-group",{model:{value:e.setForm.mallScale,callback:function(t){e.$set(e.setForm,"mallScale",t)},expression:"setForm.mallScale"}},[a("el-radio",{attrs:{label:0}},[e._v("2位小数")]),e._v(" "),a("el-radio",{attrs:{label:1}},[e._v("整数")])],1),e._v(" "),a("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refash))])]],2),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("setForm")}}},[e._v("保存")])],1)],1)],1)])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("数据精度")])])}]};var Ns=a("VU/8")(Ls,ks,!1,function(e){a("F3eK")},"data-v-07fa3a02",null).exports,Ts={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,getTime:C.getTime,getSeconds:C.getSeconds,search:"",activeStatus:"",tableData:[],currentPage:1,pageSize:20,pageSizes:[20,40,60,80],total:0,loading:!1}},created:function(){this.getList()},computed:{},methods:{renderHeader:function(e,t,a){t.column,t.$index;return e("span",{},[e("span",{},"优惠人群"),e("el-popover",{props:{placement:"top-start",width:"200",trigger:"hover",content:"当一个会员处于多个会员分组时，可能造成该会员同时命中多个满减送活动，此时默认只参与优惠力度最大的那个活动。"}},[e("i",{slot:"reference",class:"iconfont icon-xinxixianshi"},"")])])},getList:function(){var e=this,t={currentPage:this.currentPage,pageSize:this.pageSize,startStatus:this.activeStatus,search:this.search.trim()};this.loading=!0,A.get("/api-mall/page-reduce-activity",{params:t}).then(function(t){0===t.data.errorCode?(e.loading=!1,t.data.result.result?(e.tableData=t.data.result.result,e.total=t.data.result.totalCount):(e.tableData=[],e.total=0)):(e.$message.error(t.data.message),e.loading=!1)})},getSearchList:function(){this.currentPage=1,this.getList()},handleSizeChange:function(e){this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currentPage=e,this.getList()},deleteActive:function(e,t){var a=this,s={activityId:e.activityId};A.post("/api-mall/delete-reduce-activity",_.a.stringify(s)).then(function(e){0===e.data.errorCode?(a.tableData.splice(t,1),0===a.tableData.length&&a.currentPage>1&&(a.currentPage=a.currentPage-1),a.$message.success("删除成功"),a.getList()):a.$message.error(e.data.message)})},newActive:function(e){localStorage.removeItem("priceObj"),this.$router.push({name:"newReduceDiscount",params:{activityId:e}})}},components:{}},Ds={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[s("div",{staticClass:"mall-content-section"},[s("div",{staticClass:"mall-content-title"},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),s("el-breadcrumb-item",[e._v("促销活动")]),e._v(" "),s("el-breadcrumb-item",[e._v("满减送")])],1),e._v(" "),e._m(0)],1),e._v(" "),s("div",{staticClass:"mall-section header-style"},[s("div",{staticClass:"operate-top"},[s("div",{staticClass:"fl"},[s("div",{staticClass:"search-item"},[s("el-select",{staticClass:"w-120",attrs:{placeholder:"活动状态",clearable:""},on:{change:e.getSearchList},model:{value:e.activeStatus,callback:function(t){e.activeStatus=t},expression:"activeStatus"}},[s("el-option",{attrs:{label:"未开始",value:0}}),e._v(" "),s("el-option",{attrs:{label:"进行中",value:1}}),e._v(" "),s("el-option",{attrs:{label:"已结束",value:2}})],1)],1),e._v(" "),s("div",{staticClass:"search-item"},[s("el-input",{attrs:{placeholder:"请输入活动名称","prefix-icon":"el-icon-search",clearable:""},on:{clear:e.getSearchList},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.getSearchList(t):null}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)]),e._v(" "),s("div",{staticClass:"fr"},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.newActive("-1")}}},[e._v("新建活动")])],1)]),e._v(" "),s("div",{staticClass:"table-content"},[[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},[s("el-table-column",{attrs:{label:"活动名称",prop:"activityName"}}),e._v(" "),s("el-table-column",{attrs:{label:"活动时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticClass:"time-lh"},[e._v(e._s(t.row.beginTime?e.getTime(t.row.beginTime):"--")+" "+e._s(t.row.beginTime?e.getSeconds(t.row.beginTime):"--")+"~~")]),e._v(" "),s("p",{staticClass:"time-lh"},[e._v(e._s(t.row.endTime?e.getTime(t.row.endTime):"--")+" "+e._s(t.row.endTime?e.getSeconds(t.row.endTime):"--"))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"活动状态",prop:"startStatus"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.startStatus?s("p",[e._v("未开始")]):e._e(),e._v(" "),1===t.row.startStatus?s("p",[e._v("进行中")]):e._e(),e._v(" "),2===t.row.startStatus?s("p",[e._v("已结束")]):e._e()]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"商品范围",prop:"proRelationType"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.proRelationType?s("p",[e._v("所有商品")]):2===t.row.proRelationType?s("p",[e._v("按商品品牌")]):e._e(),e._v(" "),3===t.row.proRelationType?s("p",[e._v("按商品品类")]):e._e(),e._v(" "),4===t.row.proRelationType?s("p",[e._v("按商品分类")]):e._e(),e._v(" "),5===t.row.proRelationType?s("p",[e._v("按单件商品")]):e._e()]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"优惠人群","render-header":e.renderHeader},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.memberLabelType?s("p",[e._v("全部会员")]):e._e(),e._v(" "),2===t.row.memberLabelType?s("p",[e._v(e._s(t.row.memberTagCount)+"个会员分组")]):e._e(),e._v(" "),3===t.row.memberLabelType?s("p",[e._v("会员筛选")]):e._e()]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"fz0"},[s("el-button",{staticStyle:{"margin-right":"16px","line-height":"24px"},attrs:{type:"text"},on:{click:function(a){e.newActive(t.row.activityId)}}},[e._v("编辑")]),e._v(" "),s("el-popover",{attrs:{placement:"top",width:"160"},model:{value:t.row.visible2,callback:function(a){e.$set(t.row,"visible2",a)},expression:"scope.row.visible2"}},[s("p",{staticStyle:{"line-height":"1.5",padding:"10px 10px 20px"}},[e._v("确定删除该活动吗？")]),e._v(" "),s("div",{staticStyle:{"text-align":"right",margin:"0"}},[s("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.row.visible2=!1}}},[e._v("取消")]),e._v(" "),s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.deleteActive(t.row,t.$index)}}},[e._v("确定")])],1),e._v(" "),s("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除")])],1)],1)]}}])}),e._v(" "),s("template",{slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2)],e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length,expression:"tableData.length"}],staticClass:"pagination-conteiner"},[s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])],2)])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("满减送")])])}]};var Ps=a("VU/8")(Ts,Ds,!1,function(e){a("47Nh"),a("cXwZ")},"data-v-647b424f",null).exports,Fs={name:"newPrice",data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,fixedWidth:document.documentElement.clientWidth-200,getTimeAll:C.formatDate,pageTitle:"新建满减送",priceForm:{activityId:"",activityName:"",activityDescription:"",activeTime:[],proRule:1,proRelationType:1,discountValue:[{cost:"",reduce:"",limit:0,isUse:0,gift:[{giftType:1,proCode:"",giftId:"",giftName:"",isUse:0}]}],memberLabelType:1,fullType:1,proNum:0,checkedActivity:[],activityShare:[{type:400,isShare:1}]},rules:{activityName:[{required:!0,message:"请输入活动名称",trigger:"blur"}],activityDescription:[{required:!0,message:"请输入活动说明",trigger:"blur"}],activeTime:[{required:!0,message:"请选择日期",trigger:"blur"}]},activityNameLen:0,activityDescriptionLen:0,brandList:[],brandId:"",goodsClassifyList:[],goodsClassify:null,goodsCateIds:[],selectCateData:[],goodsShow:!1,goodIdStatus:!0,proNum:0,refash:!1,selectNum:0,defaltSelected:[],height:543,projectName:"mall",headerList:[],effectiveStatus:1,removeProIdsArr:[],addProIdsArr:[],pickerOptions:{},dialogVisible:!1,dialogForm:{},showList:!1,uploadData:{type:5,activityId:""},action:window.location.origin+"/api-mall/upload-goods-selected-goods?requestProject=mall",headersUpload:{sign:""},loading:!1,isImport:!1,importAddId:"",successNum:0,falseNum:0,importMess:!1,submitLoading:!1,importInfo:{dialogVisible:!1,infoList:[{reason:"货号在该品牌下面没有对应的商品",data:["ab","234234324"]},{reason:"货号在该品牌下面没有对应的商品",data:["ab"]}]},channel:0,peopleFilterInfo:"",searchBackTxt:"",conditionList:[],getSaveData:"",sceneValue:"member",useId:"",hasSearchData:"",operateType:!0,toggleTag:!1,saveTag:!1,usePeopleFilter:!1,searchParams:{},responseParams:[]}},mounted:function(){""!==this.searchBackTxt&&this.$refs.peopleFilter.getAbInfo(this.searchBackTxt)},created:function(){if(localStorage.getItem("addProIds")?(this.importAddId=localStorage.getItem("addProIds"),localStorage.removeItem("addProIds")):this.importAddId="",this.activityId=this.$route.params.activityId,localStorage.getItem("priceObj")){"-1"===this.activityId?this.pageTitle="新建满减送":this.pageTitle="编辑满减送",this.priceForm.activeTime=[];var e=JSON.parse(localStorage.getItem("priceObj"));this.priceForm=e.priceForm,this.brandId=e.brandId,this.goodsClassify=e.goodsClassify,this.goodsCateIds=e.goodsCateIds,this.selectCateData=e.selectCateData,this.priceForm.proRelationType=e.proRelationType,this.priceForm.memberLabelType=e.memberLabelType,this.defaltSelected=e.tagGroupList,this.removeProIdsArr=e.removeProIdsArr,this.addProIdsArr=e.addProIdsArr,this.uploadData.activityId=this.priceForm.activityId,this.proNum=e.proNum,this.selectNum=e.proNum,this.priceForm.proNum=this.proNum-e.removeProIdsArr.length+e.addProIdsArr.length,this.searchBackTxt=e.searchBackTxt,this.conditionList=e.conditionList,this.searchParams=e.searchParams,this.responseParams=e.responseParams,this.channel=e.channel,1===this.channel&&3===this.priceForm.memberLabelType&&this.getPeopleFilter(),this.priceForm.proNum>0?this.goodIdStatus=!1:this.goodIdStatus=!0,localStorage.removeItem("priceObj")}else if("-1"!==this.activityId)this.pageTitle="编辑满减送",this.getMess();else{this.pageTitle="新建满减送";var t=!0,a=!1,s=void 0;try{for(var i,r=b()(this.priceForm.activityShare);!(t=(i=r.next()).done);t=!0){var o=i.value;1===o.isShare&&this.priceForm.checkedActivity.push(o.type)}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}}},computed:{},methods:{changeTime:function(){this.priceForm.activeTime&&new Date(this.priceForm.activeTime[1]).valueOf()<new Date((new Date).toLocaleDateString()).valueOf()&&this.$message.error("结束时间不能小于当前时间！")},getMess:function(){var e=this,t={activityId:this.activityId};A.get("/api-mall/get-reduce-activity",{params:t}).then(function(t){if(0===t.data.errorCode){e.usePeopleFilter=!1,e.priceForm.activeTime=[],e.priceForm.activityName=t.data.result.activityName,e.priceForm.activityDescription=t.data.result.activityDescription,e.activityNameLen=C.getZhLen(e.priceForm.activityName),e.priceForm.activeTime.push(t.data.result.beginTime),e.priceForm.activeTime.push(t.data.result.endTime),e.priceForm.proRule=t.data.result.proRule,e.priceForm.discountValue=JSON.parse(t.data.result.discountValue),e.channel=t.data.result.channel,e.priceForm.memberLabelType=t.data.result.memberLabelType,e.searchParams=t.data.result.searchParams,3===e.priceForm.memberLabelType&&(""!==e.searchParams&&e.searchParams?1===e.channel&&3===e.priceForm.memberLabelType&&e.getPeopleFilter():e.$message.error("会员筛选为空"));var a=!0,s=!1,i=void 0;try{for(var r,o=b()(e.priceForm.discountValue);!(a=(r=o.next()).done);a=!0){var l=r.value;l.hasOwnProperty("isUse"),l.hasOwnProperty("isUse")||(l.isUse=1),l.hasOwnProperty("gift")||(l.gift=[{giftType:1,giftId:"",giftName:"",isUse:0,proCode:""}])}}catch(e){s=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw i}}e.priceForm.activityId=t.data.result.activityId,e.priceForm.proRelationType=t.data.result.proRelationType,3===e.priceForm.memberLabelType&&(e.useId=t.data.result.activityId,e.searchBackTxt=JSON.parse(t.data.result.searchParams),e.searchParams=t.data.result.searchParams,e.responseParams=t.data.result.responseParams,e.hasSearchData=t.data.result.searchParams),e.priceForm.fullType=t.data.result.fullType,e.uploadData.activityId=e.activityId;var n=!0,d=!1,c=void 0;try{for(var u,m=b()(e.priceForm.discountValue);!(n=(u=m.next()).done);n=!0){var p=u.value;if(p.isUse=1===p.isUse,p.gift){var h=!0,g=!1,v=void 0;try{for(var f,y=b()(p.gift);!(h=(f=y.next()).done);h=!0){var _=f.value;_.isUse=1===_.isUse,_.editStatus=!!_.giftId}}catch(e){g=!0,v=e}finally{try{!h&&y.return&&y.return()}finally{if(g)throw v}}}}}catch(e){d=!0,c=e}finally{try{!n&&m.return&&m.return()}finally{if(d)throw c}}if(1===e.priceForm.fullType){var I=!0,S=!1,w=void 0;try{for(var x,L=b()(e.priceForm.discountValue);!(I=(x=L.next()).done);I=!0){var k=x.value;k.limit=1===k.limit}}catch(e){S=!0,w=e}finally{try{!I&&L.return&&L.return()}finally{if(S)throw w}}}if(e.defaltSelected=t.data.result.tagGroupList,e.memberLabelType=t.data.result.memberLabelType,e.proNum=t.data.result.proNum,e.priceForm.proNum=t.data.result.proNum,t.data.result.tagGroupList?e.defaltSelected=t.data.result.tagGroupList:e.defaltSelected=[],e.priceForm.memberLabelType=t.data.result.memberLabelType,4===e.priceForm.proRelationType&&(e.goodsClassify=t.data.result.relationId.split(","),e.getClassifyList()),2===e.priceForm.proRelationType&&(e.brandId="-1"===t.data.result.brandId?"":t.data.result.brandId,e.getBrandList()),3===e.priceForm.proRelationType&&e.getCateMess(t.data.result.relationId),5===e.priceForm.proRelationType&&"-1"===e.$route.params.goodIds&&(e.goodIds=t.data.result.relationId),e.selectNum=t.data.result.proNum,t.data.result.proNum>0?e.goodIdStatus=!1:e.goodIdStatus=!0,e.priceForm.activityShare=JSON.parse(t.data.result.activityShare),e.priceForm.activityShare){var N=!0,T=!1,D=void 0;try{for(var P,F=b()(e.priceForm.activityShare);!(N=(P=F.next()).done);N=!0){var A=P.value;1===A.isShare&&e.priceForm.checkedActivity.push(A.type)}}catch(e){T=!0,D=e}finally{try{!N&&F.return&&F.return()}finally{if(T)throw D}}}}else e.$message.error(t.data.message)})},getPeopleFilter:function(){var e=this,t={params:this.searchParams};A.post("/api-plug/screening-show-back",_.a.stringify(t)).then(function(t){0===t.data.errorCode?e.peopleFilterInfo=t.data.result:e.$message.error(t.data.message)})},getCateMess:function(e){var t=this,a={categorys:e};A.get("/api-goods/list-categorys",{params:a}).then(function(e){0===e.data.errorCode?e.data.result?t.selectCateData=e.data.result:t.selectCateData=[]:t.$message.error(e.data.message)})},goodsType:function(){2===this.priceForm.proRelationType?this.getBrandList():4===this.priceForm.proRelationType&&this.getClassifyList()},activityNameLimit:function(e){var t=this;this.$nextTick(function(){t.priceForm.activityName=C.getInputVal(e,15),t.activityNameLen=C.getZhLen(t.priceForm.activityName)})},activityDescriptionLimit:function(e){var t=this;this.$nextTick(function(){t.priceForm.activityDescription=C.getInputVal(e,30),t.activityDescriptionLen=C.getZhLen(t.priceForm.activityDescription)})},getBrandList:function(){var e=this;A.get("/api-mall/list-enterprise-brand").then(function(t){0===t.data.errorCode?t.data.result?e.brandList=t.data.result:e.brandList=[]:e.$message.error(t.data.message)})},getClassifyList:function(){var e=this;A.get("/api-mall/list_mall_goods_tag_tree").then(function(t){0===t.data.errorCode?(e.goodsClassifyList.push({childTagList:t.data.result.childTagList,mallProTagId:t.data.result.mallProTagId,tagName:t.data.result.tagName}),e.getTree(e.goodsClassifyList)):e.$message.error(t.data.message)})},getTree:function(e){for(var t in e)e[t].label=e[t].tagName,e[t].id=e[t].mallProTagId,e[t].children=e[t].childTagList,e[t].children?this.getTree(e[t].children):delete e[t].children},getCateIds:function(e){this.searchId=e,e.length||(this.selectCateData=[])},hideDrag:function(){var e=this;this.$nextTick(function(){e.$refs.modal&&e.$refs.modal.showDrag&&(e.$refs.modal.showDrag=!1)})},changeFullType:function(){this.priceForm.discountValue=[{cost:"",reduce:"",isUse:!1,gift:[{giftType:1,giftId:"",giftName:"",isUse:!1}]}]},compareNum:function(e,t){var a=this;return e!==this.priceForm.discountValue.length-1&&Number(t.cost)>=Number(this.priceForm.discountValue[e+1].cost)?(this.$message.error("不可大于下一个阶段折扣件数"),this.$nextTick(function(){t.cost=a.priceForm.discountValue[e+1].cost-1}),!1):(Number(t.cost)<=0&&(this.$message.error("满减件数不可为0"),t.cost=0),0!==e&&Number(t.cost)<=Number(this.priceForm.discountValue[e-1].cost)?(this.$message.error("不可小于上一个阶段折扣件数"),this.$nextTick(function(){t.cost=a.priceForm.discountValue[e-1].cost+1}),!1):0===e&&0===Number(t.cost)?(this.$message.error("不可设置为0"),1!==this.priceForm.discountValue.length?this.$nextTick(function(){t.cost=a.priceForm.discountValue[1].cost-1}):this.$nextTick(function(){t.cost=1}),!1):void 0)},compareDiscount:function(e,t){var a=this;return e!==this.priceForm.discountValue.length-1&&Number(t.reduce)<=Number(this.priceForm.discountValue[e+1].reduce)?(this.$message.error("不可大于下一个阶段折扣"),this.$nextTick(function(){t.reduce=a.priceForm.discountValue[e+1].reduce+1}),!1):(Number(t.reduce)<=0&&(this.$message.error("折扣不可为0"),this.$nextTick(function(){t.reduce=0})),0!==e&&Number(t.reduce)>=Number(this.priceForm.discountValue[e-1].reduce)?(this.$message.error("不可小于上一个阶段折扣"),0===Number(this.priceForm.discountValue[e-1].reduce)?this.$nextTick(function(){t.reduce=""}):this.$nextTick(function(){t.reduce=a.priceForm.discountValue[e-1].reduce-1}),!1):e===this.priceForm.discountValue.length-1&&(Number(t.reduce)>=10||Number(t.reduce)<=0)?(this.$message.error("折扣设置不合理"),1!==this.priceForm.discountValue.length?this.$nextTick(function(){t.reduce=0}):this.$nextTick(function(){t.reduce=9}),!1):void 0)},compareReduceNum:function(e,t){var a=this;return Number(t.cost)<=0&&(this.$message.error("满减金额不可为0"),t.cost=0),Number(t.reduce)>Number(t.cost)&&(this.$message.error("满减不能大于商品的价格"),this.$nextTick(function(){t.cost=t.reduce+1})),0!==e&&Number(t.cost)<=Number(this.priceForm.discountValue[e-1].cost)?(this.$message.error("不可小于上一个阶段"),this.$nextTick(function(){t.cost=a.priceForm.discountValue[e-1].cost+1}),!1):e!==this.priceForm.discountValue.length-1&&Number(t.cost)>=Number(this.priceForm.discountValue[e+1].cost)?(this.$message.error("不可大于下一个阶段"),this.$nextTick(function(){t.cost=a.priceForm.discountValue[e+1].cost-1}),!1):void 0},compareReduce:function(e,t){var a=this;return Number(t.cost)<=0&&(this.$message.error("满减金额不可为0"),t.cost=0),Number(t.reduce)>Number(t.cost)&&(this.$message.error("满减不能大于商品的价格"),this.$nextTick(function(){t.reduce=0})),0!==e&&Number(t.reduce)<=Number(this.priceForm.discountValue[e-1].reduce)?(this.$message.error("不可小于上一个阶段"),this.$nextTick(function(){t.reduce=a.priceForm.discountValue[e-1].reduce+1}),!1):e!==this.priceForm.discountValue.length-1&&Number(t.reduce)>=Number(this.priceForm.discountValue[e+1].reduce)?(this.$message.error("不可大于下一个阶段"),this.$nextTick(function(){t.reduce=a.priceForm.discountValue[e+1].reduce-1}),!1):void 0},deleteTiePrice:function(e,t){this.priceForm.discountValue.splice(e,1),t.visible2=!1},deleteTiePrice1:function(e,t){this.priceForm.discountValue.splice(e,1),t.visible1=!1},addReducePrice:function(){if(this.priceForm.discountValue.length>=10)return this.$message.error("最多添加5级"),!1;1===this.priceForm.fullType?this.priceForm.discountValue.push({cost:this.priceForm.discountValue[this.priceForm.discountValue.length-1].cost+1,reduce:0,limit:0,gift:[{giftType:1,giftId:"",giftName:"",isUse:!1}]}):2===this.priceForm.fullType&&this.priceForm.discountValue.push({cost:this.priceForm.discountValue[this.priceForm.discountValue.length-1].cost+1,reduce:0,gift:[{giftType:1,giftId:"",giftName:"",isUse:!1}]})},goList:function(){localStorage.removeItem("priceObj"),this.$router.push({name:"reduceDiscountList"})},selectPieceGoods:function(){if(3===this.priceForm.memberLabelType&&this.toggleTag&&!this.getSaveData)return this.$message.error("请选中人群筛选器的数据"),!1;this.usePeopleFilter&&this.$refs.peopleFilter.saveSelectData();var e=!0,t=!1,a=void 0;try{for(var s,i=b()(this.priceForm.discountValue);!(e=(s=i.next()).done);e=!0){var r=s.value;r.visible2=!1,r.visible1=!1}}catch(e){t=!0,a=e}finally{try{!e&&i.return&&i.return()}finally{if(t)throw a}}"-1"===this.activityId&&(this.priceForm.proNum=0);var o={priceForm:this.priceForm,proNum:this.proNum,brandId:this.brandId,goodsClassify:this.goodsClassify,goodsCateIds:this.goodsCateIds,selectCateData:this.selectCateData,proRelationType:this.priceForm.proRelationType,memberLabelType:this.priceForm.memberLabelType,tagGroupList:this.defaltSelected,importAddId:this.importAddId,removeProIdsArr:this.removeProIdsArr,addProIdsArr:this.addProIdsArr,searchBackTxt:this.searchBackTxt,conditionList:this.conditionList,searchParams:this.searchParams,responseParams:this.responseParams,channel:this.channel};window.localStorage.setItem("priceObj",O()(o)),this.isImport=!1,this.$router.push({name:"selectGoods",params:{activityId:this.activityId,selectNum:this.selectNum}})},handleDataTransferred:function(e){this.defaltSelected=e},handleDataLeft:function(e,t){this.defaltSelected=e},changeCheck:function(e){if(0===this.priceForm.checkedActivity.length){var t=!0,a=!1,s=void 0;try{for(var i,r=b()(this.priceForm.activityShare);!(t=(i=r.next()).done);t=!0){i.value.isShare=0}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}}var o=!0,l=!1,n=void 0;try{for(var d,c=b()(this.priceForm.activityShare);!(o=(d=c.next()).done);o=!0){var u=d.value;-1===this.priceForm.checkedActivity.indexOf(u.type)?u.isShare=0:u.isShare=1}}catch(e){l=!0,n=e}finally{try{!o&&c.return&&c.return()}finally{if(l)throw n}}},uploadDialogVisible:function(){this.dialogVisible=!0,this.importMess=!1},downloadFile:function(){window.open("static/满减送活动商品导入模板.xlsx")},uploadFileBefore:function(e){return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!==e.type&&"application/vnd.ms-excel"!==e.type?(this.$message.error("文件格式错误，请导入.xlsx .csv格式的文件"),!1):e.size>5242880?(this.$message.error("请上传小于5MB的文件"),!1):(localStorage.getItem("sign")?this.headersUpload.sign=localStorage.getItem("sign"):this.headersUpload.sign="",this.loading=!0,void(this.fileName=e.name))},uploadFile:function(e,t){this.loading=!0,0===e.errorCode?(this.loading=!1,this.isImport=!0,this.importAddId?this.importAddId=this.importAddId+","+e.result.selectedProIds:this.importAddId=e.result.selectedProIds,this.uploadData.activityId=e.result.activityId,this.priceForm.activityId=e.result.activityId,this.successNum=e.result.successNum,this.falseNum=e.result.falseNum,this.priceForm.proNum=this.priceForm.proNum+e.result.successNum,0!==this.proNum?this.proNum=this.proNum+e.result.successNum:this.proNum=e.result.successNum,e.result.failDetail?this.importInfo.infoList=e.result.failDetail:this.importInfo.infoList=[],this.selectNum=e.result.successNum,window.localStorage.setItem("addProIds",this.importAddId),this.importMess=!0,this.priceForm.proNum>0?this.goodIdStatus=!1:this.goodIdStatus=!0,this.activityId=e.result.activityId):(this.loading=!1,this.$message.error(e.message))},showInfo:function(){this.importInfo.dialogVisible=!0},changeUpDate:function(){this.refash=!this.refash},changeUpDate2:function(e){this.refash=!this.refash},confirmGift:function(e){var t=this;if(""===e.proCode||!e.hasOwnProperty("proCode"))return this.$message.error("请填写商品货号"),!1;var a={proCode:e.proCode};A.post("/api-mall/get-free-pro",_.a.stringify(a)).then(function(a){0===a.data.errorCode&&a.data.result?(t.refash=!t.refash,e.editStatus=!0,e.giftId=a.data.result.proId,e.giftName=a.data.result.proName):t.$message.error(a.data.message)})},cancelGift:function(e){e.giftId?(e.proCode="",e.editStatus=!0):this.$nextTick(function(){e.giftId="",e.giftName="",e.proCode=""}),this.refash=!this.refash},EditGiftName:function(e){this.refash=!this.refash,e.editStatus=!1},submitActive:function(e){var t=this;if(this.priceForm.activeTime&&new Date(this.priceForm.activeTime[1]).valueOf()<new Date((new Date).toLocaleDateString()).valueOf())return this.$message.error("结束时间小能大于当前时间！"),!1;if(3===this.priceForm.memberLabelType&&this.toggleTag&&!this.getSaveData)return this.$message.error("请选中人群筛选器的数据"),!1;var a={activityId:"-1"===this.activityId?"":this.activityId,activityName:this.priceForm.activityName,activityDescription:this.priceForm.activityDescription,beginTime:this.priceForm.activeTime?this.getTimeAll(this.priceForm.activeTime[0]):"",endTime:this.priceForm.activeTime?this.getTimeAll(this.priceForm.activeTime[1]):"",proRule:this.priceForm.proRule,discountValue:[],proRelationType:this.priceForm.proRelationType,addProIdsStr:"",removeProIdsStr:"",brandId:this.brandId,activityGroupList:[{storeTags:[],mallActivityGroupId:"-1",sort:1}],memberLabelType:this.priceForm.memberLabelType,fullType:this.priceForm.fullType,activityShare:O()(this.priceForm.activityShare),searchParams:this.searchParams,responseParams:this.responseParams};if(3===this.priceForm.proRelationType){var s=[],i=!0,r=!1,o=void 0;try{for(var l,n=b()(this.selectCateData);!(i=(l=n.next()).done);i=!0){var d=l.value;s.push(d.categoryId)}}catch(e){r=!0,o=e}finally{try{!i&&n.return&&n.return()}finally{if(r)throw o}}a.relationId=s===[]?"":s.join(",")}else if(4===this.priceForm.proRelationType)a.relationId=this.goodsClassify?this.goodsClassify.join(","):"";else if(5===this.priceForm.proRelationType){var c=[],u=[];if(0===this.addProIdsArr.length)c=[];else{var m=!0,p=!1,h=void 0;try{for(var g,v=b()(this.addProIdsArr);!(m=(g=v.next()).done);m=!0){var f=g.value;c.push(f.mallProId)}}catch(e){p=!0,h=e}finally{try{!m&&v.return&&v.return()}finally{if(p)throw h}}}if(0===this.removeProIdsArr.length)u=[];else{var y=!0,_=!1,C=void 0;try{for(var I,S=b()(this.removeProIdsArr);!(y=(I=S.next()).done);y=!0){var w=I.value;u.push(w.mallProId)}}catch(e){_=!0,C=e}finally{try{!y&&S.return&&S.return()}finally{if(_)throw C}}}a.removeProIdsStr=u.join(","),""!==this.importAddId?a.addProIdsStr=c.join(",")+","+this.importAddId:a.addProIdsStr=c.join(",")}this.$refs[e].validate(function(e){for(var s in t.priceForm.discountValue){if(0===t.priceForm.discountValue[s].cost||0===t.priceForm.discountValue[s].reduce&&t.priceForm.discountValue[s].isUse)return t.$message.error("请填写正确的优惠条件"),!1;if(!t.priceForm.discountValue[s].cost||!t.priceForm.discountValue[s].reduce&&t.priceForm.discountValue[s].isUse)return t.$message.error("阶梯价设置不可为空"),!1;if(!t.priceForm.discountValue[s].isUse&&!t.priceForm.discountValue[s].gift[0].isUse)return t.$message.error("请填写正确的优惠条件"),!1}if(2===t.priceForm.memberLabelType&&t.defaltSelected.length<1)return t.$message.error("请选择会员分组"),!1;if(!t.priceForm.memberLabelType)return t.$message.error("请选择适用对象"),!1;var i=void 0;if(2===t.priceForm.memberLabelType){i=[];var r=!0,o=!1,l=void 0;try{for(var n,d=b()(t.defaltSelected);!(r=(n=d.next()).done);r=!0){var c=n.value;i.push(c.memberTagGroupId)}}catch(e){o=!0,l=e}finally{try{!r&&d.return&&d.return()}finally{if(o)throw l}}a.memberLabelId=i.join(","),t.searchParams="",t.responseParams=""}else 1===t.priceForm.memberLabelType?(a.memberLabelId="",t.searchParams="",t.responseParams=""):3===t.priceForm.memberLabelType&&(a.memberLabelId="");if(2===t.priceForm.proRelationType&&""===t.brandId)return t.$message.error("请选择商品品牌"),!1;if(3===t.priceForm.proRelationType&&""===a.relationId)return t.$message.error("请选择商品品类"),!1;if(4===t.priceForm.proRelationType&&""===a.relationId)return t.$message.error("请选择商品分类"),!1;if(5===t.priceForm.proRelationType&&t.priceForm.proNum<=0)return t.$message.error("请选择商品"),!1;var u=[],m=he(t.priceForm.discountValue),p=!0,h=!1,g=void 0;try{for(var v,f=b()(m);!(p=(v=f.next()).done);p=!0){var y=v.value;y.limit=y.limit?1:0,y.isUse=y.isUse?1:0;var _=[],C=!0,I=!1,S=void 0;try{for(var w,x=b()(y.gift);!(C=(w=x.next()).done);C=!0){var L=w.value;if(L.isUse&&1===L.giftType&&""===L.giftId)return t.$message.error("请选择赠品"),!1;_.push({giftType:L.giftType,giftId:L.isUse?L.giftId:"",giftName:L.isUse?L.giftName:"",isUse:L.isUse?1:0}),y.gift=_}}catch(e){I=!0,S=e}finally{try{!C&&x.return&&x.return()}finally{if(I)throw S}}u.push({cost:y.cost,reduce:y.reduce,limit:1===t.priceForm.fullType?y.limit:"-1",isUse:y.isUse,gift:y.gift})}}catch(e){h=!0,g=e}finally{try{!p&&f.return&&f.return()}finally{if(h)throw g}}if(a.discountValue=u,t.submitLoading=!0,!e)return t.submitLoading=!1,!1;A.post("/api-mall/create-reduce-activity",a).then(function(e){0===e.data.errorCode?(t.$message.success("保存成功"),localStorage.removeItem("priceObj"),window.localStorage.removeItem("addProIds"),t.$router.push({name:"reduceDiscountList"}),t.submitLoading=!1):(t.$message.error(e.data.message),t.submitLoading=!1)})})},getData:function(){this.$refs.peopleFilter.confirmSet(),this.usePeopleFilter=!0},findFilter:function(e){this.searchParams=e},cancelFilter:function(){this.$refs.peopleFilter.cancelSet()},getBackData:function(e){this.responseParams=e,this.getSaveData=e},editShow:function(){this.toggleTag=!0,this.saveTag=!1},editHide:function(){this.toggleTag=!1,this.saveTag=!0},hideBtn:function(e){0===e&&(this.memberSearchStr=-1,this.toggleTag=!1)}},components:{Treeselect:ce.a,goodsCatediff:Ya,importInfo:Ye}},As={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"},on:{click:function(t){return t.stopPropagation(),e.hideDrag(t)}}},[a("div",{staticClass:"mall-content-section"},[a("div",{staticClass:"mall-content-title"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),a("el-breadcrumb-item",[e._v("促销活动")]),e._v(" "),a("el-breadcrumb-item",{attrs:{to:{path:"/reduceDiscountList"}}},[e._v("满减送")]),e._v(" "),a("el-breadcrumb-item",[e._v(e._s(e.pageTitle))])],1),e._v(" "),a("h3",[a("span",[e._v(e._s(e.pageTitle))])])],1),e._v(" "),a("div",{staticClass:"mall-section"},[a("el-form",{ref:"priceForm",staticClass:"demo-ruleForm",attrs:{model:e.priceForm,rules:e.rules,"label-width":"130px","label-position":"right"}},[a("div",{staticClass:"el-form-group"},[a("h3",[e._v("活动信息")]),e._v(" "),a("el-form-item",{attrs:{label:"活动名称",prop:"activityName"}},[a("el-input",{staticClass:"width-600",on:{input:function(t){return e.activityNameLimit(t)}},model:{value:e.priceForm.activityName,callback:function(t){e.$set(e.priceForm,"activityName",t)},expression:"priceForm.activityName"}},[a("span",{attrs:{slot:"suffix"},slot:"suffix"},[e._v(e._s(e.activityNameLen)+"/15")])])],1),e._v(" "),a("el-form-item",{attrs:{label:"活动说明",prop:"activityDescription"}},[a("el-input",{staticClass:"width-600",attrs:{type:"textarea",rows:3,placeholder:"请输入内容"},on:{input:e.activityDescriptionLimit},model:{value:e.priceForm.activityDescription,callback:function(t){e.$set(e.priceForm,"activityDescription",t)},expression:"priceForm.activityDescription"}}),e._v(" "),a("span",{staticClass:"input-position"},[e._v(e._s(e.activityDescriptionLen)+"/50")])],1),e._v(" "),a("el-form-item",{attrs:{label:"活动时间",prop:"activeTime"}},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},on:{change:e.changeTime},model:{value:e.priceForm.activeTime,callback:function(t){e.$set(e.priceForm,"activeTime",t)},expression:"priceForm.activeTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"适用对象",required:""}},[[a("el-radio",{attrs:{label:1},model:{value:e.priceForm.memberLabelType,callback:function(t){e.$set(e.priceForm,"memberLabelType",t)},expression:"priceForm.memberLabelType"}},[e._v("全部会员")]),e._v(" "),a("el-radio",{attrs:{label:2},model:{value:e.priceForm.memberLabelType,callback:function(t){e.$set(e.priceForm,"memberLabelType",t)},expression:"priceForm.memberLabelType"}},[e._v("会员分组")]),e._v(" "),a("el-radio",{attrs:{label:3},model:{value:e.priceForm.memberLabelType,callback:function(t){e.$set(e.priceForm,"memberLabelType",t)},expression:"priceForm.memberLabelType"}},[e._v("会员筛选")])]],2),e._v(" "),2===e.priceForm.memberLabelType?a("div",{staticStyle:{margin:"-30px 0 0 100px",width:"856px"}},[a("vue-gic-member-group",{attrs:{defaltSelected:e.defaltSelected,headerList:e.headerList,height:e.height,projectName:e.projectName,effectiveStatus:e.effectiveStatus},on:{handleDataTransferred:e.handleDataTransferred,handleDataLeft:e.handleDataLeft}})],1):e._e(),e._v(" "),3===e.priceForm.memberLabelType?a("div",{staticClass:"fiter-class-container"},[0===e.channel?a("div",[a("vue-gic-people",{ref:"peopleFilter",attrs:{projectName:e.projectName,isAdd:e.isAdd,searchBackTxt:e.searchBackTxt,conditionList:e.conditionList,triggerReset:!0,useId:e.useId,hasSearchData:e.hasSearchData,sceneValue:e.sceneValue},on:{"update:searchBackTxt":function(t){e.searchBackTxt=t},"update:conditionList":function(t){e.conditionList=t},findFilter:e.findFilter,getBackData:e.getBackData,editHide:e.editHide,editShow:e.editShow,hideBtn:e.hideBtn}}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.toggleTag,expression:"toggleTag"}],staticClass:"gic-people--button"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.getData}},[e._v("确 定")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.cancelFilter}},[e._v("取 消")])],1)],1):e._e(),e._v(" "),a("el-popover",{attrs:{placement:"top-start",width:"400",trigger:"hover",content:e.searchParams}},[a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v(e._s(e.peopleFilterInfo))])],1)],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"活动类型",required:""}},[a("el-radio-group",{on:{change:e.changeFullType},model:{value:e.priceForm.fullType,callback:function(t){e.$set(e.priceForm,"fullType",t)},expression:"priceForm.fullType"}},[a("el-radio",{attrs:{label:1}},[e._v("满金额")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("满件数")])],1)],1),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:2===e.priceForm.fullType,expression:"priceForm.fullType === 2"}],staticClass:"goods-tip"},[e._v("商品计算规则")]),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2===e.priceForm.fullType,expression:"priceForm.fullType === 2"}],staticStyle:{"vertical-align":"middle",position:"relative",display:"inline-block"},attrs:{required:"","label-width":"20px"}},[a("el-popover",{staticClass:"tip-mol",staticStyle:{"margin-left":"-10px"},attrs:{placement:"right",width:"400",trigger:"hover"}},[a("p",[e._v("设置购买数量是否限制为单商品：")]),e._v(" "),a("p",[e._v("如：优惠设置了满2件8折，商品规则为商品池，则用户购买活动商品中的A和B，即满足8折的优惠条件；若商品设置为单商品，则用户购买A和B，不满足8折的优惠条件，需购买2件A才符合8折的优惠条件。")]),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[a("i",{staticClass:"iconfont icon-xinxixianshi"})])],1),e._v(" "),[a("el-radio",{attrs:{label:1},model:{value:e.priceForm.proRule,callback:function(t){e.$set(e.priceForm,"proRule",t)},expression:"priceForm.proRule"}},[e._v("商品池")]),e._v(" "),a("el-radio",{attrs:{label:2},model:{value:e.priceForm.proRule,callback:function(t){e.$set(e.priceForm,"proRule",t)},expression:"priceForm.proRule"}},[e._v("单商品")])]],2)],1),e._v(" "),a("div",{staticClass:"el-form-group"},[a("h3",{staticStyle:{"margin-bottom":"8px"}},[e._v("优惠设置")]),e._v(" "),a("div",{staticClass:"title-tip"},[a("i",{staticClass:"el-icon-info"}),e._v(" "),a("span",[e._v("当设置多层优惠时，请以逐级递增的形式进行设置，如设置5层优惠，系统检测顺序为5-4-3-2-1")])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1===e.priceForm.fullType,expression:"priceForm.fullType === 1"}]},[a("div",{staticClass:"tier-table-content"},e._l(e.priceForm.discountValue,function(t,s){return a("div",{key:s,staticClass:"tier-table"},[a("div",{staticClass:"tier-table-header"},[e._v("优惠层级"+e._s(s+1))]),e._v(" "),a("div",{staticClass:"tier-table-tbody"},[a("div",{staticClass:"tier-table-item"},[a("el-form-item",{attrs:{"label-position":"left","label-width":"110px"}},[a("span",{staticClass:"item1"},[e._v("优惠条件")]),e._v(" "),a("span",{staticClass:"item2"},[e._v("满")]),e._v(" "),a("el-input-number",{staticClass:"w-120",attrs:{"controls-position":"right",precision:0},on:{change:function(a){e.compareReduceNum(s,t)}},model:{value:t.cost,callback:function(a){e.$set(t,"cost",a)},expression:"item.cost"}}),e._v(" "),a("span",{staticClass:"item3"},[e._v("元")])],1)],1),e._v(" "),a("div",{staticClass:"tier-table-item"},[a("el-form-item",{attrs:{"label-position":"left","label-width":"110px"}},[a("div",[a("span",{staticClass:"item1"},[e._v("优惠内容")]),e._v(" "),a("el-checkbox",{staticClass:"item2",on:{change:e.changeUpDate},model:{value:t.isUse,callback:function(a){e.$set(t,"isUse",a)},expression:"item.isUse"}}),e._v(" "),a("span",{staticClass:"item2"},[e._v("减")]),e._v(" "),a("el-input-number",{staticClass:"w-120",attrs:{"controls-position":"right",precision:2},on:{change:function(a){e.compareReduce(s,t)}},model:{value:t.reduce,callback:function(a){e.$set(t,"reduce",a)},expression:"item.reduce"}}),e._v(" "),a("span",{staticClass:"item3"},[e._v("元")])],1),e._v(" "),e._l(t.gift,function(t,s){return a("div",{key:s,staticStyle:{"margin-left":"100px","margin-top":"10px"}},[a("div",[a("el-checkbox",{staticClass:"item2",on:{change:function(a){e.changeUpDate2(t)}},model:{value:t.isUse,callback:function(a){e.$set(t,"isUse",a)},expression:"itm.isUse"}},[e._v("送赠品")]),e._v(" "),t.isUse?a("div",{staticClass:"gift-name"},[t.editStatus?a("div",[a("el-button",{staticClass:"item2",attrs:{type:"text"}},[e._v(e._s(t.giftName))]),e._v(" "),t.giftName?a("i",{staticClass:"el-icon-edit",on:{click:function(a){e.EditGiftName(t)}}}):e._e()],1):a("div",{staticClass:"gift-name-input"},[a("el-input",{staticClass:"send-goods",attrs:{placeholder:"请填写商品货号"},on:{input:e.changeUpDate},model:{value:t.proCode,callback:function(a){e.$set(t,"proCode",a)},expression:"itm.proCode"}}),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){e.confirmGift(t)}}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){e.cancelGift(t)}}},[e._v("取消")])],1)]):e._e()],1),e._v(" "),a("p",{staticClass:"warm-tip"},[e._v("如需使用赠品功能，请选联系品牌项目经理将小程序升级到最新版")])])})],2)],1),e._v(" "),a("div",{staticStyle:{"vertical-align":"middle","line-height":"32px","margin-left":"40px"}},[a("el-checkbox",{on:{change:function(a){e.changeUpDate(t)}},model:{value:t.limit,callback:function(a){e.$set(t,"limit",a)},expression:"item.limit"}},[a("span",[e._v("上不封顶")]),e._v(" "),a("el-popover",{staticClass:"tip-mol",staticStyle:{left:"85px",top:"5px"},attrs:{placement:"right",width:"400",trigger:"hover"}},[a("p",[e._v("若设置上不封顶，则优惠金额会随着满减金额而翻倍")]),e._v(" "),a("p",[e._v("如：设置满减金额为100元减20元且上不封顶，则买家购买总金额为200元时，可优惠40元")]),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[a("i",{staticClass:"iconfont icon-xinxixianshi"})])],1)],1)],1),e._v(" "),a("div",{staticClass:"tier-table-item operate-btn",staticStyle:{"margin-left":"100px"}},[a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:t.visible1,callback:function(a){e.$set(t,"visible1",a)},expression:"item.visible1"}},[a("p",{staticStyle:{"line-height":"1.5",padding:"10px"}},[e._v("确定要删除吗？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.visible1=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.deleteTiePrice1(s,t)}}},[e._v("确定")])],1),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除")])],1)],1)])])})),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.priceForm.discountValue.length<10,expression:"priceForm.discountValue.length < 10"}],staticClass:"add-num",on:{click:e.addReducePrice}},[a("i",{staticClass:"el-icon-plus"}),e._v(" "),a("el-button",{staticClass:"add-text",attrs:{type:"text"}},[e._v("添加优惠层级")]),e._v(" "),a("span",{staticClass:"add-tip"},[e._v("最多可设置10级 （每级优惠不叠加）")])],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:2===e.priceForm.fullType,expression:"priceForm.fullType === 2"}]},[a("div",{staticClass:"tier-table-content"},e._l(e.priceForm.discountValue,function(t,s){return a("div",{key:s,staticClass:"tier-table"},[a("div",{staticClass:"tier-table-header"},[e._v("优惠层级"+e._s(s+1))]),e._v(" "),a("div",{staticClass:"tier-table-tbody"},[a("div",{staticClass:"tier-table-item"},[a("el-form-item",{attrs:{"label-position":"left"}},[a("span",{staticClass:"item1"},[e._v("优惠条件")]),e._v(" "),a("span",{staticClass:"item2"},[e._v("满")]),e._v(" "),a("el-input-number",{staticClass:"w-120",attrs:{"controls-position":"right",precision:0},on:{change:function(a){e.compareNum(s,t)}},model:{value:t.cost,callback:function(a){e.$set(t,"cost",a)},expression:"item.cost"}}),e._v(" "),a("span",{staticClass:"item3"},[e._v("件")])],1)],1),e._v(" "),a("div",{staticClass:"tier-table-item"},[a("el-form-item",{attrs:{"label-position":"left"}},[a("div",[a("span",{staticClass:"item1"},[e._v("优惠内容")]),e._v(" "),a("el-checkbox",{staticClass:"item2",on:{change:e.changeUpDate},model:{value:t.isUse,callback:function(a){e.$set(t,"isUse",a)},expression:"item.isUse"}}),e._v(" "),a("span",{staticClass:"item2"},[e._v("打")]),e._v(" "),a("el-input-number",{staticClass:"w-120",attrs:{"controls-position":"right",precision:2},on:{change:function(a){e.compareDiscount(s,t)}},model:{value:t.reduce,callback:function(a){e.$set(t,"reduce",a)},expression:"item.reduce"}}),e._v(" "),a("span",{staticClass:"item3"},[e._v("折")])],1),e._v(" "),e._l(t.gift,function(t,s){return a("div",{key:s,staticStyle:{"margin-left":"100px","margin-top":"10px"}},[a("div",[a("el-checkbox",{staticClass:"item2",on:{change:function(a){e.changeUpDate2(t)}},model:{value:t.isUse,callback:function(a){e.$set(t,"isUse",a)},expression:"itm.isUse"}},[e._v("送赠品")]),e._v(" "),t.isUse?a("div",{staticClass:"gift-name"},[t.editStatus?a("div",[a("el-button",{staticClass:"item2",attrs:{type:"text"}},[e._v(e._s(t.giftName))]),e._v(" "),t.giftName?a("i",{staticClass:"el-icon-edit",on:{click:function(a){e.EditGiftName(t)}}}):e._e()],1):a("div",{staticClass:"gift-name-input"},[a("el-input",{staticClass:"send-goods",attrs:{placeholder:"请填写商品货号"},on:{input:e.changeUpDate},model:{value:t.proCode,callback:function(a){e.$set(t,"proCode",a)},expression:"itm.proCode"}}),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){e.confirmGift(t)}}},[e._v("确定")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){e.cancelGift(t)}}},[e._v("取消")])],1)]):e._e()],1),e._v(" "),a("p",{staticClass:"warm-tip"},[e._v("如需使用赠品功能，请选联系品牌项目经理将小程序升级到最新版")])])})],2)],1),e._v(" "),a("div",{staticClass:"tier-table-item operate-btn",staticStyle:{"margin-left":"100px"}},[a("el-popover",{attrs:{placement:"top",width:"160"},model:{value:t.visible2,callback:function(a){e.$set(t,"visible2",a)},expression:"item.visible2"}},[a("p",{staticStyle:{"line-height":"1.5",padding:"10px"}},[e._v("确定要删除该阶梯价吗？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.visible2=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.deleteTiePrice(s,t)}}},[e._v("确定")])],1),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除")])],1)],1)])])})),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.priceForm.discountValue.length<10,expression:"priceForm.discountValue.length < 10"}],staticClass:"add-num",on:{click:e.addReducePrice}},[a("i",{staticClass:"el-icon-plus"}),e._v(" "),a("el-button",{staticClass:"add-text",attrs:{type:"text"}},[e._v("添加优惠层级")]),e._v(" "),a("span",{staticClass:"add-tip"},[e._v("最多可设置10级 （每级优惠不叠加）")])],1)]),e._v(" "),a("span",{staticClass:"goods-tip",staticStyle:{"line-height":"42px"}},[e._v("优惠共享")]),e._v(" "),a("el-form-item",{staticStyle:{"vertical-align":"middle",position:"relative",display:"inline-block"},attrs:{required:"","label-width":"20px"}},[a("el-popover",{staticClass:"tip-mol",staticStyle:{"margin-left":"-10px",top:"5px"},attrs:{placement:"right",width:"400",trigger:"hover"}},[a("p",[e._v("买家下单时仅可与勾选的活动类型叠加使用")]),e._v(" "),a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[a("i",{staticClass:"iconfont icon-xinxixianshi"})])],1),e._v(" "),a("div",{staticStyle:{display:"inline-block"}},[a("el-checkbox-group",{model:{value:e.priceForm.checkedActivity,callback:function(t){e.$set(e.priceForm,"checkedActivity",t)},expression:"priceForm.checkedActivity"}},e._l(e.priceForm.activityShare,function(t){return a("el-checkbox",{key:t.type,attrs:{label:t.type},on:{change:function(a){e.changeCheck(t)}}},[400===t.type?a("span",[e._v("会员折扣")]):501===t.type?a("span",[e._v("折扣活动")]):502===t.type?a("span",[e._v("满立减活动")]):503===t.type?a("span",[e._v("包邮活动")]):504===t.type?a("span",[e._v("阶梯价活动")]):e._e()])}))],1),e._v(" "),a("span",{staticClass:"activiti-tip",staticStyle:{display:"inline-block","vertical-align":"bottom"}},[e._v("其他未列入的活动默认可叠加，待后续迭代功能")])],1)],1),e._v(" "),a("div",{staticClass:"el-form-group"},[a("h3",[e._v("选择活动商品")]),e._v(" "),a("el-form-item",{attrs:{label:"活动商品范围",required:""}},[a("el-select",{attrs:{placeholder:"请选择活动区域"},on:{change:e.goodsType},model:{value:e.priceForm.proRelationType,callback:function(t){e.$set(e.priceForm,"proRelationType",t)},expression:"priceForm.proRelationType"}},[a("el-option",{attrs:{label:"所有商品",value:1}}),e._v(" "),a("el-option",{attrs:{label:"按商品品牌",value:2}}),e._v(" "),a("el-option",{attrs:{label:"按商品品类",value:3}}),e._v(" "),a("el-option",{attrs:{label:"按商品分类",value:4}}),e._v(" "),a("el-option",{attrs:{label:"按单个商品",value:5}})],1),e._v(" "),a("div",{staticClass:"goods-select"},[a("el-select",{directives:[{name:"show",rawName:"v-show",value:2===e.priceForm.proRelationType,expression:"priceForm.proRelationType === 2"}],staticClass:"w-200",attrs:{clearable:"",placeholder:"请选择"},model:{value:e.brandId,callback:function(t){e.brandId=t},expression:"brandId"}},e._l(e.brandList,function(e,t){return a("el-option",{key:t,attrs:{label:e.brandName,value:e.brandId}})})),e._v(" "),a("goodsCatediff",{directives:[{name:"show",rawName:"v-show",value:3==e.priceForm.proRelationType,expression:"priceForm.proRelationType == 3"}],ref:"modal",attrs:{selectCateData:e.selectCateData},on:{getCateIds:e.getCateIds}}),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:4==e.priceForm.proRelationType,expression:"priceForm.proRelationType == 4"}]},[a("treeselect",{staticClass:"tree-select",staticStyle:{width:"400px"},attrs:{multiple:!0,options:e.goodsClassifyList,placeholder:"选择分类","disable-branch-nodes":!0},model:{value:e.goodsClassify,callback:function(t){e.goodsClassify=t},expression:"goodsClassify"}})],1),e._v(" "),a("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refash))]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:5===e.priceForm.proRelationType,expression:"priceForm.proRelationType === 5"}],staticClass:"w-200",on:{click:e.selectPieceGoods}},[e._v(e._s(e.goodIdStatus?"选择商品":"已选择"+e.priceForm.proNum+"件数"))]),e._v(" "),a("a",{directives:[{name:"show",rawName:"v-show",value:5===e.priceForm.proRelationType,expression:"priceForm.proRelationType === 5"}],staticStyle:{"margin-left":"30px"},attrs:{href:"javaScript:void(0)"},on:{click:e.uploadDialogVisible}},[e._v("（或）通过EXCEL导入活动商品")]),e._v(" "),a("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refash))])],1)],1)],1),e._v(" "),a("div",{staticClass:"confim-btn",style:{width:e.fixedWidth+"px"}},[a("el-form-item",{staticClass:"fix-btn"},[a("el-button",{attrs:{type:"primary",size:"small",loading:e.submitLoading},on:{click:function(t){e.submitActive("priceForm")}}},[e._v("保 存")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:e.goList}},[e._v("返 回")])],1)],1)])],1)]),e._v(" "),a("el-dialog",{attrs:{title:"导入活动商品",visible:e.dialogVisible,width:"620px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{model:e.dialogForm,"label-position":"right","label-width":"80px"}},[a("el-form-item",{attrs:{label:"选择文件",required:""}},[a("div",[a("div",{staticClass:"upload-btn"},[a("el-upload",{staticClass:"upload-ele",attrs:{action:e.action,headers:e.headersUpload,"before-upload":e.uploadFileBefore,"on-success":e.uploadFile,"with-credentials":"","show-file-list":e.showList,data:e.uploadData}},[a("el-button",{attrs:{size:"small"}},[a("i",{staticClass:"el-icon-upload2",staticStyle:{"margin-right":"5px"}}),e._v("点击上传")])],1)],1),e._v(" "),a("el-button",{attrs:{type:"info",plain:""},on:{click:e.downloadFile}},[e._v("下载EXCEL模板")])],1),e._v(" "),a("p",{directives:[{name:"show",rawName:"v-show",value:e.importMess,expression:"importMess"}],staticClass:"import-info"},[e._v("\n          本次共导入 "),a("span",{staticStyle:{"font-weight":"600"}},[e._v(e._s(e.successNum+e.falseNum))]),e._v(" 个商品，其中成功 "),a("span",{staticStyle:{"font-weight":"600"}},[e._v(e._s(e.successNum))]),e._v(" 个，失败 "),a("span",{staticStyle:{color:"#f5222d"}},[e._v(e._s(e.falseNum))]),e._v(" 个"),a("a",{directives:[{name:"show",rawName:"v-show",value:e.falseNum>0,expression:"falseNum > 0"}],staticStyle:{"margin-left":"10px"},attrs:{href:"javaScript:void(0)"},on:{click:e.showInfo}},[e._v("查看失败原因")])])]),e._v(" "),a("el-form-item",{attrs:{label:"导入规则"}},[a("div",{staticClass:"line"}),e._v(" "),a("div",{staticClass:"upload-rules"},[a("p",[e._v("1. 每个文件最多300个宝贝，文件大小不超过2M")]),e._v(" "),a("p",[e._v("2. 只需要填写SPU（货号）和实售价")]),e._v(" "),a("p",[e._v("3. 仅支持.xlsx .csv文件的导入（建议直接下载模板，在模板的基础上进行数据的填充）")])])])],1)],1),e._v(" "),a("importInfo",{attrs:{importInfo:e.importInfo}})],1)},staticRenderFns:[]};var Ms=a("VU/8")(Fs,As,!1,function(e){a("M5b0"),a("ZGhX")},"data-v-6e4280e0",null).exports,Os={name:"pieceGoods",data:function(){return{getTime:C.getTime,getSeconds:C.getSeconds,mallHeight:document.documentElement.clientHeight-64-98,fixedWidth:document.documentElement.clientWidth-200,goodsClassifyList:[],goodsClassify:null,search:"",checked:!1,activeName:"first",soldList:[],activityId:"",pageNum:1,pageSize:20,pageSizes:[20,40,60,80],total:0,sortKey:"create_time",sortValue:"asc",categoryId:"",refash:!1,selectGoodsList:[],selectNum:0,deleteGoodsList:[],addProIdsArr:[],removeProIdsArr:[],selectAllStatus:!1,loading:!0}},created:function(){this.activityId=this.$route.params.activityId,this.selectNum=this.$route.params.selectNum,this.getClassifyList(),this.getGoodsList(),localStorage.getItem("priceObj")&&(this.addProIdsArr=JSON.parse(localStorage.getItem("priceObj")).addProIdsArr,this.removeProIdsArr=JSON.parse(localStorage.getItem("priceObj")).removeProIdsArr)},computed:{},methods:{getClassifyList:function(){var e=this;A.get("/api-mall/list_mall_goods_tag_tree").then(function(t){0===t.data.errorCode?(e.goodsClassifyList.push({childTagList:t.data.result.childTagList,mallProTagId:t.data.result.mallProTagId,tagName:t.data.result.tagName}),e.getTree(e.goodsClassifyList)):e.$message.error(t.data.message)})},getTree:function(e){for(var t in e)e[t].label=e[t].tagName,e[t].id=e[t].mallProTagId,e[t].children=e[t].childTagList,e[t].children?this.getTree(e[t].children):delete e[t].children},getGoodsList:function(){var e=this,t=void 0,a=void 0;"first"===this.activeName?(t={activityId:this.activityId,pageNum:this.pageNum,pageSize:this.pageSize,sortKey:this.sortKey,sortValue:this.sortValue,type:5,isSaling:2,categoryId:this.categoryId,proTagId:this.goodsClassify,search:this.search.trim(),isHide:this.checked?1:0},a="/api-mall/page-activity-goods"):"second"===this.activeName?(t={activityId:this.activityId,pageNum:this.pageNum,pageSize:this.pageSize,sortKey:this.sortKey,sortValue:this.sortValue,type:5,isSaling:1,proTagId:this.goodsClassify,categoryId:this.categoryId,search:this.search.trim(),isHide:this.checked?1:0},a="/api-mall/page-activity-goods"):"third"===this.activeName&&(t={activityId:this.activityId,pageNum:this.pageNum,pageSize:this.pageSize,sortKey:this.sortKey,sortValue:this.sortValue,type:5,search:this.search.trim()},a="/api-mall/page-selected-activity-goods"),this.loading=!0,A.post(a,_.a.stringify(t)).then(function(t){if(0===t.data.errorCode){t.data.result.result?(e.soldList=t.data.result.result,e.total=t.data.result.totalCount):(e.soldList=[],e.total=0);var a=function(t){2===t.isSelStatus?(t.selectedStatus=!0,e.selectGoodsList.find(function(e){return e.mallProId===t.mallProId})||(-1===e.deleteGoodsList.indexOf(t.mallProId)?e.selectGoodsList.push(t):t.selectedStatus=!1)):t.selectedStatus=!1},s=!0,i=!1,r=void 0;try{for(var o,l=b()(e.soldList);!(s=(o=l.next()).done);s=!0){a(p=o.value)}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}var n=!0,d=!1,c=void 0;try{for(var u,m=b()(e.soldList);!(n=(u=m.next()).done);n=!0){var p=u.value,h=!0,g=!1,v=void 0;try{for(var f,y=b()(e.selectGoodsList);!(h=(f=y.next()).done);h=!0){var _=f.value;p.mallProId===_.mallProId&&(-1===e.deleteGoodsList.indexOf(p.mallProId)?p.selectedStatus=!0:p.selectedStatus=!1)}}catch(e){g=!0,v=e}finally{try{!h&&y.return&&y.return()}finally{if(g)throw v}}}}catch(e){d=!0,c=e}finally{try{!n&&m.return&&m.return()}finally{if(d)throw c}}var C=[],I=[];C=JSON.parse(localStorage.getItem("priceObj")).addProIdsArr,I=JSON.parse(localStorage.getItem("priceObj")).removeProIdsArr;var S=function(e){C.find(function(t){return t.mallProId===e.mallProId})&&(e.selectedStatus=!0)},w=!0,x=!1,L=void 0;try{for(var k,N=b()(e.soldList);!(w=(k=N.next()).done);w=!0){S(k.value)}}catch(e){x=!0,L=e}finally{try{!w&&N.return&&N.return()}finally{if(x)throw L}}var T=function(e){I.find(function(t){return t.mallProId===e.mallProId})&&(e.selectedStatus=!1)},D=!0,P=!1,F=void 0;try{for(var A,M=b()(e.soldList);!(D=(A=M.next()).done);D=!0){T(A.value)}}catch(e){P=!0,F=e}finally{try{!D&&M.return&&M.return()}finally{if(P)throw F}}e.selectAllStatus=e.soldList.every(function(e){return e.selectedStatus});var O=!0,$=!1,V=void 0;try{for(var R,U=b()(e.soldList);!(O=(R=U.next()).done);O=!0){var E=R.value;null!==E.tieredNameList&&(E.tieredNameList=E.tieredNameList.join(";"))}}catch(e){$=!0,V=e}finally{try{!O&&U.return&&U.return()}finally{if($)throw V}}e.loading=!1;var G=function(t){2===t.isSelStatus&&!1===t.selectedStatus?e.removeProIdsArr.find(function(e){return e.mallProId===t.mallProId})||e.removeProIdsArr.push(t):2!==t.isSelStatus&&t.selectedStatus&&(e.addProIdsArr.find(function(e){return e.mallProId===t.mallProId})||e.addProIdsArr.push(t))},B=!0,z=!1,j=void 0;try{for(var H,Y=b()(e.soldList);!(B=(H=Y.next()).done);B=!0){G(H.value)}}catch(e){z=!0,j=e}finally{try{!B&&Y.return&&Y.return()}finally{if(z)throw j}}}else e.$message.error(t.data.message),e.loading=!1})},handleSizeChange:function(e){this.pageSize=e,this.getGoodsList()},handleCurrentChange:function(e){this.refash=!this.refash,this.pageNum=e,this.selectAllStatus=!1,this.getGoodsList()},handleClick:function(e){this.selectAllStatus=!1,this.pageNum=1,this.getGoodsList()},getSearchList:function(){this.pageNum=1,this.getGoodsList()},checkedSelected:function(){this.pageNum=1,this.getGoodsList()},sortChange:function(e){"createTime"===e.prop?this.sortKey="create_time":this.sortKey=e.prop,"ascending"===e.order?this.sortValue="asc":"descending"==e.order&&(this.sortValue="desc"),this.getGoodsList()},checkedEverySelected:function(e,t,a){if(this.refash=!this.refash,e)for(var s in this.selectGoodsList.push(t),this.deleteGoodsList)-1!==this.deleteGoodsList.indexOf(t.mallProId)&&this.deleteGoodsList.splice(s,1);else{for(var i in this.selectGoodsList)t.mallProId===this.selectGoodsList[i].mallProId&&(this.selectGoodsList.splice(i,1),this.deleteGoodsList.find(function(e){e.mallProId,t.mallProId})||this.deleteGoodsList.push(t.mallProId));for(var r in this.addProIdsArr)this.addProIdsArr[r].mallProId===t.mallProId&&(this.addProIdsArr.splice(r,1),r=0)}2===t.isSelStatus&&!1===t.selectedStatus?this.removeProIdsArr.find(function(e){return e.mallProId===t.mallProId})||this.removeProIdsArr.push(t):2!==t.isSelStatus&&t.selectedStatus&&(this.addProIdsArr.find(function(e){return e.mallProId===t.mallProId})||this.addProIdsArr.push(t)),this.selectAllStatus=this.soldList.every(function(e){return e.selectedStatus})},selectAll:function(){var e=this;if(this.refash=!this.refash,this.selectAllStatus){var t=function(t){t.selectedStatus=!0,e.selectGoodsList.push(t),2===t.isSelStatus&&!1===t.selectedStatus?e.removeProIdsArr.find(function(e){return e.mallProId===t.mallProId})||e.removeProIdsArr.push(t):2!==t.isSelStatus&&t.selectedStatus&&(e.addProIdsArr.find(function(e){return e.mallProId===t.mallProId})||e.removeProIdsArr.find(function(e){return e.mallProId===t.mallProId})||e.addProIdsArr.push(t))},a=!0,s=!1,i=void 0;try{for(var r,o=b()(this.soldList);!(a=(r=o.next()).done);a=!0){t(r.value)}}catch(e){s=!0,i=e}finally{try{!a&&o.return&&o.return()}finally{if(s)throw i}}}else{var l=function(t){for(var a in t.selectedStatus=!1,e.selectGoodsList)t.mallProId===e.selectGoodsList[a].mallProId&&(e.selectGoodsList.splice(a,1),e.deleteGoodsList.find(function(e){e.mallProId,t.mallProId})||e.deleteGoodsList.push(t.mallProId));for(var s in e.addProIdsArr)e.addProIdsArr.find(function(e){return e.mallProId===t.mallProId})&&e.addProIdsArr.splice(s,1);2===t.isSelStatus&&!1===t.selectedStatus?e.removeProIdsArr.find(function(e){return e.mallProId===t.mallProId})||e.removeProIdsArr.push(t):2!==t.isSelStatus&&t.selectedStatus&&(e.addProIdsArr.find(function(e){return e.mallProId===t.mallProId})||e.removeProIdsArr.find(function(e){return e.mallProId===t.mallProId})||e.addProIdsArr.push(t))},n=!0,d=!1,c=void 0;try{for(var u,m=b()(this.soldList);!(n=(u=m.next()).done);n=!0){l(u.value)}}catch(e){d=!0,c=e}finally{try{!n&&m.return&&m.return()}finally{if(d)throw c}}}},submitGoodsId:function(){var e=[],t=!0,a=!1,s=void 0;try{for(var i,r=b()(this.selectGoodsList);!(t=(i=r.next()).done);t=!0){var o=i.value;-1===this.deleteGoodsList.indexOf(o.mallProId)&&e.push(o.mallProId)}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}e===[]||e.join(",");var l=JSON.parse(localStorage.getItem("priceObj"));if((l.proNum?l.proNum:0)+this.addProIdsArr.length-this.removeProIdsArr.length<=0)return this.$message.error("请选择商品"),!1;l.removeProIdsArr=this.removeProIdsArr,l.addProIdsArr=this.addProIdsArr,window.localStorage.setItem("priceObj",O()(l)),this.$router.push({name:"newReduceDiscount",params:{activityId:this.activityId}})}},components:{Treeselect:ce.a}},$s={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[s("div",{staticClass:"mall-content-section"},[e._v("\n    "+e._s(e.$route.meta.keepAlive)+"\n    "),s("div",{staticClass:"mall-content-title",staticStyle:{position:"relative",border:"none"}},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),s("el-breadcrumb-item",[e._v("促销活动")]),e._v(" "),s("el-breadcrumb-item",[e._v("选择单件商品")])],1),e._v(" "),e._m(0)],1),e._v(" "),s("div",{staticClass:"mall-section"},[s("el-tabs",{staticClass:"bread-content",on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},["first"===e.activeName||"second"===e.activeName?s("div",{staticClass:"operate-top"},[s("div",{staticClass:"fl"},[s("div",{staticClass:"search-item"},[s("treeselect",{staticClass:"tree-select",staticStyle:{width:"400px"},attrs:{options:e.goodsClassifyList,placeholder:"选择分类"},on:{input:e.getSearchList},model:{value:e.goodsClassify,callback:function(t){e.goodsClassify=t},expression:"goodsClassify"}})],1),e._v(" "),s("div",{staticClass:"search-item"},[s("el-input",{attrs:{placeholder:"请输入商品名称或货号","prefix-icon":"el-icon-search",clearable:""},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.getSearchList(t):null}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),s("div",{staticClass:"search-item",staticStyle:{"line-height":"32px"}},[s("el-checkbox",{on:{change:e.checkedSelected},model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("隐藏已参加活动的商品")])],1)]),e._v(" "),s("div",{staticClass:"fr"},[s("el-checkbox",{attrs:{label:"全选本页",border:""},on:{change:e.selectAll},model:{value:e.selectAllStatus,callback:function(t){e.selectAllStatus=t},expression:"selectAllStatus"}})],1)]):e._e(),e._v(" "),s("el-tab-pane",{attrs:{label:"出售中",name:"first"}}),e._v(" "),s("el-tab-pane",{attrs:{label:"仓库中",name:"second"}}),e._v(" "),s("el-tab-pane",{attrs:{label:"已选择("+e.selectNum+")",name:"third"}}),e._v(" "),s("div",{staticClass:"goods-list-content",class:"third"===e.activeName?"select-third":""},[[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.soldList},on:{"sort-change":e.sortChange}},[s("el-table-column",{attrs:{label:"商品信息",width:"400px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"goods-info"},[s("div",[s("a",{attrs:{href:"javascript:;"}},[null===t.row.mallProImageUrl?s("img",{staticClass:"imgs-style",attrs:{src:"http://pic01-10001430.image.myqcloud.com/img-icon-pro.png",alt:""}}):s("img",{staticClass:"imgs-style",attrs:{src:t.row.mallProImageUrl,alt:""}})])]),e._v(" "),s("div",{staticClass:"goods-text"},[s("div",{staticClass:"goods-text-name"},[e._v(e._s(t.row.proName))]),e._v(" "),s("div",{staticClass:"goods-text-info"},[s("div",[e._v("货号："+e._s(t.row.proCode))]),e._v(" "),s("div",[e._v("￥"+e._s(t.row.mallProSpuPrice))])])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"创建时间",sortable:"custom",prop:"createTime"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticClass:"line-18"},[e._v(e._s(e.getTime(t.row.createTime)))]),e._v(" "),s("p",{staticClass:"line-18"},[e._v(e._s(e.getSeconds(t.row.createTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"库存",sortable:"custom",prop:"stock"}}),e._v(" "),s("el-table-column",{attrs:{prop:"saleNum",label:"总销量",sortable:"custom"}}),e._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"tip-cont"},[null!==t.row.tieredNameList?s("el-tooltip",{staticClass:"item",staticStyle:{width:"160px"},attrs:{effect:"dark",content:"已参加其他阶梯价活动："+t.row.tieredNameList,placement:"top"}},[s("el-checkbox",{attrs:{label:"已参加活动",border:""},on:{change:function(a){return e.checkedEverySelected(a,t.row,t.$index)}},model:{value:t.row.selectedStatus,callback:function(a){e.$set(t.row,"selectedStatus",a)},expression:"scope.row.selectedStatus"}})],1):s("el-checkbox",{attrs:{label:"选择商品",border:""},on:{change:function(a){return e.checkedEverySelected(a,t.row,t.$index)}},model:{value:t.row.selectedStatus,callback:function(a){e.$set(t.row,"selectedStatus",a)},expression:"scope.row.selectedStatus"}}),e._v(" "),s("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refash))])],1)]}}])}),e._v(" "),s("template",{slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2)],e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.soldList.length,expression:"soldList.length"}],staticClass:"pagination-conteiner"},[s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{background:"","current-page":e.pageNum,"page-sizes":e.pageSizes,"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])],2)],1),e._v(" "),s("div",{staticClass:"confim-btn",style:{width:e.fixedWidth+"px"}},[s("div",{staticClass:"fix-btn"},[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.submitGoodsId}},[e._v("保 存")]),e._v(" "),s("el-button",{attrs:{size:"small"},on:{click:function(t){e.$router.go(-1)}}},[e._v("返 回")])],1)])],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("选择单件商品")])])}]};var Vs=a("VU/8")(Os,$s,!1,function(e){a("5XYr"),a("yVXe")},"data-v-2db46028",null).exports,Rs={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,searchValue:"",getTime:C.getTime,getSeconds:C.getSeconds,tableList:[],loading:!1,currentPage:1,pageSizes:[20,40,60,80],pageSize:20,total:0,dialogVisible:!1,dialogForm:{},showList:!1,uploadData:{},action:window.location.origin+"/api-mall/upload-collocationScheme-selected-goods?requestProject=mall",headersUpload:{sign:""},dialogLoading:!1,dialogMatch:!1,matchTitle:"添加主商品",stepText:1,addStatus:!1,mainSearch:"",addMainStatus:!1,goodsListMain:[],matchGoodsList:[],addMatchStatus:!1,matchSearch:"",mainProCode:"",matchProCode:"",successNum:0,sum:0,falseNum:0,importMess:!1,schemeId:"",importInfo:{dialogVisible:!1,infoList:[{reason:"货号在该品牌下面没有对应的商品",data:["ab","234234324","32423432","sfuiwerfufg"]},{reason:"货号在该品牌下面没有对应的商品",data:["ab"]}]},isNew:!0}},created:function(){this.getList()},computed:{},methods:{handleSizeChange:function(e){this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currentPage=e,this.getList()},getList:function(){var e=this,t={currentPage:this.currentPage,pageSize:this.pageSize,search:this.searchValue};A.get("/api-mall/page-collocationScheme-goods",{params:t}).then(function(t){0===t.data.errorCode?t.data.result.result?(e.tableList=t.data.result.result,e.total=t.data.result.totalCount,e.loading=!1):(e.tableList=[],e.total=0,e.loading=!1):e.$message.error(t.data.message)})},handleSearch:function(e){this.currentPage=1,this.pageSize=20,this.searchValue=e,this.getList()},deleteList:function(e,t){var a=this,s={schemeId:e.schemeId};A.post("/api-mall/delete-collocationScheme-goods",_.a.stringify(s)).then(function(e){0===e.data.errorCode?(a.tableList.splice(t,1),0===a.tableList.length&&a.currentPage>1&&(a.currentPage=a.currentPage-1),a.$message.success("删除成功！"),a.getList()):a.$message.error(e.data.message)})},editMatch:function(e){this.isNew=!1,this.addMainStatus=!0,this.dialogMatch=!0,this.schemeId=e.schemeId,this.mainProCode=e.mainBody,this.goodsListMain=[],this.goodsListMain.push({proName:e.mainProName,proCode:e.mainBody,mallProImageUrl:e.mainImageUrl});var t=!0,a=!1,s=void 0;try{for(var i,r=b()(e.proCodeAndImage);!(t=(i=r.next()).done);t=!0){var o=i.value;""!==this.matchProCode?this.matchProCode=this.matchProCode+","+o.proCode:this.matchProCode=o.proCode,this.matchGoodsList.push({proName:o.proName,proCode:o.proCode,mallProImageUrl:o.imageUrl})}}catch(e){a=!0,s=e}finally{try{!t&&r.return&&r.return()}finally{if(a)throw s}}},createMatch:function(){this.dialogMatch=!0,this.isNew=!0},addGoodsMain:function(){var e=this;if(""===this.mainSearch)return this.$message.error("请输入主商品货号"),!1;if(""!==this.mainProCode||this.mainSearch.split(",").length>1)return this.$message.error("主商品最多添加一个"),!1;var t={proCodes:this.mainSearch};A.post("/api-mall/check-mainProCode",_.a.stringify(t)).then(function(t){if(0!==t.data.errorCode)return e.$message.error(t.data.message),!1;if("1"===t.data.result)return e.$message.error("主商品已存在，请勿重复添加"),e.mainSearch="",!1;var a={proCodes:e.mainSearch};A.post("/api-mall/get-proDetail",_.a.stringify(a)).then(function(t){0===t.data.errorCode?(e.mainProCode=e.mainSearch,t.data.result?(e.goodsListMain=t.data.result,e.addMainStatus=!0,e.mainSearch=""):(e.$message.error("该商品的货号不存在"),e.goodsListMain=[],e.mainProCode="")):e.$message.error(t.data.message)})})},deleteGoodsMain:function(e){this.mainProCode="",this.goodsListMain=[],this.addMainStatus=!1},deleteGoodsMatch:function(e,t){this.addMatchStatus=!1,this.matchGoodsList.splice(e,1);var a=[],s=!0,i=!1,r=void 0;try{for(var o,l=b()(this.matchGoodsList);!(s=(o=l.next()).done);s=!0){var n=o.value;a.push(n.proCode)}}catch(e){i=!0,r=e}finally{try{!s&&l.return&&l.return()}finally{if(i)throw r}}this.matchProCode=a.join(",")},selectMatchGoods:function(){if(this.matchTitle="添加搭配商品",""===this.mainProCode)return this.$message.error("请添加主商品"),!1;this.stepText=2,this.matchProCode.split(",").length>=6&&(this.addMatchStatus=!0)},isRepeat:function(e){var t={};for(var a in e){if(t[e[a]])return!0;t[e[a]]=!0}return!1},addGoodsMatch:function(){var e=this,t=this.matchSearch.split(","),a=this.matchSearch.split(",").concat(this.matchProCode.split(",")),s=this.isRepeat(t),i=this.isRepeat(a);if(s||i)return this.$message.error("禁止添加重复商品货号"),!1;if(this.matchProCode.split(",").length+this.matchSearch.split(",").length>6||this.matchSearch.split(",").length>6)return this.$message.error("搭配商品最多添加6个"),!1;var r={proCodes:this.matchSearch};A.post("/api-mall/get-proDetail",_.a.stringify(r)).then(function(t){0===t.data.errorCode?t.data.result?(e.matchGoodsList=e.matchGoodsList.concat(t.data.result),""!==e.matchProCode?(e.matchProCode=e.matchProCode+","+e.matchSearch,e.matchProCode.split(",").length>=6&&(e.addMatchStatus=!0)):e.matchProCode=e.matchSearch,e.matchSearch=""):(e.$message.error("该商品的货号不存在"),e.matchProCode=e.matchSearch,e.matchGoodsList=e.matchGoodsList):e.$message.error(t.data.message)})},submitMatch:function(){var e=this;if(""===this.matchProCode)return this.$message.error("请添加搭配商品"),!1;var t={},a="";this.isNew?(a="/api-mall/create-collocationScheme-goods",t={mainBody:this.mainProCode,otherItems:this.matchProCode}):(a="/api-mall/update-collocationScheme-goods",t={mainBody:this.mainProCode,otherItems:this.matchProCode,schemeId:this.schemeId}),A.post(a,t).then(function(t){0===t.data.errorCode?(e.$message.success("创建成功"),e.dialogMatch=!1,e.getList()):e.$message.error(t.data.message)})},cancelMatch:function(){this.addMainStatus=!1,this.addMatchStatus=!1,this.stepText=1,this.dialogMatch=!1,this.goodsListMain=[],this.matchGoodsList=[],this.mainSearch="",this.matchSearch="",this.mainProCode="",this.matchProCode="",this.matchTitle="添加主商品"},betachUpload:function(){this.dialogVisible=!0,this.importMess=!1},downloadFile:function(){window.open("static/商品搭配导入模板.xlsx")},uploadFileBefore:function(e){return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"!==e.type&&"application/vnd.ms-excel"!==e.type?(this.$message.error("文件格式错误，请导入.xlsx .csv格式的文件"),!1):e.size>5242880?(this.$message.error("请上传小于5MB的文件"),!1):(localStorage.getItem("sign")?this.headersUpload.sign=localStorage.getItem("sign"):this.headersUpload.sign="",this.dialogLoading=!0,void(this.fileName=e.name))},uploadFile:function(e,t){this.dialogLoading=!0,0===e.errorCode?(this.importMess=!0,this.successNum=e.result.successNum,this.sum=e.result.sum,this.falseNum=e.result.falseNum,this.dialogLoading=!1,this.searchValue="",this.currentPage=1,this.pageSize=20,e.result.failDetail?this.importInfo.infoList=e.result.failDetail:this.importInfo.infoList=[],this.getList()):(this.dialogLoading=!1,this.$message.error(e.message))},showInfo:function(){this.importInfo.dialogVisible=!0}},components:{importInfo:Ye}},Us={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[s("div",{staticClass:"mall-content-section"},[s("div",{staticClass:"mall-content-title"},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),s("el-breadcrumb-item",[e._v("商品管理")]),e._v(" "),s("el-breadcrumb-item",[e._v("商品搭配")])],1),e._v(" "),e._m(0)],1),e._v(" "),s("div",{staticClass:"mall-section el-toop-section"},[s("div",{staticClass:"operate-top"},[s("div",{staticClass:"fl"},[s("el-input",{attrs:{placeholder:"请输入商品名称/货号","prefix-icon":"el-icon-search",clearable:""},on:{clear:function(t){e.handleSearch(e.searchValue)}},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.handleSearch(e.searchValue)}},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1),e._v(" "),s("div",{staticClass:"fr"},[s("el-button",{attrs:{type:"primary"},on:{click:e.createMatch}},[e._v("创建搭配")]),e._v(" "),s("el-button",{on:{click:e.betachUpload}},[e._v("批量导入")])],1)]),e._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableList}},[s("el-table-column",{attrs:{label:"主商品","min-width":"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"goods-info"},[s("img",{attrs:{src:t.row.mainImageUrl}}),e._v(" "),s("div",{staticClass:"goods-text"},[s("p",[e._v(e._s(t.row.mainProName))]),e._v(" "),s("p",{staticClass:"goods-spu"},[e._v("spu："+e._s(t.row.mainBody))])])])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"搭配商品",prop:"createTime","min-width":"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{staticClass:"match-img-container",staticStyle:{height:"52px"}},e._l(t.row.proCodeAndImage,function(t,a){return s("div",{key:a,staticClass:"match-img-box"},[s("el-tooltip",{attrs:{placement:"bottom"}},[s("div",{attrs:{slot:"content"},slot:"content"},[e._v(e._s(t.proName)),s("br"),e._v("spu:"+e._s(t.proCode))]),e._v(" "),s("img",{attrs:{src:t.imageUrl,alt:""}})])],1)}))]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"创建时间",prop:"createTime"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticStyle:{"line-height":"18px"}},[e._v(e._s(e.getTime(t.row.createTime)))]),e._v(" "),s("p",{staticClass:"gray-color",staticStyle:{"line-height":"18px"}},[e._v(e._s(e.getSeconds(t.row.createTime)))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",[s("el-button",{attrs:{type:"text"},on:{click:function(a){e.editMatch(t.row)}}},[e._v("编辑")]),e._v(" "),s("el-popover",{staticStyle:{"margin-left":"8px"},attrs:{placement:"top",width:"160"},model:{value:t.row.visible2,callback:function(a){e.$set(t.row,"visible2",a)},expression:"scope.row.visible2"}},[s("p",{staticStyle:{"line-height":"1.5",padding:"10px 10px 20px"}},[e._v("确定删除该搭配吗？")]),e._v(" "),s("div",{staticStyle:{"text-align":"right",margin:"0"}},[s("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){t.row.visible2=!1}}},[e._v("取消")]),e._v(" "),s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.deleteList(t.row,t.$index)}}},[e._v("确定")])],1),e._v(" "),s("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除")])],1)],1)]}}])}),e._v(" "),s("template",{slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.tableList.length>0,expression:"tableList.length > 0"}],staticClass:"pagination-conteiner"},[s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])],1)]),e._v(" "),s("el-dialog",{attrs:{title:"导入商品搭配",visible:e.dialogVisible,width:"620px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.dialogLoading,expression:"dialogLoading"}],attrs:{model:e.dialogForm,"label-position":"right","label-width":"80px"}},[s("el-form-item",{attrs:{label:"选择文件",required:""}},[s("div",{staticClass:"upload-btn"},[s("el-upload",{staticClass:"upload-ele",attrs:{action:e.action,headers:e.headersUpload,"before-upload":e.uploadFileBefore,"on-success":e.uploadFile,"with-credentials":"","show-file-list":e.showList,data:e.uploadData}},[s("el-button",{attrs:{size:"small"}},[s("i",{staticClass:"el-icon-upload2",staticStyle:{"margin-right":"5px"}}),e._v("点击上传")])],1)],1),e._v(" "),s("el-button",{attrs:{type:"info",plain:""},on:{click:e.downloadFile}},[e._v("下载EXCEL模板")]),e._v(" "),s("p",{directives:[{name:"show",rawName:"v-show",value:e.importMess,expression:"importMess"}],staticClass:"import-info"},[e._v("\n          本次共导入 "),s("span",{staticStyle:{"font-weight":"600"}},[e._v(e._s(e.sum))]),e._v(" 个商品，其中成功 "),s("span",{staticStyle:{"font-weight":"600"}},[e._v(e._s(e.successNum))]),e._v(" 个，失败 "),s("span",{staticStyle:{color:"#f5222d"}},[e._v(e._s(e.falseNum))]),e._v(" 个 "),s("a",{directives:[{name:"show",rawName:"v-show",value:e.falseNum>0,expression:"falseNum > 0"}],staticStyle:{"margin-left":"10px"},attrs:{href:"javaScript:void(0)"},on:{click:e.showInfo}},[e._v("查看失败原因")])])],1),e._v(" "),s("el-form-item",{attrs:{label:"导入规则"}},[s("div",{staticClass:"line"}),e._v(" "),s("div",{staticClass:"upload-rules"},[s("p",[e._v("1. 每个文件最多300个商品")]),e._v(" "),s("p",[e._v("2. 只需要填写主商品和搭配商品的SPU（货号）")]),e._v(" "),s("p",[e._v("3. 仅支持.xlsx .xls文件的导入（建议直接下载模板，在模板的基础上进行数据的填充）")]),e._v(" "),s("p",[e._v("4. 导入后，请在当前页面等待，系统将很快为您反馈导入结果！！！")])])])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:e.matchTitle,visible:e.dialogMatch,width:"520px"},on:{"update:visible":function(t){e.dialogMatch=t},close:e.cancelMatch}},[1===e.stepText?s("div",{staticClass:"match-content"},[s("div",{staticClass:"search-add"},[s("el-input",{staticClass:"main-search",attrs:{placeholder:"请输入主商品货号"},model:{value:e.mainSearch,callback:function(t){e.mainSearch=t},expression:"mainSearch"}}),e._v(" "),s("el-button",{staticClass:"add-btn",attrs:{disabled:e.addMainStatus},on:{click:e.addGoodsMain}},[e._v("添加")])],1),e._v(" "),s("div",{staticClass:"add-list-content"},[e.goodsListMain.length>0?s("div",{staticClass:"add-list"},e._l(e.goodsListMain,function(t,a){return s("div",{key:a,staticClass:"add-item"},[s("img",{attrs:{src:t.mallProImageUrl}}),e._v(" "),s("div",{staticClass:"goods-text-dialog"},[s("p",{staticClass:"pro-name"},[e._v(e._s(t.proName))]),e._v(" "),s("p",{staticClass:"goods-spu"},[e._v("spu："+e._s(t.proCode))])]),e._v(" "),s("el-button",{staticClass:"delete-btn",attrs:{type:"text"},on:{click:function(t){e.deleteGoodsMain(a)}}},[e._v("删除")])],1)})):s("div",{staticClass:"step-tip"},[s("p",[e._v("步骤一：先搜索主商品并添加")]),e._v(" "),s("p",[e._v("（主商品只能添加一个）")])])])]):e._e(),e._v(" "),2===e.stepText?s("div",{staticClass:"match-content"},[s("div",{staticClass:"search-add"},[s("el-input",{staticClass:"main-search",attrs:{placeholder:"请输入搭配商品货号"},model:{value:e.matchSearch,callback:function(t){e.matchSearch=t},expression:"matchSearch"}}),e._v(" "),s("el-button",{staticClass:"add-btn",attrs:{disabled:e.addMatchStatus},on:{click:e.addGoodsMatch}},[e._v("添加")])],1),e._v(" "),s("div",{staticClass:"add-list-content"},[e.matchGoodsList.length>0?s("div",{staticClass:"add-list"},e._l(e.matchGoodsList,function(t,a){return s("div",{key:a,staticClass:"add-item"},[s("img",{attrs:{src:t.mallProImageUrl}}),e._v(" "),s("div",{staticClass:"goods-text-dialog"},[s("p",{staticClass:"pro-name"},[e._v(e._s(t.proName))]),e._v(" "),s("p",{staticClass:"goods-spu"},[e._v("spu："+e._s(t.proCode))])]),e._v(" "),s("el-button",{staticClass:"delete-btn",attrs:{type:"text"},on:{click:function(s){e.deleteGoodsMatch(a,t)}}},[e._v("删除")])],1)})):s("div",{staticClass:"step-tip"},[s("p",[e._v("步骤二：再搜索搭配商品并添加")]),e._v(" "),s("p",[e._v("（搭配商品最多可添加6个）")])])])]):e._e(),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.cancelMatch}},[e._v("取 消")]),e._v(" "),1===e.stepText?s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.selectMatchGoods()}}},[e._v("下一步")]):e._e(),e._v(" "),2===e.stepText?s("el-button",{attrs:{type:"primary"},on:{click:e.submitMatch}},[e._v("确 定")]):e._e()],1)]),e._v(" "),s("importInfo",{attrs:{importInfo:e.importInfo}})],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("商品搭配")])])}]};var Es=a("VU/8")(Rs,Us,!1,function(e){a("FlYF"),a("KP6K")},"data-v-f36db9c4",null).exports,Gs={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,getTime:C.getTime,getSeconds:C.getSeconds,tableData:[],dateValue:[],applyStartTime:"",applyEndTime:"",searchValue:"",searchColumn:"report_id",dataType:"",applyStatus:"",currentPage:1,pageSize:20,pageSizes:[20,40,60,80],total:0,loading:!1,projectCode:"mall"}},created:function(){this.getList()},computed:{},methods:{getList:function(){var e=this,t={applyStartTime:this.applyStartTime,applyEndTime:this.applyEndTime,searchValue:this.searchValue,searchColumn:this.searchColumn,dataType:this.dataType,applyStatus:this.applyStatus,currentPage:this.currentPage,pageSize:this.pageSize,projectCode:"mall"};A.post("/api-admin/page-download-report",_.a.stringify(t)).then(function(t){0===t.data.errorCode?t.data.result.result?(e.tableData=t.data.result.result,e.total=t.data.result.totalCount):(e.tableData=[],e.total=0):e.$message.error(t.data.message)})},getListCurr:function(){this.currentPage=1,this.getList()},getTimeDate:function(e){e?(this.applyStartTime=e[0],this.applyEndTime=e[1],this.currentPage=1):(this.applyStartTime="",this.applyEndTime="",this.currentPage=1),this.getList()},handleSizeChange:function(e){this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currentPage=e,this.getList()},downLoadReport:function(e){var t=this,a={downloadReportId:e,projectCode:"mall"};A.post("/api-admin/download-report",_.a.stringify(a)).then(function(e){var a=e.data;0==a.errorCode?window.location.href=a.result:t.$message.error(e.data.message)})},reportList:function(e){this.$router.push({path:"/uploadList",query:{reportId:e}})}},components:{}},Bs={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[s("div",{staticClass:"mall-content-section"},[s("div",{staticClass:"mall-content-title"},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),s("el-breadcrumb-item",[e._v("报表中心")]),e._v(" "),s("el-breadcrumb-item",[e._v("报表列表")])],1),e._v(" "),e._m(0)],1),e._v(" "),s("div",{staticClass:"mall-section"},[s("div",{staticClass:"operate-top"},[s("div",{staticClass:"search-item"},[s("el-date-picker",{staticClass:"date-picker",attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.getTimeDate},model:{value:e.dateValue,callback:function(t){e.dateValue=t},expression:"dateValue"}})],1),e._v(" "),s("div",{staticClass:"search-item"},[s("el-select",{staticClass:"w-120",attrs:{placeholder:"所有类型",clearable:""},on:{change:e.getListCurr},model:{value:e.dataType,callback:function(t){e.dataType=t},expression:"dataType"}},[s("el-option",{attrs:{label:"脱敏数据",value:1}}),e._v(" "),s("el-option",{attrs:{label:"完整数据",value:2}})],1)],1),e._v(" "),s("div",{staticClass:"search-item"},[s("el-select",{staticClass:"w-120",attrs:{placeholder:"所有状态",clearable:""},on:{change:e.getListCurr},model:{value:e.applyStatus,callback:function(t){e.applyStatus=t},expression:"applyStatus"}},[s("el-option",{attrs:{label:"已生成",value:2}}),e._v(" "),s("el-option",{attrs:{label:"待审核",value:1}}),e._v(" "),s("el-option",{attrs:{label:"生成中",value:3}}),e._v(" "),s("el-option",{attrs:{label:"审核超时",value:4}})],1)],1),e._v(" "),s("div",{staticClass:"search-item"},[s("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入内容","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.getListCurr(t):null}},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}},[s("el-select",{staticClass:"search-select",attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.searchColumn,callback:function(t){e.searchColumn=t},expression:"searchColumn"}},[s("el-option",{attrs:{label:"报告ID",value:"report_id"}}),e._v(" "),s("el-option",{attrs:{label:"操作人员",value:"apply_clerk_name"}}),e._v(" "),s("el-option",{attrs:{label:"文件名称",value:"report_name"}}),e._v(" "),s("el-option",{attrs:{label:"数据内容",value:"data_content"}})],1)],1)],1)]),e._v(" "),s("div",{staticClass:"list-content"},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData}},[s("el-table-column",{attrs:{label:"报告ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(t.row.reportId?t.row.reportId:"--"))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticClass:"time-lh"},[e._v(e._s(t.row.applyTime?e.getTime(t.row.applyTime):"--")+" "+e._s(t.row.applyTime?e.getSeconds(t.row.applyTime):"--"))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作人员",prop:"applyName"}}),e._v(" "),s("el-table-column",{attrs:{label:"文件名称",prop:"reportName"}}),e._v(" "),s("el-table-column",{attrs:{label:"时间范围"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.reportStartTime&&t.row.reportEndTime?s("div",[s("p",{staticClass:"time-lh"},[e._v(e._s(t.row.reportStartTime?e.getTime(t.row.reportStartTime):"")+"至")]),e._v(" "),s("p",{staticClass:"time-lh"},[e._v(e._s(t.row.reportEndTime?e.getTime(t.row.reportEndTime):""))])]):s("div",[e._v("历史累计数据")])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"报告类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(1===t.row.dataType?"脱敏数据":"完整数据"))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"数据总量",prop:"dataCount"}}),e._v(" "),s("el-table-column",{attrs:{label:"数据内容",prop:"dataContent"}}),e._v(" "),s("el-table-column",{attrs:{label:"审核状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[2==t.row.applyStatus?s("p",{staticClass:"dm-status--success"},[s("el-tooltip",{attrs:{placement:"right"}},[s("div",{attrs:{slot:"content"},slot:"content"},[s("p",[e._v("审核人姓名："+e._s(t.row.auditorName?t.row.auditorName:"--"))]),e._v(" "),s("p",[e._v("审核人手机："+e._s(t.row.auditorPhone?t.row.auditorPhone:"--"))])]),e._v(" "),s("span",[e._v("已生成")])])],1):e._e(),e._v(" "),1==t.row.applyStatus?s("p",{staticClass:"dm-status--warning"},[e._v("待审核")]):e._e(),e._v(" "),3==t.row.applyStatus?s("p",{staticClass:"dm-status--primary"},[e._v("生成中...")]):e._e(),e._v(" "),4==t.row.applyStatus?s("p",{staticClass:"dm-status--danger"},[e._v("审核超时")]):e._e()]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[2==t.row.applyStatus?s("div",[s("el-button",{attrs:{type:"text"},on:{click:function(a){e.downLoadReport(t.row.downloadReportId)}}},[e._v("下载")]),e._v(" "),s("el-button",{attrs:{type:"text"},on:{click:function(a){e.reportList(t.row.reportId)}}},[e._v("记录")])],1):s("div",[e._v("--")])]}}])}),e._v(" "),s("template",{slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length,expression:"tableData.length"}],staticClass:"pagination-conteiner"},[s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])],1)])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("报表列表")])])}]};var zs=a("VU/8")(Gs,Bs,!1,function(e){a("CM68"),a("7R1e")},"data-v-48ffb8d4",null).exports,js={data:function(){return{mallHeight:document.documentElement.clientHeight-64-98,getTime:C.getTime,getSeconds:C.getSeconds,tableData:[],dateValue:[],downloadStartTime:"",downloadEndTime:"",searchValue:"",searchColumn:"report_id",reportDataType:"",applyStatus:"",currentPage:1,pageSize:20,pageSizes:[20,40,60,80],total:0,loading:!1}},created:function(){this.$route.query.reportId&&(this.searchValue=this.$route.query.reportId),this.getList()},computed:{},methods:{getList:function(){var e=this,t={downloadStartTime:this.downloadStartTime,downloadEndTime:this.downloadEndTime,searchValue:this.searchValue,searchColumn:this.searchColumn,reportDataType:this.reportDataType,currentPage:this.currentPage,pageSize:this.pageSize,projectCode:"mall"};A.post("/api-admin/page-download-log",_.a.stringify(t)).then(function(t){0===t.data.errorCode?t.data.result.result?(e.tableData=t.data.result.result,e.total=t.data.result.totalCount):(e.tableData=[],e.total=0):e.$message.error(t.data.message)})},getListCurr:function(){this.currentPage=1,this.getList()},getTimeDate:function(e){e?(this.downloadStartTime=e[0],this.downloadEndTime=e[1],this.currentPage=1):(this.downloadStartTime="",this.downloadEndTime="",this.currentPage=1),this.getList()},handleSizeChange:function(e){this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currentPage=e,this.getList()}},components:{}},Hs={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mall-section-container",style:{minHeight:e.mallHeight+"px"}},[s("div",{staticClass:"mall-content-section"},[s("div",{staticClass:"mall-content-title"},[s("el-breadcrumb",{attrs:{separator:"/"}},[s("el-breadcrumb-item",[e._v("微商城")]),e._v(" "),s("el-breadcrumb-item",[e._v("报表中心")]),e._v(" "),s("el-breadcrumb-item",[e._v("下载日志")])],1),e._v(" "),e._m(0)],1),e._v(" "),s("div",{staticClass:"mall-section"},[s("div",{staticClass:"operate-top"},[s("div",{staticClass:"search-item"},[s("el-date-picker",{staticClass:"date-picker",attrs:{format:"yyyy-MM-dd","value-format":"yyyy-MM-dd",type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.getTimeDate},model:{value:e.dateValue,callback:function(t){e.dateValue=t},expression:"dateValue"}})],1),e._v(" "),s("div",{staticClass:"search-item"},[s("el-select",{staticClass:"w-120",attrs:{placeholder:"所有类型",clearable:""},on:{change:e.getListCurr},model:{value:e.reportDataType,callback:function(t){e.reportDataType=t},expression:"reportDataType"}},[s("el-option",{attrs:{label:"脱敏数据",value:1}}),e._v(" "),s("el-option",{attrs:{label:"完整数据",value:2}})],1)],1),e._v(" "),s("div",{staticClass:"search-item"},[s("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入内容","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.getListCurr(t):null}},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}},[s("el-select",{staticClass:"search-select",attrs:{slot:"prepend",placeholder:"请选择"},slot:"prepend",model:{value:e.searchColumn,callback:function(t){e.searchColumn=t},expression:"searchColumn"}},[s("el-option",{attrs:{label:"报告ID",value:"report_id"}}),e._v(" "),s("el-option",{attrs:{label:"下载人员",value:"download_person_name"}}),e._v(" "),s("el-option",{attrs:{label:"文件名称",value:"report_name"}}),e._v(" "),s("el-option",{attrs:{label:"数据内容",value:"report_content"}})],1)],1)],1)]),e._v(" "),s("div",{staticClass:"list-content"},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData}},[s("el-table-column",{attrs:{label:"报告ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(t.row.reportId?t.row.reportId:"--"))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"下载时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",{staticClass:"time-lh"},[e._v(e._s(t.row.downloadTime?e.getTime(t.row.downloadTime):"--"))]),e._v(" "),s("p",{staticClass:"time-lh"},[e._v(e._s(t.row.downloadTime?e.getSeconds(t.row.downloadTime):"--"))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"下载人员",prop:"downloadPersonName"}}),e._v(" "),s("el-table-column",{attrs:{label:"文件名称",prop:"reportName"}}),e._v(" "),s("el-table-column",{attrs:{label:"时间范围"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.reportStartTime&&t.row.reportEndTime?s("div",[s("p",{staticClass:"time-lh"},[e._v(e._s(t.row.reportStartTime?e.getTime(t.row.reportStartTime):"")+"至")]),e._v(" "),s("p",{staticClass:"time-lh"},[e._v(e._s(t.row.reportEndTime?e.getTime(t.row.reportEndTime):""))])]):s("div",[e._v("历史累计数据")])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"报告类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(1===t.row.reportDataType?"脱敏数据":"完整数据"))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"数据总量",prop:"reportCount"}}),e._v(" "),s("el-table-column",{attrs:{label:"数据内容",prop:"reportContent"}}),e._v(" "),s("template",{slot:"empty"},[s("div",{staticClass:"no-data-wrap"},[s("div",{staticClass:"no-data-icon"},[s("img",{attrs:{src:a("8Td+")}})]),e._v(" "),s("p",[e._v("暂无数据")])])])],2),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length,expression:"tableData.length"}],staticClass:"pagination-conteiner"},[s("div",{staticClass:"pagination"},[s("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,layout:"total, sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])],1)])])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("h3",[t("span",[this._v("下载日志")])])}]};var Ys=a("VU/8")(js,Hs,!1,function(e){a("Nt1+"),a("NzFK")},"data-v-a64c2e70",null).exports;o.a.use(c.a),o.a.use(m.a);var Zs=new c.a({routes:[{path:"/",name:"main",component:v,children:[{path:"goodsClassify",name:"goodsClassify",component:Je},{path:"goodsList",name:"goodsList",component:Ie},{path:"goodsEdit/:mallProId/:createSource",name:"goodsEdit",component:ze},{path:"mallIndex",name:"mallIndex",component:ct},{path:"mallPage",name:"mallPage",component:pt},{path:"commonSet",name:"commonSet",component:Vt},{path:"orderSet",name:"orderSet",component:jt},{path:"templateEdit/:templateId",name:"templateEdit",component:Zt},{path:"searchSet",name:"searchSet",component:Wt},{path:"dataAccuracy",name:"dataAccuracy",component:Ns},{path:"orderAll",name:"orderAll",component:ta},{path:"refundManage",name:"refundManage",component:ma},{path:"evaluationManage",name:"evaluationManage",component:ba},{path:"batchManage",name:"batchManage",component:Ca},{path:"orderDetails/:orderId",name:"orderDetails",component:ia},{path:"refundOrderDetails/:orderRefundId",name:"refundOrderDetails",component:ga},{path:"batchDelivery",name:"batchDelivery",component:la},{path:"goodsSynList",name:"goodsSynList",component:wa},{path:"goodsErpEdit/:mallProId",name:"goodsErpEdit",component:Da},{path:"discountSale",name:"discountSale",component:za},{path:"packageMail",name:"packageMail",component:Ja},{path:"mailActivityGoods",name:"mailActivityGoods",component:Qa},{path:"createActivity",name:"createActivity",component:ts},{path:"createActivityGoods",name:"createActivityGoods",component:is},{path:"evaluateList",name:"evaluateList",component:ls},{path:"addressList",name:"addressList",component:cs},{path:"addressEdit/:sellerAddressId",name:"addressEdit",component:ps},{path:"reduceDiscountList",name:"reduceDiscountList",component:Ps},{path:"newReduceDiscount/:activityId",name:"newReduceDiscount",component:Ms},{path:"selectGoods/:activityId/:selectNum",name:"selectGoods",component:Vs},{path:"matchList",name:"matchList",component:Es},{path:"/reportList",name:"reportList",component:zs},{path:"/uploadList",name:"uploadList",component:Ys}]},{path:"/newPage/:pageId",name:"newPage",component:Mt},{path:"/imgSpace",name:"imgSpace",component:qe,children:[{path:"/imgSpaceList",name:"imgSpaceList",component:lt}]},{path:"/imgRecycle",name:"imgRecycle",component:gs,children:[{path:"/imgRecycleList",name:"imgRecycleList",component:xs}]}]}),Ks=a("Rf8U"),Js=a.n(Ks),Ws=a("zL8q"),qs=a.n(Ws);a("tvR6"),a("fCJj");for(var Qs in i.a.polyfill(),o.a.use(qs.a),o.a.use(Js.a,k.a),o.a.axios.defaults.withCredentials=!0,o.a.config.productionTip=!1,o.a.prototype.testHost=window.location.origin,C)o.a.filter(Qs,C[Qs]);new o.a({el:"#app",router:Zs,store:P,components:{App:n},template:"<App/>"})},"Nt1+":function(e,t){},NzFK:function(e,t){},OL9M:function(e,t){},P46x:function(e,t){},PkPf:function(e,t){},PtMU:function(e,t){},RRyA:function(e,t){},Rclr:function(e,t){},Rt1m:function(e,t){},"S/2A":function(e,t){},SJI6:function(e,t){e.exports=Vuex},V52o:function(e,t){},VHaN:function(e,t){},VIek:function(e,t){},VeOt:function(e,t){},VrN5:function(e,t){},WH0e:function(e,t){},WjWg:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGgAAAAaCAYAAABb9hlrAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6M0Q5NzYxNzk4MjkxMTFFODk4MDI5QTcyNEU1OENDN0EiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6M0Q5NzYxN0E4MjkxMTFFODk4MDI5QTcyNEU1OENDN0EiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDozRDk3NjE3NzgyOTExMUU4OTgwMjlBNzI0RTU4Q0M3QSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDozRDk3NjE3ODgyOTExMUU4OTgwMjlBNzI0RTU4Q0M3QSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgclLk4AAAToSURBVHja7FrrkeIwDIYbGjAlZEsIJYQSQgmhBCiBlEBKICWQEkgJlxJICZzNfuKE1nbsXNjjx2rGA8S2/JD06RHmt9tt9kPvS79+ruDNKcaC9NhEtyta8g9rnnQ765ZHzitun3Rl+yHKAuYT5Z4xOQ2K3Bu/m52lP2X9BcZ/aVI2C3wxhwu5cDNG4btZpAuY083n80Y8S8GrcR3WsR9aW1kuOWHzD/ojRGAnxlOuYfrPlmmNPk9peZ6zuc1A/3HAYCrd9rr19wfQ6FfRybKJ3+jbieeZbpeR61yEhfoox7jrFOcBrwu3bs+ZQ6l4WNBdUt8Dp2SBpEnGrI01kSXaNHoM1YwnJwk9lWW9hFlfZeHROs6V0tqwPMOj0ta2hSKShW9dyIH9FV4fBC3OcXGxAvDOhd+xUYZGdAAmK0sjTTzKvv/lg4TF5uycJ+Enb+h78r8Yw3lccCargMhUDyMERHOPIwQUdDH88CP2N7mA4Pw5JUJApHhXKN5VCOsg5h9J2TjESQgi+Mkj70BJRytog74LPkvASM+durh8A1W1hoqW/Z75ghpYcBJi8Y5AyNff017QH6IoZs8bM0/PMec9IGjI2LkfY6wQZ3By4uDAGm66ggSuuQOOfedzxpFBwhg6WxDDZ0EJrCzFGQ+OgOEK68kxVvEwO4FUpyRjIWYzRvu7yLkN45GyMJU7/7vf0by/JcAZoJbt02aRZ08w0yMwUPgsGM/VL5aXcBhaonWM0dLRWsaQnm0Yvyz2tPrS12grrM1hkws7gdY9+SQ9z0DFE2FfvYhYlyPaRghmBagOoR77NzC3wj5NVPeBvKeVEfXCcjk1S/YIjyuXpupxJXDYCLlAEldPWOPrPL95QtsPCL3HBUsiwe6/4P+wIm0ZArnGNLp/6bN0IIy5txIBgnIKiHyEEE7jYV7D8RWAtBya/xIyB9Vr9DgEd7It92eBlqvYuB34hlRGQi2GhFcEKqxiFQcj/GoxYI5lyGaQjHVItBSbr14kp44slq1VC1gtInmGRqxtBKSRle8i9/I4z8ITDifA+Bjme1um/UIBzRg89aK/cUAh9Xcj125HXHYbebYSSOEU0C5Co2wHeBnEIcfJhHAqYdGE56S9mYgQN1ygzN8a+NpPDMlR90E+CJ+9S0ApO0w7kJTKGlb6YuFcHCH502sJCCax1N72FofdEgwh+ewdlnAfO8IHxaBQsA+Kimwg8euLoS2x+LedCH356wxOW2lpItApwWtIwdQIH1SMgEWvD5oqUZ1SKByj16zye8+8hSIR7ncMqtsBKNpDyQrbRX2zD9oP+SCiY+BLuSeBiBpWN8I6Zii48heJHfk3bL5kl2lKKyuqWJAfAbzkjP+QkEw0Ws/+vvagMLwmuI+tXIzwQcaCUyhLO0d8nlPCZrJuZOX5RBbwSNLANxOhOEWNdCnmElbsnQrRWuZj8DVUOTdvOtce2O09ylJSgs7mnRy5lG2dnCW8H0yxyIoPEUqesjupFw6pbyJeg0tz5jmIdMhKQJ9yhOpUXqLSh7WeZ3wKksujjRcsrWFKkYbAMfa8xh0UQqlUgNVUAk1iy10d/OID4qg+9FSiGBlpPeDIwqOa2d8mUqmjIV/icugOB994LH6DvjSinMTvoIFFJR4eHfNVvacvplb3uYef/8W9N/38L+7N6Y8AAwAWU5xR7+7t4gAAAABJRU5ErkJggg=="},X0KP:function(e,t){},XCWS:function(e,t){},XKAA:function(e,t){},Xykz:function(e,t){},"ZCI+":function(e,t){},ZGhX:function(e,t){},ZmCn:function(e,t){},aH8B:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJ4AAAAxCAYAAAArzxBAAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAqYSURBVHja7J15jF5VGcZ/7zfTZVqWLtRSbKFgESkRKNUAEaRlKVRJWlaFACZQpSggRYSwiQmLuMQWAS0iICAKGGiRiIaERRSKyqJikQCmtIVCW2hHltk7r3/c56THy/2Wmfm+aRPPk5ycu557vvc+593OuTPQD7j7Du5OQkJ/UernfbsDH0/iSxg04knTTQeOcXdLIkwYLI03DBgLDAF2SSJMGCziTQFagKHAUcnXS2g48USyo0W8FuCj0oAJCQ3VeNsBe4hsw0S+iUmMCY0m3uHA8FxJfl5Cn9HcBzPbBJwaEbYEGDA5iTGhYcQDZgIjgW4RLhBvaBJjQkOI5+4l4BKgKdJ2gXgprE1omMY7DBgFdOWIVwLeSGJMqDvx3H0I8INIw+U13r+SGBMaofG+CmwL9ERRcEy8lUmMCXUlnruPBi4S6YhIF0zu7WbWk8SYUDfiaZbiJrI52di8BqL1ABvcHbO0ViChfhrvEOBIoLfM+QfIlkZtC7yXRJnQF5TKaLsRwG9EzJLqJmm/ocC/yabLRpAtGkjYCuDuI9x9jN5fI9o3BZsDbcNKZUzsvWTTYYF0cekBXiKbqx2eiLdVYW/gfmBvdz8gECWQJWyLoObuYyLCjnD32dE9Fggc9oHzgOkF91pMqrj9fLvA/sC1RaZ2LjC7wMQ269gSYALQBmwiWziQsBXAzJ529z9rdwpwIHAOsMrdjwDOBvYD1uiaC919KvCirp2h8gLwSWCJuz+r+9C9vwauBV5w91eBZcCp7j5O18wBQh8ujNodK9dtzYd8PHffFrivwAyXRLpbgT2BDu33Am+lV75V4iFlJJ4EnouO36h6tOrtgT9UIHJsWteY2euyig/Jx/8F8CowD1gNnEK2Yim0/7rqeREhsZyJvQs4WYd6c/UdGgXtIl67tN6lZrYiveetxs8zkca13az97ohEPTo/xsw2yKS2iywbg0tlZh5MbchmhHaj9lt0LwXnQ/tjogC0J0+8yUCeQIF0d0vNdgCdEfFWA2eGDiYk9CmdIm13a5mod6lSKx2Boyq9wFXRqADYGThKTu5GqeNlKc+XUEg8YEeyZU95PKIopKQ0Si+bl7o/BrRGqvh64GCp1PdV7wLs5u53JfJtvWY5mMjBfHYIIL5WcO4VskWeI8lyeM0iXzPwODA167sPkQN7dHRNyPcNlbbcpQYhjHf3VWXKcnd/2N0vc/f93b25TBtTvDYsKEojufsz7n5olX5e4e6X9iO/tkbLyypdN8/dH9Wi22rXubtfFx27WMfu7UPXFkmZLCp4xli1+Zy7t+fkNy13bU3PdvcZoYFmCeOC3DVdwHr5dT2RZnwHeJbsu9oOXbeU7DuMdhGuKSJoIOAp7n51Fa23FvgxMF9EXUk2OxIir2nAlSq97n4a8MsKI/W7wH/KnBsaHODo2Ej9rp+5+25FfXX3ocC3gdYafk+MK5SCOhL4XZVrZwL3ufuxZta7hTThbLlJKGq9Dng3uqSlHqZ2MlkiOMa9wBc1GgLpnlc9TSRbBhwPzBIJY63YLZPcKfJN1Iv9oEIOCuBad58AnAs8YGZfzwlkmMLyGySQQ939jDIEuKyPCximqt4V2AtYXnDNbNWjlJd6p4aXOFb5LICfu/uEGgg1R+Q7brDJ5+7DI9IdYmZPNMrUzsgde0K5mHhhwCMi6G4i6TBFunfw4dmNpqjEJnfHOiRIO83sRrKFqQCny5TXA5+Ltn+Y/15Y+wujQwfW8BKR7xvwEWm9WjAXuGcL/LWGHaLtvzbSxzs8d6w7OlciSyjPJFsMEIh1tV5+fjVyU0S0Ibkypo79fjRKei4c6Efluv/L0aFZIkmMj0kbBpxWQ9OTgZNkOS6OtF61r/tuBi6XRbllkMm3Pto+vVEf7DcDB0X7T0faBOAe4JjIz+slSzA/SZY8jgmcn9ONyRfIWBeYGe6+UNpumtruyl32WXffmDv2TzPrLmhyJNnH6UHTLAW+qRJwUWQGHwBOcPdSOVOoF3ands+X5rtIhD6abBFGObQDV2mwLlB7ZwxG5Glmne5+LNmc7w3AVxSM/bGM7GJ8yt3nVTg/KybepFwke4C27we+wOYk8nrgYDN7w933yRGplCNfTLiw/W6dZbQi5+x2FaSC8rgGuLSCf/eICLEauMDdLzezDndvkUZcBzyo6w5T3vK1Mv3bT4O6F1hsZr3uPl8uyu3uPraS/6bBdb52FyigOX8w0lJmtsTdd5SszgmydPebNSBWlenHJOBbFZrePp9OCZiu+sWYncBfgKlmFj7sOb7AZDdH5raV7DuNs4EzgduAN+ssn3jpT0+ZH5k391dU8e9ClDxf+ydHWg5gvs7fmR/BBfmxu0Oqysw6tX2fArFRUZtUCbi+IfktKPI9G0i+tWZ2rpTHQcBTGnwrgevK9GOJme1crsS/uRRpjtZo5K8AtmHzzMVMM+so4w/lyfc94EsKUtbKJL9YSwTYRxwVpX7aCs63mVlPvlTx70IE93u1uVB5ykV6zoO56+aX6dvhZH9DsAu4JXqZPdIgALfW4OuFxO4ZEfmuKchCNJKA3Wb2JPAZ4NM6fG4twVW14OLh4P9E9ee1/VvgxJxJGAKML5OHO1aheGfuXGs9/RNNagdn/TsDbDv271ZK2L1kHzltp4E3HrgkIu7qkFpSiifuW5PSUUHb5f2iO2R+a9J6OfIt1e9eONi5PTPDzJ6RC4b81AER7x5tb1L9rOp1wNyClzqqoJ03peWKzOkmsnnbepLuCZmADmnYgSBo+X/kSPIrESSY4Ztymusp7e6Va+8UNn+DfHvBC+xic8K+Jq0Xke84ka+ZLQC5EFMKot9+Ee9PEtLOOQLOjU2TppS2UVqBnH91ZgVybeijRgpplwnuPkplnLtPdfeLyWYjpitY2cPM2sq0M9rdW8qUUoF/d1sBQS7T7mIze79Ac4UoOMhoGPBT7Z5VIQpcHA3iOX3QOr3yrx+r5MBX+N0tShBXI1iTZrVCGenue5ItAt4b2KCUT/+JJ+GcpRzV29GLf14dGK4IZ1+N7h1ybZxXgf1v9yPzfrDqE0TmjdK+y+XftCpxPM7MVlVoZ538tKKyuMC/e7SgjRtUX1lw7vFAsMjRvkCauC0iZhGBQrqkT1pP924CjqhAvlkVfncb8HINj5mhfG4o78tPnwP8CJhkZh8MyHRHKvQx+WYTgZ3E7OaCXNxOkZ1/Sj5HlzRfT9TZ1RJwX9X5rmSzHB75ij1kq13WAx+USylI40yt8VF/U71vZGo3FbS5O/BK/pkiyz7a/bvMcpg8X2tma6r8zqGRmX7JzNp1bATQWU12CnrGm9nr2h+vd1MNXWa2XPdMBMYB60M70YDcJ8p69Er268oEaOHZG83stQp93kZB1/8sBG1WvmZSFDV2VyHeScAqdSwQrw1YUUOyMeH/GKWcwzwD+ImitnLLg7qj6PetXBDxGvByIl1CzcQLkZOZfR84UT7f7gX3BBNwvcj2NtlXSc+bWWta8JlQj/A5RDTN7j5MgcaeWsuX/rtPwqCScbSIl1RbwqASb4i7L0uSSNgS5PuEEspJGAkDDy4qEK3F3acpDwMwUXN3SYIJjSMeWZ7uPXLzuUnrJQy2qU2qLmFA+O8AP0pKDqHaSsMAAAAASUVORK5CYII="},cFcj:function(e,t){},cV0v:function(e,t){},cXwZ:function(e,t){},clUE:function(e,t){},cooY:function(e,t){},dQI6:function(e,t){},e6wZ:function(e,t){},fCJj:function(e,t){},fY5I:function(e,t){},fvXX:function(e,t){},g7Hf:function(e,t){},gHWI:function(e,t){},grVv:function(e,t){},hCmM:function(e,t){},"j+LA":function(e,t){},k4TW:function(e,t){},kf5e:function(e,t){},lRwf:function(e,t){e.exports=Vue},liMJ:function(e,t){},ll1g:function(e,t){},m5KO:function(e,t){},mBjh:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t){var a=document.createElement("_"),s=a.appendChild(document.createElement("_")),i=a.appendChild(document.createElement("_")),r=s.appendChild(document.createElement("_")),o=void 0,l=void 0;return s.style.cssText=a.style.cssText="height:100%;left:0;opacity:0;overflow:hidden;pointer-events:none;position:absolute;top:0;transition:0s;width:100%;z-index:-1",r.style.cssText=i.style.cssText="display:block;height:100%;transition:0s;width:100%",r.style.width=r.style.height="200%",e.appendChild(a),n(),function(){d(),e.removeChild(a)};function n(){d();var r=e.offsetWidth,c=e.offsetHeight;r===o&&c===l||(o=r,l=c,i.style.width=2*r+"px",i.style.height=2*c+"px",a.scrollLeft=a.scrollWidth,a.scrollTop=a.scrollHeight,s.scrollLeft=s.scrollWidth,s.scrollTop=s.scrollHeight,t({width:r,height:c})),s.addEventListener("scroll",n),a.addEventListener("scroll",n)}function d(){s.removeEventListener("scroll",n),a.removeEventListener("scroll",n)}}},miNb:function(e,t){},n1Oe:function(e,t){},oJml:function(e,t){},oQG7:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RDVFN0U1ODZBRkU3MTFFN0I0MDFDNkZFRTFGMTA4Q0YiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RDVFN0U1ODdBRkU3MTFFN0I0MDFDNkZFRTFGMTA4Q0YiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowQzY0NUJGRkFGQjMxMUU3QjQwMUM2RkVFMUYxMDhDRiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowQzY0NUMwMEFGQjMxMUU3QjQwMUM2RkVFMUYxMDhDRiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PiVStbwAAAO9SURBVHja7JtJaBRBFIYrGkRQENwTEHGBEfEg3vSoF1FE3IgXxRwikoungOjBRL0IRr2YiAcVEYISRZkoGpMgLjNeIoNxa0ZEIxqMxg2XuGX8H11hos5kpnuqqjPV74efSjJTVV1fV1fXe90pcRwnJVi+NYoRMEAGyAAZIIsBMkAGyABZDJABMkAGyGKAFgHshd8xQG+6Da+Hx0cikWnwJPw8Ed4EJ2wDWKIwofoL3g5gDdm+gL7ohO2C66hvGwCWKmyrEvBOD/cFfD6AYi9AfkFZz5dwWk254P0D8iCKawwwrTofdWoZoKvHmFGOj3px+BUDFOKBn0qATjevRwxQiP4C6n5jgEKUF1B3OgMUYjG2JeO8VkId2lwvYoBCjIU3+6i31YZYXNUAajGjyjzMvtkodvA2Jq2pcAvATMkDHq2ZUXgCx8L/q5viYfii3KYMBUexbwVMUUiZ4nFQiNgO34Kfw2PgefAaeFYxARxUEr4iB0Ptz4FXwTM09HWcIiGcsO4syQvKAh2AJxcTQBPqgzcCXFsey8ZMWmLgBSN1DTStl7R9ygeejHroSlgKP2SAboZ7GaAkPYaOb1CshN+GGSDdLCp8Ji8I4jMUW8IMcH++l+0wEC+hOBlGgE/gPYraqoE/hA1gNWZPv4qG0A6tg/vCBPAqBq36EUCDihtKsQDcqbpBnBDKRdaHAWALBntXU9uN8CfbAR7S1TBOzEcUp2wG2IVBdmju45jNAI/q7gAnqEu4TwitA/gDbjLU1wkbAVJO8b2hvs4J990eqwCeMdURThQlKFr91C3VcDyf4Zhws9OjhZvun0vH6aENevnosuETdhZeESTA1/Bu2hbITepfchyHQK6mkAxemKOt9kxtaBYlGQa8XpWqMtI34XUy55ZT6HMtisMie4qf4t5G02sGjoteDl1ieg2kBznL84Un15zzKObLxTtj7BvQuhs1fRN5IWfeVx8LN62VGzLs9ZL47GlAAFtNA6zCYHsLuPul5Jp4Ycifg3zxkt7h7jMFsBkACr7UJMRK4T4oGlwSApF8BbnDBMCUvOOqOnDKDtfIX2MB7z+vmwAYxaBVPyKkjXNMPoIMUnETAI9ounyqRkAEdE9u5LUB7IHbdBy5hlnt5xh+o7ijE2CznC02K64TYFTYr5gugD+F+79wtqtTF8BOP1FHsUkGBz06AN4Q4VFCB8AEAywM4P0QAcxrrF4TqtWO43wPCcByHQC3CZaSUI7FABkgA2SALAbIABkgA2SALAbIABlgSPVHgAEAjb728HeZGTYAAAAASUVORK5CYII="},oyc9:function(e,t){},pRNm:function(e,t){e.exports=VueRouter},pROI:function(e,t){},pThe:function(e,t){},qofe:function(e,t){},sKg4:function(e,t){},t8X1:function(e,t){},"t9M/":function(e,t){},tt8p:function(e,t){},tvR6:function(e,t){},tzAU:function(e,t){},"u/OI":function(e,t){},u0Ez:function(e,t){},u8g3:function(e,t){},x4E0:function(e,t){},xHyU:function(e,t){},y6mx:function(e,t,a){e.exports=a.p+"static/img/navbar.bf48624.png"},yHTX:function(e,t){},yVXe:function(e,t){},zskF:function(e,t){}},["NHnr"]);